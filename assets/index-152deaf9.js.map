{"version":3,"file":"index-152deaf9.js","sources":["../../src/utils/Listener.ts","../../src/Camera/CameraManager.ts","../../src/GameEvents/GameEvents.ts","../../src/Camera/eventListeners.ts","../../src/RemoteMic/Network/utils.ts","../../src/RemoteMic/Network/sendEvent.ts","../../src/RemoteMic/RemoteMicInput.ts","../../src/Scenes/Settings/SettingsState.ts","../../src/utils/storage.ts","../../src/RemoteMic/RemoteMicManager.ts","../../src/Stats/lastVisit.ts","../../src/Songs/utils/isNotesSection.ts","../../src/Songs/utils/notesSelectors.ts","../../src/utils/clearString.ts","../../scripts/utils.ts","../../src/Songs/SongDao.ts","../../src/RemoteMic/Network/TheServer.ts","../../src/utils/isE2E.ts","../../src/utils/peerJSOptions.ts","../../src/RemoteMic/Network/P2PServer.ts","../../src/RemoteMic/Network/WebRTCServer.ts","../../src/Scenes/Game/Singing/Input/DrawingTestInput.tsx","../../src/Scenes/Game/Singing/Input/DummyInput.tsx","../../src/Scenes/Game/Singing/Input/MicStrategies/Aubio.ts","../../src/UserMedia/userMediaService.ts","../../src/Scenes/Game/Singing/Input/MicInput.tsx","../../src/Scenes/Game/Singing/Input/RemoteMicInput.tsx","../../src/Players/utils.ts","../../src/Scenes/SelectInput/InputSources/DrawingTest.ts","../../src/Scenes/SelectInput/InputSources/Microphone.ts","../../src/Scenes/SelectInput/InputSources/Remote.ts","../../src/Scenes/Game/Singing/Input/InputManager.ts","../../src/Scenes/SelectInput/InputSources/Dummy.ts","../../src/Scenes/SelectInput/InputSources/index.ts","../../src/Players/PlayersManager.ts","../../src/RemoteMic/eventListeners.tsx","../../src/Scenes/Game/eventListeners.ts","../../src/Songs/stats/common.ts","../../src/Songs/stats/index.ts","../../src/hooks/players/consts.ts","../../src/Stats/players.ts","../../src/Scenes/Game/Singing/Input/SimplifiedMic.tsx","../../src/RemoteMic/Network/TheClient.ts","../../src/RemoteMic/Network/WebRTCClient.ts","../../src/Songs/utils/getSongBeatLength.ts","../../src/interfaces.ts","../../src/consts.ts","../../src/utils/pitchToFrequency.ts","../../src/Scenes/Game/Singing/GameState/Helpers/calcDistance.tsx","../../src/Scenes/Game/Singing/GameState/Helpers/detectVibrato.ts","../../src/Scenes/Game/Singing/GameState/Helpers/appendFrequencyToPlayerNotes.ts","../../src/Scenes/Game/Singing/Helpers/getPlayerNoteDistance.ts","../../src/Scenes/Game/Singing/GameState/Helpers/calculateScore.ts","../../src/Scenes/Game/Singing/GameState/Helpers/getCurrentBeat.ts","../../src/Scenes/Game/Singing/GameState/GameState.ts","../../src/utils/exposeSingletons.ts","../../src/utils/isDev.ts","../../src/GameEvents/hooks.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/styles.ts","../../src/Elements/cssMixins.ts","../../src/hooks/useKeyboard.ts","../../src/Scenes/KeyboardHelp/HelpView.tsx","../../src/Scenes/KeyboardHelp/Context.tsx","../../src/Elements/LayoutWithBackground.tsx","../../src/Elements/NormalizeFontSize.tsx","../../src/Elements/MicIcon.tsx","../../src/Scenes/RemoteMic/BottomBar.tsx","../../src/Elements/Button.tsx","../../src/Elements/Menu.tsx","../../src/Elements/Switcher.tsx","../../src/Elements/Input.tsx","../../src/Scenes/RemoteMic/Panels/Microphone/Connect.tsx","../../src/hooks/useDebounce.ts","../../src/Scenes/RemoteMic/Panels/Microphone/RemoteSongSearch.tsx","../../src/Scenes/RemoteMic/Panels/Microphone/Keyboard.tsx","../../src/Elements/Modal.tsx","../../src/Scenes/RemoteMic/Components/PlayerChangeModal.tsx","../../src/Scenes/RemoteMic/Components/PlayerNumberCircle.tsx","../../src/Scenes/RemoteMic/Panels/Microphone/PlayerChange.tsx","../../src/Scenes/RemoteMic/hooks/usePermissions.ts","../../src/Scenes/RemoteMic/Panels/Microphone/VolumeIndicator.tsx","../../src/Scenes/RemoteMic/Panels/Microphone/MicPreview.tsx","../../src/Scenes/RemoteMic/Panels/Microphone/Ping.tsx","../../src/UserMedia/hooks.ts","../../src/utils/isOpera.ts","../../src/UserMedia/allow-mic.png","../../src/UserMedia/enable-mic-opera.png","../../src/UserMedia/enable-mic.png","../../src/UserMedia/UserMediaEnabled.tsx","../../src/Scenes/RemoteMic/Panels/Microphone.tsx","../../src/Scenes/RemoteMic/Panels/Microphone/ConfirmReadiness.tsx","../../src/Scenes/RemoteMic/Panels/RemoteSettings/ManagePlayers.tsx","../../src/Scenes/RemoteMic/Panels/RemoteSettings.tsx","../../src/Songs/hooks/useSongIndex.ts","../../src/utils/languageNameToIsoCode.ts","../../src/Scenes/RemoteMic/Panels/RemoteSongList.tsx","../../src/Scenes/RemoteMic/RemoteMic.tsx","../../src/Elements/dotparty.gif","../../src/Elements/logo.gif","../../src/Elements/pride.png","../../src/Elements/Logo.tsx","../../src/utils/isChromium.ts","../../src/Elements/RecommendedBrowsers.tsx","../../src/Scenes/Welcome/GithubRibbon.tsx","../../src/Elements/MenuWithLogo.tsx","../../src/assets/166500__thompsonman__camera-shutter.wav","../../src/assets/376817__original_sound__impact-cinematic.wav","../../src/assets/421888__b-sean__retro.mp3","../../src/assets/Funk Cool Groove (No Copyright Music) By Anwar Amr.mp3","../../src/assets/menu_back.wav","../../src/assets/menu_enter.wav","../../src/assets/menu_navigate.wav","../../src/SoundManager.ts","../../src/hooks/useBackgroundMusic.ts","../../src/hooks/useKeyboardHelp.ts","../../src/hooks/useKeyboardNav.ts","../../src/utils/startViewTransition.ts","../../src/hooks/useSmoothNavigate.ts","../../src/Scenes/Settings/InputLag.tsx","../../src/Scenes/Settings/Settings.tsx","../../src/Scenes/Convert/Elements.tsx","../../src/Songs/utils/convertTxtToSong.ts","../../src/Scenes/Convert/Steps/AuthorAndVid.tsx","../../src/Scenes/Convert/importUltrastarEsSong.ts","../../src/Scenes/Convert/Steps/BasicData.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/formatMs.tsx","../../src/Scenes/Convert/Steps/PreviewAndVolumeAdjustment.tsx","../../src/Scenes/Convert/Steps/SongMetadata.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Components/AdjustPlayback.tsx","../../src/Scenes/Game/Singing/Hooks/useCurrentSectionIndex.ts","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Components/EditSection.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Components/ListTracks.tsx","../../src/Scenes/Convert/calculateProperBpm.ts","../../src/Scenes/Game/Singing/GameState/Helpers/beatToMs.ts","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Components/ManipulateBpm.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Components/ShiftGap.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Components/ShiftVideoGap.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseSectionPaddings.ts","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/addHeadstart.ts","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseGap.ts","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseLyricSpaces.ts","../../src/hooks/usePlayerVolume.ts","../../src/hooks/useUnstuckYouTubePlayer.ts","../../src/Elements/VideoPlayer/Youtube.tsx","../../src/Elements/VideoPlayer/DirectVideo.tsx","../../src/Elements/VideoPlayer/dummy.mp4","../../src/Elements/VideoPlayer/Offline.tsx","../../src/Elements/VideoPlayer/index.tsx","../../src/Elements/Menu/Heading.tsx","../../src/Scenes/SelectInput/SelectPreference.tsx","../../src/hooks/players/usePlayerMic.ts","../../src/Elements/VolumeIndicator.tsx","../../src/Scenes/ConnectRemoteMic/ConnectRemoteMic.tsx","../../src/Scenes/SelectInput/hooks/useMicrophoneList.ts","../../src/Scenes/SelectInput/hooks/usePlayerInput.ts","../../src/Scenes/SelectInput/hooks/useRemoteMicAutoselect.ts","../../src/utils/isWindows.ts","../../src/Scenes/SelectInput/Variants/Advanced.tsx","../../src/Scenes/SelectInput/MicCheck.tsx","../../src/Scenes/SelectInput/Variants/BuiltIn.tsx","../../src/Scenes/SelectInput/Variants/RemoteMics.tsx","../../src/Scenes/SelectInput/Variants/SingStarMics.tsx","../../src/Scenes/SelectInput/Variants/Skip.tsx","../../src/Scenes/SelectInput/SelectInputView.tsx","../../src/Scenes/SelectInput/SelectInputModal.tsx","../../src/Scenes/Game/Singing/GameOverlay/Components/PauseMenu.tsx","../../src/Songs/utils/getSongFirstNoteMs.ts","../../src/Songs/utils/getSkipIntroTime.ts","../../src/utils/songHasLongIntro.ts","../../src/Scenes/Game/Singing/GameOverlay/Components/SkipIntro.tsx","../../src/Scenes/Game/Singing/GameOverlay/Components/SkipOutro.tsx","../../src/Scenes/Game/Singing/GameOverlay/Components/DurationBar.tsx","../../src/Scenes/SingASong/SongSelection/SongSettings/MicCheck/Ping.tsx","../../src/Scenes/SingASong/SongSelection/SongSettings/MicCheck/Status.tsx","../../src/hooks/players/usePlayerMicStatus.ts","../../src/Scenes/Game/Singing/GameOverlay/Components/LyricsVolumeIndicator.tsx","../../src/Scenes/Game/Singing/GameOverlay/Components/Lyrics.tsx","../../src/Scenes/Game/Singing/GameOverlay/Components/ScoreText.tsx","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/utils/getNoteColor.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/triangle.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/utils.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/SungTriangle.ts","../../src/utils/randomValue.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/calculateData.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/roundRect.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/applyColor.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/Elements/note.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/Elements/playerNote.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/spriteMap.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/utils/createCanvas.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/cachedSprites.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/spriteWithStartAndEnd.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/note.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/playerFrequencyTrace.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/playerNote.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/ParticleManager.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/Triangle.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/ExplodingNote.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/FadeoutNote.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/utils/loadImage.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/ray-particle.png","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/Ray.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/Vibrato.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/CanvasDrawing.ts","../../src/Scenes/Game/Singing/GameOverlay/GameOverlay.tsx","../../src/Scenes/Game/Singing/Player.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/EditSong.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo.tsx","../../src/Scenes/Convert/Convert.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/fixVideoGap.ts","../../src/Songs/hooks/useSong.ts","../../src/Scenes/Edit/Edit.tsx","../../src/Songs/utils/convertSongToTxt.ts","../../src/Scenes/Edit/SongList.tsx","../../src/Scenes/ExcludeLanguages/ExcludeLanguagesView.tsx","../../src/Scenes/SingASong/SongSelection/Hooks/useSongList.ts","../../src/Scenes/SingASong/SongSelection/Hooks/selectRandomSong.ts","../../src/hooks/usePrevious.ts","../../src/Scenes/SingASong/SongSelection/Hooks/useSongSelectionKeyboardNavigation.ts","../../src/Scenes/SingASong/SongSelection/Hooks/useSongSelection.ts","../../src/Scenes/SingASong/SongSelection/Playlists.tsx","../../src/Scenes/SingASong/SongSelection/QuickSearch.tsx","../../src/Scenes/SingASong/SongSelection/SelectRandomTip.tsx","../../src/Songs/stats/hooks.ts","../../src/Scenes/SingASong/SongSelection/SongCard.tsx","../../src/Scenes/SingASong/SongSelection/SongSettings/GameSettings.tsx","../../src/Scenes/SingASong/SongSelection/SongSettings/MicCheck/NoiseDetection.tsx","../../src/Scenes/SingASong/SongSelection/SongSettings/MicCheck/SinglePlayer.tsx","../../src/Scenes/SingASong/SongSelection/SongSettings/MicCheck.tsx","../../src/Elements/Autocomplete.tsx","../../src/Scenes/SingASong/SongSelection/SongSettings/PlayerSettings/SinglePlayer.tsx","../../src/Scenes/SingASong/SongSelection/SongSettings/PlayerSettings.tsx","../../src/Scenes/SingASong/SongSelection/SongSettings/SongSettings.tsx","../../src/hooks/useViewportSize.ts","../../src/Scenes/SingASong/SongSelection/SongPreview.tsx","../../src/hooks/useBlockScroll.ts","../../src/Scenes/SingASong/SongSelection/SongSelection.tsx","../../src/Scenes/SingASong/SingASong.tsx","../../src/hooks/useFullscreen.ts","../../src/Elements/TransitionWrapper.tsx","../../src/assets/459342__papaninkasettratat__cinematic-music-short.mp3","../../src/utils/sleep.ts","../../src/Scenes/Game/Singing/WaitForReadiness.tsx","../../src/Scenes/Game/Singing/Helpers/generatePlayerChanges.ts","../../src/Elements/GameTip.tsx","../../src/Scenes/Game/Singing/PostGame/Views/Results/CameraRoll.tsx","../../src/Scenes/Game/SongPage.tsx","../../src/Scenes/Game/Singing/PostGame/Views/Results/PlayerScore.tsx","../../src/Scenes/Game/Singing/PostGame/Views/Results.tsx","../../src/hooks/players/useRecentPlayerNames.ts","../../src/Scenes/Game/Singing/PostGame/Views/HighScoreRename.tsx","../../src/Scenes/Game/Singing/PostGame/Views/HighScores.tsx","../../src/Scenes/Game/Singing/PostGame/PostGameView.tsx","../../src/Scenes/Game/Singing/PostGame/PostGame.tsx","../../src/Scenes/Game/Singing/Singing.tsx","../../src/Scenes/Game/Game.tsx","../../src/Scenes/Jukebox/Jukebox.tsx","../../src/Scenes/SelectInput/SelectInput.tsx","../../src/Elements/ErrorFallback.tsx","../../src/styles.ts","../../src/Elements/GameScreens.tsx","../../src/Scenes/Edit/GetSongsBPMs.tsx","../../src/Scenes/ExcludeLanguages/ExcludeLanguages.tsx","../../src/Scenes/ManageSongs/ManageSongs.tsx","../../src/Scenes/QuickSetup/SuggestMobileMode.tsx","../../src/Scenes/QuickSetup/QuickSetup.tsx","../../src/Scenes/Settings/RemoteMicSettings.tsx","../../src/Scenes/Welcome/FacebookLink.tsx","../../src/Scenes/Welcome/Welcome.tsx","../../src/Toolbar/Fullscreen.tsx","../../src/Toolbar/QRCodeModal.tsx","../../src/Toolbar/Toolbar.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["type Callback<ARG extends Array<any>> = (...args: ARG) => void;\nexport default class Listener<ARG extends Array<any> = []> {\n    private listeners: Callback<ARG>[] = [];\n    protected onUpdate = (...args: ARG) => {\n        this.listeners.forEach((callback) => callback(...args));\n    };\n\n    public addListener = (listener: Callback<ARG>) => {\n        this.listeners.push(listener);\n\n        return () => {\n            this.removeListener(listener);\n        };\n    };\n\n    public removeListener = (listener: Callback<ARG>) => {\n        this.listeners = this.listeners.filter((callback) => callback !== listener);\n    };\n\n    public clearAllListeners = () => {\n        console.log('clearing all listeners');\n        this.listeners = [];\n    };\n}\n","import Listener from 'utils/Listener';\n\nconst CAMERA_GRANT_KEY = 'CAMERA_GRANT_KEY';\n\nconst storedGrant = localStorage.getItem(CAMERA_GRANT_KEY);\n\nclass CameraManager extends Listener<[boolean]> {\n    private canvas: HTMLCanvasElement;\n    private video: HTMLVideoElement;\n    private stream: MediaStream | null = null;\n    private recorder: MediaRecorder | null = null;\n    private videoData: Blob[] = [];\n\n    public constructor() {\n        super();\n        this.video = document.createElement('video');\n        this.video.width = 480;\n        this.video.height = this.video.width * (9 / 16);\n\n        this.canvas = document.createElement('canvas');\n        this.canvas.width = this.video.width;\n        this.canvas.height = this.video.height;\n    }\n\n    private permissionGranted: boolean | null = storedGrant !== null ? JSON.parse(storedGrant) : null;\n    public requestPermissions = async () => {\n        try {\n            this.stream = await navigator.mediaDevices.getUserMedia({ video: true });\n            this.permissionGranted = true;\n            await this.stopRecord();\n        } catch (e) {\n            this.permissionGranted = false;\n        }\n        localStorage.setItem(CAMERA_GRANT_KEY, JSON.stringify(this.permissionGranted));\n        this.onUpdate(this.permissionGranted);\n\n        return this.permissionGranted;\n    };\n\n    public disable = () => {\n        this.permissionGranted = false;\n        localStorage.setItem(CAMERA_GRANT_KEY, JSON.stringify(this.permissionGranted));\n        this.onUpdate(this.permissionGranted);\n    };\n\n    public startRecord = async () => {\n        if (!this.permissionGranted) return;\n        this.stream = await navigator.mediaDevices.getUserMedia({ video: { frameRate: 2 } });\n\n        const settings = this.stream.getVideoTracks()[0].getSettings();\n\n        this.video.width = settings.width ?? this.video.width;\n        this.video.height = settings.height ?? this.video.height;\n        this.canvas.width = this.video.width;\n        this.canvas.height = this.video.height;\n        this.video.srcObject = this.stream;\n        await this.video.play();\n\n        this.recorder = new MediaRecorder(this.stream, { mimeType: 'video/webm' });\n\n        this.recorder.ondataavailable = (evt) => {\n            this.videoData.push(evt.data);\n        };\n\n        this.recorder.start();\n    };\n\n    public getVideo = () => {\n        const blob = new Blob(this.videoData, { type: 'video/webm' });\n\n        return URL.createObjectURL(blob);\n    };\n\n    public stopRecord = async () => {\n        if (!this.permissionGranted) return;\n        this.recorder?.stop();\n        this.stream?.getTracks().forEach((track) => track.stop());\n    };\n    public clearData = () => {\n        this.videoData.length = 0;\n    };\n\n    public restartRecord = async () => {\n        await this.stopRecord();\n        await this.clearData();\n        await this.startRecord();\n    };\n\n    public getPermissionStatus = () => this.permissionGranted;\n}\n\nexport default new CameraManager();\n","import { SelectedPlayerInput } from 'Players/PlayersManager';\nimport {\n    WebRTCRemoteMicListEvent,\n    WebRTCSetPermissionsEvent,\n    WebRTCSubscribeEvent,\n    keyStrokes,\n} from 'RemoteMic/Network/events';\nimport { HelpEntry } from 'Scenes/KeyboardHelp/Context';\nimport { SongStats } from 'Songs/stats/common';\nimport { PeerErrorType, SingSetup, Song, SongPreview } from 'interfaces';\nimport posthog from 'posthog-js';\nimport { transportErrorReason } from 'RemoteMic/Network/TheClient';\n\nexport class GameEvent<T extends (...args: any[]) => void> {\n    protected subscribers: Array<T> = [];\n    public lastParams: Parameters<T> | null = null;\n\n    public subscribe = (callback: T, getLast = false) => {\n        this.unsubscribe(callback);\n        this.subscribers.push(callback);\n        if (getLast && this.lastParams !== null) {\n            callback(...this.lastParams);\n        }\n    };\n\n    public unsubscribe = (callback: T) => {\n        this.subscribers = this.subscribers.filter((cb) => cb !== callback);\n    };\n\n    public dispatch = (...args: Parameters<T>) => {\n        this.log && console.log('dispatch', this.name, ...args);\n        this.subscribers.forEach((callback) => callback(...args));\n        this.lastParams = args;\n\n        if (this.track) {\n            posthog.capture(this.name, this.track instanceof Function ? this.track(...args) : args);\n        }\n    };\n\n    public constructor(\n        private name: string,\n        private track: boolean | ((...args: Parameters<T>) => any) = false,\n        private log = true,\n    ) {}\n}\n\nexport const events = {\n    sectionChange: new GameEvent<(player: number, previousSectionIndex: number) => void>(\n        'sectionChange',\n        undefined,\n        false,\n    ),\n    // newPlayerNote: new GameEvent<(player: number, playerNote: PlayerNote) => void>('//', true),\n    // playerNoteUpdate: new GameEvent<(player: number, playerNote: PlayerNote) => void>('//', true),\n\n    songStarted: new GameEvent<(song: Song | SongPreview, singSetup: SingSetup) => void>('songStarted', false),\n    songEnded: new GameEvent<\n        (song: Song | SongPreview, singSetup: SingSetup, scores: Array<{ name: string; score: number }>) => void\n    >('songEnded', false),\n\n    remoteMicConnected: new GameEvent<(remoteMic: { id: string; name: string; silent: boolean }) => void>(\n        'remoteMicConnected',\n    ),\n    remoteMicDisconnected: new GameEvent<(remoteMic: { id: string; name: string }, silent: boolean) => void>(\n        'remoteMicDisconnected',\n    ),\n    playerNameChanged: new GameEvent<(playerNumber: number, oldName: string | undefined) => void>('playerNameChanged'),\n    playerInputChanged: new GameEvent<\n        (playerNumber: number, oldInput: SelectedPlayerInput | undefined, newInput: SelectedPlayerInput) => void\n    >('playerInputChanged', (player, oldI, newI) => ({ player, old: oldI?.source, new: newI.source })),\n    inputListChanged: new GameEvent<(initial: boolean) => void>('inputListChanged'),\n\n    karaokeConnectionStatusChange: new GameEvent<\n        (\n            status: 'connecting' | 'connected' | 'disconnected' | 'reconnecting' | 'error',\n            e?: transportErrorReason,\n        ) => void\n    >('karaokeConnectionStatusChange'),\n    remoteMicPlayerSet: new GameEvent<(playerNumber: number | null) => void>('remoteMicPlayerSet'),\n    remoteMicMonitoringStarted: new GameEvent('remoteMicMonitoringStarted'),\n    remoteMicMonitoringStopped: new GameEvent('remoteMicMonitoringStopped'),\n\n    micMonitoringStarted: new GameEvent('micMonitoringStarted'),\n    micMonitoringStopped: new GameEvent('micMonitoringStopped'),\n    playerChangeRequested: new GameEvent<(remoteMicId: string, newPlayerNumber: number | null) => void>(\n        'playerChangeRequested',\n        true,\n    ),\n\n    songStatStored: new GameEvent<(key: string, stats: SongStats) => void>('songStatStored'),\n    songScoreUpdated: new GameEvent<(key: string, stats: SongStats, newName: string) => void>(\n        'songScoreUpdated',\n        () => undefined,\n    ),\n\n    remoteMicSubscribed: new GameEvent<(id: string, channel: WebRTCSubscribeEvent['channel']) => void>(\n        'remoteMicSubscribed',\n    ),\n    remoteKeyboardPressed: new GameEvent<(key: keyStrokes) => void>('remoteKeyboardPressed', true),\n    remoteSongSearch: new GameEvent<(search: string) => void>('remoteSongSearch', true),\n    remoteMicListUpdated: new GameEvent<(list: WebRTCRemoteMicListEvent['list']) => void>('remoteMicListUpdated'),\n    remoteKeyboardLayout: new GameEvent<(help: HelpEntry | undefined) => void>('remoteKeyboardLayout'),\n    remoteReadinessRequested: new GameEvent('remoteReadinessRequested'),\n    remoteMicPermissionsSet: new GameEvent<(level: WebRTCSetPermissionsEvent['level']) => void>(\n        'remoteMicPermissionsSet',\n    ),\n    readinessConfirmed: new GameEvent<(deviceId: string) => void>('remoteReadinessConfirmed'),\n};\n\nexport default events;\n","import CameraManager from 'Camera/CameraManager';\nimport events from 'GameEvents/GameEvents';\n\nevents.songStarted.subscribe(() => {\n    CameraManager.clearData();\n    CameraManager.startRecord();\n});\nevents.songEnded.subscribe(() => {\n    CameraManager.stopRecord();\n});\n","import * as msgpackr from 'msgpackr';\n\nexport function getPingTime() {\n    return Date.now();\n}\n\nexport const pack = <T>(data: T): Buffer => {\n    return msgpackr.pack(data);\n};\n\nexport const unpack = <T>(buffer: Uint8Array): T => {\n    return msgpackr.unpack(buffer);\n};\n","import { DataConnection } from 'peerjs';\nimport { WebRTCEvents } from 'RemoteMic/Network/events';\n\nfunction sendEvent<T extends WebRTCEvents>(\n    connection: DataConnection | null | undefined,\n    type: T['t'],\n    payload?: Omit<T, 't'>,\n) {\n    connection?.send({ t: type, ...payload });\n}\n\nexport default sendEvent;\n","import { WebRTCEvents, WebRTCSetPermissionsEvent } from 'RemoteMic/Network/events';\nimport { getPingTime } from 'RemoteMic/Network/utils';\nimport Peer from 'peerjs';\nimport sendEvent from './Network/sendEvent';\n\nclass RemoteMicInput {\n    private frequencies: number[] | number[][] = [0];\n    private volumes = [0];\n\n    private requestReadinessPromise: null | Promise<boolean> = null;\n\n    public constructor(private connection: Peer.DataConnection) {}\n\n    getChannelsCount = () => 1;\n\n    getFrequencies = () => {\n        const freqs = this.frequencies;\n\n        if (Array.isArray(freqs[0])) {\n            this.frequencies = [freqs[0].at(-1)!];\n        }\n        return freqs;\n    };\n    getVolumes = () => this.volumes;\n\n    getInputLag = () => 200;\n\n    requestReadiness = () => {\n        console.log('requestReadiness');\n        if (!this.requestReadinessPromise) {\n            this.requestReadinessPromise = new Promise<boolean>((resolve) => {\n                const listener = (data: WebRTCEvents) => {\n                    if (data.t === 'confirm-readiness') {\n                        resolve(true);\n                        this.connection.off('data', listener);\n                        this.requestReadinessPromise = null;\n                    }\n                };\n\n                this.connection.on('data', listener);\n\n                sendEvent(this.connection, 'request-readiness');\n            });\n        }\n        return this.requestReadinessPromise!;\n    };\n    startMonitoring = async () => {\n        sendEvent(this.connection, 'start-monitor');\n\n        this.connection?.on('data', this.handleRTCData);\n    };\n\n    stopMonitoring = async () => {\n        sendEvent(this.connection, 'stop-monitor');\n\n        this.connection?.off('data', this.handleRTCData);\n    };\n\n    private handleRTCData = (data: WebRTCEvents) => {\n        if (data.t === 'freq') {\n            this.frequencies = [data[0], data[0]];\n            this.volumes = [data[1], data[1]];\n        }\n    };\n}\n\nexport class RemoteMic {\n    private input: RemoteMicInput;\n    private pingTime: number = 9999;\n    private pingInterval: ReturnType<typeof setTimeout> | null = null;\n    constructor(public id: string, public name: string, public connection: Peer.DataConnection) {\n        this.input = new RemoteMicInput(connection);\n\n        this.pingClient();\n    }\n\n    public getInput = () => this.input;\n\n    public setPlayerNumber = (playerNumber: number | null) => {\n        sendEvent(this.connection, 'set-player-number', { playerNumber });\n    };\n\n    public onDisconnect = () => {\n        if (this.pingInterval !== null) {\n            clearInterval(this.pingInterval);\n        }\n    };\n\n    public setPermission = (level: WebRTCSetPermissionsEvent['level']) => {\n        sendEvent<WebRTCSetPermissionsEvent>(this.connection, 'set-permissions', { level });\n    };\n\n    private isPinging = false;\n    private latency: number = 9999;\n\n    public onPong = () => {\n        this.latency = getPingTime() - this.pingTime;\n        this.isPinging = false;\n\n        this.pingClient();\n    };\n\n    private pingClient = () => {\n        this.pingInterval = setTimeout(() => {\n            this.pingTime = getPingTime();\n            this.isPinging = true;\n            sendEvent(this.connection, 'ping');\n        }, 1000);\n    };\n\n    public getLatency = () => (this.isPinging ? getPingTime() - this.pingTime : this.latency);\n\n    public getPingTime = () => this.pingTime;\n}\n","import { milliseconds } from 'interfaces';\nimport { useEffect, useState } from 'react';\nimport { ValuesType } from 'utility-types';\n\nclass Setting<T> {\n    private value: T | undefined = undefined;\n\n    private listeners: Array<(newValue: T) => void> = [];\n    public constructor(\n        private name: string,\n        private defaultValue: T,\n        private driver: 'localStorage' | 'sessionStorage' = 'localStorage',\n    ) {}\n\n    public get = (): T => {\n        if (this.value === undefined) {\n            this.value = JSON.parse(window[this.driver].getItem(`settings-${this.name}`)!) ?? this.defaultValue;\n        }\n        return this.value as T;\n    };\n\n    public set = (newValue: T) => {\n        this.value = newValue;\n\n        window[this.driver].setItem(`settings-${this.name}`, JSON.stringify(newValue));\n        this.listeners.forEach((listener) => listener(newValue));\n    };\n\n    public addListener = (newListener: (newValue: T) => void) => {\n        this.listeners.push(newListener);\n\n        return () => {\n            this.listeners = this.listeners.filter((listener) => listener !== newListener);\n        };\n    };\n}\n\nexport const GraphicsLevel = ['high', 'low'] as const;\nconst GRAPHICS_LEVEL_KEY = 'graphics-level';\nexport const GraphicSetting = new Setting<ValuesType<typeof GraphicsLevel>>(GRAPHICS_LEVEL_KEY, GraphicsLevel[0]);\n\nexport const MicSetupPreference = [null, 'skip', 'remoteMics', 'mics', 'advanced', 'built-in'] as const;\nconst MIC_SETUP_PREFERENCE_KEY = 'mic-setup-preference';\nexport const MicSetupPreferenceSetting = new Setting<ValuesType<typeof MicSetupPreference>>(\n    MIC_SETUP_PREFERENCE_KEY,\n    MicSetupPreference[0],\n    'sessionStorage',\n);\n\nexport const FpsCount = [60, 30] as const;\nexport const FPSCountSetting = new Setting<ValuesType<typeof FpsCount>>('fps-count', FpsCount[0]);\n\nexport const ExcludedLanguagesSetting = new Setting<string[] | null>('EXCLUDED_LANGUAGES_KEY_V2', null);\n\nexport const MobilePhoneModeSetting = new Setting<boolean | null>('MOBILE_PHONE_MODE_KEY', null);\n\nexport const InputLagSetting = new Setting<milliseconds>('INPUT_LAG', 0);\n\nexport const RemoteMicPermissions = ['write', 'read'] as const;\nexport const DefaultRemoteMicPermission = new Setting<ValuesType<typeof RemoteMicPermissions>>(\n    'DefaultRemoteMicPermission',\n    'write',\n);\n\nexport const BackgroundMusic = ['New', 'Classic'] as const;\nexport const BackgroundMusicSetting = new Setting<ValuesType<typeof BackgroundMusic>>(\n    'background-music',\n    BackgroundMusic[0],\n);\n\nexport function useSettingValue<T>(value: Setting<T>) {\n    const [currentValue, setCurrentValue] = useState(value.get());\n\n    useEffect(() => {\n        return value.addListener(setCurrentValue);\n    }, [value]);\n\n    return [currentValue, value.set] as const;\n}\n","const abstractStorage = (type: typeof sessionStorage | typeof localStorage) => ({\n    storeValue: <T>(key: string, value: T) => {\n        type.setItem(key, JSON.stringify(value));\n    },\n    getValue: <T = any>(key: string): T | null => {\n        const val = type.getItem(key);\n\n        if (val === null) {\n            return null;\n        }\n\n        return JSON.parse(val);\n    },\n});\n\nconst storage = {\n    ...abstractStorage(localStorage),\n    session: abstractStorage(sessionStorage),\n};\n\nexport default storage;\n","import events from 'GameEvents/GameEvents';\nimport { WebRTCEvents, WebRTCSetPermissionsEvent, WebRTCSubscribeEvent } from 'RemoteMic/Network/events';\nimport { RemoteMic } from 'RemoteMic/RemoteMicInput';\nimport { DefaultRemoteMicPermission } from 'Scenes/Settings/SettingsState';\nimport Peer from 'peerjs';\nimport Listener from 'utils/Listener';\nimport storage from 'utils/storage';\n\nconst RememberedAccessesKey = 'RememberedAccessesKey';\nconst RememberedSubscriptionsKey = 'rememberedSubscriptionsKey';\ntype subscriptionChannels = WebRTCSubscribeEvent['channel'];\n\nclass RemoteMicManager extends Listener<[string, WebRTCSetPermissionsEvent['level']]> {\n    private remoteMics: RemoteMic[] = [];\n    private micAccessMap: Record<string, WebRTCSetPermissionsEvent['level']> =\n        storage.getValue(RememberedAccessesKey) ?? {};\n\n    private subscriptions: Record<subscriptionChannels, string[]> = storage.session.getValue(\n        RememberedSubscriptionsKey,\n    ) ?? { 'remote-mics': [] };\n\n    public addRemoteMic = (id: string, name: string, connection: Peer.DataConnection, silent: boolean) => {\n        this.remoteMics = this.remoteMics.filter((remoteMic) => remoteMic.id !== id);\n        this.remoteMics = [...this.remoteMics, new RemoteMic(id, name, connection)];\n        this.setPermission(id, this.getPermission(id));\n\n        events.remoteMicConnected.dispatch({ id, name, silent });\n    };\n\n    public removeRemoteMic = (id: string, silent = false) => {\n        const remoteMic = this.remoteMics.find((remoteMic) => remoteMic.id === id);\n        this.remoteMics = this.remoteMics.filter((remoteMic) => remoteMic.id !== id);\n        if (remoteMic) {\n            remoteMic.onDisconnect();\n            events.remoteMicDisconnected.dispatch(remoteMic, silent);\n        }\n    };\n\n    public getRemoteMics = () => this.remoteMics;\n\n    public getRemoteMicById = (id: string) => this.remoteMics.find((remoteMic) => remoteMic.id === id);\n\n    public broadcast = (event: WebRTCEvents) => {\n        this.getRemoteMics().forEach((remoteMic) => remoteMic.connection.send(event));\n    };\n\n    public broadcastToChannel = (channel: subscriptionChannels, event: WebRTCEvents) => {\n        this.subscriptions[channel].forEach((id) => this.getRemoteMicById(id)?.connection.send(event));\n    };\n\n    public getPermission = (id: string) => this.micAccessMap[id] ?? DefaultRemoteMicPermission.get();\n\n    public setPermission = (id: string, permission: WebRTCSetPermissionsEvent['level']) => {\n        this.getRemoteMicById(id)?.setPermission(permission);\n\n        this.micAccessMap[id] = permission;\n\n        storage.storeValue(RememberedAccessesKey, this.micAccessMap);\n        this.onUpdate(id, permission);\n    };\n\n    public addSubscription = (id: string, channel: subscriptionChannels) => {\n        this.subscriptions[channel] = [...new Set([...this.subscriptions[channel], id])];\n        storage.session.storeValue(RememberedSubscriptionsKey, this.subscriptions);\n        events.remoteMicSubscribed.dispatch(id, channel);\n    };\n\n    public removeSubscription = (id: string, channel: subscriptionChannels) => {\n        this.subscriptions[channel] = this.subscriptions[channel]?.filter((remoteMicId) => remoteMicId !== id) ?? [];\n        storage.session.storeValue(RememberedSubscriptionsKey, this.subscriptions);\n    };\n}\n\nexport default new RemoteMicManager();\n","const CURRENT_VISIT_KEY = 'CURRENT_VISIT_KEY';\nconst LAST_VISIT_KEY = 'LAST_VISIT_KEY';\n\nconst VISIT_TIMEOUT_MS = 3 * 60 * 60 * 1_000;\n\nconst currentTime = Date.now();\nconst currentVisit = Number(localStorage.getItem(CURRENT_VISIT_KEY) ?? currentTime);\n\n// One of the few ways to determine if user already visited the site before\n// Note that this is simulated in E2E tests - adjust them if you change this\nconst isFirstVisit = localStorage.getItem('posthog-user-id') === null;\n\n// If it's the first visit, don't show new songs\n// If the user visited the site before, show new songs added since the functionality was implemented\nconst defaultLastVisit = isFirstVisit ? currentTime : 1673642382501; // implementation time\nlet lastVisit = Number(localStorage.getItem(LAST_VISIT_KEY) ?? defaultLastVisit);\n\nif (isFirstVisit || currentTime - currentVisit > VISIT_TIMEOUT_MS) {\n    localStorage.setItem(LAST_VISIT_KEY, String(currentVisit));\n    lastVisit = currentVisit;\n}\nlocalStorage.setItem(CURRENT_VISIT_KEY, String(currentTime));\n\nexport { lastVisit };\n","import { NotesSection, Section } from 'interfaces';\n\nexport default function isNotesSection(section: Section | undefined | null): section is NotesSection {\n    return section?.type === 'notes' && !!section.notes.length;\n}\n","import { NotesSection, Section } from 'interfaces';\nimport isNotesSection from './isNotesSection';\n\nexport const getFirstNoteStartFromSections = (sections: Section[]) => {\n    const firstNoteSection = sections.find(isNotesSection);\n\n    return firstNoteSection ? firstNoteSection.notes[0].start : Infinity;\n};\nexport const getLastNoteEndFromSections = (sections: Section[]) => {\n    const notesSections = sections.filter(isNotesSection);\n    const lastSection = notesSections.at(-1);\n\n    return lastSection ? getLastNoteEnd(lastSection) : 0;\n};\n\nexport const getLastNoteEnd = (section: NotesSection) => {\n    const lastNote = section.notes.at(-1)!;\n\n    return lastNote.start + lastNote.length;\n};\n\nexport const getNoteAtBeat = (section: NotesSection, beat: number, tolerance = 0) => {\n    return section.notes.find((note) => note.start - tolerance <= beat && note.start + note.length + tolerance >= beat);\n};\n","const ALPHANUMERIC_REGEX = /[^0-9a-z]/gi;\n\nexport default function clearString(str: string) {\n    return str.toLowerCase().normalize('NFKD').replace(ALPHANUMERIC_REGEX, '');\n}\n","import { Song, SongPreview } from \"../src/interfaces\";\nimport { getFirstNoteStartFromSections } from \"../src/Songs/utils/notesSelectors\";\nimport clearString from \"../src/utils/clearString\";\n\nconst generateSearchString = (song: Pick<Song, 'title' | 'artist'>) => clearString(`${song.artist}${song.title}`);\n\nexport const getSongPreview = (file: string, songData: Song, local = false): SongPreview => ({\n    ...songData,\n    file,\n    tracksCount: songData.tracks.length,\n    tracks: songData.tracks.map(({ name, sections }) => ({\n        name,\n        start: getFirstNoteStartFromSections(sections),\n    })),\n    search: generateSearchString(songData),\n    local,\n});\n","import { lastVisit } from 'Stats/lastVisit';\nimport { isAfter } from 'date-fns';\nimport { Song, SongPreview } from 'interfaces';\nimport localForage from 'localforage';\nimport { getSongPreview } from '../../scripts/utils';\n\nconst storage = localForage.createInstance({\n    name: 'songs',\n});\n\nconst DELETED_SONGS_KEY = 'DELETED_SONGS';\nconst SONGS_KEY = 'STORED_SONGS';\n\nclass SongDao {\n    private finalIndex: SongPreview[] | null = null;\n    private indexWithDeletedSongs: SongPreview[] | null = null;\n    public store = async (song: Song) => {\n        await storage.setItem(this.generateSongFile(song), { ...song, lastUpdate: new Date().toISOString() });\n        await this.reloadIndex();\n    };\n\n    public get = async (fileName: string) => {\n        const localSong = await this.getLocal(fileName);\n\n        if (!localSong) {\n            return await fetch(`./songs/${fileName}`).then((response) => response.json());\n        }\n\n        return localSong;\n    };\n\n    public getIndex = async (includeDeleted = false): Promise<SongPreview[]> => {\n        if (this.finalIndex === null) {\n            await this.reloadIndex();\n        }\n\n        return includeDeleted ? this.indexWithDeletedSongs! : this.finalIndex!;\n    };\n\n    public getCurrentIndex = () => this.finalIndex;\n\n    public getDeletedSongsList = async () => {\n        const list = await storage.getItem<string[]>(DELETED_SONGS_KEY);\n\n        return list ?? [];\n    };\n\n    public generateSongFile = (\n        song: Pick<Song | SongPreview, 'artist' | 'title'> & { file?: string },\n        extension = 'json',\n    ) => (song.file ? song.file : `${song?.artist}-${song?.title}.${extension}`.replace(/[^a-zA-Z0-9 .-]/, '-'));\n\n    public reloadIndex = async () => {\n        const [defaultIndex, storageIndex, deletedSongs] = await Promise.all([\n            fetch('./songs/index.json').then((response) => response.json() as Promise<SongPreview[]>),\n            this.getLocalIndex(),\n            this.getDeletedSongsList(),\n        ]);\n        const lastVisitDate = new Date(lastVisit);\n\n        const localSongs = storageIndex.map((song) => song.file);\n\n        this.indexWithDeletedSongs = [\n            ...storageIndex,\n            ...defaultIndex.filter((song) => !localSongs.includes(this.generateSongFile(song))),\n        ].map((song) => ({\n            ...song,\n            isNew: song.lastUpdate ? isAfter(new Date(song.lastUpdate), lastVisitDate) : false,\n            isDeleted: deletedSongs?.includes(this.generateSongFile(song)),\n        }));\n\n        this.indexWithDeletedSongs.sort((a, b) =>\n            `${a.artist} ${a.title}`.localeCompare(`${b.artist} ${b.title}`.toLowerCase()),\n        );\n\n        this.finalIndex = this.indexWithDeletedSongs.filter((song) => !song.isDeleted);\n    };\n\n    public deleteSong = async (fileName: string) => {\n        await storage.removeItem(fileName);\n\n        return this.reloadIndex();\n    };\n\n    public softDeleteSong = async (fileName: string) => {\n        const deletedItems = await this.getDeletedSongsList();\n        await storage.setItem(DELETED_SONGS_KEY, [...new Set([...deletedItems, fileName])]);\n        return this.reloadIndex();\n    };\n    public restoreSong = async (fileName: string) => {\n        const deletedItems = await this.getDeletedSongsList();\n        await storage.setItem(\n            DELETED_SONGS_KEY,\n            deletedItems.filter((item) => item !== fileName),\n        );\n        return this.reloadIndex();\n    };\n\n    private getLocal = async (fileName: string) => storage.getItem<Song>(decodeURIComponent(fileName));\n    public getLocalIndex = async () => {\n        const allSongs = await Promise.all((await this.getKeys()).map(this.getLocal));\n\n        return allSongs\n            .filter((song): song is Song => song !== null)\n            .map((song) => getSongPreview(this.generateSongFile(song), song, true));\n    };\n\n    private getKeys = async () => {\n        const specialKeys = [DELETED_SONGS_KEY];\n\n        return (await storage.keys()).filter((key) => !specialKeys.includes(key));\n    };\n}\n\nexport default new SongDao();\n","import events from 'GameEvents/GameEvents';\nimport { WebRTCEvents } from 'RemoteMic/Network/events';\nimport { pack, unpack } from 'RemoteMic/Network/utils';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport SongDao from 'Songs/SongDao';\nimport Listener from 'utils/Listener';\nimport { v4 } from 'uuid';\n\nconst ROOM_ID_KEY = 'room_id_key';\n\nexport const WEBSOCKETS_SERVER = import.meta.env.VITE_APP_WEBSOCKET_URL;\n\nexport interface ForwardedMessage {\n    t: 'forward';\n    sender: string;\n    payload: WebRTCEvents;\n}\n\ninterface WebsocketConnectedMessage {\n    t: 'connected';\n}\n\nexport type transportCloseReason = string;\nexport type transportErrorReason = string;\n\nexport interface ServerTransport extends Listener<[WebRTCEvents, SenderWrapper]> {\n    connect(\n        roomId: string,\n        onConnect: () => void,\n        onClose: (reason: transportCloseReason, originalEvent: any) => void,\n    ): void;\n    sendEvent(event: WebRTCEvents): void;\n}\n\nexport type WebsocketMessage = ForwardedMessage | WebsocketConnectedMessage;\n\nexport class WebSocketServerTransport extends Listener<[WebRTCEvents, SenderWrapper]> implements ServerTransport {\n    private connection: WebSocket | null = null;\n    public constructor(private pswd: string) {\n        super();\n    }\n\n    public connect(\n        roomId: string,\n        onConnect: () => void,\n        onClose: (reason: transportCloseReason, originalEvent: any) => void,\n    ) {\n        this.connection = new WebSocket(WEBSOCKETS_SERVER);\n        this.connection.binaryType = 'arraybuffer';\n        this.connection.onopen = () => {\n            this.connection?.send(pack({ t: 'register-room', id: roomId, pswd: this.pswd }));\n            onConnect();\n\n            this.connection?.addEventListener('message', (message) => {\n                const payload: WebsocketMessage = unpack(message.data);\n\n                // @ts-ignore\n                if (!['ping', 'pong', 'freq'].includes(payload?.payload?.t)) console.log('received', payload);\n\n                if (payload.t === 'forward') {\n                    const { sender, payload: data } = payload;\n                    const conn = new SenderWrapper(sender, this.connection!);\n\n                    this.onUpdate(data, conn);\n                }\n            });\n        };\n    }\n\n    public sendEvent = (event: WebRTCEvents) => {};\n\n    public close = () => {\n        this.connection?.close();\n    };\n}\n\ntype callback = (data: any) => void;\nclass SenderWrapper {\n    constructor(public peer: string, private socket: WebSocket) {}\n\n    public send = (payload: WebRTCEvents) => {\n        const data = { t: 'forward', recipients: [this.peer], payload };\n        if (!['ping', 'pong', 'freq'].includes(payload?.t)) console.log('sending', this.peer, payload);\n        this.socket.send(pack(data));\n    };\n\n    private callbacksMap: Map<callback, callback> = new Map();\n\n    public on = (event: string, callback: (data: any) => void) => {\n        if (event === 'data') {\n            this.callbacksMap.set(callback, (message) => {\n                const data: WebsocketMessage = unpack(message.data);\n                if (data.t === 'forward') {\n                    const { sender, payload } = data;\n                    if (sender === this.peer) {\n                        callback(payload);\n                    }\n                }\n            });\n            this.socket.addEventListener('message', this.callbacksMap.get(callback)!);\n        }\n    };\n\n    public off = (event: string, callback: (data: any) => void) => {\n        if (event === 'data') {\n            const actualCallback = this.callbacksMap.get(callback);\n            this.socket.removeEventListener('message', actualCallback!);\n            this.callbacksMap.delete(callback);\n        }\n    };\n}\n\nexport class TheServer {\n    private roomId = window.sessionStorage.getItem(ROOM_ID_KEY)!;\n    private started = false;\n\n    public constructor(private transport: ServerTransport) {\n        if (!this.roomId) {\n            this.roomId = v4();\n        }\n    }\n\n    public start = () => {\n        if (this.started) return;\n        this.started = true;\n        console.log('connection started', this.roomId);\n        window.sessionStorage.setItem(ROOM_ID_KEY, this.roomId);\n\n        this.transport.connect(\n            this.roomId,\n            () => {\n                this.transport.addListener((event, sender) => {\n                    const type = event.t;\n                    if (type === 'register') {\n                        // @ts-ignore\n                        RemoteMicManager.addRemoteMic(event.id, event.name, sender, event.silent);\n                    } else if (type === 'unregister') {\n                        RemoteMicManager.removeRemoteMic(sender.peer, true);\n                    } else if (type === 'subscribe-event') {\n                        RemoteMicManager.addSubscription(sender.peer, event.channel);\n                    } else if (type === 'unsubscribe-event') {\n                        RemoteMicManager.removeSubscription(sender.peer, event.channel);\n                    } else if (type === 'ping') {\n                        sender.send({ t: 'pong' } as WebRTCEvents);\n                    } else if (type === 'pong') {\n                        RemoteMicManager.getRemoteMicById(sender.peer)?.onPong();\n                    } else if (type === 'request-songlist') {\n                        Promise.all([SongDao.getLocalIndex(), SongDao.getDeletedSongsList()]).then(\n                            ([custom, deleted]) => {\n                                sender.send({\n                                    t: 'songlist',\n                                    custom: custom.map((song) => ({\n                                        artist: song.artist,\n                                        title: song.title,\n                                        video: song.video,\n                                        language: song.language,\n                                    })),\n                                    deleted,\n                                });\n                            },\n                        );\n                    } else if (RemoteMicManager.getPermission(sender.peer) === 'write') {\n                        if (type === 'keystroke') {\n                            events.remoteKeyboardPressed.dispatch(event.key);\n                        } else if (type === 'search-song') {\n                            events.remoteSongSearch.dispatch(event.search);\n                        } else if (type === 'request-mic-select') {\n                            events.playerChangeRequested.dispatch(event.id, event.playerNumber);\n                        }\n                    }\n                });\n            },\n            () => {\n                this.started = false;\n            },\n        );\n    };\n\n    public getRoomId = () => this.roomId;\n}\n","export default function isE2E() {\n    return window.isE2ETests || window.location.search.includes('e2e-test');\n}\n","import { PeerJSOption } from 'peerjs';\nimport isE2E from 'utils/isE2E';\n\nconst e2eOverrides: PeerJSOption = isE2E()\n    ? {\n          host: 'localhost',\n          port: 3001,\n          path: '/',\n      }\n    : {};\n\nconst options: PeerJSOption = {\n    ...e2eOverrides,\n    // debug: 3,\n};\n\nexport default options;\n","import events from 'GameEvents/GameEvents';\nimport { WebRTCEvents, WebRTCSongListEvent } from 'RemoteMic/Network/events';\nimport sendEvent from 'RemoteMic/Network/sendEvent';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport SongDao from 'Songs/SongDao';\nimport { Peer } from 'peerjs';\nimport peerJSOptions from 'utils/peerJSOptions';\nimport { v4 } from 'uuid';\n\nconst ROOM_ID_KEY = 'room_id_key';\n\nexport class P2PServer {\n    private roomId = window.sessionStorage.getItem(ROOM_ID_KEY)!;\n    private peer: Peer | null = null;\n    private started = false;\n\n    public constructor() {\n        if (!this.roomId) {\n            this.roomId = v4();\n        }\n\n        window.addEventListener('beforeunload', () => {\n            RemoteMicManager.getRemoteMics().forEach((remoteMic) => remoteMic.connection.close());\n            this.peer?.disconnect();\n        });\n    }\n\n    public start = () => {\n        if (this.started) return;\n        this.started = true;\n        console.log('connection started');\n        window.sessionStorage.setItem(ROOM_ID_KEY, this.roomId);\n\n        this.peer = new Peer(this.roomId, peerJSOptions);\n\n        this.peer.on('open', function (id) {\n            console.log('My peer ID is: ' + id);\n        });\n\n        this.peer.on('connection', (conn) => {\n            conn.on('data', (data: WebRTCEvents) => {\n                const type = data.t;\n                if (type === 'register') {\n                    RemoteMicManager.addRemoteMic(data.id, data.name, conn, data.silent);\n                } else if (type === 'unregister') {\n                    RemoteMicManager.removeRemoteMic(conn.peer, true);\n                } else if (type === 'subscribe-event') {\n                    RemoteMicManager.addSubscription(conn.peer, data.channel);\n                } else if (type === 'unsubscribe-event') {\n                    RemoteMicManager.removeSubscription(conn.peer, data.channel);\n                } else if (type === 'ping') {\n                    conn.send({ t: 'pong' } as WebRTCEvents);\n                } else if (type === 'pong') {\n                    RemoteMicManager.getRemoteMicById(conn.peer)?.onPong();\n                } else if (type === 'request-songlist') {\n                    Promise.all([SongDao.getLocalIndex(), SongDao.getDeletedSongsList()]).then(([custom, deleted]) => {\n                        sendEvent<WebRTCSongListEvent>(conn, 'songlist', {\n                            custom: custom.map((song) => ({\n                                artist: song.artist,\n                                title: song.title,\n                                video: song.video,\n                                language: song.language,\n                            })),\n                            deleted,\n                        });\n                    });\n                } else if (RemoteMicManager.getPermission(conn.peer) === 'write') {\n                    if (type === 'keystroke') {\n                        events.remoteKeyboardPressed.dispatch(data.key);\n                    } else if (type === 'search-song') {\n                        events.remoteSongSearch.dispatch(data.search);\n                    } else if (type === 'request-mic-select') {\n                        events.playerChangeRequested.dispatch(data.id, data.playerNumber);\n                    }\n                }\n            });\n\n            conn.on('open', () => {\n                console.log('connected');\n            });\n\n            conn.on('error', (data) => console.warn('error', data));\n\n            // iceStateChanged works - close/disconnected/error doesn't for some reason\n            // @ts-expect-error `iceStateChanged` is not included in TS definitions\n            conn.on('iceStateChanged', (state) => {\n                if (state === 'disconnected' || state === 'closed') {\n                    RemoteMicManager.removeRemoteMic(conn.peer);\n                }\n            });\n\n            conn.on('close', () => {\n                RemoteMicManager.removeRemoteMic(conn.peer);\n            });\n        });\n        this.peer.on('close', () => {\n            this.started = false;\n        });\n    };\n\n    public getRoomId = () => this.roomId;\n}\n","import { TheServer, WebSocketServerTransport } from 'RemoteMic/Network/TheServer';\nimport { P2PServer } from './P2PServer';\n\nif (window.location.search.includes('pswd')) {\n    const urlParams = new URLSearchParams(window.location.search);\n    const pswd = urlParams.get('pswd');\n    if (pswd) {\n        window.sessionStorage.setItem('pswd', pswd);\n\n        urlParams.delete('pswd');\n        window.location.search = urlParams.toString();\n    }\n}\nconst pswd = window.sessionStorage.getItem('pswd');\nconst server: TheServer | P2PServer = pswd ? new TheServer(new WebSocketServerTransport(pswd)) : new P2PServer();\n\nexport const isWebsockets = server instanceof TheServer;\nexport default server;\n","import InputInterface from './Interface';\n\nclass DrawingTestInput implements InputInterface {\n    private frequencies: [number, number] = [440, 410];\n    private volumes: [number, number] = [1, 1];\n\n    public startMonitoring = async () => {};\n\n    public getFrequencies = (deviceId?: string) => this.frequencies;\n    public getVolumes = (deviceId?: string) => this.volumes;\n\n    public stopMonitoring = async (deviceId?: string) => {};\n\n    public getInputLag = () => 0;\n    public getChannelsCount = () => 2;\n\n    public setFrequency = (channel: 0 | 1, value: number) => (this.frequencies[channel] = value);\n\n    public requestReadiness = () => Promise.resolve(true);\n\n    public getStatus = () => 'ok' as const;\n}\n\nexport default new DrawingTestInput();\n","import InputInterface from './Interface';\n\nclass DummyInput implements InputInterface {\n    private frequencies: [number, number] = [410, 210];\n    private volumes: [number, number] = [1, 1];\n    private timestamp = 0;\n    private interval: number | null = null;\n\n    private isMonitoring = false;\n\n    public startMonitoring = async () => {\n        if (this.isMonitoring) return;\n        this.isMonitoring = true;\n        this.interval = window.setInterval(() => {\n            this.timestamp = this.timestamp + 32;\n\n            const secPart = 0; // this.timestamp % 1000;\n            if (secPart > 232 && secPart < 708) {\n                this.frequencies[0] = 0;\n                this.frequencies[1] = 0;\n            } else {\n                this.frequencies[0] = Math.sin(this.timestamp / 1000) * 50 + 100;\n                this.frequencies[1] = Math.cos(this.timestamp / 1000) * 50 + 200;\n\n                // this.volumes = this.frequencies.map((freq) => (1.5 + Math.random()) / 80) as [number, number];\n            }\n        }, 32);\n    };\n\n    public getFrequencies = () => this.frequencies;\n    public getVolumes = () => this.volumes;\n\n    public stopMonitoring = async () => {\n        if (!this.isMonitoring) return;\n        this.isMonitoring = false;\n        if (this.interval) {\n            window.clearInterval(this.interval);\n        }\n    };\n\n    public getInputLag = () => 150;\n    public getChannelsCount = () => 2;\n    public requestReadiness = () => Promise.resolve(true);\n\n    public getStatus = () => 'ok' as const;\n}\n\nexport default new DummyInput();\n","import aubio from 'aubiojs';\nimport { FrequencyDetectionStrategy } from './interfaces';\n\nexport default class AubioStrategy implements FrequencyDetectionStrategy {\n    private detector: any;\n\n    public init = async (context: AudioContext, buffer: number): Promise<void> => {\n        const { Pitch } = await aubio();\n\n        this.detector = new Pitch('default', buffer, buffer / 8, context.sampleRate);\n        this.detector.setTolerance(0.5);\n    };\n\n    public getSampleSize(): number {\n        return 1 << 11;\n    }\n\n    public getFrequency = async (data: Float32Array) => {\n        return this.detector.do(data);\n    };\n}\n","import Listener from 'utils/Listener';\n\ntype accessStatus = 'uninitialised' | 'requested' | 'accepted' | 'declined';\nclass UserMediaService extends Listener<[accessStatus]> {\n    private status: accessStatus = 'uninitialised';\n\n    public getUserMedia: typeof navigator.mediaDevices.getUserMedia = async (...args) =>\n        this.requestAndTrack(() => navigator.mediaDevices.getUserMedia(...args));\n\n    public enumerateDevices: typeof navigator.mediaDevices.enumerateDevices = async (...args) =>\n        this.requestAndTrack(() => navigator.mediaDevices.enumerateDevices(...args));\n\n    private requestAndTrack = async <T extends CallableFunction>(fnc: T) => {\n        try {\n            if (this.status !== 'accepted') this.setStatus('requested');\n            const result = await fnc();\n            this.setStatus('accepted');\n\n            return result;\n        } catch (e) {\n            this.setStatus('declined');\n            throw e;\n        }\n    };\n\n    private setStatus = (newStatus: accessStatus) => {\n        this.status = newStatus;\n\n        this.onUpdate(newStatus);\n    };\n\n    public getStatus = () => this.status;\n}\n\nexport default new UserMediaService();\n","import { captureException } from '@sentry/react';\nimport events from 'GameEvents/GameEvents';\nimport AubioStrategy from 'Scenes/Game/Singing/Input/MicStrategies/Aubio';\nimport userMediaService from 'UserMedia/userMediaService';\nimport Listener from 'utils/Listener';\nimport InputInterface from './Interface';\n\nclass MicInput extends Listener<[[number, number], [number, number]]> implements InputInterface {\n    private stream: MediaStream | null = null;\n    private context: AudioContext | null = null;\n\n    private interval: ReturnType<typeof setInterval> | null = null;\n\n    private frequencies: [number, number] = [0, 0];\n    private volumes: [number, number] = [0, 0];\n\n    private startedMonitoring = false;\n\n    public startMonitoring = async (deviceId?: string, echoCancellation = false) => {\n        if (this.startedMonitoring) return;\n        this.startedMonitoring = true;\n\n        try {\n            this.stream = await userMediaService.getUserMedia({\n                audio: {\n                    ...(deviceId ? { deviceId, exact: true } : {}),\n                    echoCancellation: echoCancellation,\n                },\n                video: false,\n            });\n            try {\n                this.context = new AudioContext();\n\n                const source = this.context.createMediaStreamSource(this.stream);\n                const splitter = this.context.createChannelSplitter(2);\n                source.connect(splitter);\n\n                const analyserCh0 = this.context.createAnalyser();\n                analyserCh0.fftSize = 2048;\n                analyserCh0.minDecibels = -100;\n                const analyserCh1 = this.context.createAnalyser();\n                analyserCh1.fftSize = 2048;\n                analyserCh1.minDecibels = -100;\n                splitter.connect(analyserCh0, 0);\n                splitter.connect(analyserCh1, 1);\n\n                const strategy = new AubioStrategy();\n                await strategy.init(this.context, analyserCh0.fftSize);\n\n                this.interval = setInterval(async () => {\n                    const dataCh0 = new Float32Array(analyserCh0.fftSize);\n                    const dataCh1 = new Float32Array(analyserCh1.fftSize);\n\n                    analyserCh0.getFloatTimeDomainData(dataCh0);\n                    analyserCh1.getFloatTimeDomainData(dataCh1);\n\n                    this.frequencies = await Promise.all([\n                        strategy.getFrequency(dataCh0),\n                        strategy.getFrequency(dataCh1),\n                    ]);\n\n                    this.volumes = [this.calculateVolume(dataCh0), this.calculateVolume(dataCh1)];\n\n                    this.onUpdate(this.frequencies, this.volumes);\n                }, this.context.sampleRate / analyserCh0.fftSize);\n\n                events.micMonitoringStarted.dispatch();\n            } catch (e) {\n                captureException(e);\n                console.error(e);\n            }\n        } catch (e) {\n            captureException(e, { level: 'warning' });\n            console.warn(e);\n        }\n    };\n\n    public getFrequencies = () => {\n        return this.frequencies;\n    };\n    public getVolumes = () => this.volumes;\n\n    public stopMonitoring = async () => {\n        if (!this.startedMonitoring) return;\n        this.startedMonitoring = false;\n        this.interval && clearInterval(this.interval);\n        this.stream?.getTracks().forEach(function (track) {\n            track.stop();\n        });\n        try {\n            await this.context?.close();\n        } catch (e) {\n            console.log('MicInput.stoMonitoring error', e);\n        }\n\n        events.micMonitoringStopped.dispatch();\n    };\n\n    public getInputLag = () => 180;\n    public getChannelsCount = () => 2;\n\n    private calculateVolume(input: Float32Array) {\n        let i;\n        let sum = 0.0;\n        for (i = 0; i < input.length; ++i) {\n            sum += input[i] * input[i];\n        }\n        return Math.sqrt(sum / input.length);\n    }\n    public requestReadiness = () => Promise.resolve(true);\n\n    public getStatus = () => 'ok' as const;\n}\n\nexport default new MicInput();\n","import RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport InputInterface from './Interface';\n\nclass RemoteMicInput implements InputInterface {\n    private frequencies: [number] = [0];\n    private volumes: [number] = [1];\n\n    public startMonitoring = async (remoteMicId?: string) => {\n        return RemoteMicManager.getRemoteMicById(remoteMicId ?? '')\n            ?.getInput()\n            .startMonitoring();\n    };\n\n    public getFrequencies = (deviceId?: string) => {\n        const val = RemoteMicManager.getRemoteMicById(deviceId ?? '')\n            ?.getInput()\n            .getFrequencies();\n\n        return val ?? this.frequencies;\n    };\n    public getVolumes = (deviceId?: string) => {\n        const val = RemoteMicManager.getRemoteMicById(deviceId ?? '')\n            ?.getInput()\n            .getVolumes();\n\n        return val ?? this.volumes;\n    };\n\n    public stopMonitoring = async (deviceId?: string) =>\n        RemoteMicManager.getRemoteMicById(deviceId ?? '')\n            ?.getInput()\n            .stopMonitoring();\n\n    public requestReadiness = (deviceId?: string) =>\n        RemoteMicManager.getRemoteMicById(deviceId ?? '')\n            ?.getInput()\n            .requestReadiness() ?? Promise.resolve(true);\n\n    public getInputLag = (deviceId?: string) =>\n        RemoteMicManager.getRemoteMicById(deviceId ?? '')\n            ?.getInput()\n            .getInputLag() ?? 0;\n\n    public getChannelsCount = () => 1;\n\n    public getStatus = (deviceId?: string) => {\n        const mic = RemoteMicManager.getRemoteMicById(deviceId ?? '');\n\n        if (!mic || mic.getLatency() > 1500) {\n            return 'unavailable' as const;\n        } else if (mic.getLatency() > 500) {\n            return 'unstable' as const;\n        }\n\n        return 'ok' as const;\n    };\n}\n\nexport default new RemoteMicInput();\n","import { SelectedPlayerInput } from 'Players/PlayersManager';\n\nexport const getInputId = (input: Pick<SelectedPlayerInput, 'deviceId' | 'channel'>) =>\n    `${input.deviceId};${input.channel}`;\n","import { getInputId } from 'Players/utils';\nimport { InputSource } from './interfaces';\n\nconst inputs = [\n    {\n        channels: 2,\n        channel: 1,\n        label: 'Drawing Test Input',\n        id: getInputId({ deviceId: 'default', channel: 1 }),\n        deviceId: 'default',\n    },\n];\n\nexport class DrawingTestInputSource {\n    public static readonly inputName = 'DrawingTest';\n\n    public static getDefault = () => inputs[0];\n\n    public static getInputs = async (): Promise<InputSource[]> => inputs;\n\n    public static subscribeToListChange = (callback: () => void) => undefined;\n    public static unsubscribeToListChange = (callback: () => void) => undefined;\n}\n","import { captureException } from '@sentry/react';\nimport { getInputId } from 'Players/utils';\nimport userMediaService from 'UserMedia/userMediaService';\nimport { range } from 'lodash-es';\nimport { InputSource } from './interfaces';\n\ninterface NameMapper {\n    test: (label: string, channel: number, channels: number) => boolean;\n    map: (label: string, channel: number) => string;\n}\n\nconst singstarWirelessMicMapper: NameMapper = {\n    test: (label) =>\n        label.toLowerCase().includes('wireless mic #') || label.toLowerCase().includes('sony wireless singstar'),\n    map: (label, channel) => `SingStar Wireless - ${channel === 0 ? 'Blue' : 'Red'}`,\n};\nconst singstarWiredMicMapper: NameMapper = {\n    test: (label) => label.toLowerCase().includes('usbmic serial#') || label.toLowerCase().includes('singstar'),\n    map: (label, channel) => `SingStar Wired - ${channel === 0 ? 'Blue' : 'Red'}`,\n};\nconst singstarGenericMapper: NameMapper = {\n    test: (label, channel, channels) => channels === 2 && label.toLowerCase().includes('singstar'),\n    map: (label, channel) => `SingStar Mic - ${channel === 0 ? 'Blue' : 'Red'}`,\n};\n\nconst getPreferred = (...[label, ch, channels]: Parameters<NameMapper['test']>) =>\n    singstarWiredMicMapper.test(label, ch, channels) ||\n    singstarWirelessMicMapper.test(label, ch, channels) ||\n    singstarGenericMapper.test(label, ch, channels)\n        ? ch\n        : undefined;\n\nconst mapInputName = (label: string, channel: number, channels: number) => {\n    if (singstarWirelessMicMapper.test(label, channel, channels)) return singstarWirelessMicMapper.map(label, channel);\n    if (singstarWiredMicMapper.test(label, channel, channels)) return singstarWiredMicMapper.map(label, channel);\n    if (singstarGenericMapper.test(label, channel, channels)) return singstarGenericMapper.map(label, channel);\n\n    return channels > 1 ? `${label} (ch ${channel + 1})` : label;\n};\n\nexport class MicrophoneInputSource {\n    private static inputList: InputSource[] = [];\n    public static readonly inputName = 'Microphone';\n\n    public static getDefault = () =>\n        MicrophoneInputSource.inputList.find((input) => input.id === getInputId({ deviceId: 'default', channel: 0 })) ??\n        MicrophoneInputSource.inputList[0] ??\n        null;\n\n    public static getInputs = async (): Promise<InputSource[]> => {\n        await userMediaService.getUserMedia({ audio: true });\n\n        let devices: MediaDeviceInfo[] = [];\n\n        try {\n            devices = await userMediaService.enumerateDevices();\n        } catch (e) {\n            captureException(e, { level: 'warning' });\n            console.warn(e);\n        }\n\n        MicrophoneInputSource.inputList = (devices as any as Array<MediaStreamTrack & MediaDeviceInfo>)\n            .filter((device) => device.kind === 'audioinput')\n            .map((device) => {\n                const channels = device.getCapabilities?.()?.channelCount?.max ?? 1;\n\n                return range(0, channels).map((channel) => ({\n                    label: mapInputName(device.label, channel, channels),\n                    channel,\n                    channels,\n                    deviceId: device.deviceId,\n                    id: getInputId({ deviceId: device.deviceId, channel }),\n                    preferred: getPreferred(device.label, channel, channels),\n                }));\n            })\n            .flat();\n\n        return MicrophoneInputSource.inputList;\n    };\n\n    public static subscribeToListChange = (callback: () => void) =>\n        navigator.mediaDevices.addEventListener('devicechange', callback);\n    public static unsubscribeToListChange = (callback: () => void) =>\n        navigator.mediaDevices.removeEventListener('devicechange', callback);\n}\n","import events from 'GameEvents/GameEvents';\nimport { getInputId } from 'Players/utils';\nimport { RemoteMic } from 'RemoteMic/RemoteMicInput';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport { InputSource } from './interfaces';\n\nconst mapRemoteMicToInput = (remoteMic: RemoteMic): InputSource => ({\n    label: `${remoteMic.name}`,\n    id: getInputId({ deviceId: remoteMic.id, channel: 0 }),\n    deviceId: remoteMic.id,\n    channels: 1,\n    channel: 0,\n});\n\nexport class RemoteMicrophoneInputSource {\n    public static readonly inputName = 'Remote Microphone';\n\n    public static getDefault = () => RemoteMicManager.getRemoteMics().map(mapRemoteMicToInput)[0] ?? null;\n\n    public static getInputs = async (): Promise<InputSource[]> =>\n        RemoteMicManager.getRemoteMics().map(mapRemoteMicToInput);\n\n    public static subscribeToListChange = (callback: () => void) => {\n        events.remoteMicConnected.subscribe(callback);\n        events.remoteMicDisconnected.subscribe(callback);\n    };\n    public static unsubscribeToListChange = (callback: () => void) => {\n        events.remoteMicConnected.unsubscribe(callback);\n        events.remoteMicDisconnected.unsubscribe(callback);\n    };\n}\n","import events from 'GameEvents/GameEvents';\nimport PlayersManager from 'Players/PlayersManager';\nimport DrawingTestInput from 'Scenes/Game/Singing/Input/DrawingTestInput';\nimport dummyInput from 'Scenes/Game/Singing/Input/DummyInput';\nimport InputInterface from 'Scenes/Game/Singing/Input/Interface';\nimport MicInput from 'Scenes/Game/Singing/Input/MicInput';\nimport RemoteMicInput from 'Scenes/Game/Singing/Input/RemoteMicInput';\nimport { DrawingTestInputSource } from 'Scenes/SelectInput/InputSources/DrawingTest';\nimport { MicrophoneInputSource } from 'Scenes/SelectInput/InputSources/Microphone';\nimport { RemoteMicrophoneInputSource } from 'Scenes/SelectInput/InputSources/Remote';\nimport { InputSourceNames } from 'Scenes/SelectInput/InputSources/interfaces';\n\nclass InputManager {\n    private isMonitoring = false;\n\n    constructor() {\n        events.inputListChanged.subscribe(async () => {\n            if (this.isMonitoring) {\n                await this.stopMonitoring();\n                this.startMonitoring();\n            }\n        });\n    }\n\n    public getInputStatus = (playerNumber: number) => {\n        const input = PlayersManager.getPlayer(playerNumber).input;\n        const source = this.sourceNameToInput(input.source);\n\n        return source.getStatus(input.deviceId, input.channel);\n    };\n\n    public getPlayerFrequency = (playerNumber: number) => {\n        const input = PlayersManager.getPlayer(playerNumber).input;\n        const frequencies = this.sourceNameToInput(input.source).getFrequencies(input.deviceId);\n\n        return frequencies[input.channel];\n    };\n\n    public getPlayerVolume = (playerNumber: number) => {\n        const input = PlayersManager.getPlayer(playerNumber).input;\n        const volumes = this.sourceNameToInput(input.source).getVolumes(input.deviceId);\n\n        return volumes[input.channel];\n    };\n\n    public getPlayerInputLag = (playerNumber: number) =>\n        this.sourceNameToInput(PlayersManager.getPlayer(playerNumber).input.source).getInputLag();\n\n    public startMonitoring = async () => {\n        await Promise.all(\n            PlayersManager.getPlayers().map((player) =>\n                this.sourceNameToInput(player.input.source).startMonitoring(player.input.deviceId),\n            ),\n        );\n        this.isMonitoring = true;\n    };\n\n    public stopMonitoring = async () => {\n        await Promise.all(\n            PlayersManager.getPlayers().map((player) =>\n                this.sourceNameToInput(player.input.source).stopMonitoring(player.input.deviceId),\n            ),\n        );\n        this.isMonitoring = false;\n    };\n\n    public monitoringStarted = () => this.isMonitoring;\n\n    // todo: Create eg. \"InputSourceManager\" and have the logic there?\n    public sourceNameToInput = (sourceName: InputSourceNames): InputInterface => {\n        if (sourceName === MicrophoneInputSource.inputName) return MicInput;\n        if (sourceName === DrawingTestInputSource.inputName) return DrawingTestInput;\n        if (sourceName === RemoteMicrophoneInputSource.inputName) return RemoteMicInput;\n        return dummyInput;\n    };\n}\n\nexport default new InputManager();\n","import { getInputId } from 'Players/utils';\nimport { InputSource } from './interfaces';\n\nconst inputList = [\n    {\n        channels: 2,\n        channel: 0,\n        label: 'Dummy Input 1',\n        id: getInputId({ deviceId: 'default', channel: 0 }),\n        deviceId: 'default',\n    },\n    {\n        channels: 2,\n        channel: 1,\n        label: 'Dummy Input 2',\n        id: getInputId({ deviceId: 'default', channel: 1 }),\n        deviceId: 'default',\n    },\n];\n\nexport class DummyInputSource {\n    public static readonly inputName = 'Dummy';\n\n    public static getDefault = () => inputList[0];\n\n    public static getInputs = async (): Promise<InputSource[]> => inputList;\n\n    public static subscribeToListChange = (callback: () => void) => undefined;\n    public static unsubscribeToListChange = (callback: () => void) => undefined;\n}\n","import events from 'GameEvents/GameEvents';\nimport { SelectedPlayerInput } from 'Players/PlayersManager';\nimport { DrawingTestInputSource } from 'Scenes/SelectInput/InputSources/DrawingTest';\nimport {\n    InputSourceList,\n    InputSourceManagerInterface,\n    InputSourceNames,\n} from 'Scenes/SelectInput/InputSources/interfaces';\nimport { DummyInputSource } from './Dummy';\nimport { MicrophoneInputSource } from './Microphone';\nimport { RemoteMicrophoneInputSource } from './Remote';\n\nconst selectedPlayerInputToId = (input: SelectedPlayerInput) => `${input.deviceId};${input.channel}`;\n\nclass InputSourceListManager {\n    private inputList: Record<InputSourceNames, InputSourceList>;\n\n    constructor() {\n        this.inputList = {\n            [MicrophoneInputSource.inputName]: this.initialiseInputSource(MicrophoneInputSource, true),\n            [DummyInputSource.inputName]: this.initialiseInputSource(DummyInputSource),\n            [RemoteMicrophoneInputSource.inputName]: this.initialiseInputSource(RemoteMicrophoneInputSource),\n            [DrawingTestInputSource.inputName]: this.initialiseInputSource(DrawingTestInputSource),\n        };\n    }\n\n    private initialiseInputSource = <T extends InputSourceManagerInterface>(source: T, lazily = false) => {\n        if (!lazily) {\n            source.getInputs().then((list) => {\n                this.inputList[source.inputName].list = list;\n                events.inputListChanged.dispatch(true);\n\n                source.subscribeToListChange(async () => {\n                    this.inputList[source.inputName].list = await source.getInputs();\n                    events.inputListChanged.dispatch(false);\n                });\n            });\n        }\n\n        return {\n            list: [],\n            getDefault: source.getDefault,\n        };\n    };\n\n    public loadMics = () => {\n        if (!this.inputList.Microphone.list.length) {\n            this.inputList.Microphone = this.initialiseInputSource(MicrophoneInputSource);\n        }\n    };\n\n    public getInputList = () => this.inputList;\n\n    public getInputForPlayerSelected = (input: SelectedPlayerInput, returnDefault = true) => {\n        const source = this.inputList[input.source];\n        return (\n            source.list.find((item) => item.id === selectedPlayerInputToId(input)) ??\n            (returnDefault ? source.getDefault() : null)\n        );\n    };\n}\nexport default new InputSourceListManager();\n","import events from 'GameEvents/GameEvents';\nimport WebRTCServer from 'RemoteMic/Network/WebRTCServer';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport inputSourceListManager from 'Scenes/SelectInput/InputSources';\nimport { InputSourceNames } from 'Scenes/SelectInput/InputSources/interfaces';\nimport { debounce } from 'lodash-es';\nimport storage from 'utils/storage';\n\nconst SELECTED_INPUTS_KEY = 'playerselectedinputs';\n\nexport interface SelectedPlayerInput {\n    source: InputSourceNames;\n    deviceId?: string;\n    channel: number;\n}\n\nexport class PlayerEntity {\n    public nameOverride: string = '';\n    constructor(public number: number, public input: SelectedPlayerInput, public name?: string) {}\n\n    public changeInput = (input: InputSourceNames, channel = 0, deviceId?: string) => {\n        let restartMonitoringPromise: null | Promise<void> = null;\n        if (InputManager.monitoringStarted()) {\n            restartMonitoringPromise = InputManager.stopMonitoring();\n        }\n\n        const newInput: SelectedPlayerInput = { source: input, deviceId, channel };\n        const oldInput = this.input;\n        this.input = newInput;\n\n        events.playerInputChanged.dispatch(this.number, oldInput, newInput);\n\n        if (restartMonitoringPromise) {\n            restartMonitoringPromise.then(InputManager.startMonitoring);\n        }\n    };\n\n    public toJSON = () => ({\n        number: this.number,\n        input: this.input,\n        name: this.name,\n    });\n\n    public getName = () => {\n        return this.nameOverride || (this.name ?? `Player #${this.number + 1}`);\n    };\n\n    public isDefaultName = () => this.name === undefined;\n\n    public setName = (newName: string) => {\n        const oldName = this.name;\n        this.name = newName;\n        events.playerNameChanged.dispatch(this.number, oldName);\n    };\n\n    public static fromJSON = (data: ReturnType<PlayerEntity['toJSON']>) =>\n        new PlayerEntity(data.number, data.input, data.name);\n}\n\nclass PlayersManager {\n    private players: PlayerEntity[] = [];\n    private requestingPromise: Promise<any> | null = null;\n    public constructor() {\n        const storedPlayers = storage.session.getValue<ReturnType<PlayerEntity['toJSON']>[]>(SELECTED_INPUTS_KEY) ?? [];\n        if (storedPlayers.length) {\n            this.players = storedPlayers.map(PlayerEntity.fromJSON);\n\n            if (this.getPlayers().some((player) => player.input.source === 'Microphone')) {\n                // If any microphones are selected, load the list\n                inputSourceListManager.loadMics();\n            }\n            if (this.getPlayers().some((player) => player.input.source === 'Remote Microphone')) {\n                // If there are some remote mics, restart the server\n                WebRTCServer.start();\n            }\n        } else {\n            this.players = [\n                new PlayerEntity(0, { source: 'Dummy', deviceId: 'default', channel: 0 }),\n                new PlayerEntity(1, { source: 'Dummy', deviceId: 'default', channel: 1 }),\n            ];\n        }\n\n        events.playerInputChanged.subscribe((playerNumber, _, newInput) => {\n            if (newInput.source === 'Remote Microphone') {\n                const microphone = RemoteMicManager.getRemoteMicById(newInput.deviceId!);\n\n                if (microphone) {\n                    this.getPlayer(playerNumber).nameOverride = microphone.name;\n                }\n            } else {\n                this.getPlayer(playerNumber).nameOverride = '';\n            }\n\n            this.storePlayers();\n        });\n\n        events.playerNameChanged.subscribe(debounce(this.storePlayers, 1000));\n\n        events.remoteMicConnected.subscribe(({ id, name }) => {\n            this.getPlayers().forEach((player) => {\n                if (\n                    player.input.source === 'Remote Microphone' &&\n                    player.input.deviceId === id &&\n                    player.getName() !== name\n                ) {\n                    player.nameOverride = name;\n                }\n            });\n        });\n    }\n\n    private storePlayers = () => {\n        storage.session.storeValue(\n            SELECTED_INPUTS_KEY,\n            this.getPlayers().map((player) => player.toJSON()),\n        );\n    };\n\n    public requestReadiness = async () => {\n        if (!this.requestingPromise) {\n            this.requestingPromise = new Promise((resolve) => {\n                const request = async () => {\n                    // todo fix this -- if there's an input that is not connected, no input will be able to\n                    // confirm readiness. It should request what it can and watch for input list changes\n                    // and could also be simplified to only care about remote mic.\n                    // Found when for some reason regular mic was assigned to a player without an id. getInputForPlayerSelected\n                    // returned null and the readiness was never requested for remote mic connected for the other player.\n                    const allInputsConnected = !this.getPlayers()\n                        .filter((player) => player.input.source === 'Remote Microphone')\n                        .some(\n                            (player) => inputSourceListManager.getInputForPlayerSelected(player.input, false) === null,\n                        );\n\n                    if (allInputsConnected) {\n                        await Promise.all(\n                            this.getPlayers().map((player) =>\n                                InputManager.sourceNameToInput(player.input.source)\n                                    .requestReadiness(player.input.deviceId)\n                                    .then(() => {\n                                        events.readinessConfirmed.dispatch(player.input.deviceId!);\n                                    }),\n                            ),\n                        );\n                        events.inputListChanged.unsubscribe(request);\n                        this.requestingPromise = null;\n                        resolve(true);\n                    }\n                };\n\n                events.inputListChanged.subscribe(request);\n                request();\n            });\n        }\n\n        return this.requestingPromise;\n    };\n\n    public getPlayers = () => this.players;\n    public getPlayer = (number: number) => this.players[number];\n\n    public getInputs = () => this.getPlayers().map((player) => player.input);\n}\n\nexport default new PlayersManager();\n","import events from 'GameEvents/GameEvents';\nimport PlayersManager from 'Players/PlayersManager';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport { RemoteMicrophoneInputSource } from 'Scenes/SelectInput/InputSources/Remote';\nimport { toast } from 'react-toastify';\n\nevents.playerInputChanged.subscribe((playerNumber, oldInput, newInput) => {\n    if (oldInput?.source === RemoteMicrophoneInputSource.inputName) {\n        const playerNumber = PlayersManager.getPlayers().find(\n            (player) => player.input.source === 'Remote Microphone' && player.input.deviceId === oldInput.deviceId,\n        )?.number;\n        const unselectedRemoteMic = RemoteMicManager.getRemoteMicById(oldInput.deviceId!);\n\n        unselectedRemoteMic?.setPlayerNumber(playerNumber !== undefined ? playerNumber : null);\n    }\n    if (newInput?.source === 'Remote Microphone') {\n        const selectedRemoteMic = RemoteMicManager.getRemoteMicById(newInput.deviceId!);\n\n        selectedRemoteMic?.setPlayerNumber(playerNumber);\n    }\n});\nevents.remoteMicConnected.subscribe(({ id }) => {\n    const playerNumberIndex = PlayersManager.getPlayers().find(\n        (player) => player.input.source === 'Remote Microphone' && player.input.deviceId === id,\n    )?.number;\n\n    if (playerNumberIndex !== undefined) {\n        const remoteMic = RemoteMicManager.getRemoteMicById(id);\n\n        remoteMic?.setPlayerNumber(playerNumberIndex);\n\n        if (InputManager.monitoringStarted()) {\n            remoteMic?.getInput()?.startMonitoring();\n        }\n    }\n});\n\nevents.playerChangeRequested.subscribe((phoneId, newPlayerNumber) => {\n    const currentPlayerNumber = PlayersManager.getPlayers().find((player) => player.input.deviceId === phoneId)?.number;\n\n    if (currentPlayerNumber !== undefined) {\n        PlayersManager.getPlayer(currentPlayerNumber).changeInput('Dummy', 0);\n    }\n    if (newPlayerNumber !== null) {\n        PlayersManager.getPlayer(newPlayerNumber).changeInput('Remote Microphone', 0, phoneId);\n    }\n});\n\nevents.remoteMicConnected.subscribe(({ name, silent }) => {\n    if (!silent) {\n        toast.success(\n            <>\n                Remote microphone <b className=\"ph-no-capture\">{name}</b> connected!\n            </>,\n        );\n    }\n});\nevents.remoteMicDisconnected.subscribe(({ name }, silent) => {\n    if (!silent) {\n        toast.warning(\n            <>\n                Remote microphone <b className=\"ph-no-capture\">{name}</b> disconnected!\n            </>,\n        );\n    }\n});\n\nconst sendPlayerStates = () => {\n    const remoteMics = RemoteMicManager.getRemoteMics().map((mic) => ({\n        id: mic.id,\n        name: mic.name,\n        number: PlayersManager.getPlayers().find((player) => player.input.deviceId === mic.id)?.number ?? null,\n    }));\n\n    RemoteMicManager.broadcastToChannel('remote-mics', { t: 'remote-mics-list', list: remoteMics });\n};\n\nevents.inputListChanged.subscribe(sendPlayerStates);\nevents.playerInputChanged.subscribe(sendPlayerStates);\nevents.remoteMicSubscribed.subscribe(sendPlayerStates);\n","import events from 'GameEvents/GameEvents';\nimport PlayersManager from 'Players/PlayersManager';\nimport { InputSourceNames } from 'Scenes/SelectInput/InputSources/interfaces';\nimport { MobilePhoneModeSetting } from 'Scenes/Settings/SettingsState';\nimport { SingSetup, Song, SongPreview } from 'interfaces';\nimport posthog from 'posthog-js';\n\nconst trackSongData =\n    (event: string) =>\n    ({ artist, title }: Song | SongPreview, setup: SingSetup, scores: Array<{ name: string; score: number }> = []) => {\n        const sameScores = scores.length > 1 && scores.every((score) => score.score === scores[0].score);\n\n        const inputs: Record<string, InputSourceNames> = {};\n        PlayersManager.getPlayers().forEach((player, index) => (inputs[`input${index}`] = player.input.source));\n\n        posthog.capture(event, {\n            name: `${artist} - ${title}`,\n            artist,\n            title,\n            mode: setup.mode,\n            tolerance: setup.tolerance,\n            players: setup.players.length,\n            sameScores,\n            mobilePhoneMode: !!MobilePhoneModeSetting.get(),\n            ...inputs,\n            ...scores.reduce((curr, score, index) => ({ ...curr, [`score${index}`]: score.score }), {}),\n        });\n    };\n\nevents.songStarted.subscribe(trackSongData('songStarted'));\nevents.songEnded.subscribe(trackSongData('songEnded'));\n","import { SingSetup, SongPreview } from 'interfaces';\nimport localForage from 'localforage';\n\nexport interface SongStats {\n    plays: number;\n    scores: Array<{\n        setup: SingSetup;\n        scores: Array<{ name: string; score: number }>;\n        date: string;\n    }>;\n}\n\nexport const getSongKey = (song: Pick<SongPreview, 'artist' | 'title'>) => `${song.artist}-${song.title}`.toLowerCase();\n\nexport const fetchSongStats = async (song: Pick<SongPreview, 'artist' | 'title'>) => {\n    const storageKey = getSongKey(song);\n    return (await localForage.getItem<SongStats>(storageKey)) || { plays: 0, scores: [] };\n};\n\nexport const storeSongStats = async (song: Pick<SongPreview, 'artist' | 'title'>, stats: SongStats) => {\n    await localForage.setItem<SongStats>(getSongKey(song), stats);\n};\n","import events from 'GameEvents/GameEvents';\nimport localForage from 'localforage';\nimport { getSongKey, SongStats, storeSongStats } from 'Songs/stats/common';\n\nevents.songEnded.subscribe(async (song, setup, scores) => {\n    let currentState = await localForage.getItem<SongStats>(getSongKey(song));\n\n    const score = { setup, scores, date: new Date().toISOString() };\n    if (currentState) {\n        // there might be cases where only { plays: number } is stored\n        currentState.scores = [...(currentState?.scores ?? []), score];\n        currentState.plays = currentState.scores.length;\n    } else {\n        currentState = {\n            plays: 1,\n            scores: [score],\n        };\n    }\n\n    await storeSongStats(song, currentState);\n    events.songStatStored.dispatch(getSongKey(song), currentState);\n});\n","export const PLAYER_NAMES_SESSION_STORAGE_KEY = 'session-player-names';\nexport const PREVIOUS_PLAYER_NAMES_STORAGE_KEY = 'previous-player-names';\n","import { PLAYER_NAMES_SESSION_STORAGE_KEY, PREVIOUS_PLAYER_NAMES_STORAGE_KEY } from 'hooks/players/consts';\n\nimport events from 'GameEvents/GameEvents';\nimport PlayersManager from 'Players/PlayersManager';\n\nevents.songStarted.subscribe((_, singSetup) => {\n    let currentNames = JSON.parse(window.sessionStorage.getItem(PLAYER_NAMES_SESSION_STORAGE_KEY)!) || [];\n    const thisPlayNames = singSetup.players.map(({ number }) => PlayersManager.getPlayer(number).getName().trim());\n\n    const newNamesSet = [...currentNames].concat(...thisPlayNames);\n    currentNames = [...new Set(newNamesSet)].filter(Boolean);\n\n    window.sessionStorage.setItem(PLAYER_NAMES_SESSION_STORAGE_KEY, JSON.stringify(currentNames));\n    window.sessionStorage.setItem(PREVIOUS_PLAYER_NAMES_STORAGE_KEY, JSON.stringify(thisPlayNames));\n});\n\nevents.songScoreUpdated.subscribe((_, __, newName) => {\n    debugger;\n    let currentNames = JSON.parse(window.sessionStorage.getItem(PLAYER_NAMES_SESSION_STORAGE_KEY)!) || [];\n\n    const newNamesSet = [...currentNames].concat(newName);\n    currentNames = [...new Set(newNamesSet)].filter(Boolean);\n\n    window.sessionStorage.setItem(PLAYER_NAMES_SESSION_STORAGE_KEY, JSON.stringify(currentNames));\n});\n","import { captureException } from '@sentry/react';\nimport events from 'GameEvents/GameEvents';\nimport AubioStrategy from 'Scenes/Game/Singing/Input/MicStrategies/Aubio';\nimport userMediaService from 'UserMedia/userMediaService';\nimport Listener from 'utils/Listener';\nimport InputInterface from './Interface';\n\nclass SimplifiedMic extends Listener<[number, number]> implements InputInterface {\n    private stream: MediaStream | null = null;\n    private context: AudioContext | null = null;\n\n    private interval: ReturnType<typeof setInterval> | null = null;\n\n    private frequencies: [number, number] = [0, 0];\n    private volumes: [number, number] = [0, 0];\n\n    private startedMonitoring = false;\n\n    public startMonitoring = async (deviceId?: string, echoCancellation = false) => {\n        if (this.startedMonitoring) return;\n        this.startedMonitoring = true;\n\n        try {\n            this.stream = await userMediaService.getUserMedia({\n                audio: {\n                    echoCancellation: true,\n                    noiseSuppression: true,\n                    autoGainControl: false,\n                },\n                video: false,\n            });\n            try {\n                this.context = new AudioContext();\n\n                const source = this.context.createMediaStreamSource(this.stream);\n\n                const analyserCh0 = this.context.createAnalyser();\n                analyserCh0.fftSize = 2048;\n                analyserCh0.minDecibels = -100;\n                source.connect(analyserCh0);\n\n                const strategy = new AubioStrategy();\n                await strategy.init(this.context, analyserCh0.fftSize);\n\n                this.interval = setInterval(async () => {\n                    const dataCh0 = new Float32Array(analyserCh0.fftSize);\n\n                    analyserCh0.getFloatTimeDomainData(dataCh0);\n                    const freq = await strategy.getFrequency(dataCh0);\n                    const volume = this.calculateVolume(dataCh0);\n\n                    this.frequencies = [freq, freq];\n\n                    this.volumes = [volume, volume];\n\n                    this.onUpdate(freq, volume);\n                }, this.context.sampleRate / analyserCh0.fftSize);\n\n                events.micMonitoringStarted.dispatch();\n            } catch (e) {\n                captureException(e);\n                console.error(e);\n            }\n        } catch (e) {\n            captureException(e, { level: 'warning' });\n            console.warn(e);\n        }\n    };\n\n    public getFrequencies = () => {\n        return this.frequencies;\n    };\n    public getVolumes = () => this.volumes;\n\n    public stopMonitoring = async () => {\n        if (!this.startedMonitoring) return;\n        this.startedMonitoring = false;\n        this.interval && clearInterval(this.interval);\n        this.stream?.getTracks().forEach(function (track) {\n            track.stop();\n        });\n        try {\n            await this.context?.close();\n        } catch (e) {\n            console.log('MicInput.stoMonitoring error', e);\n        }\n\n        events.micMonitoringStopped.dispatch();\n    };\n\n    public getInputLag = () => 180;\n    public getChannelsCount = () => 2;\n\n    private calculateVolume(input: Float32Array) {\n        let i;\n        let sum = 0.0;\n        for (i = 0; i < input.length; ++i) {\n            sum += input[i] * input[i];\n        }\n        return Math.sqrt(sum / input.length);\n    }\n    public requestReadiness = () => Promise.resolve(true);\n\n    public getStatus = () => 'ok' as const;\n}\n\nexport default new SimplifiedMic();\n","import events from 'GameEvents/GameEvents';\nimport {\n    WebRTCEvents,\n    WebRTCRequestMicSelectEvent,\n    WebRTCSongListEvent,\n    WebRTCSubscribeEvent,\n    WebRTCUnsubscribeEvent,\n    keyStrokes,\n} from 'RemoteMic/Network/events';\nimport { getPingTime, pack, unpack } from 'RemoteMic/Network/utils';\nimport SimplifiedMic from 'Scenes/Game/Singing/Input/SimplifiedMic';\nimport { throttle } from 'lodash-es';\nimport { DataConnection, Peer } from 'peerjs';\nimport Listener from 'utils/Listener';\nimport peerJSOptions from 'utils/peerJSOptions';\nimport storage from 'utils/storage';\nimport { v4 } from 'uuid';\nimport { ForwardedMessage, WEBSOCKETS_SERVER } from './TheServer';\nimport sendEvent from './sendEvent';\n\nexport const MIC_ID_KEY = 'MIC_CLIENT_ID';\n\nconst roundTo = (num: number, precision: number) => {\n    if (num === 0) return 0;\n\n    const multiplier = Math.pow(10, precision);\n\n    return Math.round(num * multiplier) / multiplier;\n};\n\nexport type transportCloseReason = string;\nexport type transportErrorReason = string;\n\nexport interface ClientTransport extends Listener<[WebRTCEvents]> {\n    connect(\n        clientId: string,\n        roomId: string,\n        onConnect: () => void,\n        onClose: (reason: transportCloseReason, originalEvent: any) => void,\n        onError: (error: transportErrorReason, originalEvent: any) => void,\n    ): void;\n    sendEvent(event: WebRTCEvents): void;\n    isConnected(): boolean;\n    close(): void;\n}\n\nexport class WebSocketClientTransport extends Listener<[WebRTCEvents]> implements ClientTransport {\n    private connection: WebSocket | null = null;\n    private roomId: string | null = null;\n\n    public connect(\n        clientId: string,\n        roomId: string,\n        onConnect: () => void,\n        onClose: (reason: transportCloseReason, originalEvent: any) => void,\n        onError: (error: transportErrorReason, originalEvent: any) => void,\n    ): void {\n        this.roomId = roomId;\n        this.connection = new WebSocket(WEBSOCKETS_SERVER);\n        this.connection.binaryType = 'arraybuffer';\n\n        this.connection.onopen = () => {\n            this.connection?.send(pack({ t: 'register-player', id: clientId, roomId: roomId }));\n        };\n\n        this.connection.onmessage = (message) => {\n            const data = unpack<ForwardedMessage>(message.data);\n            if (data.t === 'forward') {\n                this.onUpdate(data.payload);\n            } else if (data.t === 'connected') {\n                onConnect();\n            }\n        };\n\n        this.connection.onclose = (event) => {\n            let reason = 'unknown';\n            try {\n                reason = JSON.parse(event.reason)?.error;\n            } catch (e) {\n                console.info('could not parse close reason', event);\n            }\n            this.clearAllListeners();\n            onClose(reason, event);\n        };\n\n        this.connection.onerror = (event) => {\n            this.clearAllListeners();\n            onError('error', event);\n        };\n    }\n\n    public sendEvent(event: WebRTCEvents) {\n        this.connection?.send(pack({ t: 'forward', recipients: [this.roomId], payload: event }));\n    }\n\n    // readyState >=2 means that the connection is closing or closed\n    public isConnected = () => (this.connection?.readyState ?? Infinity) < 2;\n\n    public close = () => {\n        this.connection?.close();\n    };\n}\n\nexport class PeerJSClientTransport extends Listener<[WebRTCEvents]> implements ClientTransport {\n    private peer: Peer | null = null;\n    private connection: DataConnection | null = null;\n    private roomId: string | null = null;\n\n    private unavailableIdRetries = 0;\n    private unavailableIdRetryTimeout: any = null;\n\n    private connectToRoom = (\n        roomId: string,\n        onConnect: () => void,\n        onClose: (reason: transportCloseReason, originalEvent: any) => void,\n    ) => {\n        this.connection = this.peer!.connect(roomId);\n\n        this.connection.on('open', () => {\n            onConnect();\n        });\n\n        this.connection.on('close', () => onClose('closed', null));\n\n        this.connection?.on('data', (data: WebRTCEvents) => {\n            this.onUpdate(data);\n        });\n    };\n\n    public connect(\n        clientId: string,\n        roomId: string,\n        onConnect: () => void,\n        onClose: (reason: transportCloseReason, originalEvent: any) => void,\n        onError: (error: transportErrorReason, originalEvent: any) => void,\n    ): void {\n        if (this.peer && !this.peer.disconnected) {\n            this.connectToRoom(roomId, onConnect, onClose);\n        } else {\n            this.peer = new Peer(clientId, { ...peerJSOptions, debug: 3 });\n\n            this.peer.on('open', () => {\n                this.connectToRoom(roomId, onConnect, onClose);\n            });\n\n            this.peer.on('error', (e) => {\n                // Happens when the device goes from offline to online\n                if (\n                    e.type === 'unavailable-id' &&\n                    this.unavailableIdRetries < 3 &&\n                    this.unavailableIdRetryTimeout === null\n                ) {\n                    this.peer?.destroy?.();\n                    this.unavailableIdRetryTimeout = setTimeout(() => {\n                        this.unavailableIdRetryTimeout = null;\n                        this.unavailableIdRetries++;\n                        this.connect(clientId, roomId, onConnect, onClose, onError);\n                    }, 1750);\n                } else {\n                    this.unavailableIdRetries = 0;\n                    console.error(e.type, e);\n                    onClose(e.type, e);\n                }\n            });\n        }\n    }\n\n    public sendEvent(event: WebRTCEvents) {\n        this.connection?.send(event);\n    }\n\n    public isConnected = () => !!this.connection?.open && !this.peer?.disconnected;\n\n    public close = () => {\n        this.connection?.close();\n    };\n}\n\nexport class TheClient {\n    private clientId = storage.getValue(MIC_ID_KEY);\n    private roomId: string | null = null;\n\n    private reconnecting = false;\n    private connected = false;\n\n    private frequencies: number[] = [];\n\n    public constructor(private transport: ClientTransport) {}\n\n    private sendFrequencies = throttle((volume: number) => {\n        const freqs = this.frequencies.map((freq) => roundTo(freq, 2));\n        this.frequencies.length = 0;\n        this.sendEvent('freq', [freqs, roundTo(volume, 4)]);\n    }, 50);\n\n    // Chunk frequencies and send them in packages\n    // One package throttled with 75ms contains ~10 frequencies\n    private onFrequencyUpdate = throttle((freq: number, volume: number) => {\n        this.frequencies.push(freq);\n\n        this.sendFrequencies(volume);\n    }, 1_000 / 60);\n\n    public getClientId = () => this.clientId;\n    private setClientId = (id: string) => {\n        this.clientId = id;\n        storage.storeValue(MIC_ID_KEY, id);\n    };\n\n    public connect = (roomId: string, name: string, silent: boolean) => {\n        if (this.clientId === null) this.setClientId(v4());\n        this.roomId = roomId;\n\n        if (this.transport.isConnected()) {\n            console.log('not reconnecting', this.transport);\n            return;\n        }\n\n        if (!this.reconnecting) {\n            events.karaokeConnectionStatusChange.dispatch('connecting');\n        }\n        this.transport.connect(\n            this.clientId,\n            this.roomId,\n            () => {\n                this.connectToServer(roomId, name, silent);\n            },\n            (reason, event) => {\n                console.log('closed connection :o', reason, event);\n                window.removeEventListener('beforeunload', this.disconnect);\n\n                if (this.reconnecting) {\n                    events.karaokeConnectionStatusChange.dispatch('reconnecting');\n                } else if (!this.connected) {\n                    events.karaokeConnectionStatusChange.dispatch('error', reason);\n                } else {\n                    events.karaokeConnectionStatusChange.dispatch('disconnected');\n                }\n\n                events.remoteMicPlayerSet.dispatch(null);\n                events.remoteKeyboardLayout.dispatch(undefined);\n\n                SimplifiedMic.removeListener(this.onFrequencyUpdate);\n                SimplifiedMic.stopMonitoring();\n\n                if (!this.reconnecting && this.connected) {\n                    this.reconnecting = true;\n                    setTimeout(() => this.reconnect(roomId, name), 1500);\n                }\n                this.connected = false;\n            },\n            console.warn,\n        );\n    };\n\n    public latency = 999;\n    public pingStart = Date.now();\n    public pinging = false;\n    private ping = () => {\n        this.pinging = true;\n        this.pingStart = getPingTime();\n\n        this.sendEvent('ping', { p: this.pingStart });\n    };\n\n    private onPong = () => {\n        this.latency = getPingTime() - this.pingStart;\n        this.pinging = false;\n\n        setTimeout(this.ping, 1000);\n    };\n\n    public connectToServer = (roomId: string, name: string, silent: boolean) => {\n        this.connected = true;\n        this.reconnecting = false;\n        events.karaokeConnectionStatusChange.dispatch('connected');\n        this.sendEvent('register', { name, id: this.clientId!, silent });\n        this.ping();\n        window.addEventListener('beforeunload', this.disconnect);\n\n        this.transport.addListener((data) => {\n            const type = data.t;\n\n            if (type === 'start-monitor') {\n                SimplifiedMic.removeListener(this.onFrequencyUpdate);\n                SimplifiedMic.addListener(this.onFrequencyUpdate);\n                // echoCancellation is turned on because without it there is silence from the mic\n                // every other second (possibly some kind of Chrome Mobile bug)\n                SimplifiedMic.startMonitoring(undefined, true);\n            } else if (type === 'stop-monitor') {\n                SimplifiedMic.removeListener(this.onFrequencyUpdate);\n                SimplifiedMic.stopMonitoring();\n            } else if (type === 'set-player-number') {\n                events.remoteMicPlayerSet.dispatch(data.playerNumber);\n            } else if (type === 'keyboard-layout') {\n                events.remoteKeyboardLayout.dispatch(data.help);\n            } else if (type === 'reload-mic') {\n                window.removeEventListener('beforeunload', this.disconnect);\n                this.sendEvent('unregister');\n                window.sessionStorage.setItem('reload-mic-request', '1');\n                document.getElementById('phone-ui-container')?.remove();\n                window.location.reload();\n            } else if (type === 'request-readiness') {\n                events.remoteReadinessRequested.dispatch();\n            } else if (type === 'pong') {\n                this.onPong();\n            } else if (type === 'ping') {\n                this.sendEvent('pong');\n            } else if (type === 'set-permissions') {\n                events.remoteMicPermissionsSet.dispatch(data.level);\n            } else if (type === 'remote-mics-list') {\n                events.remoteMicListUpdated.dispatch(data.list);\n            }\n        });\n    };\n\n    private reconnect = (roomId: string, name: string) => {\n        if (this.reconnecting) {\n            events.karaokeConnectionStatusChange.dispatch('reconnecting');\n            this.connect(roomId, name, false);\n            setTimeout(() => this.reconnect(roomId, name), 2000);\n        }\n    };\n\n    public sendKeyStroke = (key: keyStrokes) => {\n        this.sendEvent('keystroke', { key });\n    };\n\n    public searchSong = (search: string) => {\n        this.sendEvent('search-song', { search });\n    };\n\n    public requestPlayerChange = (id: string, playerNumber: number | null) => {\n        this.sendEvent<WebRTCRequestMicSelectEvent>('request-mic-select', { id, playerNumber });\n    };\n\n    public confirmReadiness = () => {\n        this.sendEvent('confirm-readiness');\n    };\n\n    public subscribe = (channel: WebRTCSubscribeEvent['channel']) => {\n        this.sendEvent<WebRTCSubscribeEvent>('subscribe-event', { channel });\n    };\n\n    public unsubscribe = (channel: WebRTCSubscribeEvent['channel']) => {\n        this.sendEvent<WebRTCUnsubscribeEvent>('unsubscribe-event', { channel });\n    };\n\n    public getSongList = () => this.sendRequest<WebRTCSongListEvent>({ t: 'request-songlist' }, 'songlist');\n\n    private sendEvent = <T extends WebRTCEvents>(type: T['t'], payload?: Parameters<typeof sendEvent<T>>[2]) => {\n        if (!this.transport.isConnected()) {\n            console.debug('not connected, skipping', type, payload);\n        } else {\n            this.transport.sendEvent({ t: type, ...payload } as T);\n        }\n    };\n\n    private sendRequest = <T extends WebRTCEvents>({ t, ...payload }: WebRTCEvents, response: T['t']): Promise<T> => {\n        return new Promise<T>((resolve, reject) => {\n            const timeout = setTimeout(() => {\n                this.transport.removeListener(callback);\n                reject('timeout');\n            }, 10_000);\n\n            const callback = (event: WebRTCEvents) => {\n                if (event.t === response) {\n                    clearTimeout(timeout);\n                    this.transport.removeListener(callback);\n                    resolve(event as T);\n                }\n            };\n            this.transport.addListener(callback);\n\n            this.sendEvent(t, payload);\n        });\n    };\n\n    public disconnect = () => {\n        this.transport.close();\n    };\n}\n","import { PeerJSClientTransport, TheClient, WebSocketClientTransport } from 'RemoteMic/Network/TheClient';\n\nconst urlParams = new URLSearchParams(window.location.search);\nconst transport = urlParams.get('transport');\n\nconst client: TheClient = new TheClient(\n    transport === 'websocket' ? new WebSocketClientTransport() : new PeerJSClientTransport(),\n);\n\nexport default client;\n","import { Song, SongPreview } from 'interfaces';\nimport { memoize } from 'lodash-es';\n\nexport default memoize(function getSongBeatLength(song: Song | SongPreview): number {\n    return (60 / song.bpm / song.bar) * 1000;\n});\n","import { ValuesType } from 'utility-types';\n\nexport type NoteType = 'normal' | 'star' | 'freestyle' | 'rap';\nexport interface Note {\n    start: number;\n    length: number;\n    pitch: number;\n    type: NoteType;\n    lyrics: string;\n}\n\nexport interface NotesSection {\n    // end: never;\n    start: number;\n    notes: Note[];\n    type: 'notes';\n}\n\nexport interface PauseSection {\n    start: number;\n    end: number;\n    // notes: never;\n    type: 'pause';\n}\n\nexport type Section = NotesSection | PauseSection;\n\nexport const GAME_MODE = {\n    DUEL: 'DUEL',\n    PASS_THE_MIC: 'PASS_THE_MIC',\n    CO_OP: 'CO_OP',\n} as const;\n\nexport interface PlayerSetup {\n    track: number;\n    number: number;\n}\n\nexport interface SingSetup {\n    id: string;\n    players: PlayerSetup[];\n    mode: ValuesType<typeof GAME_MODE>;\n    tolerance: number;\n}\n\nexport interface Song {\n    lastUpdate: string | undefined;\n    author: string | undefined;\n    authorUrl: string | undefined;\n    genre: string | undefined;\n    year: string | undefined;\n    edition: string | undefined;\n    language: string | string[] | undefined;\n    sourceUrl: string | undefined;\n    videoGap: number | undefined;\n    artist: string;\n    title: string;\n    video: string;\n    previewStart: number | undefined;\n    previewEnd: number | undefined;\n    gap: number;\n    bpm: number;\n    realBpm: number | undefined;\n    bar: number;\n    tracks: SongTrack[];\n    volume: number | undefined;\n}\n\nexport interface SongTrack {\n    name?: string;\n    sections: Section[];\n}\n\nexport interface SongPreview extends Omit<Song, 'tracks'> {\n    file: string;\n    tracksCount: number;\n    tracks: Array<Pick<SongTrack, 'name'> & { start: number }>;\n    search: string;\n    isNew?: boolean;\n    isDeleted?: boolean;\n    local?: boolean;\n}\n\nexport interface FrequencyRecord {\n    timestamp: number;\n    frequency: number;\n}\n\nexport interface NoteFrequencyRecord extends FrequencyRecord {\n    preciseDistance: number;\n}\n\nexport interface PlayerNote {\n    start: number;\n    length: number;\n    distance: number;\n    note: Note;\n    isPerfect: boolean;\n    vibrato: boolean;\n    frequencyRecords: NoteFrequencyRecord[];\n}\n\ntype UndefinedKeys<T> = {\n    [K in keyof T]: undefined extends T[K] ? K : never;\n}[keyof T];\n\nexport type ExtractOptional<T> = Pick<T, Exclude<UndefinedKeys<T>, undefined>>;\n\nexport type DetailedScore = Record<Note['type'] | 'perfect' | 'vibrato', number>;\n\nexport interface HighScoreEntity {\n    singSetupId: string;\n    name: string;\n    score: number;\n    date: string;\n}\n\nexport type seconds = number;\nexport type milliseconds = number;\n\n// From https://github.com/peers/peerjs/blob/releases/2.0.0/lib/enums.ts\nexport enum PeerErrorType {\n    BrowserIncompatible = 'browser-incompatible',\n    Disconnected = 'disconnected',\n    InvalidID = 'invalid-id',\n    InvalidKey = 'invalid-key',\n    Network = 'network',\n    PeerUnavailable = 'peer-unavailable',\n    SslUnavailable = 'ssl-unavailable',\n    ServerError = 'server-error',\n    SocketError = 'socket-error',\n    SocketClosed = 'socket-closed',\n    UnavailableID = 'unavailable-id',\n    WebRTC = 'webrtc',\n}\n","export const noDistanceNoteTypes = ['freestyle', 'rap'];\nexport const noPointsNoteTypes: string[] = [];\n\nexport const MIDDLEA = 440;\nexport const SEMITONE = 69;\n\nexport const MAX_NAME_LENGTH = 20;\n","import { MIDDLEA, SEMITONE } from 'consts';\n\nexport default function pitchToFrequency(note: number) {\n    return MIDDLEA * Math.pow(2, (note - SEMITONE) / 12);\n}\n","import { MIDDLEA, SEMITONE } from 'consts';\nimport pitchToFrequency from 'utils/pitchToFrequency';\nimport GameState from '../GameState';\n\nexport const pitchFromFrequency = (freq: number) =>\n    Math.round(12 * (Math.log(freq / MIDDLEA) / Math.log(2))) + SEMITONE;\n\nconst getDistanceInCents = (noteFreq: number, freq: number) =>\n    Math.floor((1200 * Math.log(freq / noteFreq)) / Math.log(2));\n\nconst getCentDistance = (targetNote: number, freq: number, tolerance: number) => {\n    const noteFreq = pitchToFrequency(targetNote);\n    const cents = getDistanceInCents(noteFreq, freq);\n    // To handle cases for cents like -1150 (=50) or 1150 (=-50)\n    const distance = Math.sign(cents) * ((((Math.abs(cents) % 1200) + 600) % 1200) - 600);\n\n    return distance / (tolerance * 100 + 50);\n};\n\nexport const calcDistanceBetweenPitches = (note: number, targetNote: number, tolerance: number) => {\n    // +6 / - 6 are here to avoid distances like -8 in favor of +4\n    // (so smallest between \"too high\" or \"too low\" pitch to hit the note in whatever octave)\n    const noteDistance = (((note % 12) - (targetNote % 12) + 18) % 12) - 6;\n\n    return Math.abs(noteDistance) <= tolerance ? 0 : noteDistance;\n};\n\nexport const calcDistance = (frequency: number, targetNote: number) => {\n    const tolerance = GameState.getTolerance();\n    const note = pitchFromFrequency(frequency);\n    let preciseDistance: number = -1;\n    const distance = calcDistanceBetweenPitches(note, targetNote, tolerance);\n\n    if (distance === 0) {\n        preciseDistance = getCentDistance(targetNote, frequency, tolerance);\n    }\n\n    return { distance, preciseDistance };\n};\n","import { FrequencyRecord } from 'interfaces';\n\nconst WINDOW_SIZE = 6;\n\nexport default function detectVibrato(data: FrequencyRecord[]): boolean {\n    const opChangePoints: Array<FrequencyRecord & { change: '>' | '<'; interval: number }> = [];\n\n    for (let i = 1; i < data.length; i++) {\n        if (Math.round(data[i].frequency / 2) === Math.round(data[i - 1].frequency / 2)) continue;\n\n        const change = data[i].frequency > data[i - 1].frequency ? '>' : '<';\n        if (opChangePoints.length === 0) {\n            opChangePoints.push({\n                ...data[i],\n                interval: data[i].timestamp - data[i - 1].timestamp,\n                change,\n            });\n        } else {\n            const lastChange = opChangePoints.at(-1)!;\n            if (lastChange.change !== change) {\n                opChangePoints.push({\n                    ...data[i],\n                    interval: data[i].timestamp - lastChange.timestamp,\n                    change,\n                });\n            }\n        }\n    }\n\n    const changePoints = opChangePoints;\n\n    for (let i = 0; i < changePoints.length - WINDOW_SIZE; i++) {\n        const window = changePoints.slice(i, i + WINDOW_SIZE - 1);\n\n        const intervals = window.map((record) => record.interval);\n        // const pitches = window.map((record) => record.pitch);\n        const maxInterval = Math.max(...intervals);\n        const minInterval = Math.min(...intervals);\n\n        const averageIntervals = intervals.reduce((sum, i) => sum + i, 0) / intervals.length;\n\n        if (maxInterval < averageIntervals * 1.75 && minInterval > averageIntervals / 1.75) return true;\n    }\n\n    return false;\n}\n","import { noDistanceNoteTypes } from 'consts';\nimport { FrequencyRecord, Note, PlayerNote } from 'interfaces';\nimport { calcDistance } from './calcDistance';\nimport detectVibrato from './detectVibrato';\n\nconst SINGING_BREAK_TOLERANCE_MS = 100;\n\nexport function appendFrequencyToPlayerNotes(\n    playerNotes: PlayerNote[],\n    record: FrequencyRecord,\n    note: Note,\n    beatLength: number,\n) {\n    if (record.frequency === 0) return;\n    const noteCandidate = {\n        ...record,\n        beat: Math.max(0, record.timestamp) / beatLength,\n        ...calcDistance(record.frequency, note.pitch),\n    };\n    const lastNote = playerNotes.at(-1);\n\n    const breakToleranceBeat = SINGING_BREAK_TOLERANCE_MS / beatLength;\n\n    const noteEndBeat = note.start + note.length;\n    const isThisNoteDifferentThanLast = !lastNote || lastNote.note.start !== note.start;\n    const isDistanceDifferent =\n        !lastNote || (lastNote.distance !== noteCandidate.distance && !noDistanceNoteTypes.includes(note.type));\n\n    if (\n        isThisNoteDifferentThanLast ||\n        isDistanceDifferent ||\n        noteCandidate.beat - (lastNote.start + lastNote.length) > breakToleranceBeat\n    ) {\n        const roundedStart = noteCandidate.beat - breakToleranceBeat < note.start ? note.start : noteCandidate.beat;\n        playerNotes.push({\n            // If this is the first player note for the note, round player note start to note's start\n            start: Math.min(isThisNoteDifferentThanLast ? roundedStart : noteCandidate.beat, noteEndBeat),\n            length: 0,\n            distance: noteCandidate.distance,\n            note,\n            isPerfect: false,\n            vibrato: false,\n            frequencyRecords: [\n                {\n                    frequency: noteCandidate.frequency,\n                    preciseDistance: noteCandidate.preciseDistance,\n                    timestamp: noteCandidate.timestamp,\n                },\n            ],\n        });\n\n        // Round the last player note length to the end of the note, so it looks a bit smoother\n        if (lastNote && note.start !== lastNote.note.start) {\n            const lastPlayerNoteEndBeat = lastNote.start + lastNote.length;\n            const lastNoteEndBeat = lastNote.note.start + lastNote.note.length;\n            const roundedLength =\n                lastPlayerNoteEndBeat + breakToleranceBeat > lastNoteEndBeat ? lastNoteEndBeat : lastPlayerNoteEndBeat;\n            lastNote.length = Math.max(0, roundedLength - lastNote.start);\n        }\n    } else {\n        lastNote.length = Math.max(0, Math.min(noteCandidate.beat, note.start + note.length) - lastNote.start);\n        lastNote.frequencyRecords.push({\n            frequency: noteCandidate.frequency,\n            timestamp: noteCandidate.timestamp,\n            preciseDistance: noteCandidate.preciseDistance,\n        });\n\n        lastNote.isPerfect = lastNote.distance === 0 && Math.abs(lastNote.length - lastNote.note.length) < 0.5;\n\n        lastNote.vibrato = lastNote.distance === 0 && detectVibrato(lastNote.frequencyRecords);\n    }\n}\n","import { noDistanceNoteTypes } from 'consts';\nimport { PlayerNote } from 'interfaces';\n\nexport default function getPlayerNoteDistance(note: PlayerNote) {\n    return noDistanceNoteTypes.includes(note.note.type) ? 0 : note.distance;\n}\n","import isNotesSection from 'Songs/utils/isNotesSection';\nimport { noPointsNoteTypes } from 'consts';\nimport { DetailedScore, PlayerNote, Song } from 'interfaces';\nimport { memoize } from 'lodash-es';\nimport tuple from '../../../../../utils/tuple';\nimport getPlayerNoteDistance from '../../Helpers/getPlayerNoteDistance';\n\nexport const MAX_POINTS = 3_500_000;\n\nconst noteTypesMultipliers: DetailedScore = {\n    freestyle: 0.25,\n    rap: 0.25,\n    star: 2,\n    normal: 1,\n    perfect: 0.5,\n    vibrato: 0.25,\n};\n\nconst countsToBeats = (counts: DetailedScore): DetailedScore => ({\n    freestyle: counts.freestyle * noteTypesMultipliers.freestyle,\n    rap: counts.rap * noteTypesMultipliers.rap,\n    star: counts.star * noteTypesMultipliers.star,\n    normal: counts.normal * noteTypesMultipliers.normal,\n    perfect: counts.perfect * noteTypesMultipliers.perfect,\n    vibrato: counts.vibrato * noteTypesMultipliers.vibrato,\n});\n\nexport const sumDetailedScore = (counts: DetailedScore) =>\n    counts.freestyle + counts.rap + counts.star + counts.normal + counts.perfect + counts.vibrato;\n\nexport const beatsToPoints = (counts: DetailedScore, pointsPerBeat: number): DetailedScore => ({\n    freestyle: counts.freestyle * pointsPerBeat,\n    rap: counts.rap * pointsPerBeat,\n    star: counts.star * pointsPerBeat,\n    normal: counts.normal * pointsPerBeat,\n    perfect: counts.perfect * pointsPerBeat,\n    vibrato: counts.vibrato * pointsPerBeat,\n});\n\nexport const addDetailedScores = (s1: DetailedScore, s2: DetailedScore): DetailedScore => ({\n    freestyle: s1.freestyle + s2.freestyle,\n    rap: s1.rap + s2.rap,\n    star: s1.star + s2.star,\n    normal: s1.normal + s2.normal,\n    perfect: s1.perfect + s2.perfect,\n    vibrato: s1.vibrato + s2.vibrato,\n});\n\nexport const divideDetailedScores = (counts: DetailedScore, divideBy: number): DetailedScore => ({\n    freestyle: counts.freestyle / divideBy,\n    rap: counts.rap / divideBy,\n    star: counts.star / divideBy,\n    normal: counts.normal / divideBy,\n    perfect: counts.perfect / divideBy,\n    vibrato: counts.vibrato / divideBy,\n});\n\nconst countSungBeats = memoize((song: Song): DetailedScore[] => {\n    return song.tracks.map(({ sections }) => {\n        const counts: DetailedScore = {\n            freestyle: 0,\n            rap: 0,\n            star: 0,\n            normal: 0,\n            perfect: 0,\n            vibrato: 0,\n        };\n        sections.filter(isNotesSection).forEach((section) => {\n            const notes = section.notes.filter((note) => !noPointsNoteTypes.includes(note.type));\n\n            notes.forEach((note) => {\n                counts[note.type] = counts[note.type] + note.length;\n                counts.perfect = counts.perfect + note.length;\n                counts.vibrato = counts.vibrato + note.length;\n            });\n        });\n\n        return counts;\n    });\n});\n\nexport function calculateDetailedScoreData(playerNotes: PlayerNote[], song: Song, trackNumber: number) {\n    const beatsPerTrack = countSungBeats(song);\n\n    const counts: DetailedScore = {\n        freestyle: 0,\n        rap: 0,\n        star: 0,\n        normal: 0,\n        perfect: 0,\n        vibrato: 0,\n    };\n\n    if (!beatsPerTrack[trackNumber]) {\n        console.error(`No beat count for track ${trackNumber} in song`, song);\n        return tuple([0, counts, counts]);\n    }\n\n    const maxCounts = countsToBeats(countSungBeats(song)[trackNumber]);\n\n    const pointsPerBeat = MAX_POINTS / sumDetailedScore(maxCounts);\n\n    for (let i = 0; i < playerNotes.length; i++) {\n        const note = playerNotes[i];\n        if (noPointsNoteTypes.includes(note.note.type)) continue;\n        if (getPlayerNoteDistance(note) !== 0) continue;\n\n        counts[note.note.type] = counts[note.note.type] + note.length;\n\n        if (note.isPerfect) counts.perfect = counts.perfect + note.length;\n        if (note.vibrato) counts.vibrato = counts.vibrato + note.length;\n    }\n\n    return tuple([pointsPerBeat, countsToBeats(counts), maxCounts]);\n}\n\nexport default function calculateScore(playerNotes: PlayerNote[], song: Song, trackNumber: number): number {\n    const [pointsPerBeat, counts] = calculateDetailedScoreData(playerNotes, song, trackNumber);\n\n    return sumDetailedScore(counts) * pointsPerBeat;\n}\n","export default function getCurrentBeat(currentTime: number, beatLength: number, gap: number, round = true): number {\n    const currentBeat = (currentTime - gap) / beatLength;\n    return round ? Math.floor(currentBeat) : currentBeat;\n}\n","import events from 'GameEvents/GameEvents';\nimport getSongBeatLength from 'Songs/utils/getSongBeatLength';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { getNoteAtBeat } from 'Songs/utils/notesSelectors';\nimport { FrequencyRecord, GAME_MODE, NotesSection, PlayerNote, SingSetup, Song } from 'interfaces';\nimport tuple from 'utils/tuple';\nimport InputManager from '../Input/InputManager';\nimport { appendFrequencyToPlayerNotes } from './Helpers/appendFrequencyToPlayerNotes';\nimport calculateScore, {\n    addDetailedScores,\n    beatsToPoints,\n    calculateDetailedScoreData,\n    divideDetailedScores,\n} from './Helpers/calculateScore';\nimport getCurrentBeat from './Helpers/getCurrentBeat';\n\nclass PlayerState {\n    private frequencyRecords: FrequencyRecord[] = [];\n    private playerNotes: PlayerNote[] = [];\n    private realFrequencyRecords: FrequencyRecord[] = [];\n    private realPlayerNotes: PlayerNote[] = [];\n    private min = Infinity;\n    private max = -Infinity;\n\n    private storedSectionIndex = 0;\n\n    public constructor(private number: number, private gameState: GameState) {\n        this.getTrack()\n            .sections.filter(isNotesSection)\n            .forEach((section) =>\n                section.notes.forEach((note) => {\n                    this.min = Math.min(this.min, note.pitch);\n                    this.max = Math.max(this.max, note.pitch);\n                }),\n            );\n    }\n\n    public getNumber = () => this.number;\n\n    public update = () => {\n        const currentTime = this.gameState.getCurrentTime();\n\n        const frequency = InputManager.getPlayerFrequency(this.number);\n        const currentTimestamp = currentTime - InputManager.getPlayerInputLag(this.number);\n\n        // If it's a pack of frequencies (from remote mic), restore last \"real\" frequencies,\n        // add and recalculate for the received pack, and store newly computed\n        // frequencies for the moment when new package arrive.\n        // If it's a single frequency, just add it to the notes\n        if (Array.isArray(frequency)) {\n            const lastRealRecord = this.realFrequencyRecords.at(-1) || this.frequencyRecords.at(0);\n            const lastTimestamp = lastRealRecord?.timestamp ?? 0;\n            const timestampStep = (currentTimestamp - lastTimestamp) / frequency.length;\n\n            this.frequencyRecords = this.realFrequencyRecords;\n            this.playerNotes = this.realPlayerNotes;\n\n            for (let i = 0; i < frequency.length; i++) {\n                const timestamp = lastTimestamp + timestampStep * (i + 1);\n                this.updatePlayerNotes(timestamp, frequency[i]);\n            }\n\n            this.realFrequencyRecords = [...this.frequencyRecords];\n            this.realPlayerNotes = [...this.playerNotes];\n            // Last note can be mutated, so we create a shallow copy of it\n            const lastNote = this.realPlayerNotes.at(-1);\n\n            if (lastNote) {\n                this.realPlayerNotes[this.realPlayerNotes.length - 1] = {\n                    ...lastNote,\n                    // This can be mutated as well\n                    frequencyRecords: [...(lastNote.frequencyRecords ?? [])],\n                };\n            }\n        } else {\n            this.updatePlayerNotes(currentTimestamp, frequency);\n        }\n\n        this.dispatchSectionUpdate();\n    };\n\n    private dispatchSectionUpdate = () => {\n        const currentSectionIndex = this.getCurrentSectionIndex();\n        if (this.storedSectionIndex !== currentSectionIndex) {\n            events.sectionChange.dispatch(this.number, this.storedSectionIndex);\n            this.storedSectionIndex = currentSectionIndex;\n        }\n    };\n\n    public updatePlayerNotes = (timestamp: number, frequency: number) => {\n        const record = { timestamp, frequency };\n        this.frequencyRecords.push(record);\n\n        const recordBeat = record.timestamp / this.gameState.getSongBeatLength();\n        const recordSection = this.getSectionByBeat(recordBeat);\n\n        if (isNotesSection(recordSection)) {\n            const note = getNoteAtBeat(recordSection, recordBeat, 0) ?? getNoteAtBeat(recordSection, recordBeat, 0.5);\n\n            if (note) appendFrequencyToPlayerNotes(this.playerNotes, record, note, this.gameState.getSongBeatLength());\n        }\n    };\n\n    public getPlayerNotes = () => this.playerNotes;\n    public getPlayerFrequencies = () => this.frequencyRecords;\n\n    public getSectionIndexByBeat = (beat: number) => {\n        return this.getTrack().sections.findIndex((section, index, sections) => {\n            if (beat < 0) return true;\n            if (beat < section.start) return false;\n            if (index === sections.length - 1) return true;\n            return sections[index + 1].start > beat;\n        });\n    };\n\n    public getCurrentSectionIndex = () => this.getSectionIndexByBeat(this.gameState.getCurrentBeat());\n\n    public getSectionByBeat = (beat: number) => this.getTrack().sections[this.getSectionIndexByBeat(beat)] ?? null;\n\n    public getCurrentSection = () => {\n        const sectionIndex = this.getCurrentSectionIndex();\n\n        return this.getTrack().sections[sectionIndex] ?? null;\n    };\n\n    public getNextSection = (index = 1) => {\n        const sectionIndex = this.getCurrentSectionIndex();\n\n        return sectionIndex > -1 ? this.getTrack().sections[sectionIndex + index] ?? null : null;\n    };\n\n    public getPreviousSection = (index = 1) => {\n        const sectionIndex = this.getCurrentSectionIndex();\n\n        return sectionIndex > -1 ? this.getTrack().sections[sectionIndex - index] ?? null : null;\n    };\n\n    public getLastNotesSection = () => {\n        const last = this.getTrack().sections.at(-1);\n        return isNotesSection(last) ? last : (this.getTrack().sections.at(-2) as NotesSection);\n    };\n\n    public getScore = () => calculateScore(this.playerNotes, this.gameState.getSong()!, this.getTrackIndex());\n    public getDetailedScore = () =>\n        calculateDetailedScoreData(this.playerNotes, this.gameState.getSong()!, this.getTrackIndex());\n\n    public getMinPitch = () => this.min;\n    public getMaxPitch = () => this.max;\n\n    public getTrackIndex = () => this.gameState.getSingSetup()!.players[this.number].track;\n    public getTrack = () => this.gameState.getSong()!.tracks[this.getTrackIndex()];\n\n    public resetNotes = () => {\n        this.playerNotes = [];\n    };\n}\n\nclass GameState {\n    private song: Song | null = null;\n    private currentTime: number = 0;\n    private duration: number = 0;\n    private singSetup: SingSetup | null = null;\n    private playerStates: PlayerState[] = [];\n\n    public setCurrentTime = (currentTime: number) => (this.currentTime = currentTime);\n    public getCurrentTime = (accountGap = true) => {\n        return this.currentTime - (accountGap && this.song ? this.song.gap : 0);\n    };\n\n    public getSongBeatLength = () => getSongBeatLength(this.song!);\n    public getCurrentBeat = () => {\n        return getCurrentBeat(this.getCurrentTime(), this.getSongBeatLength(), 0, false);\n    };\n\n    public setSong = (song: Song) => (this.song = song);\n    public getSong = () => this.song;\n\n    public setSingSetup = (singSetup: SingSetup) => {\n        this.singSetup = singSetup;\n\n        this.playerStates = singSetup.players.map(({ number }, index) => new PlayerState(number, this));\n        this.currentTime = 0;\n    };\n    public getSingSetup = () => this.singSetup;\n    public getTolerance = () => this.getSingSetup()?.tolerance ?? 2;\n\n    public setDuration = (duration: number) => (this.duration = duration);\n    public getDuration = () => this.duration;\n\n    public getPlayer = (playerNumber: number) =>\n        this.playerStates.find((player) => player.getNumber() === playerNumber);\n\n    public getPlayers = () => this.playerStates;\n\n    public getPlayerCount = () => this.playerStates.length;\n\n    public getPlayerScore = (player: number) => {\n        if (this.getSingSetup()?.mode === GAME_MODE.CO_OP) {\n            const score = this.getPlayers().reduce((curr, playerState) => curr + playerState.getScore(), 0);\n\n            return score / this.getPlayerCount();\n        } else {\n            return this.getPlayer(player)?.getScore() ?? -1;\n        }\n    };\n\n    public getPlayerDetailedScore = (player: number) => {\n        if (this.getSingSetup()?.mode === GAME_MODE.CO_OP) {\n            const scores = this.getPlayers().map((playerState) => playerState.getDetailedScore());\n\n            // getDetailedScore returns beats - calculate actual points for each player\n            const [fs, ...pointsScores] = scores.map(\n                ([pointsPerBeat, counts, maxCounts]) =>\n                    [beatsToPoints(counts, pointsPerBeat), beatsToPoints(maxCounts, pointsPerBeat)] as const,\n            );\n\n            const summedPoints = pointsScores.reduce(\n                (curr, pointsScore) => [\n                    addDetailedScores(curr[0], pointsScore[0]),\n                    addDetailedScores(curr[1], pointsScore[1]),\n                ],\n                fs,\n            );\n            return tuple([\n                divideDetailedScores(summedPoints[0], this.getPlayerCount()),\n                divideDetailedScores(summedPoints[1], this.getPlayerCount()),\n            ]);\n        } else {\n            const [pointsPerBeat, counts, maxCounts] = this.getPlayer(player)!.getDetailedScore();\n\n            return tuple([beatsToPoints(counts, pointsPerBeat), beatsToPoints(maxCounts, pointsPerBeat)]);\n        }\n    };\n\n    public startInputMonitoring = async () => {\n        return InputManager.startMonitoring();\n    };\n\n    public stopInputMonitoring = () => {\n        return InputManager.stopMonitoring();\n    };\n\n    public update = () => {\n        this.playerStates.forEach((player) => player.update());\n    };\n    public resetPlayerNotes = () => {\n        this.playerStates.forEach((player) => player.resetNotes());\n    };\n}\n\nexport default new GameState();\n","import CameraManager from 'Camera/CameraManager';\nimport GameEvents from 'GameEvents/GameEvents'; // @ts-ignore\nimport PlayersManager from 'Players/PlayersManager';\nimport WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport WebRTCServer from 'RemoteMic/Network/WebRTCServer';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport GameState from 'Scenes/Game/Singing/GameState/GameState';\nimport inputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport inputSources from 'Scenes/SelectInput/InputSources';\nimport SongDao from 'Songs/SongDao';\nimport UserMediaService from 'UserMedia/userMediaService';\n\n// @ts-ignore\nwindow.__exposeSingletons = () => {\n    // @ts-ignore\n    window.__singletons = {\n        WebRTCClient,\n        WebRTCServer,\n        GameState,\n        GameEvents,\n        RemoteMicManager,\n        SongDao,\n        InputManager: inputManager,\n        InputSourceManager: inputSources,\n        CameraManager,\n        UserMediaService,\n        PlayersManager,\n    };\n};\n\nif (process.env.NODE_ENV === 'development') {\n    // @ts-ignore\n    window.__exposeSingletons();\n    // @ts-ignore\n    console.log(window.__singletons);\n} else {\n    console.log(`Run window.__exposeSingletons() and inspect window.__singletons for debugging`);\n}\n","import isE2E from 'utils/isE2E';\n\nexport default function isDev() {\n    return process.env.NODE_ENV === 'development' && !isE2E();\n}\n","import { GameEvent } from 'GameEvents/GameEvents';\nimport { useEffect, useMemo, useState } from 'react';\n\nexport function useEventListener<T extends (...args: any[]) => void>(event: GameEvent<T>, getLast = false) {\n    const [value, setValue] = useState<Parameters<T> | null>(null);\n\n    useEffect(() => {\n        const subscriber = ((...args: Parameters<T>) => {\n            setValue(args);\n        }) as T;\n        event.subscribe(subscriber, getLast);\n        return () => event.unsubscribe(subscriber);\n    }, [event]);\n\n    return value;\n}\n\nexport function useEventEffect<T extends (...args: any[]) => void>(event: GameEvent<T> | GameEvent<T>[], effect: T) {\n    const eventList = Array.isArray(event) ? event : [event];\n\n    useEffect(() => {\n        eventList.forEach((e) => e.subscribe(effect));\n\n        return () => eventList.forEach((e) => e.unsubscribe(effect));\n    }, [...eventList, effect]);\n}\n\nexport function useEventListenerSelector<S extends any>(\n    event: GameEvent<any> | GameEvent<any>[],\n    selector: () => S,\n    dependencies: any[] = [],\n) {\n    const initialValueRef = useMemo(selector, []);\n    const [value, setValue] = useState<S>(initialValueRef);\n\n    const eventList = Array.isArray(event) ? event : [event];\n\n    useEffect(() => {\n        setValue(selector());\n    }, dependencies);\n\n    useEffect(() => {\n        const subscriber = () => setValue(selector());\n        eventList.forEach((e) => e.subscribe(subscriber));\n\n        return () => eventList.forEach((e) => e.unsubscribe(subscriber));\n    }, [...eventList]);\n\n    return value;\n}\n","export const blueFillBase = '0, 153, 255';\nexport const blueFill = (a = 1) => `rgba(${blueFillBase}, ${a})`;\nexport const blueStroke = (a = 1) => `rgba(0, 77, 128, ${a})`;\nexport const redFillBase = '255, 54, 54';\nexport const redFill = (a = 1) => `rgba(${redFillBase}, ${a})`;\nexport const redStroke = (a = 1) => `rgba(117, 25, 25, ${a})`;\n\nconst playerColors = [\n    {\n        text: blueFillBase,\n        star: {\n            fill: 'rgba(255, 183, 0, .5)',\n            stroke: 'rgba(255, 183, 0, 0)',\n            lineWidth: 1,\n        },\n        perfect: {\n            fill: blueFill(1),\n            stroke: 'white',\n            lineWidth: 1,\n        },\n        starPerfect: {\n            fill: 'rgba(255, 213, 0, 1)',\n            stroke: 'rgba(255, 183, 0, 1)',\n            lineWidth: 2,\n        },\n        hit: {\n            fill: blueFill(0.9),\n            stroke: blueStroke(0),\n            lineWidth: 1,\n        },\n        miss: {\n            fill: blueFill(0.25),\n            stroke: blueStroke(1),\n            lineWidth: 1,\n        },\n    },\n    {\n        text: redFillBase,\n        star: {\n            fill: 'rgba(255, 183, 0, .5)',\n            stroke: 'rgba(255, 183, 0, 0)',\n            lineWidth: 1,\n        },\n        perfect: {\n            fill: redFill(1),\n            stroke: 'white',\n            lineWidth: 1,\n        },\n        starPerfect: {\n            fill: 'rgba(255, 213, 0, 1)',\n            stroke: 'rgba(255, 183, 0, 1)',\n            lineWidth: 2,\n        },\n        hit: {\n            fill: redFill(0.9),\n            stroke: redStroke(0),\n            lineWidth: 1,\n        },\n        miss: {\n            fill: redFill(0.25),\n            stroke: redStroke(1),\n            lineWidth: 1,\n        },\n    },\n];\n\nconst styles = {\n    colors: {\n        players: playerColors,\n        lines: {\n            normal: {\n                fill: 'rgba(127, 127, 127, .7)',\n                stroke: 'black',\n                lineWidth: 1,\n            },\n            star: {\n                fill: 'rgba(158, 144, 106, 1)',\n                stroke: 'rgba(255, 183, 0, 1)',\n                lineWidth: 1,\n            },\n            freestyle: {\n                fill: 'rgba(255, 255, 255, 0.1)',\n                stroke: 'black',\n                lineWidth: 2,\n            },\n        },\n        text: {\n            active: 'orange',\n            activeBorder: 'rgb(101,75,22)',\n            default: 'white',\n            inactive: 'grey',\n        },\n    },\n};\n\nexport default styles;\n","import { css, keyframes } from '@emotion/react';\nimport styles from '../Scenes/Game/Singing/GameOverlay/Drawing/styles';\n\nexport const focusable = (props: { focused?: boolean }) => css`\n    ${!!props.focused && focused};\n\n    :hover {\n        ${focused};\n    }\n`;\n\nconst focusAnimation = keyframes`\n  100% {\n    box-shadow: inset 0px 0px 0px 2px ${styles.colors.text.active};\n  }\n  50% {\n    box-shadow: inset 0px 0px 0px 4px ${styles.colors.text.active};\n  }\n  0% {\n    box-shadow: inset 0px 0px 0px 2px ${styles.colors.text.active};\n  }\n`;\n\nexport const focused = css`\n    animation: ${focusAnimation} 1000ms ease-in-out infinite both;\n`;\n\nexport const typography = css`\n    font-weight: bold;\n    -webkit-text-stroke: thin black;\n    color: white;\n`;\n","import events from 'GameEvents/GameEvents';\nimport { useEventEffect } from 'GameEvents/hooks';\nimport { useHotkeys } from 'react-hotkeys-hook';\n\ntype Callback = (e?: KeyboardEvent) => void;\n\n// All besides H (help) character\nexport const REGULAR_ALPHA_CHARS = 'a,b,c,d,e,f,g,i,j,k,l,m,n,o,p,r,s,t,u,w,x,y,z';\n\n// @ts-expect-error\nnavigator?.keyboard?.lock(['Escape']);\n\n// @ts-expect-error\nexport const supportsEscAsBack = !!navigator?.keyboard?.lock;\n\nexport interface Params {\n    up?: Callback;\n    down?: Callback;\n    left?: Callback;\n    right?: Callback;\n    accept?: Callback;\n    back?: Callback;\n    random?: Callback;\n    // alphanumeric?: () => void,\n}\n\nconst paramsToKeys: { [param in keyof Params]: string[] } = {\n    up: ['up'],\n    down: ['down'],\n    left: ['left'],\n    right: ['right'],\n    accept: ['Enter'],\n    back: ['Backspace', 'Escape'],\n    random: ['Shift+R'],\n};\n\nconst keyToParam = (keyCode: string): keyof Params | null => {\n    return (Object.entries(paramsToKeys).find(([key, val]) => val.includes(keyCode))?.[0] as keyof Params) ?? null;\n};\n\nexport default function useKeyboard(params: Params, enabled = true, deps?: any[]) {\n    let handledKeys: string = Object.keys(params)\n        .map((param) => paramsToKeys[param as keyof Params])\n        .join(',');\n\n    useEventEffect(events.remoteKeyboardPressed, (param) => {\n        if (enabled) {\n            if (param in params) {\n                params[param]?.();\n            }\n        }\n    });\n\n    useHotkeys(\n        handledKeys,\n        (event, hkEvent) => {\n            const param = keyToParam(hkEvent.key);\n\n            if (!param) return;\n\n            if (param in params) {\n                event.preventDefault();\n                event.stopPropagation();\n                params[param]?.(event);\n            }\n        },\n        { enabled },\n        deps,\n    );\n}\n","import styled from '@emotion/styled';\nimport { KeyboardReturn } from '@mui/icons-material';\nimport HelpIcon from '@mui/icons-material/Help';\nimport { typography } from 'Elements/cssMixins';\nimport { MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport { supportsEscAsBack } from 'hooks/useKeyboard';\nimport { ComponentType } from 'react';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport createPersistedState from 'use-persisted-state';\nimport { RegularHelpEntry } from './Context';\ninterface Props {\n    help: RegularHelpEntry;\n}\n\nconst useIsVisible = createPersistedState('keyboard-help-visibility');\n\nexport default function KeyboardHelpView({ help }: Props) {\n    const [isVisible, setIsVisible] = useIsVisible(true);\n\n    useHotkeys('h', () => setIsVisible(!isVisible), undefined, [isVisible]);\n\n    const helps = Object.entries(help ?? {}).filter(([, value]) => value !== undefined);\n\n    const [mobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n\n    if (mobilePhoneMode) {\n        return null;\n    }\n\n    return (\n        <>\n            {!!helps.length && (\n                <Container\n                    data-test=\"help-container\"\n                    onClick={() => setIsVisible(!isVisible)}\n                    collapsed={!isVisible}\n                    data-collapsed={!isVisible}>\n                    {isVisible ? (\n                        <>\n                            <UseKeyboardIndicator>Use indicated keys on your keyboard</UseKeyboardIndicator>\n                            {helps.map(([type, label]) => {\n                                const { view: Component, defaultLabel } =\n                                    KeyhelpComponent[type as keyof RegularHelpEntry];\n                                return (\n                                    <Section key={type}>\n                                        <SectionHelp>{label ?? defaultLabel}</SectionHelp>\n                                        <SectionKeys>\n                                            <Component />\n                                        </SectionKeys>\n                                    </Section>\n                                );\n                            })}\n                            <Section>\n                                <SectionHelp>Show/hide this help</SectionHelp>\n                                <SectionKeys>\n                                    <Kbd>H</Kbd>\n                                </SectionKeys>\n                            </Section>\n                        </>\n                    ) : (\n                        <HelpIcon onClick={() => setIsVisible(!isVisible)} />\n                    )}\n                </Container>\n            )}\n        </>\n    );\n}\n\nconst HorizontalVerticalBase = ({ vertical = false, horizontal = false }) => (\n    <>\n        <Kbd disabled={!vertical}></Kbd>\n        <br />\n        <Kbd disabled={!horizontal}></Kbd>\n        <Kbd disabled={!vertical}></Kbd>\n        <Kbd disabled={!horizontal}></Kbd>\n    </>\n);\n\nconst Horizontal = () => <HorizontalVerticalBase horizontal />;\nconst Vertical = () => <HorizontalVerticalBase vertical />;\nconst HorizontalVertical = () => <HorizontalVerticalBase vertical horizontal />;\nconst Accept = () => (\n    <Kbd>\n        Enter <KeyboardReturn />\n    </Kbd>\n);\nconst Back = () => (supportsEscAsBack ? <Kbd>Escape</Kbd> : <Kbd>Backspace </Kbd>);\nconst ShiftLetter = (letter: string) => () =>\n    (\n        <>\n            <Kbd>Shift</Kbd> + <Kbd>{letter.toUpperCase()}</Kbd>\n        </>\n    );\n\nconst KeyhelpComponent: Record<keyof RegularHelpEntry, { view: ComponentType; defaultLabel: string }> = {\n    'horizontal-vertical': { view: HorizontalVertical, defaultLabel: 'Navigate' },\n    horizontal: { view: Horizontal, defaultLabel: 'Navigate' },\n    vertical: { view: Vertical, defaultLabel: 'Navigate' },\n    accept: { view: Accept, defaultLabel: 'Select' },\n    back: { view: Back, defaultLabel: 'Go back' },\n    shiftR: { view: ShiftLetter('r'), defaultLabel: 'Pick random' },\n};\n\nconst Section = styled.div`\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 1rem;\n`;\n\nconst SectionKeys = styled.div`\n    flex-wrap: nowrap;\n    text-align: center;\n    flex: 2;\n    color: white;\n    font-weight: bold;\n`;\nconst SectionHelp = styled.span`\n    flex: 3;\n    ${typography};\n    font-size: 2rem;\n    text-align: right;\n`;\n\nconst UseKeyboardIndicator = styled.div`\n    position: absolute;\n    inset: 0 0 0 0;\n    background: rgba(0, 0, 0, 0.75);\n    ${typography};\n    font-size: 2rem;\n    padding: 2rem;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    text-align: center;\n    opacity: 0;\n    transition: 300ms;\n    visibility: hidden;\n`;\n\nconst Container = styled.div<{ collapsed: boolean }>`\n    position: fixed;\n    top: 10rem;\n    right: 5.5rem;\n    padding: 0.5rem;\n    background: rgba(0, 0, 0, 0.5);\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    width: ${(props) => (props.collapsed ? 'auto' : '34rem')};\n    opacity: ${(props) => (props.collapsed ? 0.5 : 1)};\n    cursor: pointer;\n\n    z-index: 10000;\n\n    @media (max-width: 560px) {\n        display: none;\n    }\n\n    view-transition-name: help-view;\n\n    :hover {\n        ${UseKeyboardIndicator} {\n            opacity: 1;\n            visibility: visible;\n        }\n    }\n\n    svg {\n        fill: white;\n    }\n`;\n\nconst Kbd = styled.kbd<{ disabled?: boolean }>`\n    margin: 0.2rem;\n    padding: 0.12rem 0.9rem;\n    border-radius: 0.3rem;\n    border: 0.1rem solid rgb(204, 204, 204);\n    color: rgb(51, 51, 51);\n    line-height: 1.4;\n    font-size: 1.6rem;\n    display: inline-block;\n    box-shadow: 0 0.1rem 0 rgba(0, 0, 0, 0.2), inset 0 0 0 0.2rem #ffffff;\n    background-color: rgb(247, 247, 247);\n    text-shadow: 0 0.1rem 0 #fff;\n    font-weight: normal;\n\n    opacity: ${(props) => (props.disabled ? 0.25 : 1)};\n`;\n","import events from 'GameEvents/GameEvents';\nimport { useEventEffect } from 'GameEvents/hooks';\nimport { omit } from 'lodash-es';\nimport { createContext, FunctionComponent, PropsWithChildren, useEffect, useState } from 'react';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport KeyboardHelpView from './HelpView';\n\ntype keys = 'horizontal' | 'vertical' | 'horizontal-vertical' | 'accept' | 'back' | 'shiftR';\n\ntype remoteActions = 'search';\n\nexport type RegularHelpEntry = Partial<Record<keys, string | null>>;\nexport type HelpEntry = RegularHelpEntry & { remote?: remoteActions[] };\n\nexport const KeyboardHelpContext = createContext({\n    setKeyboard: (name: string, helpEntry: HelpEntry): void => {},\n    unsetKeyboard: (name: string): void => {},\n});\n\ntype KeyboardsList = Record<string, HelpEntry>;\n\nexport const KeyboardHelpProvider: FunctionComponent<PropsWithChildren> = ({ children }) => {\n    const [keyboards, setKeyboards] = useState<KeyboardsList>({});\n\n    const setKeyboard = (name: string, helpEntry: HelpEntry) => {\n        setKeyboards((kbs) => ({\n            ...kbs,\n            [name]: helpEntry,\n        }));\n    };\n\n    const unsetKeyboard = (name: string) => setKeyboards((kbs) => omit(kbs, [name]));\n\n    const [name, help] = Object.entries(keyboards).at(-1) ?? [];\n\n    useEventEffect(events.remoteMicConnected, ({ id }) => {\n        RemoteMicManager.getRemoteMicById(id)?.connection.send({\n            t: 'keyboard-layout',\n            help,\n        });\n    });\n\n    useEffect(() => {\n        RemoteMicManager.broadcast({\n            t: 'keyboard-layout',\n            help,\n        });\n    }, [name]);\n\n    const { remote, ...rest } = help ?? {};\n\n    return (\n        <KeyboardHelpContext.Provider value={{ setKeyboard, unsetKeyboard }}>\n            {children}\n            <KeyboardHelpView help={rest} />\n        </KeyboardHelpContext.Provider>\n    );\n};\n","import styled from '@emotion/styled';\nimport React, { createContext, useCallback, useContext, useEffect, useState } from 'react';\nimport { blueFill, blueStroke, redStroke } from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\n\nexport const BackgroundContext = createContext({\n    visible: true,\n    setVisibility: (visible: boolean): void => undefined,\n});\n\nexport const useBackground = (shouldBeVisible: boolean) => {\n    const background = useContext(BackgroundContext);\n    useEffect(() => {\n        if (shouldBeVisible !== background.visible) {\n            background.setVisibility(shouldBeVisible);\n        }\n    }, [shouldBeVisible, background.visible, background.setVisibility]);\n};\n\nexport default function LayoutWithBackgroundProvider({ children }: React.PropsWithChildren) {\n    const [visible, setVisible] = useState(true);\n\n    const setVisibility = useCallback(\n        (newValue: boolean) => {\n            setVisible(newValue);\n        },\n        [setVisible],\n    );\n\n    return (\n        <BackgroundContext.Provider value={{ visible, setVisibility }}>\n            {visible && <Background />}\n            {children}\n        </BackgroundContext.Provider>\n    );\n}\n\nexport const BackgroundStatic = styled.div`\n    background-color: white;\n    background-image: linear-gradient(-45deg, ${redStroke()}, ${blueFill()}, ${blueStroke()}, ${redStroke()});\n    background-size: 400% 400%;\n\n    width: 100%;\n    height: 100%;\n`;\n\nconst Background = styled(BackgroundStatic)`\n    z-index: -1;\n    top: 0;\n    position: fixed;\n    view-transition-name: background;\n\n    ${(props) => (props.theme.graphicSetting === 'high' ? 'animation: gradient 15s ease infinite' : '')};\n    ${(props) => (props.theme.graphicSetting === 'low' ? 'background-position: 100% 50%' : '')};\n\n    @keyframes gradient {\n        0% {\n            background-position: 0% 50%;\n        }\n        50% {\n            background-position: 100% 50%;\n        }\n        100% {\n            background-position: 0% 50%;\n        }\n    }\n`;\n","export default function NormalizeFontSize({ size = 16 }) {\n    return (\n        <style>\n            {`html {\n                font-size: ${size}px !important;\n            }`}\n        </style>\n    );\n}\n","import styled from '@emotion/styled';\nimport { SvgIcon } from '@mui/material';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { ComponentProps } from 'react';\n\nexport const MicIcon = ({ ...props }: ComponentProps<typeof SvgIcon>) => (\n    <SvgIcon viewBox=\"0 0 512 512\" {...props}>\n        <path\n            stroke=\"black\"\n            strokeWidth=\"2%\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            d=\"M252.529,162.029l168.125,210.156c-12.313,1.25-24.031,6.438-33.031,15.438s-14.188,20.719-15.438,33.031L162.029,252.545  c-3.563-24.922,4.813-50.078,22.625-67.891C202.467,166.857,227.623,158.467,252.529,162.029z M398.936,398.936  c-9.063,9.063-13.031,22.063-10.625,34.656l45.281,45.25c12.5,12.5,32.75,12.5,45.25,0s12.5-32.75,0-45.25l-45.25-45.281  C420.998,385.904,407.998,389.873,398.936,398.936z M162.029,162.029c18.594-18.594,43.188-29.891,68.969-32.297  c-3.375-24.563-14.906-49.391-35.031-69.516c-43.75-43.75-109.594-48.813-147.063-11.313  c-37.5,37.484-32.438,103.328,11.313,147.078c20.125,20.125,44.938,31.656,69.5,35.031  C132.154,205.217,143.436,180.623,162.029,162.029z\"\n        />\n    </SvgIcon>\n);\n\nexport const MicIconRed = styled(MicIcon)`\n    fill: rgba(${styles.colors.players[1].text});\n`;\nexport const MicIconBlue = styled(MicIcon)`\n    fill: rgba(${styles.colors.players[0].text});\n`;\n","import styled from '@emotion/styled';\nimport ListIcon from '@mui/icons-material/List';\nimport SettingsIcon from '@mui/icons-material/Settings';\nimport { MicIcon } from 'Elements/MicIcon';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { PhoneTabs } from 'Scenes/RemoteMic/RemoteMic';\n\ninterface Props {\n    active: PhoneTabs;\n    setActiveTab: (active: PhoneTabs) => void;\n}\n\nexport default function BottomBar({ active, setActiveTab }: Props) {\n    return (\n        <Container>\n            <ItemContainer\n                active={active === 'microphone'}\n                onClick={() => setActiveTab('microphone')}\n                data-test=\"menu-microphone\">\n                <ItemIcon>\n                    <MicIcon />\n                </ItemIcon>\n                <ItemTitle>Microphone</ItemTitle>\n            </ItemContainer>\n            <ItemContainer\n                active={active === 'song-list'}\n                onClick={() => setActiveTab('song-list')}\n                data-test=\"menu-song-list\">\n                <ItemIcon>\n                    <ListIcon />\n                </ItemIcon>\n                <ItemTitle>Song list</ItemTitle>\n            </ItemContainer>\n            <ItemContainer\n                active={active === 'settings'}\n                onClick={() => setActiveTab('settings')}\n                data-test=\"menu-settings\">\n                <ItemIcon>\n                    <SettingsIcon />\n                </ItemIcon>\n                <ItemTitle>Settings</ItemTitle>\n            </ItemContainer>\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    display: flex;\n    align-items: stretch;\n    width: 100%;\n    gap: 1px;\n    background: #424242;\n\n    @media (max-height: 500px) and (min-aspect-ratio: 16/10) {\n        max-width: 400px;\n        transform: scale(0.75);\n        transform-origin: bottom left;\n    }\n`;\n\nconst ItemContainer = styled.div<{ active?: boolean }>`\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    background: black;\n    padding: 1rem;\n    font-size: 1.5rem;\n    gap: 0.5rem;\n    color: ${(props) => (props.active ? styles.colors.text.active : '#cecece')};\n`;\n\nconst ItemIcon = styled.div`\n    svg {\n        width: 2.5rem;\n        height: 2.5rem;\n    }\n    font-size: 2rem;\n`;\nconst ItemTitle = styled.div``;\n","import { css } from '@emotion/react';\nimport styled from '@emotion/styled';\nimport { focused, typography } from 'Elements/cssMixins';\nimport isE2E from 'utils/isE2E';\nimport styles from '../Scenes/Game/Singing/GameOverlay/Drawing/styles';\n\nexport const Button = styled.button<{ focused?: boolean }>`\n    padding: 0.1rem 0.3rem;\n    font-size: 2.6rem;\n    display: block;\n    text-align: center;\n    cursor: pointer;\n    border: 0;\n\n    background-color: rgba(0, 0, 0, 0.75);\n    text-transform: uppercase;\n    letter-spacing: 0.2rem;\n\n    ${typography};\n\n    pointer-events: auto;\n    ${(props) => props.focused && buttonFocused};\n    box-sizing: border-box;\n\n    transition: 300ms;\n\n    :not(:disabled) {\n        :hover {\n            ${focused};\n        }\n    }\n`;\n// Disable for E2E as they wait for animation to finish (and since it's infinite they timeout)\nconst buttonFocusedAnimation = isE2E()\n    ? css``\n    : css`\n          @keyframes button-focus-loop {\n              0%,\n              100% {\n                  transform: scale(1.045);\n              }\n              50% {\n                  transform: scale(1.055);\n              }\n          }\n          animation: button-focus-loop 600ms ease-in-out infinite both;\n      `;\n\nexport const buttonFocused = css`\n    transform: scale(1.05);\n    background: ${styles.colors.text.active};\n\n    ${buttonFocusedAnimation};\n`;\n","import styled from '@emotion/styled';\nimport { Button } from './Button';\n\ntype ButtonSizes = 'small' | 'normal';\n\nexport const MenuButton = styled(Button)<{ focused?: boolean; size?: ButtonSizes }>`\n    margin: 0.5rem 0;\n    height: ${(props) => (props.size === 'small' ? '5rem' : '10rem')};\n    border: 0 solid black;\n\n    :disabled {\n        cursor: default;\n        color: #989898;\n        background-color: #212121;\n        border-width: 0.3rem;\n    }\n`;\n\nexport const MenuContainer = styled.div`\n    background: rgba(0, 0, 0, 0.5);\n    padding: 1.5rem;\n    width: 100vw;\n    box-sizing: border-box;\n    max-width: 75rem;\n    margin: 2rem auto 0 auto;\n    font-size: 2.6rem;\n    display: flex;\n    flex-direction: column;\n    gap: 2rem;\n\n    view-transition-name: menu-container;\n`;\n","import styled from '@emotion/styled';\nimport { focusable, typography } from 'Elements/cssMixins';\nimport { PropsWithChildren, ReactNode } from 'react';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { ValuesType } from 'utility-types';\n\ninterface Props extends PropsWithChildren {\n    focused: boolean;\n    label: ReactNode;\n    value: ReactNode;\n    info?: ReactNode;\n    onClick?: () => void;\n}\n\nexport function nextIndex<T extends readonly any[]>(values: T, current: number, direction: 1 | -1 = 1): number {\n    return direction === 1 ? (current + 1) % values.length : (current + values.length - 1) % values.length;\n}\nexport function nextValueIndex<T extends readonly any[]>(\n    values: T,\n    current: ValuesType<T>,\n    direction: 1 | -1 = 1,\n): number {\n    return nextIndex(values, values.indexOf(current), direction);\n}\nexport function nextValue<T extends readonly any[]>(\n    values: T,\n    current: ValuesType<T>,\n    direction: 1 | -1 = 1,\n): ValuesType<T> {\n    return values[nextValueIndex(values, current, direction)];\n}\n\nexport const Switcher = ({ focused, label, value, onClick, info, children, ...restProps }: Props) => (\n    <Container>\n        <ConfigurationPosition focused={focused} onClick={onClick} {...restProps}>\n            <span>{label ? <>{label}:</> : ''}</span> <ConfigValue>{value}</ConfigValue>\n            {children ?? null}\n        </ConfigurationPosition>\n        {info && <InfoText>{info}</InfoText>}\n    </Container>\n);\n\nconst Container = styled.div``;\n\nexport const InfoText = styled.div`\n    ${typography};\n    font-size: 2rem;\n    padding: 1rem 0.5rem 0;\n    text-align: justify;\n`;\n\nconst ConfigurationPosition = styled.span<{ focused: boolean; expanded?: boolean }>`\n    background: rgba(0, 0, 0, 0.7);\n\n    width: auto;\n    ${typography};\n\n    text-align: right;\n    font-size: ${({ expanded }) => (expanded ? '6rem' : '2.7rem')};\n    cursor: pointer;\n    padding: 0.65rem;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n\n    ${focusable}\n`;\n\nconst ConfigValue = styled.span`\n    color: ${styles.colors.text.active};\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n    padding-left: 1rem;\n`;\n","import styled from '@emotion/styled';\nimport { InfoText } from 'Elements/Switcher';\nimport { focusable, typography } from 'Elements/cssMixins';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { REGULAR_ALPHA_CHARS } from 'hooks/useKeyboard';\nimport {\n    DetailedHTMLProps,\n    ForwardedRef,\n    InputHTMLAttributes,\n    ReactNode,\n    forwardRef,\n    useImperativeHandle,\n    useRef,\n} from 'react';\nimport { useHotkeys } from 'react-hotkeys-hook';\n\ninterface Props extends Omit<DetailedHTMLProps<InputHTMLAttributes<HTMLInputElement>, HTMLInputElement>, 'onChange'> {\n    focused: boolean;\n    label: ReactNode;\n    value: string;\n    onChange: (value: string) => void;\n    disabled?: boolean;\n    adornment?: ReactNode;\n    info?: ReactNode;\n}\n\nexport const Input = forwardRef(\n    (\n        { focused, label, value, onChange, disabled, className, adornment, info, ...restProps }: Props,\n        forwardedRef: ForwardedRef<HTMLInputElement>,\n    ) => {\n        const inputRef = useRef<HTMLInputElement>(null);\n        useImperativeHandle(forwardedRef, () => inputRef.current!);\n\n        useHotkeys(REGULAR_ALPHA_CHARS, () => inputRef.current?.focus(), { enabled: focused });\n\n        return (\n            <div>\n                <Container focused={focused} className={className}>\n                    <Label>{label}</Label>\n                    <StyledInput\n                        value={value}\n                        onChange={(e) => onChange(e.target.value)}\n                        {...restProps}\n                        disabled={disabled}\n                        ref={inputRef}\n                    />\n                    {adornment && <Adornment>{adornment}</Adornment>}\n                </Container>\n                {info && <InfoText>{info}</InfoText>}\n            </div>\n        );\n    },\n);\n\nconst Adornment = styled.span``;\n\nconst Container = styled.div<{ focused: boolean }>`\n    background: black;\n    caret: underscore;\n    ${focusable};\n    ${typography};\n    width: auto;\n    display: flex;\n    cursor: text;\n    padding: 0.25em;\n    align-items: center;\n`;\n\nconst Label = styled.span`\n    padding-right: 0.5em;\n    white-space: nowrap;\n    width: auto;\n\n    svg {\n        font-size: 1em;\n    }\n`;\n\nconst StyledInput = styled.input`\n    padding: 0;\n    border: 0;\n    background: transparent;\n    caret: underscore;\n    ${typography};\n    color: ${styles.colors.text.active};\n    width: 100%;\n    font-size: 1em;\n\n    &:focus {\n        outline: none;\n    }\n`;\n","import styled from '@emotion/styled';\nimport { QrCode2, Warning, Wifi } from '@mui/icons-material';\nimport { CircularProgress } from '@mui/material';\nimport { Input } from 'Elements/Input';\nimport { MenuButton } from 'Elements/Menu';\nimport { transportErrorReason } from 'RemoteMic/Network/TheClient';\nimport WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport { ConnectionStatuses } from 'Scenes/RemoteMic/RemoteMic';\nimport { MAX_NAME_LENGTH } from 'consts';\nimport { FormEventHandler, useEffect, useRef, useState } from 'react';\nimport createPersistedState from 'use-persisted-state';\n\ninterface Props {\n    roomId: string;\n    isVisible: boolean;\n    connectionStatus: ConnectionStatuses;\n    onConnect: (silent: boolean) => void;\n    connectionError?: transportErrorReason;\n}\n\nconst usePersistedName = createPersistedState<string>('remote_mic_name');\n\nfunction Connect({ isVisible, roomId, connectionStatus, onConnect, connectionError }: Props) {\n    const [name, setName] = usePersistedName('');\n    const inputRef = useRef<HTMLInputElement | null>(null);\n\n    const disabled = connectionStatus !== 'uninitialised' && connectionStatus !== 'error';\n\n    const connectToServer = (silent = false) => {\n        WebRTCClient.connect(roomId, name, silent);\n        onConnect(silent);\n    };\n\n    const handleConnect: FormEventHandler<HTMLFormElement> = (e) => {\n        e.preventDefault();\n\n        if (name === '') {\n            inputRef.current?.focus();\n        } else {\n            connectToServer();\n        }\n    };\n\n    useEffect(() => {\n        inputRef.current?.focus();\n\n        if (window.sessionStorage.getItem('reload-mic-request') !== null) {\n            // give other components option to read the property on mount before its removed\n            window.setTimeout(() => window.sessionStorage.removeItem('reload-mic-request'), 1);\n            connectToServer(true);\n        }\n    }, []);\n\n    const [showConnectionTip, setShowConnectionTip] = useState(false);\n\n    useEffect(() => {\n        setShowConnectionTip(false);\n        if (connectionStatus === 'connecting' || connectionStatus === 'reconnecting') {\n            const timeout = setTimeout(() => setShowConnectionTip(true), 2000);\n\n            return () => clearTimeout(timeout);\n        }\n    }, [connectionStatus]);\n\n    return isVisible ? (\n        <>\n            <Form onSubmit={handleConnect}>\n                <Input\n                    maxLength={MAX_NAME_LENGTH}\n                    focused={false}\n                    label=\"Name\"\n                    placeholder=\"Enter your name\"\n                    value={name}\n                    onChange={setName}\n                    ref={inputRef}\n                    disabled={disabled}\n                    autoFocus\n                    data-test=\"player-name-input\"\n                />\n                <ConnectButton type=\"submit\" disabled={disabled} data-test=\"connect-button\">\n                    {connectionStatus === 'connecting' && <CircularProgress size={'1em'} />}\n                    {connectionStatus === 'uninitialised' ? 'Connect' : connectionStatus.toUpperCase()}\n                </ConnectButton>\n                {(showConnectionTip || connectionError) && (\n                    <>\n                        {showConnectionTip && <h3>If it doesn't connect</h3>}\n                        {connectionError && (\n                            <>\n                                <h3>\n                                    <strong>\n                                        <Warning />\n                                    </strong>{' '}\n                                    Could not connect:\n                                </h3>\n                                <h6>\n                                    Error code: <strong>{connectionError}</strong>\n                                </h6>\n                                <br />\n                            </>\n                        )}\n                        {connectionError === 'peer-unavailable' ? (\n                            <>\n                                <h4>The game seems to be offline </h4>\n                                <h5>\n                                    1. Refresh (<strong>F5</strong>) the Karaoke Game on the PC\n                                </h5>\n                                <h5>\n                                    2. Scan the{' '}\n                                    <strong>\n                                        <QrCode2 /> QR Code\n                                    </strong>{' '}\n                                    again\n                                </h5>\n                                <h5>\n                                    3. Make sure you are in the same{' '}\n                                    <strong>\n                                        <Wifi /> Wi-Fi\n                                    </strong>\n                                </h5>\n                            </>\n                        ) : connectionError === 'network' ? (\n                            <>\n                                <h4>No internet access </h4>\n                                <h5>\n                                    Make sure you are in the same{' '}\n                                    <strong>\n                                        <Wifi /> Wi-Fi\n                                    </strong>\n                                    and that it has internet connection\n                                </h5>\n                            </>\n                        ) : (\n                            <>\n                                <h5>\n                                    1. Make sure you are in the same{' '}\n                                    <strong>\n                                        <Wifi /> Wi-Fi\n                                    </strong>\n                                </h5>\n                                <h5>\n                                    2. Refresh (<strong>F5</strong>) the Karaoke Game on the PC\n                                </h5>\n                                <h5>\n                                    3. Scan the{' '}\n                                    <strong>\n                                        <QrCode2 /> QR Code\n                                    </strong>{' '}\n                                    again\n                                </h5>\n                            </>\n                        )}\n                    </>\n                )}\n            </Form>\n        </>\n    ) : null;\n}\nexport default Connect;\n\nconst Form = styled.form`\n    display: flex;\n    flex-direction: column;\n`;\n\nconst ConnectButton = styled(MenuButton)`\n    margin-bottom: 0;\n    height: 72px;\n`;\n","import { useEffect, useState } from 'react';\n\n// Hook\nexport default function useDebounce<T>(value: T, delay: number) {\n    // State and setters for debounced value\n    const [debouncedValue, setDebouncedValue] = useState(value);\n    useEffect(\n        () => {\n            // Update debounced value after delay\n            const handler = setTimeout(() => {\n                setDebouncedValue(value);\n            }, delay);\n            // Cancel the timeout if value changes (also on delay change or unmount)\n            // This is how we prevent debounced value from updating if value is changed ...\n            // .. within the delay period. Timeout gets cleared and restarted.\n            return () => {\n                clearTimeout(handler);\n            };\n        },\n        [value, delay], // Only re-call effect if value or delay changes\n    );\n    return debouncedValue;\n}\n","import { Search } from '@mui/icons-material';\nimport { Input } from 'Elements/Input';\nimport WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport { MAX_NAME_LENGTH } from 'consts';\nimport useDebounce from 'hooks/useDebounce';\nimport { ReactNode, useEffect, useRef, useState } from 'react';\nimport { useUnmount } from 'react-use';\n\ninterface Props {\n    children: (props: { onClick: () => void }) => ReactNode;\n    onSearchStateChange?: (isActive: boolean) => void;\n}\n\nfunction RemoteSongSearch({ children, onSearchStateChange }: Props) {\n    const [search, setSearch] = useState('');\n    const inputRef = useRef<HTMLInputElement | null>(null);\n\n    const [isOpen, setIsOpen] = useState(false);\n\n    const onOpen = () => {\n        setIsOpen(true);\n        onSearchStateChange?.(true);\n    };\n\n    const onClose = () => {\n        setIsOpen(false);\n        onSearchStateChange?.(false);\n    };\n\n    const debouncedSearch = useDebounce(search, 100);\n\n    useEffect(() => {\n        WebRTCClient.searchSong(debouncedSearch.trim());\n    }, [debouncedSearch]);\n\n    useUnmount(() => onSearchStateChange?.(false));\n\n    return (\n        <>\n            {children({ onClick: isOpen ? onClose : onOpen })}\n            {isOpen && (\n                <form\n                    onSubmit={(e) => {\n                        e.preventDefault();\n                        onClose();\n                    }}>\n                    <Input\n                        maxLength={MAX_NAME_LENGTH}\n                        focused={false}\n                        label={<Search />}\n                        placeholder=\"Search for a song\"\n                        value={search}\n                        onChange={setSearch}\n                        ref={inputRef}\n                        autoFocus\n                        data-test=\"search-song-input\"\n                    />\n                </form>\n            )}\n        </>\n    );\n}\nexport default RemoteSongSearch;\n","import { css } from '@emotion/react';\nimport styled from '@emotion/styled';\nimport {\n    ArrowBack,\n    ArrowForward,\n    Games,\n    KeyboardArrowDown,\n    KeyboardArrowLeft,\n    KeyboardArrowRight,\n    KeyboardArrowUp,\n    Search,\n    Shuffle,\n} from '@mui/icons-material';\nimport events from 'GameEvents/GameEvents';\nimport { useEventListener } from 'GameEvents/hooks';\nimport WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport { keyStrokes } from 'RemoteMic/Network/events';\nimport RemoteSongSearch from 'Scenes/RemoteMic/Panels/Microphone/RemoteSongSearch';\n\ninterface Props {\n    onSearchStateChange?: (isActive: boolean) => void;\n}\n\nexport default function RemoteMicKeyboard({ onSearchStateChange }: Props) {\n    const [keyboard] = useEventListener(events.remoteKeyboardLayout, true) ?? [];\n\n    const isHorizontal = keyboard?.horizontal !== undefined || keyboard?.['horizontal-vertical'] !== undefined;\n    const isVertical = keyboard?.vertical !== undefined || keyboard?.['horizontal-vertical'] !== undefined;\n\n    const onPress = (key: keyStrokes) => () => {\n        // navigator?.vibrate?.(200);\n        WebRTCClient.sendKeyStroke(key);\n    };\n\n    return keyboard !== undefined ? (\n        <Container data-test=\"remote-keyboard\">\n            {(isHorizontal || isVertical) && (\n                <ActionsContainer>\n                    <ArrowsContainer>\n                        <ArrowButton onClick={onPress('up')} disabled={!isVertical} data-test=\"arrow-up\">\n                            <KeyboardArrowUp />\n                        </ArrowButton>\n                    </ArrowsContainer>\n                    <ArrowsContainer>\n                        <ArrowButton onClick={onPress('left')} disabled={!isHorizontal} data-test=\"arrow-left\">\n                            <KeyboardArrowLeft />\n                        </ArrowButton>\n                        <ArrowButton disabled>\n                            <Games />\n                        </ArrowButton>\n                        <ArrowButton onClick={onPress('right')} disabled={!isHorizontal} data-test=\"arrow-right\">\n                            <KeyboardArrowRight />\n                        </ArrowButton>\n                    </ArrowsContainer>\n                    <ArrowsContainer>\n                        <ArrowButton onClick={onPress('down')} disabled={!isVertical} data-test=\"arrow-down\">\n                            <KeyboardArrowDown />\n                        </ArrowButton>\n                    </ArrowsContainer>\n                </ActionsContainer>\n            )}\n            <ActionsContainer>\n                <ActionButton\n                    onClick={onPress('back')}\n                    disabled={keyboard?.back === undefined}\n                    data-test=\"keyboard-backspace\">\n                    {keyboard?.back || (\n                        <>\n                            <ArrowBack /> Back\n                        </>\n                    )}\n                </ActionButton>\n                <ActionButton\n                    onClick={onPress('accept')}\n                    disabled={keyboard?.accept === undefined}\n                    data-test=\"keyboard-enter\">\n                    {keyboard?.accept || (\n                        <>\n                            Enter <ArrowForward />\n                        </>\n                    )}\n                </ActionButton>\n            </ActionsContainer>\n            <Break />\n            <ActionsContainer disabled={keyboard?.shiftR === undefined} data-test=\"keyboard-shift-r\">\n                <ActionButton onClick={onPress('random')}>\n                    <Shuffle /> {keyboard?.shiftR || 'Random Song'}\n                </ActionButton>\n            </ActionsContainer>\n            {keyboard?.remote?.includes('search') && (\n                <RemoteSongSearch onSearchStateChange={onSearchStateChange}>\n                    {(props) => (\n                        <ActionsContainer data-test=\"keyboard-search\" style={{ flex: 0 }}>\n                            <ActionButton {...props}>\n                                <Search /> Search\n                            </ActionButton>\n                        </ActionsContainer>\n                    )}\n                </RemoteSongSearch>\n            )}\n        </Container>\n    ) : null;\n}\n\nconst Container = styled.div`\n    gap: 1rem;\n    display: flex;\n    flex-wrap: wrap;\n    margin-bottom: 2rem;\n`;\nconst ArrowsContainer = styled.div`\n    display: flex;\n    justify-content: center;\n    flex: 1;\n    color: white;\n    font-size: 2rem;\n`;\n\nconst ActionsContainer = styled.div<{ disabled?: boolean }>`\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    justify-content: space-between;\n    opacity: ${(props) => (props.disabled ? 0 : 1)};\n`;\n\nconst Break = styled.div`\n    flex-basis: 100%;\n    height: 0;\n`;\n\nconst ButtonBase = styled.button<{ disabled?: boolean }>`\n    background: none;\n    border: none;\n    box-sizing: border-box;\n    margin: 0.25rem;\n    width: 4.5rem;\n    height: 4.5rem;\n\n    svg {\n        width: 2.5rem;\n        height: 2.5rem;\n    }\n\n    opacity: ${(props) => (props.disabled ? 0.25 : 1)};\n`;\n\nconst ArrowButton = styled(ButtonBase)<{ disabled?: boolean }>`\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 0.3rem;\n    border: 0.3rem solid rgb(204, 204, 204);\n    border-bottom-color: rgb(130, 130, 130);\n    border-right-color: rgb(130, 130, 130);\n    gap: 0.5rem;\n\n    ${(props) =>\n        !props.disabled\n            ? css`\n                  cursor: pointer;\n                  &:active {\n                      border: 0.3rem solid rgb(130, 130, 130);\n                      border-bottom-color: rgb(204, 204, 204);\n                      border-right-color: rgb(204, 204, 204);\n                  }\n              `\n            : ''}\n\n    color: rgb(51, 51, 51);\n    font-weight: normal;\n    font-size: 2.5rem;\n    box-shadow: 0 0.1rem 0 rgba(0, 0, 0, 0.2), inset 0 0 0 0.2rem #ffffff;\n    background-color: rgb(247, 247, 247);\n    text-shadow: 0 0.1rem 0 #fff;\n`;\n\nconst ActionButton = styled(ArrowButton)<{ disabled?: boolean }>`\n    width: 100%;\n    //height: 100%;\n    //white-space: nowrap;\n    //overflow: hidden;\n    //text-overflow: ellipsis;\n`;\n","import styled from '@emotion/styled';\nimport { PropsWithChildren } from 'react';\n\ninterface Props extends PropsWithChildren {\n    onClose?: () => void;\n}\n\nexport default function Modal({ children, onClose }: Props) {\n    return (\n        <>\n            <Backdrop onClick={onClose} />\n            <Container onClick={onClose}>\n                <div onClick={(e) => e.stopPropagation()}>{children}</div>\n            </Container>\n        </>\n    );\n}\n\nconst Container = styled.div`\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 1000;\n    overflow: auto;\n`;\n\nconst Backdrop = styled.div`\n    position: fixed;\n    top: 0;\n    left: 0;\n    background: rgba(0, 0, 0, 0.7);\n    width: 100vw;\n    height: 100vh;\n    z-index: 2;\n    backdrop-filter: blur(20px);\n`;\n","import styled from '@emotion/styled';\nimport { MenuButton, MenuContainer } from 'Elements/Menu';\nimport Modal from 'Elements/Modal';\nimport WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport React from 'react';\n\ninterface Props {\n    id: string;\n    playerNumber: number | null;\n    onModalClose: () => void;\n    header?: React.ReactNode;\n}\n\nexport default function PlayerChangeModal({ playerNumber, id, onModalClose, header }: Props) {\n    const selectPlayer = (player: number | null) => {\n        WebRTCClient.requestPlayerChange(id, player);\n        onModalClose();\n    };\n\n    const joined = playerNumber !== null;\n\n    return (\n        <Modal onClose={onModalClose}>\n            <Menu>\n                {header && <h2>{header}</h2>}\n                <MenuButton\n                    size=\"small\"\n                    data-test=\"change-to-player-0\"\n                    onClick={() => selectPlayer(0)}\n                    disabled={0 === playerNumber}\n                    style={{ color: styles.colors.players[0].perfect.fill }}>\n                    Blue\n                </MenuButton>\n                <MenuButton\n                    size=\"small\"\n                    data-test=\"change-to-player-1\"\n                    onClick={() => selectPlayer(1)}\n                    disabled={1 === playerNumber}\n                    style={{ color: styles.colors.players[1].perfect.fill }}>\n                    Red\n                </MenuButton>\n                <MenuButton\n                    size=\"small\"\n                    onClick={() => selectPlayer(null)}\n                    disabled={!joined}\n                    data-test=\"change-to-unset\">\n                    Unassign\n                </MenuButton>\n                <hr />\n                <MenuButton onClick={onModalClose} size=\"small\">\n                    Close\n                </MenuButton>\n            </Menu>\n        </Modal>\n    );\n}\n\nconst Menu = styled(MenuContainer)`\n    gap: 0;\n`;\n","import styled from '@emotion/styled';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\n\ninterface Props {\n    number: number | null;\n}\n\nexport default function PlayerNumberCircle({ number, ...restProps }: Props) {\n    return (\n        <PlayerColorCircle\n            style={{\n                background: number !== null ? styles.colors.players[number].perfect.fill : styles.colors.text.inactive,\n            }}\n            {...restProps}\n        />\n    );\n}\n\nconst PlayerColorCircle = styled.div`\n    display: inline-block;\n    width: 1em;\n    height: 1em;\n    aspect-ratio: 1;\n    border-radius: 1em;\n`;\n","import { css } from '@emotion/react';\nimport styled from '@emotion/styled';\nimport SwapHorizIcon from '@mui/icons-material/SwapHoriz';\nimport { buttonFocused } from 'Elements/Button';\nimport { focused, typography } from 'Elements/cssMixins';\nimport WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport PlayerChangeModal from 'Scenes/RemoteMic/Components/PlayerChangeModal';\nimport PlayerNumberCircle from 'Scenes/RemoteMic/Components/PlayerNumberCircle';\nimport { memo, useState } from 'react';\n\ninterface Props {\n    playerNumber: number | null;\n}\n\nexport default memo(function PlayerChange({ playerNumber }: Props) {\n    const [isOpen, setIsOpen] = useState(false);\n\n    const closeModal = () => setIsOpen(false);\n\n    const joined = playerNumber !== null;\n\n    return (\n        <>\n            <PlayerChangeContainer onClick={() => setIsOpen(true)} data-test=\"change-player\" joined={joined}>\n                {!joined ? (\n                    'Join game'\n                ) : (\n                    <>\n                        <PlayerNumberCircle number={playerNumber} /> Change\n                    </>\n                )}{' '}\n                <SwapHorizIcon />\n            </PlayerChangeContainer>\n            {isOpen && (\n                <PlayerChangeModal\n                    id={WebRTCClient.getClientId()!}\n                    playerNumber={playerNumber}\n                    onModalClose={closeModal}\n                />\n            )}\n        </>\n    );\n});\n\nconst PlayerChangeContainer = styled.button<{ joined: boolean }>`\n    position: absolute;\n    z-index: 1;\n    color: white;\n    right: 1rem;\n    bottom: 1rem;\n    padding: 1rem;\n    font-size: 2rem;\n    text-transform: uppercase;\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    border: none;\n    ${typography};\n    background: rgba(0, 0, 0, 0.75);\n\n    ${(props) =>\n        !props.joined &&\n        css`\n            font-size: 3rem;\n            padding: 3rem;\n            ${focused}\n        `}\n\n    :hover {\n        ${focused};\n    }\n\n    :active {\n        ${buttonFocused};\n    }\n\n    svg {\n        width: 2rem;\n        height: 2rem;\n    }\n`;\n","import events from 'GameEvents/GameEvents';\nimport { useEventListener } from 'GameEvents/hooks';\n\nexport default function usePermissions() {\n    const [permissions] = useEventListener(events.remoteMicPermissionsSet, true) ?? ['write'];\n\n    return permissions;\n}\n","import styled from '@emotion/styled';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport PlayerChange from 'Scenes/RemoteMic/Panels/Microphone/PlayerChange';\nimport usePermissions from 'Scenes/RemoteMic/hooks/usePermissions';\nimport { useEffect, useState } from 'react';\n\ninterface Props {\n    volume: number;\n    playerNumber: number | null;\n    frequency: number | null;\n    isMicOn: boolean;\n    isConnected: boolean;\n}\n\nexport default function VolumeIndicator({ playerNumber, volume, frequency, isMicOn, isConnected }: Props) {\n    const [maxVolume, setMaxVolume] = useState(0.000001);\n    const permissions = usePermissions();\n\n    useEffect(() => {\n        setMaxVolume((current) => (volume > current ? volume : current * 0.99));\n    }, [volume]);\n\n    const backgroundColor =\n        playerNumber !== null ? styles.colors.players[playerNumber].miss.stroke : styles.colors.lines.normal.fill;\n    const indicatorColor =\n        playerNumber !== null ? styles.colors.players[playerNumber].perfect.fill : styles.colors.lines.normal.fill;\n\n    return (\n        <IndicatorContainer\n            isMicOn={isMicOn}\n            color={backgroundColor}\n            data-player-number={`${playerNumber ?? 'none'}`}\n            data-test=\"indicator\">\n            {isMicOn && (\n                <>\n                    <Debug>\n                        {frequency ? `${Math.round(frequency)}Hz` : ' '}\n                        <br />\n                        {String(volume * 100).slice(0, 5)}\n                    </Debug>\n                </>\n            )}\n            {isConnected && permissions === 'write' && <PlayerChange playerNumber={playerNumber} />}\n            <Indicator\n                color={indicatorColor}\n                style={{ transform: `scaleY(${isMicOn ? 1 - Math.min(1, volume / maxVolume) : 1})` }}\n            />\n        </IndicatorContainer>\n    );\n}\n\nconst Debug = styled.span`\n    position: absolute;\n    color: white;\n    opacity: 0.125;\n`;\n\nconst Indicator = styled.div<{ color: string }>`\n    width: 100%;\n    height: 100%;\n    background-color: ${(props) => props.color};\n    transition: 200ms;\n    transform-origin: top;\n`;\n\nconst IndicatorContainer = styled.div<{ color: string; isMicOn: boolean }>`\n    position: relative;\n    border: 0.1rem solid white;\n    flex: 1;\n    min-height: 200px;\n    max-height: 100vw;\n    transition: 300ms;\n\n    background: ${(props) => props.color};\n`;\n","import events from 'GameEvents/GameEvents';\nimport { useEventListener } from 'GameEvents/hooks';\nimport SimplifiedMic from 'Scenes/Game/Singing/Input/SimplifiedMic';\nimport VolumeIndicator from 'Scenes/RemoteMic/Panels/Microphone/VolumeIndicator';\nimport { throttle } from 'lodash-es';\nimport { useCallback, useEffect, useState } from 'react';\n\ninterface Props {\n    isVisible: boolean;\n    isMicOn: boolean;\n    isConnected: boolean;\n}\n\nfunction MicPreview({ isVisible, isMicOn, isConnected }: Props) {\n    const [volume, setVolume] = useState(0);\n    const [frequency, setFrequency] = useState(0);\n    const [playerNumber] = useEventListener(events.remoteMicPlayerSet, true) ?? [null];\n\n    const updateVolumes = useCallback(\n        throttle((freq: number, volume: number) => {\n            setFrequency(freq);\n            setVolume(volume);\n        }, 150),\n        [setVolume, setFrequency],\n    );\n\n    useEffect(() => {\n        SimplifiedMic.startMonitoring(undefined);\n        return SimplifiedMic.addListener(updateVolumes);\n    }, [updateVolumes]);\n\n    return isVisible ? (\n        <>\n            <VolumeIndicator\n                volume={volume}\n                frequency={frequency}\n                playerNumber={playerNumber}\n                isMicOn={isMicOn}\n                isConnected={isConnected}\n            />\n        </>\n    ) : null;\n}\nexport default MicPreview;\n","import WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport { getPingTime } from 'RemoteMic/Network/utils';\nimport { useEffect, useState } from 'react';\n\ninterface Props {}\n\nfunction Ping({}: Props) {\n    const [latency, setLatency] = useState(0);\n\n    useEffect(() => {\n        const interval = setInterval(() => {\n            const now = getPingTime();\n            if (WebRTCClient.pinging && now - WebRTCClient.pingStart > latency) {\n                setLatency(now - WebRTCClient.pingStart);\n            } else {\n                setLatency(WebRTCClient.latency);\n            }\n        }, 333);\n\n        return () => {\n            clearInterval(interval);\n        };\n    }, []);\n    return <>{latency}ms</>;\n}\nexport default Ping;\n","import userMediaService from 'UserMedia/userMediaService';\nimport { useEffect, useState } from 'react';\n\nexport const useMicrophoneStatus = () => {\n    const [status, setStatus] = useState(userMediaService.getStatus());\n\n    useEffect(() => userMediaService.addListener(setStatus), []);\n\n    return status;\n};\n","export default function isOpera() {\n    return navigator?.userAgent.includes('OPR');\n}\n","export default \"__VITE_ASSET__862d35ec__\"","export default \"__VITE_ASSET__abf3bdc2__\"","export default \"__VITE_ASSET__d22be881__\"","import styled from '@emotion/styled';\nimport { Warning } from '@mui/icons-material';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { useMicrophoneStatus } from 'UserMedia/hooks';\nimport { PropsWithChildren, ReactNode } from 'react';\nimport isOpera from 'utils/isOpera';\nimport allowMic from './allow-mic.png';\nimport enableMicOpera from './enable-mic-opera.png';\nimport enableMic from './enable-mic.png';\n\nconst getProperEnableMicImage = () => (isOpera() ? enableMicOpera : enableMic);\n\ninterface Props extends PropsWithChildren {\n    fallback: ReactNode;\n    showImages?: boolean;\n}\nconst UserMediaEnabled = ({ children, fallback, showImages = true }: Props) => {\n    const status = useMicrophoneStatus();\n    return (\n        <>\n            {status === 'accepted' && children}\n            {status !== 'accepted' && (\n                <>\n                    <WarningContainer>\n                        <WarningIcon />\n                    </WarningContainer>\n                    {fallback}\n                    <AdditionalInfo>\n                        {status === 'requested' && showImages && <img src={allowMic} alt=\"how-to-allow\" />}\n                        {status === 'declined' && (\n                            <>\n                                <h3>Access is blocked, you can unblock it here</h3>\n                                {showImages && <img src={getProperEnableMicImage()} alt=\"how-to-enable\" />}\n                            </>\n                        )}\n                        {isOpera() && (\n                            <h4>\n                                <strong>Opera</strong> is buggy regarding microphone access - if you encounter issue\n                                (e.g. this message stays even after the access to microphone was granted), consider\n                                other browsers.\n                            </h4>\n                        )}\n                    </AdditionalInfo>\n                </>\n            )}\n        </>\n    );\n};\n\nconst AdditionalInfo = styled.div`\n    text-align: center;\n\n    img {\n        margin: 1.5rem 0 0.5rem;\n        box-shadow: 0.5rem 0.5rem 0.5rem rgba(0, 0, 0, 0.5), inset 0 0 0.5rem 0.5rem rgba(255, 255, 255, 0.5);\n        border: 0.5rem solid white;\n        border-radius: 1rem;\n        box-sizing: border-box;\n        max-width: 100%;\n    }\n`;\n\nconst WarningContainer = styled.div`\n    width: 100%;\n    display: flex;\n    justify-content: center;\n`;\nconst WarningIcon = styled(Warning)`\n    color: ${styles.colors.text.active};\n    font-size: 3rem;\n`;\nexport default UserMediaEnabled;\n","import styled from '@emotion/styled';\nimport { MenuButton } from 'Elements/Menu';\nimport { typography } from 'Elements/cssMixins';\nimport { transportErrorReason } from 'RemoteMic/Network/TheClient';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport SimplifiedMic from 'Scenes/Game/Singing/Input/SimplifiedMic';\nimport Connect from 'Scenes/RemoteMic/Panels/Microphone/Connect';\nimport RemoteMicKeyboard from 'Scenes/RemoteMic/Panels/Microphone/Keyboard';\nimport MicPreview from 'Scenes/RemoteMic/Panels/Microphone/MicPreview';\nimport Ping from 'Scenes/RemoteMic/Panels/Microphone/Ping';\nimport { ConnectionStatuses } from 'Scenes/RemoteMic/RemoteMic';\nimport usePermissions from 'Scenes/RemoteMic/hooks/usePermissions';\nimport UserMediaEnabled from 'UserMedia/UserMediaEnabled';\nimport { useState } from 'react';\nimport isDev from 'utils/isDev';\n\ninterface Props {\n    roomId: string;\n    connectionStatus: ConnectionStatuses;\n    connectionError?: transportErrorReason;\n    isKeepAwakeOn: boolean;\n    setIsKeepAwakeOn: (keepAwake: boolean) => void;\n    monitoringStarted: boolean;\n    setMonitoringStarted: (micMonitoring: boolean) => void;\n}\n\nfunction Microphone({\n    roomId,\n    monitoringStarted,\n    setMonitoringStarted,\n    isKeepAwakeOn,\n    setIsKeepAwakeOn,\n    connectionError,\n    connectionStatus,\n}: Props) {\n    const permissions = usePermissions();\n    const [searchActive, setSearchActive] = useState(false);\n\n    const onConnect = async () => {\n        setIsKeepAwakeOn(true);\n\n        try {\n            if (!isDev()) {\n                await document.body.requestFullscreen();\n                window.screen.orientation.unlock();\n                await window.screen.orientation.lock('portrait');\n            }\n        } catch (e) {\n            console.warn(e);\n        }\n    };\n\n    const isConnected = connectionStatus === 'connected';\n\n    const micPreview = <MicPreview isVisible isMicOn={monitoringStarted} isConnected={isConnected} />;\n\n    return (\n        <Container>\n            <UserMediaEnabled\n                showImages={false}\n                fallback={\n                    <>\n                        {micPreview}\n                        <h2>Please allow access to the microphone.</h2>\n                    </>\n                }>\n                <Panel collapse={searchActive}>\n                    <MicPreview isVisible isMicOn={monitoringStarted} isConnected={isConnected} />\n                    <Connect\n                        roomId={roomId}\n                        isVisible={true}\n                        connectionStatus={connectionStatus}\n                        onConnect={onConnect}\n                        connectionError={connectionError}\n                    />\n                </Panel>\n                <Panel>\n                    {permissions === 'write' && <RemoteMicKeyboard onSearchStateChange={setSearchActive} />}\n                    {permissions === 'read' && (\n                        <NoPermissionsMsg data-test=\"no-permissions-message\">\n                            No permission to control the game. Go to in-game <strong>Settings</strong> menu {' '}\n                            <strong>Remote Microphones Settings</strong> to manage them.\n                        </NoPermissionsMsg>\n                    )}\n                    <KeepAwake onClick={() => setIsKeepAwakeOn(!isKeepAwakeOn)}>\n                        WakeLock: <strong>{isKeepAwakeOn ? 'ON' : 'OFF'}</strong>\n                    </KeepAwake>\n                    <MicInputState\n                        onClick={() =>\n                            monitoringStarted\n                                ? SimplifiedMic.stopMonitoring()\n                                : SimplifiedMic.startMonitoring(undefined)\n                        }>\n                        Microphone: <strong data-test=\"monitoring-state\">{monitoringStarted ? 'ON' : 'OFF'}</strong>\n                    </MicInputState>\n                    {isConnected && (\n                        <KeepAwake>\n                            Ping: <Ping />\n                        </KeepAwake>\n                    )}\n                </Panel>\n            </UserMediaEnabled>\n        </Container>\n    );\n}\nexport default Microphone;\n\nconst Container = styled.div`\n    font-size: 2.6rem;\n    display: flex;\n    flex-direction: column;\n    gap: 2rem;\n    padding: 1.5rem;\n    box-sizing: border-box;\n\n    @media (max-height: 500px) and (min-aspect-ratio: 16/10) {\n        flex-direction: row;\n    }\n\n    ${MenuButton} {\n        padding: 0.5em;\n        height: 72px;\n\n        margin-bottom: 1em;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 0.5em;\n    }\n\n    h5 {\n        margin-top: 0.5em;\n\n        svg {\n            font-size: 0.9em;\n        }\n    }\n`;\n\nconst Panel = styled.div<{ collapse?: boolean }>`\n    flex: 1;\n    transition: 300ms ease-in-out;\n\n    margin-top: ${(props) => (props.collapse ? '-100%' : '0')};\n\n    @media (max-height: 500px) and (min-aspect-ratio: 16/10) {\n        margin-top: 0;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n    }\n`;\n\nconst MicInputState = styled.div`\n    ${typography}\n    strong {\n        color: ${styles.colors.text.active};\n    }\n    align-self: flex-end;\n`;\nconst KeepAwake = styled(MicInputState)``;\n\nconst NoPermissionsMsg = styled.h5`\n    padding-bottom: 5rem;\n`;\n","import styled from '@emotion/styled';\nimport { MenuButton, MenuContainer } from 'Elements/Menu';\nimport { focused } from 'Elements/cssMixins';\nimport events from 'GameEvents/GameEvents';\nimport { useEventEffect } from 'GameEvents/hooks';\nimport WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport { useEffect, useState } from 'react';\n\ninterface Props {\n    onConfirm: () => void;\n}\n\nfunction ConfirmReadiness({ onConfirm }: Props) {\n    const [visible, setVisible] = useState(false);\n    const [isAfterReload, setIsAfterReload] = useState(false);\n\n    // Try to predict the readiness request from the game. If the refresh request happened and after reconnection\n    // The player number is set for the phone, it's likely that a readiness confirmation is needed so the button\n    // is displayed even before the event comes around\n    useEffect(() => {\n        if (window.sessionStorage.getItem('reload-mic-request') !== null) {\n            setIsAfterReload(true);\n        }\n    }, []);\n    useEventEffect(events.remoteMicPlayerSet, () => {\n        if (isAfterReload) {\n            setIsAfterReload(false);\n            setVisible(true);\n        }\n    });\n\n    useEventEffect(events.remoteReadinessRequested, () => {\n        setVisible(true);\n    });\n    const confirm = () => {\n        WebRTCClient.confirmReadiness();\n        setVisible(false);\n        onConfirm();\n    };\n\n    return visible ? (\n        <Form>\n            <MenuContainer>\n                <ReadyButton data-test=\"ready-button\" onClick={confirm}>\n                    Ready\n                </ReadyButton>\n            </MenuContainer>\n        </Form>\n    ) : null;\n}\nexport default ConfirmReadiness;\n\nconst Form = styled.div`\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    backdrop-filter: blur(10px);\n    z-index: 1000;\n`;\n\nconst ReadyButton = styled(MenuButton)`\n    aspect-ratio: 1;\n\n    ${focused};\n`;\n","import styled from '@emotion/styled';\nimport { MenuButton } from 'Elements/Menu';\nimport events from 'GameEvents/GameEvents';\nimport { useEventListener } from 'GameEvents/hooks';\nimport { useEffect, useState } from 'react';\nimport { WebRTCRemoteMicListEvent } from 'RemoteMic/Network/events';\nimport WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport PlayerChangeModal from 'Scenes/RemoteMic/Components/PlayerChangeModal';\nimport PlayerNumberCircle from 'Scenes/RemoteMic/Components/PlayerNumberCircle';\nimport { ValuesType } from 'utility-types';\n\ninterface Props {}\n\nfunction ManagePlayers(props: Props) {\n    useEffect(() => {\n        WebRTCClient.subscribe('remote-mics');\n\n        return () => {\n            WebRTCClient.unsubscribe('remote-mics');\n        };\n    }, []);\n\n    const [list] = useEventListener(events.remoteMicListUpdated) ?? [[]];\n\n    return (\n        <>\n            <h3>Manage Players</h3>\n            {list.map((mic) => (\n                <Entry mic={mic} key={mic.id} />\n            ))}\n            {list.length === 0 && <h4>No remote microphones connected</h4>}\n        </>\n    );\n}\n\nconst Entry = ({ mic }: { mic: ValuesType<WebRTCRemoteMicListEvent['list']> }) => {\n    const [open, setOpen] = useState(false);\n    const permission = RemoteMicManager.getPermission(mic.id);\n    return (\n        <Container data-test=\"manage-players\">\n            {open && (\n                <PlayerChangeModal\n                    id={mic.id}\n                    playerNumber={mic.number}\n                    onModalClose={() => setOpen(false)}\n                    header={\n                        <>\n                            Change <strong className=\"ph-no-capture\">{mic.name}</strong>:\n                        </>\n                    }\n                />\n            )}\n            <RemoteMicEntry\n                onClick={() => setOpen(true)}\n                data-test=\"remote-mic-entry\"\n                data-id={mic.id}\n                value={permission}\n                size=\"small\">\n                <PlayerNumberCircle number={mic.number} />\n                <RemoteMicId>{mic.id.slice(-4)}</RemoteMicId>\n                <RemoteMicName className=\"ph-no-capture\" isSelf={mic.id === WebRTCClient.getClientId()}>\n                    {mic.name}\n                </RemoteMicName>\n            </RemoteMicEntry>\n        </Container>\n    );\n};\n\nconst Container = styled.div`\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n`;\n\nconst RemoteMicEntry = styled(MenuButton)`\n    display: flex;\n    align-items: center;\n    padding: 0 2rem;\n`;\n\nconst RemoteMicName = styled.div<{ isSelf: boolean }>`\n    ${(props) => props.isSelf && `color: ${styles.colors.text.active};`}\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n`;\nconst RemoteMicId = styled.span`\n    font-size: 1.5rem;\n    padding: 0 1rem;\n`;\nexport default ManagePlayers;\n","import styled from '@emotion/styled';\nimport { MenuButton } from 'Elements/Menu';\nimport { MIC_ID_KEY, transportErrorReason } from 'RemoteMic/Network/TheClient';\nimport WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport ManagePlayers from 'Scenes/RemoteMic/Panels/RemoteSettings/ManagePlayers';\nimport { ConnectionStatuses } from 'Scenes/RemoteMic/RemoteMic';\nimport usePermissions from 'Scenes/RemoteMic/hooks/usePermissions';\n\ninterface Props {\n    roomId: string;\n    connectionStatus: ConnectionStatuses;\n    connectionError?: transportErrorReason;\n    isKeepAwakeOn: boolean;\n    setIsKeepAwakeOn: (keepAwake: boolean) => void;\n    monitoringStarted: boolean;\n    setMonitoringStarted: (micMonitoring: boolean) => void;\n}\n\nfunction RemoteSettings({\n    roomId,\n    monitoringStarted,\n    setMonitoringStarted,\n    isKeepAwakeOn,\n    setIsKeepAwakeOn,\n    connectionError,\n    connectionStatus,\n}: Props) {\n    const permissions = usePermissions();\n    const reset = () => {\n        WebRTCClient.disconnect();\n        localStorage.removeItem('remote_mic_name');\n        localStorage.removeItem(MIC_ID_KEY);\n        window.location.reload();\n    };\n    return (\n        <Container>\n            <h3>\n                Remote mic ID:{' '}\n                <strong data-test=\"remote-mic-id\">\n                    {WebRTCClient.getClientId()?.slice(-4).toUpperCase() ?? '----'}\n                </strong>\n            </h3>\n            <MenuButton onClick={reset} size=\"small\" data-test=\"reset-microphone\">\n                Reset microphone\n            </MenuButton>\n            <h5>Removes all persisted microphone data.</h5>\n            <hr />\n            {permissions === 'write' && <ManagePlayers />}\n        </Container>\n    );\n}\nexport default RemoteSettings;\n\nconst Container = styled.div`\n    font-size: 2.6rem;\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    padding: 1.5rem;\n    box-sizing: border-box;\n    gap: 1rem;\n`;\n","import { SongPreview } from 'interfaces';\nimport { useEffect, useRef, useState } from 'react';\nimport SongDao from 'Songs/SongDao';\n\nexport default function useSongIndex(includeDeleted = false) {\n    const [songIndex, setSongIndex] = useState<SongPreview[] | null>(SongDao.getCurrentIndex());\n    // Prevent recreating of the array every render\n    const emptyList = useRef<SongPreview[]>([]);\n\n    const loadSongs = () => SongDao.getIndex(includeDeleted).then(setSongIndex);\n\n    useEffect(() => {\n        loadSongs();\n    }, []);\n\n    return {\n        data: songIndex ?? emptyList.current,\n        reload: loadSongs,\n        isLoading: songIndex === null,\n    };\n}\n","function generateLangMap() {\n    const langNames = new Intl.DisplayNames(['en'], { type: 'language' });\n    const langMap: Record<string, string> = {};\n    for (let i = 0; i < 26; i++) {\n        for (let j = 0; j < 26; j++) {\n            let code = String.fromCharCode(97 + i) + String.fromCharCode(97 + j);\n            let name = langNames.of(code);\n            if (name !== code && name !== undefined) {\n                langMap[name] = code;\n            }\n        }\n    }\n    const langMap2: Record<string, string> = {\n        // Avoid using deprecated codes:\n        Akan: 'ak',\n        Hebrew: 'he',\n        Indonesian: 'id',\n        Javanese: 'jv',\n        Romanian: 'ro',\n        Yiddish: 'yi',\n        // Optional extras:\n        Tagalog: 'tl',\n        English: 'gb',\n        Korean: 'kr',\n        Swedish: 'se',\n        Latin: 'va',\n    };\n    return { ...langMap, ...langMap2 };\n}\n\n// Usage:\nconst langMap = generateLangMap();\n\nexport default function (language: string) {\n    return langMap[language];\n}\n","import styled from '@emotion/styled';\nimport { transportErrorReason } from 'RemoteMic/Network/TheClient';\nimport WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport { WebRTCSongListEvent } from 'RemoteMic/Network/events';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { ConnectionStatuses } from 'Scenes/RemoteMic/RemoteMic';\nimport SongDao from 'Songs/SongDao';\nimport useSongIndex from 'Songs/hooks/useSongIndex';\nimport { uniqBy } from 'lodash-es';\nimport { useEffect, useMemo, useState } from 'react';\nimport languageNameToIsoCode from 'utils/languageNameToIsoCode';\n\ninterface Props {\n    roomId: string;\n    connectionStatus: ConnectionStatuses;\n    connectionError?: transportErrorReason;\n    isKeepAwakeOn: boolean;\n    setIsKeepAwakeOn: (keepAwake: boolean) => void;\n    monitoringStarted: boolean;\n    setMonitoringStarted: (micMonitoring: boolean) => void;\n}\n\nfunction RemoteSongList({\n    roomId,\n    monitoringStarted,\n    setMonitoringStarted,\n    isKeepAwakeOn,\n    setIsKeepAwakeOn,\n    connectionError,\n    connectionStatus,\n}: Props) {\n    const originalSongList = useSongIndex();\n\n    const [overrides, setOverrides] = useState<WebRTCSongListEvent | undefined>();\n    useEffect(() => {\n        if (connectionStatus === 'connected' && overrides === undefined) {\n            WebRTCClient.getSongList().then(setOverrides);\n        }\n    }, [overrides, connectionStatus]);\n\n    const songList = useMemo(\n        () =>\n            uniqBy(\n                originalSongList.data\n                    .map((song) => ({ ...song, id: SongDao.generateSongFile(song) }))\n                    .filter((song) => !(overrides?.deleted ?? []).includes(song.id))\n                    .map((song) => ({\n                        id: song.id,\n                        artist: song.artist,\n                        title: song.title,\n                        video: song.video,\n                        language: song.language,\n                    }))\n                    .concat(\n                        ...(overrides?.custom ?? []).map((song) => ({ ...song, id: SongDao.generateSongFile(song) })),\n                    ),\n                (song) => song.id,\n            ),\n        [originalSongList.data, overrides],\n    );\n\n    return (\n        <Container>\n            {songList.map((song) => {\n                const language = Array.isArray(song.language) ? song.language[0] : song.language!;\n\n                return (\n                    <SongItemContainer key={`${song.artist}-${song.title}`} data-test={song.id}>\n                        <Language>\n                            <img src={`https://flagcdn.com/${languageNameToIsoCode(language)}.svg`} alt={language} />\n                        </Language>\n                        <ArtistTitle>\n                            <Title>{song.title}</Title>\n                            <Artist>{song.artist}</Artist>\n                        </ArtistTitle>\n                    </SongItemContainer>\n                );\n            })}\n        </Container>\n    );\n}\nexport default RemoteSongList;\n\nconst Container = styled.div`\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 5rem;\n`;\n\nconst SongItemContainer = styled.div`\n    background: rgba(0, 0, 0, 0.25);\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    padding: 1.5rem 1rem;\n    border-bottom: 1px solid black;\n`;\n\nconst Language = styled.div`\n    img {\n        height: 3rem;\n        width: 3rem;\n        object-fit: cover;\n        border-radius: 3rem;\n        border: 0.1rem black solid;\n        aspect-ratio: 1;\n    }\n`;\n\nconst ArtistTitle = styled.div`\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    gap: 1rem;\n`;\n\nconst Artist = styled.span`\n    color: ${styles.colors.text.default};\n    font-size: 1.25rem;\n    white-space: nowrap;\n    overflow: hidden;\n    font-weight: bold;\n    text-overflow: ellipsis;\n`;\nconst Title = styled.span`\n    color: ${styles.colors.text.active};\n\n    font-size: 1.5rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n`;\n","import styled from '@emotion/styled';\nimport NoSleep from '@uriopass/nosleep.js';\nimport { useBackground } from 'Elements/LayoutWithBackground';\nimport NormalizeFontSize from 'Elements/NormalizeFontSize';\nimport events from 'GameEvents/GameEvents';\nimport { useEventEffect, useEventListener } from 'GameEvents/hooks';\nimport BottomBar from 'Scenes/RemoteMic/BottomBar';\nimport Microphone from 'Scenes/RemoteMic/Panels/Microphone';\nimport ConfirmReadiness from 'Scenes/RemoteMic/Panels/Microphone/ConfirmReadiness';\nimport RemoteSettings from 'Scenes/RemoteMic/Panels/RemoteSettings';\nimport RemoteSongList from 'Scenes/RemoteMic/Panels/RemoteSongList';\nimport { useState } from 'react';\n\ninterface Props {\n    roomId: string;\n}\n\nconst noSleep = new NoSleep();\n\nexport type ConnectionStatuses = Parameters<typeof events.karaokeConnectionStatusChange.dispatch>[0] | 'uninitialised';\n\nexport type PhoneTabs = 'microphone' | 'song-list' | 'settings';\n\nfunction RemoteMic({ roomId }: Props) {\n    useBackground(true);\n    const [activeTab, setActiveTab] = useState<PhoneTabs>('microphone');\n\n    const [connectionStatus, connectionError] = useEventListener(events.karaokeConnectionStatusChange) ?? [\n        'uninitialised',\n    ];\n\n    const [monitoringStarted, setMonitoringStarted] = useState(false);\n    useEventEffect(events.micMonitoringStarted, () => setMonitoringStarted(true));\n    useEventEffect(events.micMonitoringStopped, () => setMonitoringStarted(false));\n\n    const [isKeepAwakeOn, setIsKeepAwakeOn] = useState(false);\n\n    const setKeepAwake = async (turnOn: boolean) => {\n        try {\n            if (turnOn && !noSleep.isEnabled) {\n                await noSleep.enable();\n            } else if (!turnOn && noSleep.isEnabled) {\n                await noSleep.disable();\n            }\n            setIsKeepAwakeOn(turnOn);\n        } catch (e) {\n            console.warn('Couldnt set wakelock', e);\n        }\n    };\n\n    const onConfirm = () => {\n        setKeepAwake(true);\n    };\n\n    return (\n        <>\n            <ConfirmReadiness onConfirm={onConfirm} />\n            <NormalizeFontSize size={10} />\n            <Container id=\"phone-ui-container\">\n                {activeTab === 'microphone' && (\n                    <Microphone\n                        roomId={roomId}\n                        monitoringStarted={monitoringStarted}\n                        setMonitoringStarted={setMonitoringStarted}\n                        connectionStatus={connectionStatus}\n                        setIsKeepAwakeOn={setIsKeepAwakeOn}\n                        isKeepAwakeOn={isKeepAwakeOn}\n                        connectionError={connectionError}\n                    />\n                )}\n                {activeTab === 'song-list' && (\n                    <RemoteSongList\n                        roomId={roomId}\n                        monitoringStarted={monitoringStarted}\n                        setMonitoringStarted={setMonitoringStarted}\n                        connectionStatus={connectionStatus}\n                        setIsKeepAwakeOn={setIsKeepAwakeOn}\n                        isKeepAwakeOn={isKeepAwakeOn}\n                        connectionError={connectionError}\n                    />\n                )}\n                {activeTab === 'settings' && (\n                    <RemoteSettings\n                        roomId={roomId}\n                        monitoringStarted={monitoringStarted}\n                        setMonitoringStarted={setMonitoringStarted}\n                        connectionStatus={connectionStatus}\n                        setIsKeepAwakeOn={setIsKeepAwakeOn}\n                        isKeepAwakeOn={isKeepAwakeOn}\n                        connectionError={connectionError}\n                    />\n                )}\n                <BottomBarFiller />\n                <BottomBar setActiveTab={setActiveTab} active={activeTab} />\n            </Container>\n        </>\n    );\n}\nexport default RemoteMic;\n\nconst BottomBarFiller = styled.div`\n    height: 6rem;\n\n    @media (max-height: 500px) and (min-aspect-ratio: 16/10) {\n        height: 0;\n    }\n`;\n\nconst Container = styled.div`\n    margin: 0 auto;\n    width: 100%;\n    max-width: 400px;\n    box-sizing: border-box;\n    min-height: 100vh;\n    background: rgba(0, 0, 0, 0.5);\n\n    @media (max-height: 500px) and (min-aspect-ratio: 16/10) {\n        max-width: 960px;\n    }\n`;\n","export default \"data:image/gif;base64,R0lGODlhiQAzAOflAAABAAYAAAACAAcAAAkBAAoDAQsEAxAFABEHABIIABMKABgJAhQLAhsLABwNACANAR0OACEOAyMPACMQACcPACgQASgRAioSACsTACwTACwUAC8WAC4WAzAWADQVADUXATYYAjgYADkZADoaADobAD8aAzscAUEbAD4dAEMdAEUeAkAgAEYfAEUfA0ghAE4hAksjAU8iAFEjAFIkAFMlAFQmAVsmAFcoAFwnAF0oAF8qAmEqAGIrAGMsAGksAWUuAGotAmAwDWwuAGsuA20vAF0zDm4wAG8xAHEyAHIzAXgyAHM0AnU1AHo0AHY2AHw1AH43AIA5AoE6AIM7AIQ8AIk7AIU9AIs8AIc+AIw9AI0+AY4+ApFAAJJBAJNCAJRDAJpCAZVEAJtDAp1EAJxEA55FAKBHAKFIAKJJAKhIAaRKAKVLAKtKAKxLAI5RI5BRJK9NALBOALFPALJQALNRALlQBLtRALxSAL1TAL9UAMFWAMJXAMRYArlbCsZZAMVZA8xYAMhaAM9aANFcAdNdAtVfAMpiDddgAN1fANhhAN9hANljAOFiAeNkAOJkA91mAONlBN5nAdhoDeVmAOdoAO5mAOJqB+9nAOlpAPBpAfFqA654SvNrAOduDvRsAPZtAN5yGONxGvduANh0IPFwB/hvAOtxE+B0Gt90I/lwAOxyFPNxCu5zBud0EvRyANt2Is54Ndp2Krt8S+B1JM95L9V4Ked0HeF2G/txAO1zFvRyDOh1E9x3I895NtV4ML19Rsp7NcN8Qbx9TMl7O8J8R9Z5Kq6AW8h7QrZ/ULh/S7V/VsV9O75+R8t8NsR9QqmCYKeCZpqFcLGBVq+BXJGHe4+HgbeAUaOEZqGEbLaAV6CEcauDXKqDYZuGcZmGd42Ih5KIfJCIgpSId4iKh4uKgv///////////////////////////////////////////////////////////////////////////////////////////////////////////yH5BAEIAP8ALAAAAACJADMAAAj+AP8JHEiwoMGDCBMqXMiwocOHECMSHEexosWLGDNq3Mixo8ePIDtKHPhtGK6TKFOqXInrGcuXMGPKnEmzpspU40YKHBdryICfQIMKFVpHFq6hSJOWSMq0qdOnUH8S8PRN579v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\"","export default \"__VITE_ASSET__a63f4704__\"","export default \"__VITE_ASSET__898ca0f7__\"","import styled from '@emotion/styled';\nimport dotparty from 'Elements/dotparty.gif';\nimport logo from 'Elements/logo.gif';\nimport pride from 'Elements/pride.png';\nimport { MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\n\nif (window.location.search.includes('pride')) {\n    sessionStorage.setItem('pride', 'true');\n}\n\nexport default function Logo(props: any) {\n    const [mobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n\n    if (mobilePhoneMode) {\n        return null;\n    }\n    return (\n        <Container>\n            {sessionStorage.getItem('pride') === 'true' && <PrideLogo src={pride} alt=\"AllKaraoke Pride logo part 1\" />}\n            <StyledLogo src={logo} alt=\"AllKaraoke logo\" {...props} />\n            <DotParty src={dotparty} alt=\"AllKaraoke Pride logo part 2\" />\n        </Container>\n    );\n}\nconst StyledLogo = styled.img`\n    width: 66rem;\n    height: 16.4rem;\n`;\n\nconst Container = styled.div`\n    position: relative;\n    height: 16.4rem;\n    view-transition-name: logo;\n`;\n\nconst PrideLogo = styled(StyledLogo)`\n    position: absolute;\n`;\n\nconst DotParty = styled.img`\n    position: absolute;\n    width: 13.7rem;\n    height: 5.1rem;\n    bottom: -0.5rem;\n    right: -1rem;\n`;\n","export default function isChromium() {\n    return 'chrome' in window;\n}\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport isChromium from 'utils/isChromium';\n\nfunction RecommendedBrowsers() {\n    return (\n        <>\n            {!isChromium() && (\n                <RecommendChrome>\n                    <h2>\n                        This game is tested in <strong>Google Chrome</strong> and <strong>MS Edge</strong>.\n                    </h2>\n                    It's not guaranteed to work on other browsers (like the one you use now).\n                </RecommendChrome>\n            )}\n        </>\n    );\n}\n\nconst RecommendChrome = styled.div`\n    width: 100%;\n    ${typography};\n    text-align: center;\n    background: darkred;\n    padding: 3rem 0;\n    margin-top: 1rem;\n    h2 {\n        margin-top: 0;\n    }\n\n    strong {\n        color: ${styles.colors.text.active};\n    }\n`;\n\nexport default RecommendedBrowsers;\n","// https://tholman.com/github-corners/\nimport styled from '@emotion/styled';\n\nexport default function GithubRibbon() {\n    return (\n        <>\n            <Ribbon\n                href=\"https://github.com/Asvarox/allkaraoke\"\n                aria-label=\"View source on GitHub\"\n                target=\"_blank\"\n                rel=\"noreferrer\">\n                <svg\n                    width=\"80\"\n                    height=\"80\"\n                    viewBox=\"0 0 250 250\"\n                    style={{\n                        fill: '#151513',\n                        color: '#fff',\n                        position: 'absolute',\n                        top: 0,\n                        border: 0,\n                        left: 0,\n                        transform: 'scale(-1, 1)',\n                    }}\n                    aria-hidden=\"true\">\n                    <path d=\"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z\"></path>\n                    <path\n                        d=\"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2\"\n                        fill=\"currentColor\"\n                        style={{ transformOrigin: '13rem 10.6rem' }}\n                        className=\"octo-arm\"></path>\n                    <path\n                        d=\"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z\"\n                        fill=\"currentColor\"\n                        className=\"octo-body\"></path>\n                </svg>\n            </Ribbon>\n        </>\n    );\n}\n\nconst Ribbon = styled.a`\n    &:hover .octo-arm {\n        animation: octocat-wave 560ms ease-in-out;\n    }\n    @keyframes octocat-wave {\n        0 %,\n        100% {\n            transform: rotate(0);\n        }\n        20%,\n        60% {\n            transform: rotate(-25deg);\n        }\n        40%,\n        80% {\n            transform: rotate(10deg);\n        }\n    }\n    @media (max-width: 500px) {\n        &:hover .octo-arm {\n            animation: none;\n        }\n        .octo-arm {\n            animation: octocat-wave 560ms ease-in-out;\n        }\n    }\n\n    view-transition-name: github-ribbon;\n`;\n","import styled from '@emotion/styled';\nimport { useBackground } from 'Elements/LayoutWithBackground';\nimport Logo from 'Elements/Logo';\nimport { MenuContainer } from 'Elements/Menu';\nimport RecommendedBrowsers from 'Elements/RecommendedBrowsers';\nimport GithubRibbon from 'Scenes/Welcome/GithubRibbon';\nimport { PropsWithChildren } from 'react';\n\ntype Props = PropsWithChildren<{\n    supportedBrowsers?: boolean;\n}>;\nfunction MenuWithLogo({ children, supportedBrowsers }: Props) {\n    useBackground(true);\n\n    return (\n        <>\n            <GithubRibbon />\n            <Container>\n                <Logo />\n                {supportedBrowsers && <RecommendedBrowsers />}\n                <MenuContainer>{children}</MenuContainer>\n            </Container>\n        </>\n    );\n}\n\nconst Container = styled.div`\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n`;\n\nexport default MenuWithLogo;\n","export default \"__VITE_ASSET__190aec3e__\"","export default \"__VITE_ASSET__ba17dbac__\"","export default \"__VITE_ASSET__2ad5728e__\"","export default \"__VITE_ASSET__4b5d4e94__\"","export default \"__VITE_ASSET__1483804b__\"","export default \"__VITE_ASSET__c276addd__\"","export default \"__VITE_ASSET__c41709e6__\"","import { Howl } from 'howler';\n\nimport cameraSound from 'assets/166500__thompsonman__camera-shutter.wav';\nimport waitFinishedSound from 'assets/376817__original_sound__impact-cinematic.wav';\nimport classicBackgroundMusicSound from 'assets/421888__b-sean__retro.mp3';\nimport backgroundMusicSound from 'assets/Funk Cool Groove (No Copyright Music) By Anwar Amr.mp3';\nimport menuBackSound from 'assets/menu_back.wav';\nimport menuEnterSound from 'assets/menu_enter.wav';\nimport menuNavigateSound from 'assets/menu_navigate.wav';\n\nconst menuNavigate = new Howl({\n    src: menuNavigateSound,\n});\n\nconst menuEnter = new Howl({\n    src: menuEnterSound,\n});\n\nconst menuBack = new Howl({\n    src: menuBackSound,\n});\n\nconst waitFinished = new Howl({\n    src: waitFinishedSound,\n    preload: true,\n});\n\nconst cameraShot = new Howl({\n    src: cameraSound,\n    preload: true,\n    volume: 0.1,\n});\n\nconst backgroundMusic = new Howl({\n    src: backgroundMusicSound,\n    volume: 0.3,\n    loop: true,\n});\nconst classicBackgroundMusic = new Howl({\n    src: classicBackgroundMusicSound,\n    volume: 0.4,\n    loop: true,\n});\n\nexport { backgroundMusic, cameraShot, classicBackgroundMusic, menuBack, menuEnter, menuNavigate, waitFinished };\n","import { BackgroundMusicSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport { backgroundMusic, classicBackgroundMusic } from 'SoundManager';\nimport { useEffect } from 'react';\n\nexport default function useBackgroundMusic(play: boolean) {\n    const [backgroundMusicSelection] = useSettingValue(BackgroundMusicSetting);\n\n    const music = backgroundMusicSelection === 'Classic' ? classicBackgroundMusic : backgroundMusic;\n\n    useEffect(() => {\n        if (play) {\n            if (!music.playing()) {\n                music.play();\n            }\n        } else {\n            music.stop();\n        }\n    }, [play]);\n}\n","import { useContext, useEffect, useRef } from 'react';\nimport { HelpEntry, KeyboardHelpContext } from 'Scenes/KeyboardHelp/Context';\n\nlet id = 0;\n\nexport default function useKeyboardHelp(help: HelpEntry, enabled: boolean) {\n    const name = useRef(`${String(Math.random())}-${id++}`);\n    const { setKeyboard, unsetKeyboard } = useContext(KeyboardHelpContext);\n\n    const setHelp = (help: HelpEntry) => {\n        setKeyboard(name.current, help);\n    };\n\n    const clearHelp = () => unsetKeyboard(name.current);\n\n    useEffect(() => {\n        if (enabled) {\n            setHelp(help);\n        }\n\n        return clearHelp;\n    }, [help, enabled]);\n\n    return { setHelp, clearHelp };\n}\n","import { HelpEntry } from 'Scenes/KeyboardHelp/Context';\nimport { menuBack, menuEnter, menuNavigate } from 'SoundManager';\nimport useKeyboard from 'hooks/useKeyboard';\nimport { useEffect, useMemo, useRef, useState } from 'react';\nimport useKeyboardHelp from './useKeyboardHelp';\n\n/**\n * todo: Bug: for some reason elementList is duplicated eg.\n * ['a', 'b', 'c', 'a', 'b', 'c']\n *\n * But still works even with dynamic elements :shrugs:\n */\ninterface Options {\n    enabled?: boolean;\n    onBackspace?: () => void;\n    backspaceHelp?: string | null;\n    direction?: 'horizontal' | 'vertical';\n    additionalHelp?: HelpEntry;\n}\n\ninterface KeyboardAction {\n    callback: () => void;\n    label?: string;\n    propName: string;\n}\n\nexport default function useKeyboardNav(options: Options = {}, debug = false) {\n    const { enabled = true, onBackspace, backspaceHelp = null, direction = 'vertical', additionalHelp = {} } = options;\n\n    const [currentlySelected, setCurrentlySelected] = useState<string | null>(null);\n    const elementList = useRef<string[]>([]);\n    const newElementList = useRef<string[]>([]);\n    const actions = useRef<Record<string, KeyboardAction>>({});\n\n    const currentlySelectedActionLabel = actions.current[currentlySelected!]?.label;\n    const help = useMemo(\n        () => ({\n            [direction]: null,\n            accept: currentlySelectedActionLabel ?? null,\n            back: onBackspace ? backspaceHelp : undefined,\n            ...additionalHelp,\n        }),\n        [currentlySelectedActionLabel, actions, backspaceHelp, direction],\n    );\n    useKeyboardHelp(help, enabled);\n\n    const handleEnter = () => {\n        actions.current[currentlySelected!]?.callback();\n        menuEnter.play();\n    };\n\n    const handleBackspace = () => {\n        if (onBackspace) {\n            menuBack.play();\n            onBackspace();\n        }\n    };\n\n    const handleNavigation = (direction: -1 | 1) => {\n        const currentIndex = currentlySelected ? elementList.current.indexOf(currentlySelected) : 0;\n        menuNavigate.play();\n\n        setCurrentlySelected(elementList.current.at((currentIndex + direction) % elementList.current.length) ?? null);\n    };\n\n    useKeyboard(\n        {\n            [direction === 'vertical' ? 'up' : 'left']: () => handleNavigation(-1),\n            [direction === 'vertical' ? 'down' : 'right']: () => handleNavigation(1),\n            accept: handleEnter,\n            back: handleBackspace,\n        },\n        enabled,\n        [currentlySelected, elementList.current],\n    );\n\n    let defaultSelection = '';\n\n    const register = (\n        name: string,\n        onActive: () => void,\n        help?: string,\n        isDefault = false,\n        { propName = 'onClick', disabled = false } = {},\n    ) => {\n        if (disabled) {\n            return { disabled, focused: false };\n        }\n        newElementList.current.push(name);\n        if (onActive) actions.current[name] = { callback: onActive, label: help, propName };\n\n        if (isDefault) {\n            defaultSelection = name;\n        }\n\n        const focused = enabled && currentlySelected === name;\n\n        return {\n            focused,\n            [propName]: onActive,\n            keyboardNavigationChangeFocus: handleNavigation,\n            'data-test': name,\n            ...(enabled ? { 'data-focused': focused } : {}),\n        };\n    };\n\n    useEffect(() => {\n        let newElements = newElementList.current.filter((e) => !elementList.current.includes(e));\n        debug && newElements.length && console.log('new elements', newElements);\n        elementList.current = [...newElementList.current];\n        newElementList.current.length = 0;\n\n        if (!elementList.current.length) return;\n        if (\n            currentlySelected === null ||\n            elementList.current.indexOf(currentlySelected) === -1 ||\n            newElements.includes(defaultSelection)\n        ) {\n            setCurrentlySelected(defaultSelection || elementList.current[0]);\n        }\n    });\n\n    const focusElement = (name: string) => {\n        if (elementList.current.includes(name)) setCurrentlySelected(name);\n    };\n\n    return {\n        focusElement,\n        focused: currentlySelected,\n        register,\n    };\n}\n","export default function startViewTransition(callback: () => void) {\n    // @ts-expect-error\n    if (!document.startViewTransition) {\n        callback();\n    } else {\n        // @ts-expect-error\n        document.startViewTransition(async () => {\n            await callback();\n        });\n    }\n}\n","import startViewTransition from 'utils/startViewTransition';\nimport { useLocation } from 'wouter';\n\ninterface Options {\n    replace?: boolean;\n    smooth?: boolean;\n}\n\nexport default function useSmoothNavigate() {\n    const [, baseNavigate] = useLocation();\n\n    return (to: string, { smooth = true, ...options }: Options = {}) => {\n        // This disabled smooth navigation with viewTransition as it crashes the app on Chrome\n        // See https://bugs.chromium.org/p/chromium/issues/detail?id=1443134\n        // @ts-ignore\n        if (!window.__enableSmooth || !smooth) {\n            baseNavigate(to, options);\n        } else {\n            startViewTransition(() => baseNavigate(to, options));\n        }\n    };\n}\n","import styled from '@emotion/styled';\nimport { Input } from 'Elements/Input';\nimport { forwardRef, useImperativeHandle, useRef } from 'react';\nimport { InputLagSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\n\ninterface Props {\n    focused: boolean;\n}\n\nconst InputLag = forwardRef<HTMLInputElement, Props>(({ ...restProps }, forwardedRef) => {\n    const inputRef = useRef<HTMLInputElement>(null);\n    useImperativeHandle(forwardedRef, () => inputRef.current!);\n    const [inputLag, setInputLag] = useSettingValue(InputLagSetting);\n\n    return (\n        <InputLagField\n            ref={inputRef}\n            label=\"Input lag\"\n            value={String(inputLag)}\n            onChange={(val) => setInputLag(+val)}\n            type=\"number\"\n            step={50}\n            min={-2000}\n            max={2000}\n            adornment={'ms'}\n            onKeyDown={(e) => {\n                if (e.code === 'Enter') {\n                    inputRef.current?.blur();\n                }\n            }}\n            info=\"If the sound is not synchorised with the lyrics, use this to compensate it.\"\n            {...restProps}\n        />\n    );\n});\n\nconst InputLagField = styled(Input)`\n    input {\n        text-align: right;\n    }\n`;\n\nexport default InputLag;\n","import { CircularProgress } from '@mui/material';\nimport CameraManager from 'Camera/CameraManager';\nimport { MenuButton } from 'Elements/Menu';\nimport MenuWithLogo from 'Elements/MenuWithLogo';\nimport { nextValue, Switcher } from 'Elements/Switcher';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport { ReactNode, useEffect, useRef, useState } from 'react';\nimport InputLag from 'Scenes/Settings/InputLag';\nimport {\n    BackgroundMusic,\n    BackgroundMusicSetting,\n    FpsCount,\n    FPSCountSetting,\n    GraphicSetting,\n    GraphicsLevel,\n    MobilePhoneModeSetting,\n    useSettingValue,\n} from 'Scenes/Settings/SettingsState';\n\ninterface Props {}\n\nfunction Settings(props: Props) {\n    useBackgroundMusic(false);\n    const navigate = useSmoothNavigate();\n    const goBack = () => navigate('/');\n\n    const { register } = useKeyboardNav({ onBackspace: goBack });\n\n    const [graphicLevel, setGraphicLevel] = useSettingValue(GraphicSetting);\n    const [fpsCount, setFpsCount] = useSettingValue(FPSCountSetting);\n    const [mobilePhoneMode, setMobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n    const [backgroundMusic, setBackgroundMusic] = useSettingValue(BackgroundMusicSetting);\n    const inputLagRef = useRef<HTMLInputElement | null>(null);\n\n    const [camera, setCamera] = useState<null | boolean>(CameraManager.getPermissionStatus());\n    useEffect(() => {\n        return CameraManager.addListener((status) => {\n            setCamera(status);\n        });\n    }, []);\n\n    const [isRequestInProgress, setIsRequestInProgress] = useState(false);\n    const enableCamera = () => {\n        setIsRequestInProgress(true);\n        CameraManager.requestPermissions().then(() => setIsRequestInProgress(false));\n    };\n\n    let cameraValue: ReactNode = 'Disabled';\n    if (isRequestInProgress) cameraValue = <CircularProgress size=\"0.9em\" />;\n    else if (camera === null) cameraValue = 'Click to enable';\n    else if (camera) cameraValue = 'Enabled';\n\n    return (\n        <MenuWithLogo>\n            <h1>Settings</h1>\n            <Switcher\n                {...register('graphics-level', () => setGraphicLevel(nextValue(GraphicsLevel, graphicLevel)))}\n                label=\"Graphics\"\n                value={graphicLevel.toUpperCase()}\n            />\n            <Switcher\n                {...register('fps-count-level', () => setFpsCount(nextValue(FpsCount, fpsCount)))}\n                label=\"FPS Count\"\n                value={fpsCount}\n            />\n            <Switcher\n                {...register('background-music-selection', () =>\n                    setBackgroundMusic(nextValue(BackgroundMusic, backgroundMusic)),\n                )}\n                label=\"Background Music\"\n                value={backgroundMusic}\n            />\n            <InputLag ref={inputLagRef} {...register('input-lag', () => inputLagRef.current?.focus())} />\n            <hr />\n            <Switcher\n                {...register('camera-access', () => (camera ? CameraManager.disable() : enableCamera()))}\n                label=\"Enable camera mode\"\n                value={cameraValue}\n                info=\"Record a timelapse video from singing. The recording is not sent nor stored anywhere.\"\n            />\n            <hr />\n            <Switcher\n                {...register('mobile-phone-mode', () => setMobilePhoneMode(!mobilePhoneMode))}\n                label=\"Mobile Phone Mode\"\n                value={mobilePhoneMode ? 'Yes' : 'No'}\n                info=\"Adjust the game to a smaller screen. Disables option to sing in duets.\"\n            />\n            <hr />\n            <MenuButton {...register('remote-mics-settings', () => navigate('/settings/remote-mics'))} size=\"small\">\n                Remote Microphones Settings\n            </MenuButton>\n            <MenuButton {...register('setup-mics-button', () => navigate('/select-input'))} size=\"small\">\n                Setup Microphones\n            </MenuButton>\n            <MenuButton {...register('manage-songs-button', () => navigate('/manage-songs'))} size=\"small\">\n                Manage Songs\n            </MenuButton>\n            <MenuButton {...register('back-button', goBack)}>Return To Main Menu</MenuButton>\n        </MenuWithLogo>\n    );\n}\n\nexport default Settings;\n","import styled from '@emotion/styled';\nimport { Search } from '@mui/icons-material';\nimport { Button, Tooltip } from '@mui/material';\nimport { ComponentProps } from 'react';\n\nexport const Pre = styled.span`\n    font-family: monospace;\n`;\n\nexport const inputAction = (action: ComponentProps<typeof Button>['onClick'], enabled: boolean, label = 'Lookup') => ({\n    InputProps: {\n        endAdornment: (\n            <Tooltip title={enabled ? 'Open search results for the song' : 'Artist or title of the song is unknown'}>\n                <span>\n                    <Button\n                        sx={{ mr: -1 }}\n                        endIcon={<Search />}\n                        color={'secondary'}\n                        variant={'text'}\n                        onClick={action}\n                        disabled={!enabled}>\n                        {label}\n                    </Button>\n                </span>\n            </Tooltip>\n        ),\n    },\n});\n","import { ExtractOptional, NotesSection, Section, Song } from 'interfaces';\n\nexport const typesMap = {\n    R: 'rap',\n    F: 'freestyle',\n    '*': 'star',\n    ':': 'normal',\n} as const;\n\nexport type SongTXTKeys =\n    | 'TRACKNAMES'\n    | 'YEAR'\n    | 'LASTUPDATE'\n    | 'EDITION'\n    | 'GENRE'\n    | 'LANGUAGE'\n    | 'VIDEOGAP'\n    | 'REALBPM'\n    | 'PREVIEWSTART'\n    | 'PREVIEWEND'\n    | 'VOLUME'\n    | 'CREATOR'\n    | 'CREATORURL'\n    | 'SOURCEURL'\n    | 'TITLE'\n    | 'ARTIST'\n    | 'BPM'\n    | 'GAP'\n    | 'VIDEOID';\n\nfunction getPropertyValueFromTxt(txt: string, key: SongTXTKeys, type?: 'string'): string | undefined;\nfunction getPropertyValueFromTxt(txt: string, key: SongTXTKeys, type?: 'array'): string[] | undefined;\nfunction getPropertyValueFromTxt(txt: string, key: SongTXTKeys, type?: 'number'): number | undefined;\nfunction getPropertyValueFromTxt(txt: string, key: SongTXTKeys, type: 'string' | 'number' | 'array' = 'string') {\n    const regex = new RegExp(`#${key}\\\\:(.*)`);\n\n    const value = txt.match(regex)?.[1];\n    if (value === undefined) return undefined;\n    if (type === 'number') {\n        return Number(value.replace(',', '.')) ?? 0;\n    } else if (type === 'array') {\n        const vals = value.split(', ');\n\n        return vals.length > 1 ? vals : value;\n    }\n    return value;\n}\n\nconst LINE_BREAK_RELATIVE_REGEXP = /- -?\\d+ -?\\d+/;\n\nexport function getVideoId(url: string) {\n    try {\n        const linkUrl = new URL(url);\n        return linkUrl.searchParams.get('v') || false;\n    } catch (e: any) {\n        return false;\n    }\n}\nfunction safeJsonParse<T extends any, DV extends any = T>(str: any, defaultValue: DV): T | DV {\n    try {\n        return JSON.parse(str);\n    } catch (e) {\n        return defaultValue;\n    }\n}\n\nexport default function convertTxtToSong(\n    text: string,\n    videoLink?: string,\n    author?: string,\n    authorUrl?: string,\n    sourceUrl?: string,\n): Song {\n    const trackNames: string[] = safeJsonParse<string[]>(getPropertyValueFromTxt(text, 'TRACKNAMES'), []);\n\n    const additionalData = {\n        year: getPropertyValueFromTxt(text, 'YEAR'),\n        lastUpdate: getPropertyValueFromTxt(text, 'LASTUPDATE'),\n        edition: getPropertyValueFromTxt(text, 'EDITION'),\n        genre: getPropertyValueFromTxt(text, 'GENRE'),\n        language: getPropertyValueFromTxt(text, 'LANGUAGE', 'array'),\n        videoGap: getPropertyValueFromTxt(text, 'VIDEOGAP', 'number'),\n        realBpm: getPropertyValueFromTxt(text, 'REALBPM', 'number'),\n        previewStart: getPropertyValueFromTxt(text, 'PREVIEWSTART', 'number'),\n        previewEnd: getPropertyValueFromTxt(text, 'PREVIEWEND', 'number'),\n        volume: getPropertyValueFromTxt(text, 'VOLUME', 'number'),\n        author: getPropertyValueFromTxt(text, 'CREATOR') ?? author,\n        authorUrl: getPropertyValueFromTxt(text, 'CREATORURL') ?? authorUrl,\n        sourceUrl: getPropertyValueFromTxt(text, 'SOURCEURL') ?? sourceUrl,\n        // todo upgrade eslint and use `satisfies` instead of `as`\n    } as ExtractOptional<Song>;\n\n    if (additionalData.videoGap) additionalData.videoGap = Math.floor(additionalData.videoGap);\n\n    const song: Song = {\n        title: getPropertyValueFromTxt(text, 'TITLE') ?? '',\n        artist: getPropertyValueFromTxt(text, 'ARTIST') ?? '',\n        bpm: Number(getPropertyValueFromTxt(text, 'BPM')?.replace(',', '.') ?? 0),\n        bar: 4,\n        gap: Number(getPropertyValueFromTxt(text, 'GAP')?.replace(',', '.') ?? 0),\n        video: getPropertyValueFromTxt(text, 'VIDEOID') ?? '',\n        ...additionalData,\n        tracks: [],\n    };\n\n    if (song.video === '' && videoLink) {\n        try {\n            const linkUrl = new URL(videoLink);\n            song.video = linkUrl.searchParams.get('v') || 'Invalid link';\n        } catch (e: any) {\n            song.video = `Invalid link: ${e.message}`;\n        }\n    }\n\n    let sections: Section[] = [];\n    let lastStart = 0;\n\n    text.split('\\n').forEach((line) => {\n        if (line.startsWith('#')) return;\n        const split = line.split(' ');\n\n        // Sometimes the txts are wrongly formatted and include breaks/notes that just overlap\n        // The assumption here is that tracks should start and end roughly similarly, so if a next\n        // track starts just as the previous ends, it's considered a wrong formatting issue rather\n        // than a new track\n        if (Number(split[1]) < lastStart * 0.75 && sections.length) {\n            // new track (song is a duet)\n            if (trackNames[song.tracks.length]) song.tracks.push({ sections, name: trackNames[song.tracks.length] });\n            else song.tracks.push({ sections });\n            sections = [];\n        }\n\n        if (LINE_BREAK_RELATIVE_REGEXP.test(line)) {\n            // \"Pause\" or relative line break\n            const [, start, end] = split;\n            sections.push({ start: Number(start), end: Number(end), type: 'pause' });\n            sections.push({ start: Number(end), type: 'notes', notes: [] });\n\n            lastStart = Number(end);\n        } else if (line.startsWith('-')) {\n            // new section\n            sections.push({ start: Number(line.split('-')[1].trim()), notes: [], type: 'notes' });\n        } else if (Object.keys(typesMap).includes(line[0])) {\n            if (sections.length === 0) {\n                sections = [{ start: 0, notes: [], type: 'notes' }];\n            }\n            // Note\n            const lastSection = sections[sections.length - 1];\n\n            const [type, start, length, pitch, ...lyrics] = split;\n\n            (lastSection as NotesSection).notes.push({\n                type: typesMap[type as 'R' | '*' | ':'] ?? 'normal',\n                start: Number(start),\n                length: Number(length),\n                pitch: Number(pitch),\n                lyrics: lyrics.join(' '),\n            });\n            lastStart = Number(split[1]);\n        }\n    });\n\n    if (trackNames[song.tracks.length]) song.tracks.push({ sections, name: trackNames[song.tracks.length] });\n    else song.tracks.push({ sections });\n\n    song.tracks = song.tracks.map((track) => ({\n        ...track,\n        // get rid of sections with no notes\n        sections: track.sections.filter((section) => section.type === 'pause' || section.notes.length),\n    }));\n\n    return song;\n}\n","import { Box, TextField } from '@mui/material';\nimport { inputAction } from 'Scenes/Convert/Elements';\nimport { getVideoId } from 'Songs/utils/convertTxtToSong';\nimport YouTube from 'react-youtube';\n\nexport interface AuthorAndVidEntity {\n    author: string;\n    authorUrl: string;\n    video: string;\n}\n\ninterface Props {\n    onChange: (data: AuthorAndVidEntity) => void;\n    data: AuthorAndVidEntity;\n    songTitle?: string;\n    songArtist?: string;\n}\n\nexport default function AuthorAndVid(props: Props) {\n    const searchForVideo = () => {\n        window.open(\n            `https://www.youtube.com/results?search_query=${encodeURIComponent(\n                props?.songArtist + ' ' + props?.songTitle,\n            )}`,\n            '_blank',\n        );\n    };\n    const isSearchableForVideo = !!props.songTitle && !!props.songArtist;\n\n    const videoId = getVideoId(props.data.video);\n\n    return (\n        <Box sx={{ display: 'flex', flexWrap: 'wrap' }} data-test=\"author-and-vid\">\n            <TextField\n                data-test=\"author-name\"\n                sx={{ mt: 2 }}\n                value={props.data.author}\n                onChange={(e) => props.onChange({ ...props.data, author: e.target.value })}\n                label=\"Author name (optional)\"\n                fullWidth\n                size=\"small\"\n                helperText=\"Nickname of the person that created the .txt file.\"\n            />\n            <TextField\n                data-test=\"author-url\"\n                sx={{ mt: 2 }}\n                value={props.data.authorUrl}\n                onChange={(e) => props.onChange({ ...props.data, authorUrl: e.target.value })}\n                label=\"Author URL (optional)\"\n                helperText=\"Link to authors page/profile.\"\n                fullWidth\n                size=\"small\"\n            />\n            <Box sx={{ display: 'flex', flexDirection: 'row', mt: 2, alignItems: 'center', width: '100%' }}>\n                <TextField\n                    data-test=\"video-url\"\n                    required\n                    value={props.data.video}\n                    onChange={(e) => props.onChange({ ...props.data, video: e.target.value })}\n                    label=\"YouTube Video URL\"\n                    placeholder=\"https://www.youtube.com/watch?v=\"\n                    fullWidth\n                    size=\"small\"\n                    helperText=\"Link to YouTube video, eg https://www.youtube.com/watch?v=xxxxxxxxx. Click the 'Lookup' button to look for it on YouTube\"\n                    name=\"videoUrl\"\n                    {...inputAction(searchForVideo, isSearchableForVideo)}\n                />\n            </Box>\n            {videoId && (\n                <Box>\n                    <YouTube videoId={videoId} />\n                </Box>\n            )}\n        </Box>\n    );\n}\n","import { AuthorAndVidEntity } from 'Scenes/Convert/Steps/AuthorAndVid';\n\nexport default async function importSongFromSource(url: string) {\n    const urlObj = new URL(url);\n\n    if (urlObj.host === 'usdb.animux.de') {\n        return importUsDbAnimuxSong(url, urlObj);\n    } else if (urlObj.host === 'ultrastar-es.org') {\n        return importUltrastarEsSong(url);\n    }\n}\n\nasync function importUltrastarEsSong(url: string): Promise<AuthorAndVidEntity> {\n    const response = await fetch(`https://at-cors-anywhere.fly.dev/raw?url=${encodeURIComponent(url)}`);\n    const text = await response.text();\n\n    const doc = new DOMParser().parseFromString(text, 'text/html');\n\n    const id = doc.querySelector('ul[data-id]')?.getAttribute('data-id');\n    const txtUrl = `https://ultrastar-es.org/pl/canciones/descargar/txt/${id}`;\n    window.location.href = txtUrl;\n\n    const authorPath = doc.querySelector('#listado > ul > li > dl > dd:nth-child(6) > a')?.getAttribute('href');\n    const videoId = doc.querySelector('#listado > ul > li')?.getAttribute('data-id');\n\n    return {\n        authorUrl: authorPath ? 'https://ultrastar-es.org' + authorPath : '',\n        author: doc.querySelector('#listado > ul > li > dl > dd:nth-child(6)')?.textContent ?? '',\n        video: videoId ? 'https://www.youtube.com/watch?v=' + videoId : '',\n    };\n}\n\nasync function importUsDbAnimuxSong(url: string, obj: URL): Promise<AuthorAndVidEntity> {\n    const response = await fetch(`https://at-cors-anywhere.fly.dev/raw?url=${encodeURIComponent(url)}`);\n    const text = await response.text();\n\n    const doc = new DOMParser().parseFromString(text, 'text/html');\n\n    const author = doc.querySelector('a[href^=\"?link=profil&id=\"]')?.textContent;\n    const authorPath = doc.querySelector('a[href^=\"?link=profil&id=\"]')?.getAttribute?.('href');\n\n    const artist = doc.querySelector(\n        '#tablebg > tbody > tr:nth-child(3) > td > table:nth-child(2) > tbody > tr.list_head > td:nth-child(1)',\n    )?.textContent;\n    const title = doc.querySelector(\n        '#tablebg > tbody > tr:nth-child(3) > td > table:nth-child(2) > tbody > tr.list_head > td:nth-child(2)',\n    )?.textContent;\n\n    window.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(artist + ' ' + title)}`, '_blank');\n    window.open(`http://usdb.animux.de/index.php?link=gettxt&id=${obj.searchParams.get('id')}`, '_blank');\n\n    return {\n        authorUrl: authorPath ? 'http://usdb.animux.de/index.php' + authorPath : '',\n        author: author ?? '',\n        video: '',\n    };\n}\n","import { Box, FormControlLabel, Switch, TextField } from '@mui/material';\nimport { AuthorAndVidEntity } from 'Scenes/Convert/Steps/AuthorAndVid';\nimport importUltrastarEsSong from 'Scenes/Convert/importUltrastarEsSong';\nimport { ChangeEventHandler } from 'react';\nimport createPersistedState from 'use-persisted-state';\n\nexport interface BasicDataEntity {\n    sourceUrl: string;\n    txtInput: string;\n}\n\ninterface Props {\n    shouldAutoImport: boolean;\n    onAutoImport: (data: AuthorAndVidEntity) => void;\n    onChange: (data: BasicDataEntity) => void;\n    data: BasicDataEntity;\n    isTxtRequired: boolean;\n}\n\nconst useFixDiacritics = createPersistedState<boolean>('editSongFixDiacritics', sessionStorage);\n\nexport default function BasicData(props: Props) {\n    const onSourceUrlEdit: ChangeEventHandler<HTMLInputElement> = async (e) => {\n        props.onChange({ ...props.data, sourceUrl: e.target.value });\n        if (props.shouldAutoImport) {\n            const data = await importUltrastarEsSong(e.target.value);\n\n            if (data) props.onAutoImport(data);\n        }\n    };\n\n    const [attemptFixDiacritics, setAttemptFixDiacritics] = useFixDiacritics(true);\n\n    return (\n        <Box sx={{ display: 'flex', flexWrap: 'wrap' }} data-test=\"basic-data\">\n            {props.isTxtRequired && (\n                <div>\n                    <h4>Where to find songs?</h4>\n                    <p>\n                        Any UltraStar compatible .txt file will do. You can find many already made songs on{' '}\n                        <a href=\"https://usdb.animux.de/\" target=\"_blank\" rel=\"noreferrer\">\n                            usdb.animux.de\n                        </a>\n                        {' or '}\n                        <a href=\"https://ultrastar-es.org/en\" target=\"_blank\" rel=\"noreferrer\">\n                            ultrastar-es.org\n                        </a>\n                        .<br />\n                        <br />\n                    </p>\n                    <p>\n                        You don't need audio/video files, you'll be able to search for appropriate YouTube video and\n                        synchronise the lyrics to it in subsequent steps.\n                    </p>\n                </div>\n            )}\n            <TextField\n                sx={{ mt: 2 }}\n                value={props.data.sourceUrl}\n                onChange={onSourceUrlEdit}\n                label=\"Source URL (optional)\"\n                fullWidth\n                size=\"small\"\n                data-test=\"source-url\"\n                helperText=\"The link to the page from which the .TXT file was downloaded.\"\n            />\n            {props.isTxtRequired && (\n                <>\n                    <TextField\n                        required\n                        sx={{ mt: 2 }}\n                        fullWidth\n                        size=\"small\"\n                        multiline\n                        label=\"Song's UltraStar .TXT file contents\"\n                        onChange={(e) =>\n                            props.onChange({\n                                ...props.data,\n                                txtInput: attemptFixDiacritics ? fixDiacritics(e.target.value) : e.target.value,\n                            })\n                        }\n                        value={props.data.txtInput}\n                        maxRows={15}\n                        minRows={15}\n                        InputProps={{\n                            inputProps: {\n                                'data-test': 'input-txt',\n                            },\n                        }}\n                    />\n                    <FormControlLabel\n                        checked={attemptFixDiacritics}\n                        control={<Switch />}\n                        label=\"Fix polish diacritic characters\"\n                        onChange={(_, checked) => setAttemptFixDiacritics(checked)}\n                    />\n                </>\n            )}\n        </Box>\n    );\n}\n\nfunction fixDiacritics(txt: string): string {\n    return txt\n        .replaceAll('', '')\n        .replaceAll('', \"'\")\n        .replaceAll('', \"'\")\n\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '')\n        .replaceAll('', '');\n}\n","import { Button, Tooltip } from '@mui/material';\nimport { Pre } from 'Scenes/Convert/Elements';\nimport GameState from 'Scenes/Game/Singing/GameState/GameState';\nimport { PlayerRef } from 'Scenes/Game/Singing/Player';\nimport { seconds } from 'interfaces';\nimport { YouTubePlayer } from 'react-youtube';\n\nconst formatMs = (msec: number) => {\n    const minutes = Math.floor(msec / 1000 / 60);\n    const seconds = Math.floor(msec / 1000) - minutes * 60;\n    const miliseconds = Math.floor(msec % 1000);\n\n    return (\n        <Pre>\n            {String(minutes).padStart(2, '0')}:{String(seconds).padStart(2, '0')}.{String(miliseconds).padStart(3, '0')}\n        </Pre>\n    );\n};\n\nconst ytPlayerAdapter = (player: PlayerRef | YouTubePlayer): PlayerRef => {\n    if ('playVideo' in player) {\n        return {\n            play: () => player.playVideo(),\n            pause: () => player.pauseVideo(),\n            seekTo: (timeSec: seconds) => player.seekTo(timeSec, true),\n            setPlaybackSpeed: (rate) => player.setPlaybackRate(rate),\n        };\n    }\n\n    return player;\n};\n\nexport const msec = (ms: number | undefined, player?: PlayerRef | YouTubePlayer | null) => (\n    <Tooltip title=\"Click to play the moment just before this time\" placement={'top'} arrow>\n        <Button\n            sx={{ py: 0.15, mb: 0.5 }}\n            variant={'contained'}\n            size=\"small\"\n            disabled={!player}\n            onClick={\n                player\n                    ? () => {\n                          GameState.resetPlayerNotes();\n                          ytPlayerAdapter(player).seekTo((ms ?? 0) / 1000 - 0.7);\n                      }\n                    : undefined\n            }>\n            {formatMs(ms ?? 0)}\n        </Button>\n    </Tooltip>\n);\n\nexport default formatMs;\n","import { Box, Slider } from '@mui/material';\nimport { SongMetadataEntity } from 'Scenes/Convert/Steps/SongMetadata';\nimport { msec } from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/formatMs';\nimport backgroundMusic from 'assets/Funk Cool Groove (No Copyright Music) By Anwar Amr.mp3';\nimport { useEffect, useRef, useState } from 'react';\nimport YouTube from 'react-youtube';\n\ninterface Props {\n    onChange: (data: SongMetadataEntity) => void;\n    data: SongMetadataEntity;\n    videoId: string;\n    videoGap?: number;\n}\n\nconst MIN_PREVIEW_LENGTH = 10;\n\nexport default function PreviewAndVolumeAdjustment({ data, onChange, videoId, videoGap = 0 }: Props) {\n    const player = useRef<YouTube | null>(null);\n    const reference = useRef<HTMLAudioElement | null>(null);\n\n    const [initialised, setInitialised] = useState(false);\n    useEffect(() => {\n        (async () => {\n            if (data.volume === 0) {\n                onChange({ ...data, volume: 0.5 });\n                await player.current?.getInternalPlayer()?.setVolume(50);\n            } else {\n                await player.current?.getInternalPlayer()?.setVolume(data.volume * 100);\n            }\n            setInitialised(true);\n        })();\n    }, []);\n\n    useEffect(() => {\n        if (!initialised) {\n            return;\n        }\n        const interval = setInterval(async () => {\n            const currentVolume = await player.current?.getInternalPlayer()?.getVolume();\n            if (currentVolume !== undefined && currentVolume !== data.volume * 100) {\n                onChange({ ...data, volume: currentVolume / 100 });\n            }\n        }, 500);\n\n        return () => {\n            clearInterval(interval);\n        };\n    }, [initialised, data, onChange]);\n\n    const [isPlayerPlaying, setIsPlayerPlaying] = useState(false);\n    const [isReferencePlaying, setIsReferencePlaying] = useState(false);\n\n    const handleSliderChange = async (e: any, value: number | number[]) => {\n        await player.current?.getInternalPlayer()?.setVolume(+value * 100);\n        onChange({ ...data, volume: +value });\n    };\n\n    const previewStart = data.previewStart ?? videoGap + 60;\n    const previewEnd = data.previewEnd ?? previewStart + 30;\n    const [duration, setDuration] = useState<number | null>(null);\n    useEffect(() => {\n        player.current?.getInternalPlayer()?.getDuration().then(setDuration);\n    }, []);\n\n    const internalPlayer = player.current?.getInternalPlayer();\n\n    return (\n        <Box sx={{ display: 'flex', flexDirection: 'column', width: '100%' }}>\n            <h3>\n                Set song preview (start: {msec(previewStart * 1000, internalPlayer)}, end:{' '}\n                {msec(previewEnd * 1000, internalPlayer)})\n            </h3>\n            <Box sx={{ display: 'flex', gap: 5 }}>\n                <Slider\n                    data-test=\"song-preview\"\n                    disabled={duration === null}\n                    step={1}\n                    value={[previewStart, previewEnd]}\n                    max={(duration ?? 500) - MIN_PREVIEW_LENGTH}\n                    onChange={(e, value) => {\n                        const [start, end] = value as number[];\n                        if (end - start > MIN_PREVIEW_LENGTH) {\n                            onChange({\n                                ...data,\n                                previewStart: start,\n                                previewEnd: end,\n                            });\n                        }\n                    }}\n                />\n            </Box>\n\n            <h3>Adjust volume</h3>\n            <Box sx={{ display: 'flex', gap: 5 }}>\n                <Box>\n                    <h4>Song</h4>\n                    <YouTube\n                        videoId={videoId}\n                        ref={player}\n                        onPlay={() => {\n                            setIsPlayerPlaying(true);\n\n                            if (isReferencePlaying) {\n                                reference.current?.pause();\n                                setTimeout(() => setIsReferencePlaying(true), 200);\n                            }\n                        }}\n                        onPause={() => {\n                            setIsReferencePlaying(false);\n                        }}\n                    />\n                </Box>\n                <Box>\n                    <h4>Reference sound</h4>\n                    <p>Use the slider below to make the video volume roughly the same as this music.</p>\n                    <br />\n                    <audio\n                        ref={reference}\n                        controls\n                        src={backgroundMusic}\n                        loop\n                        onPlay={(e) => {\n                            e.currentTarget.volume = 0.5;\n                            setIsReferencePlaying(true);\n                            if (isPlayerPlaying) {\n                                player.current?.getInternalPlayer()?.pauseVideo();\n                                setTimeout(() => setIsPlayerPlaying(true), 200);\n                            }\n                        }}\n                        onPause={() => {\n                            setIsReferencePlaying(false);\n                            if (isPlayerPlaying) {\n                                player.current?.getInternalPlayer()?.playVideo();\n                            }\n                        }}\n                    />\n                </Box>\n            </Box>\n            <h4>Final Song Volume ({data.volume * 100})</h4>\n            <Box>\n                <Slider\n                    data-test=\"volume\"\n                    min={0.1}\n                    max={1}\n                    step={0.01}\n                    aria-label=\"Volume\"\n                    value={data.volume}\n                    onChange={handleSliderChange}\n                />\n            </Box>\n        </Box>\n    );\n}\n","import { Autocomplete, Grid, TextField } from '@mui/material';\nimport { inputAction } from 'Scenes/Convert/Elements';\nimport PreviewAndVolumeAdjustment from 'Scenes/Convert/Steps/PreviewAndVolumeAdjustment';\nimport useSongIndex from 'Songs/hooks/useSongIndex';\nimport { useMemo } from 'react';\n\nexport interface SongMetadataEntity {\n    artist: string;\n    title: string;\n    year: string;\n    realBpm: string;\n    language: string | string[];\n    volume: number;\n    previewStart: number | undefined;\n    previewEnd: number | undefined;\n    genre?: string;\n}\n\ninterface Props {\n    onChange: (data: SongMetadataEntity) => void;\n    data: SongMetadataEntity;\n    songTitle?: string;\n    songArtist?: string;\n    videoId: string;\n    videoGap?: number;\n}\n\nexport default function SongMetadata(props: Props) {\n    const songList = useSongIndex(true);\n\n    const definedLanguages = useMemo(\n        () => [\n            ...new Set(\n                songList.data\n                    .map(({ language }) => (Array.isArray(language) ? language : [language]))\n                    .flat()\n                    .filter(Boolean),\n            ),\n        ],\n        [songList.data],\n    );\n    const definedGenres = useMemo(\n        () => [\n            ...new Set(\n                songList.data\n                    .map((song) => song.genre)\n                    .filter(Boolean)\n                    .map((genre) => genre!.toLowerCase().replace(/\\b\\w/g, (l) => l.toUpperCase().trim())),\n            ),\n        ],\n        [songList.data],\n    );\n\n    const searchGoogle = (phrase: string) => {\n        window.open(\n            `https://www.google.com/search?q=${encodeURIComponent(`${props.songArtist} ${props.songTitle} ${phrase}`)}`,\n            '_blank',\n        );\n    };\n    const isSearchableForVideo = !!props.songTitle && !!props.songArtist;\n\n    return (\n        <Grid container spacing={2} sx={{ mt: 6 }}>\n            <Grid item xs={6}>\n                <TextField\n                    value={props.data.artist}\n                    onChange={(e) => props.onChange({ ...props.data, artist: e.target.value })}\n                    label=\"Song artist\"\n                    size=\"small\"\n                    data-test=\"song-artist\"\n                    required\n                    fullWidth\n                />\n            </Grid>\n            <Grid item xs={6}>\n                <TextField\n                    value={props.data.title}\n                    onChange={(e) => props.onChange({ ...props.data, title: e.target.value })}\n                    label=\"Song title\"\n                    fullWidth\n                    size=\"small\"\n                    required\n                    data-test=\"song-title\"\n                />\n            </Grid>\n            <Grid item xs={6}>\n                <Autocomplete\n                    onKeyDown={(event) => {\n                        if (event.key === 'Enter') {\n                            event.preventDefault();\n                        }\n                    }}\n                    freeSolo\n                    disableClearable\n                    options={definedGenres}\n                    value={props.data.genre ?? ''}\n                    onChange={(e, newValue) => props.onChange({ ...props.data, genre: newValue })}\n                    renderInput={(params) => (\n                        <TextField\n                            {...params}\n                            onBlur={(e) => props.onChange({ ...props.data, genre: e.target.value })}\n                            label=\"Song genre (optional)\"\n                            size=\"small\"\n                            data-test=\"song-genre\"\n                            fullWidth\n                        />\n                    )}\n                />\n            </Grid>\n            <Grid item xs={6}>\n                <Autocomplete\n                    onKeyDown={(event) => {\n                        if (event.key === 'Enter') {\n                            event.preventDefault();\n                        }\n                    }}\n                    multiple\n                    freeSolo\n                    disableClearable\n                    options={definedLanguages}\n                    value={typeof props.data.language === 'string' ? [props.data.language] : props.data.language}\n                    onChange={(e, newValue) => {\n                        props.onChange({\n                            ...props.data,\n                            language: newValue ? (newValue.filter(Boolean) as string[]) : props.data.language,\n                        });\n                    }}\n                    renderInput={(params) => (\n                        <TextField\n                            {...params}\n                            label=\"Song language\"\n                            fullWidth\n                            size=\"small\"\n                            required={!props.data.language?.length}\n                            data-test=\"song-language\"\n                        />\n                    )}\n                />\n            </Grid>\n            <Grid item xs={6}>\n                <TextField\n                    data-test=\"release-year\"\n                    value={props.data.year}\n                    onChange={(e) => props.onChange({ ...props.data, year: e.target.value })}\n                    label=\"Release year\"\n                    helperText=\"The year the song was released. Click the 'Lookup' button to look for it on Google\"\n                    fullWidth\n                    size=\"small\"\n                    required\n                    {...inputAction(() => searchGoogle('release year'), isSearchableForVideo)}\n                />\n            </Grid>\n            <Grid item xs={6}>\n                <TextField\n                    data-test=\"song-bpm\"\n                    value={props.data.realBpm}\n                    onChange={(e) => props.onChange({ ...props.data, realBpm: e.target.value })}\n                    label=\"Song (real) BPM\"\n                    helperText=\"The actual tempo of the song. Click the 'Lookup' button to look for it on Google\"\n                    fullWidth\n                    type=\"number\"\n                    size=\"small\"\n                    required\n                    {...inputAction(() => searchGoogle('tempo'), isSearchableForVideo)}\n                />\n            </Grid>\n            <Grid item xs={12}></Grid>\n            <Grid item xs={12}>\n                <PreviewAndVolumeAdjustment {...props} />\n            </Grid>\n        </Grid>\n    );\n}\n","import { Box, Button, ButtonGroup, Divider, Typography } from '@mui/material';\nimport { useState } from 'react';\nimport { Pre } from 'Scenes/Convert/Elements';\nimport formatMs from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/formatMs';\nimport { PlayerRef } from 'Scenes/Game/Singing/Player';\n\ninterface Props {\n    player: PlayerRef;\n    currentTime: number;\n    effectsEnabled: boolean;\n    onEffectsToggle: () => void;\n}\n\nexport default function AdjustPlayback({ player, currentTime, effectsEnabled, onEffectsToggle }: Props) {\n    const seekBy = (bySec: number) => player.seekTo((currentTime + bySec) / 1000);\n    const [currentSpeed, setCurrentSpeed] = useState(1);\n\n    return (\n        <>\n            <Box sx={{ mb: 2 }}>\n                <Typography variant={'h6'} data-test=\"current-time\">\n                    Current time: {formatMs(currentTime)} (<Pre>{Math.round(currentTime)}</Pre> ms)\n                </Typography>\n                <Box sx={{ display: 'flex', gap: 1 }}>\n                    <ButtonGroup variant=\"contained\" sx={{ display: 'flex', mt: 1, flex: 1 }}>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(-10_000)} data-test=\"seek-10s\">\n                            -10\n                        </Button>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(-5_000)} data-test=\"seek-5s\">\n                            -5\n                        </Button>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(-1_000)} data-test=\"seek-1s\">\n                            -1\n                        </Button>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(-500)} data-test=\"seek-0.5s\">\n                            -0.5\n                        </Button>\n                    </ButtonGroup>\n                    <Divider />\n                    <ButtonGroup variant=\"contained\" sx={{ display: 'flex', mt: 1, flex: 1 }}>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(+500)} data-test=\"seek+0.5s\">\n                            +0.5\n                        </Button>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(+1_000)} data-test=\"seek+1s\">\n                            +1\n                        </Button>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(+5_000)} data-test=\"seek+5s\">\n                            +5\n                        </Button>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(+10_000)} data-test=\"seek+10s\">\n                            +10\n                        </Button>\n                    </ButtonGroup>\n                </Box>\n            </Box>\n            <Box sx={{ mb: 2 }}>\n                <Typography variant={'h6'}>\n                    Playback speed: <Pre data-test=\"current-speed\">{currentSpeed * 100}%</Pre>\n                </Typography>\n                <ButtonGroup variant=\"contained\" sx={{ display: 'flex', mt: 1 }}>\n                    {[0.25, 0.5, 0.75, 1, 1.25, 1.5, 2].map((speed) => (\n                        <Button\n                            data-test={`speed-${speed}`}\n                            key={speed}\n                            sx={{ flex: 1 }}\n                            onClick={() => {\n                                setCurrentSpeed(speed);\n                                player.setPlaybackSpeed(speed);\n                            }}\n                            disabled={currentSpeed === speed}>\n                            {speed * 100}%\n                        </Button>\n                    ))}\n                </ButtonGroup>\n            </Box>\n        </>\n    );\n}\n","import { Section } from 'interfaces';\nimport { useMemo } from 'react';\n\nexport default function useCurrentSectionIndex(sections: Section[], currentBeat: number) {\n    const wholeBeat = Math.floor(currentBeat);\n    return useMemo(\n        () =>\n            sections.findIndex((section, index) => {\n                if (wholeBeat < 0) return true;\n                if (wholeBeat < section.start) return false;\n                if (index === sections.length - 1) return true;\n                if (sections[index + 1].start > wholeBeat) {\n                    return true;\n                }\n                return false;\n            }),\n        [wholeBeat, sections],\n    );\n}\n","import styled from '@emotion/styled';\nimport {\n    Box,\n    Button,\n    ButtonGroup,\n    List,\n    ListItem,\n    ListItemButton,\n    ListItemText,\n    Stack,\n    TextField,\n    Typography,\n} from '@mui/material';\nimport { msec } from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/formatMs';\nimport GameState from 'Scenes/Game/Singing/GameState/GameState';\nimport getCurrentBeat from 'Scenes/Game/Singing/GameState/Helpers/getCurrentBeat';\nimport useCurrentSectionIndex from 'Scenes/Game/Singing/Hooks/useCurrentSectionIndex';\nimport { PlayerRef } from 'Scenes/Game/Singing/Player';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { getFirstNoteStartFromSections } from 'Songs/utils/notesSelectors';\nimport { Song } from 'interfaces';\nimport { useEffect, useState } from 'react';\n\ninterface Props {\n    song: Song;\n    currentTime: number;\n    beatLength: number;\n    player: PlayerRef;\n    onRecordChange: (changeRecords: ChangeRecord[]) => void;\n    onTrackNameChange: (track: number, newName: string) => void;\n}\n\ninterface ChangeRecordBase {\n    track: number;\n    section: number;\n}\n\ninterface ChangeRecordShift extends ChangeRecordBase {\n    track: number;\n    section: number;\n    type: 'shift';\n    shift: number;\n}\n\ninterface ChangeRecordDelete extends ChangeRecordBase {\n    track: number;\n    section: number;\n    type: 'delete';\n}\n\nexport type ChangeRecord = ChangeRecordDelete | ChangeRecordShift;\n\nexport default function EditSection({\n    song,\n    currentTime,\n    beatLength,\n    player,\n    onRecordChange,\n    onTrackNameChange,\n}: Props) {\n    const [track, setTrack] = useState(0);\n    const [selectedSection, setSelectedSection] = useState(-1);\n    const [changeRecords, setChangeRecords] = useState<ChangeRecord[]>([]);\n    const currentBeat = getCurrentBeat(currentTime, beatLength, song.gap);\n\n    const sections = song.tracks[track].sections.filter(isNotesSection);\n\n    const currentSectionIndex = useCurrentSectionIndex(sections, currentBeat);\n\n    const onSectionClick = (index: number) => {\n        setSelectedSection(index);\n        GameState.resetPlayerNotes();\n        player.seekTo((sections[index].start * beatLength + song.gap) / 1000);\n    };\n\n    const deleteSection = () => {\n        setChangeRecords((records) => [...records, { type: 'delete', section: selectedSection, track }]);\n        if (selectedSection === sections.length - 1) {\n            setSelectedSection((selected) => selected - 1);\n        }\n    };\n\n    const shiftSection = (newStart: number) => {\n        setChangeRecords((records) => {\n            const lastRecord = records.at(-1);\n\n            if (\n                lastRecord &&\n                lastRecord.type === 'shift' &&\n                lastRecord.track === track &&\n                lastRecord.section === selectedSection\n            ) {\n                const newRecords = [...records];\n                (newRecords.at(-1)! as ChangeRecordShift).shift = newStart;\n\n                return newRecords;\n            }\n\n            return [...records, { type: 'shift', section: selectedSection, track, shift: newStart }];\n        });\n    };\n\n    useEffect(() => {\n        onRecordChange(changeRecords);\n    }, [onRecordChange, changeRecords]);\n\n    return (\n        <SectionEdtiorContainer>\n            <Stack direction=\"row\">\n                <Typography variant={'h6'} mb={0} sx={{ flex: 1 }}>\n                    Edit verses\n                    {song.tracks.length > 1 && (\n                        <ButtonGroup variant={'contained'} sx={{ ml: 2 }} size={'small'}>\n                            {song.tracks.map((_, index) => (\n                                <Button\n                                    key={index}\n                                    onClick={() => setTrack(index)}\n                                    disabled={track === index}\n                                    data-test={`track-${index + 1}`}>\n                                    Track {index + 1}\n                                </Button>\n                            ))}\n                        </ButtonGroup>\n                    )}\n                </Typography>\n                <TextField\n                    placeholder=\"Set track name\"\n                    sx={{ flex: 1 }}\n                    size=\"small\"\n                    value={song.tracks[track]?.name ?? ''}\n                    onChange={(e) => onTrackNameChange(track, e.target.value)}\n                    data-test=\"track-name\"\n                />\n            </Stack>\n            <Stack direction=\"row\" spacing={2} sx={{ height: '400px' }}>\n                <List sx={{ overflowY: 'auto' }}>\n                    {sections.map((section, index) => (\n                        <ListItem key={section.start} disablePadding data-test={`section-${index}`}>\n                            <ListItemButton onClick={() => onSectionClick(index)} selected={selectedSection === index}>\n                                <ListItemText\n                                    primaryTypographyProps={{\n                                        fontWeight: index === currentSectionIndex ? 'bold' : 'normal',\n                                    }}\n                                    primary={\n                                        isNotesSection(section)\n                                            ? section.notes.map((note) => note.lyrics).join('')\n                                            : '[pause]'\n                                    }\n                                />\n                            </ListItemButton>\n                        </ListItem>\n                    ))}\n                </List>\n                <SectionEditForm>\n                    {selectedSection > -1 && (\n                        <>\n                            {selectedSection === 0 && (\n                                <h3 data-test={`use-gap-info`}>Use gap shift to change when this section starts</h3>\n                            )}\n                            {selectedSection > 0 && (\n                                <>\n                                    <TextField\n                                        data-test=\"change-start-beat\"\n                                        size={'small'}\n                                        type=\"number\"\n                                        onChange={(e) => shiftSection(+e.target.value)}\n                                        value={getFirstNoteStartFromSections([sections[selectedSection]])}\n                                        label=\"Change start beat\"\n                                        InputProps={{\n                                            inputProps: {\n                                                step: 1,\n                                            },\n                                        }}\n                                        fullWidth\n                                        sx={{ mb: 2 }}\n                                        helperText={\n                                            <>\n                                                Timestamp:{' '}\n                                                {msec(\n                                                    getFirstNoteStartFromSections([sections[selectedSection]]) *\n                                                        beatLength +\n                                                        song.gap,\n                                                    player,\n                                                )}\n                                            </>\n                                        }\n                                    />\n                                </>\n                            )}\n                            <Button\n                                variant=\"contained\"\n                                color={'error'}\n                                onClick={deleteSection}\n                                fullWidth\n                                data-test=\"delete-section\">\n                                Delete section\n                            </Button>\n                        </>\n                    )}\n                </SectionEditForm>\n                <SectionChangeList>\n                    <Box sx={{ overflowY: 'auto', maxHeight: '34rem' }} data-test=\"change-list\">\n                        {changeRecords.map((change, index) => {\n                            let message = '';\n                            let Component = SectionChangeDelete;\n                            if (change.type === 'delete') {\n                                Component = SectionChangeDelete;\n                                message = `Deleted`;\n                            } else if (change.type === 'shift') {\n                                Component = SectionChangeShift;\n                                message = `Start -> ${change.shift}`;\n                            }\n\n                            return (\n                                <Component key={index}>\n                                    <strong>\n                                        Track: {change.track + 1}, Section: {change.section + 1}, {message}\n                                    </strong>\n                                </Component>\n                            );\n                        })}\n                    </Box>\n                    {changeRecords.length > 0 && (\n                        <Button\n                            data-test=\"undo-change\"\n                            variant=\"contained\"\n                            color={'warning'}\n                            onClick={() =>\n                                setChangeRecords((records) =>\n                                    records.filter((_, index) => index !== records.length - 1),\n                                )\n                            }\n                            fullWidth>\n                            Undo last change\n                        </Button>\n                    )}\n                </SectionChangeList>\n            </Stack>\n        </SectionEdtiorContainer>\n    );\n}\n\nconst SectionChangeList = styled.div`\n    flex: 1;\n`;\n\nconst ChangeEntry = styled.div`\n    padding: 0.5rem;\n`;\n\nconst SectionChangeDelete = styled(ChangeEntry)`\n    color: red;\n`;\n\nconst SectionChangeShift = styled(ChangeEntry)`\n    color: #0059ff;\n`;\n\nconst Editor = styled.div`\n    display: flex;\n    flex-direction: row;\n`;\n\nconst SectionEdtiorContainer = styled.div``;\n\nconst SectionEditForm = styled.div`\n    flex: 1;\n`;\n\nconst SectionList = styled.div`\n    flex: 1;\n    overflow-y: auto;\n`;\nconst SectionListEntry = styled.div<{ active: boolean; selected: boolean }>`\n    font-weight: ${(props) => (props.active ? 'bold' : 'normal')};\n\n    border: 0.1rem solid;\n    border-color: ${(props) => (props.selected ? 'black' : 'white')};\n\n    padding: 1rem;\n`;\n","import { Song } from 'interfaces';\nimport { PlayerRef } from 'Scenes/Game/Singing/Player';\n\ninterface Props {\n    player: PlayerRef;\n    song: Song;\n    beatLength: number;\n}\n\nexport default function ListTracks({ song, player, beatLength }: Props) {\n    return (\n        <>\n            {/*{song.tracks.map(({ sections }, index) => {*/}\n            {/*    const notesSections = sections.filter(isNotesSection);*/}\n            {/*    const firstNote = notesSections[0].notes[0];*/}\n\n            {/*    const lastNote = notesSections.at(-1)?.notes.at(-1);*/}\n\n            {/*    if (!firstNote || !lastNote || !beatLength) return null;*/}\n\n            {/*    return (*/}\n            {/*        <EditorRow key={index}>*/}\n            {/*            <strong>Track #{index + 1} - </strong>*/}\n            {/*            Start: {msec(firstNote.start * beatLength + song.gap, player)}, end:{' '}*/}\n            {/*            {msec(lastNote.start * beatLength + song.gap, player)}*/}\n            {/*        </EditorRow>*/}\n            {/*    );*/}\n            {/*})}*/}\n        </>\n    );\n}\n","import { Song } from 'interfaces';\nimport isNotesSection from 'Songs/utils/isNotesSection';\n\nexport default function calculateProperBPM(desiredEndMs: number, song: Song) {\n    const notesSections = song.tracks[0].sections.filter(isNotesSection);\n\n    const lastNote = notesSections.at(-1)?.notes.at(-1)!;\n\n    const desiredLengthMs = desiredEndMs - song.gap;\n    const bpmLength = lastNote.start + lastNote.length;\n\n    return Number((60_000 / ((desiredLengthMs / bpmLength) * song.bar)).toFixed(2));\n}\n","import { Song, SongPreview } from 'interfaces';\nimport getSongBeatLength from 'Songs/utils/getSongBeatLength';\n\nexport default function beatToMs(beat: number, song: Song | SongPreview): number {\n    return getSongBeatLength(song) * beat;\n}\n","import { Box, TextField } from '@mui/material';\nimport { Pre } from 'Scenes/Convert/Elements';\nimport calculateProperBPM from 'Scenes/Convert/calculateProperBpm';\nimport beatToMs from 'Scenes/Game/Singing/GameState/Helpers/beatToMs';\nimport { PlayerRef } from 'Scenes/Game/Singing/Player';\nimport { getLastNoteEndFromSections } from 'Songs/utils/notesSelectors';\nimport { Song } from 'interfaces';\nimport { useState } from 'react';\n\ninterface Props {\n    onChange: (bpm: number) => void;\n    current: number;\n    player: PlayerRef;\n    song: Song;\n}\n\nexport default function ManipulateBpm({ current, onChange, player, song }: Props) {\n    const lastNoteEndBeat = Math.max(...song.tracks.map((track) => getLastNoteEndFromSections(track.sections)));\n    const lastNoteEndMs = beatToMs(lastNoteEndBeat, song) + song.gap;\n    const [desiredLastNoteEnd, setDesiredLastNoteEnd] = useState<number>(Math.round(lastNoteEndMs));\n\n    return (\n        <Box sx={{ display: 'flex', gap: 2, mb: 2 }}>\n            <TextField\n                data-test=\"desired-end\"\n                size={'small'}\n                type=\"number\"\n                value={desiredLastNoteEnd}\n                onChange={(e) => setDesiredLastNoteEnd(+e.target.value)}\n                label=\"Desired last note end time (in milliseconds)\"\n                sx={{ flex: 1 }}\n                helperText={\n                    !!desiredLastNoteEnd ? (\n                        <>\n                            Est. proper Tempo (BPM):{' '}\n                            <Pre data-test=\"desired-bpm\">{calculateProperBPM(desiredLastNoteEnd, song)}</Pre>\n                        </>\n                    ) : (\n                        ' '\n                    )\n                }\n            />\n            <TextField\n                data-test=\"change-bpm\"\n                size={'small'}\n                type=\"number\"\n                value={current}\n                onChange={(e) => onChange(+e.target.value)}\n                label=\"Tempo (BPM) of the lyrics\"\n                sx={{ flex: 0.5 }}\n                helperText={' '}\n                InputProps={{\n                    inputProps: {\n                        step: '0.1',\n                    },\n                }}\n            />\n        </Box>\n    );\n}\n","import { Box, Button, ButtonGroup, TextField, Typography } from '@mui/material';\nimport { msec } from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/formatMs';\nimport { PlayerRef } from 'Scenes/Game/Singing/Player';\n\ninterface Props {\n    onChange: (shift: number) => void;\n    current: number;\n    player: PlayerRef;\n    finalGap: number;\n}\n\nexport default function ShiftGap({ current, onChange, player, finalGap }: Props) {\n    return (\n        <Box sx={{ flex: 1 }}>\n            <Typography variant={'h6'}>Gap shift (final: {msec(finalGap, player)})</Typography>\n            <Box sx={{ display: 'flex', gap: 1, mt: 1 }}>\n                <ButtonGroup sx={{ flex: 1 }}>\n                    <Button sx={{ flex: 1, px: 1 }} onClick={() => onChange(current - 1000)} data-test=\"shift-gap-1s\">\n                        -1000\n                    </Button>\n                    <Button sx={{ flex: 1, px: 1 }} onClick={() => onChange(current - 500)} data-test=\"shift-gap-0.5s\">\n                        -500\n                    </Button>\n                    <Button sx={{ flex: 1, px: 1 }} onClick={() => onChange(current - 50)} data-test=\"shift-gap-0.05s\">\n                        -50\n                    </Button>\n                </ButtonGroup>\n                <TextField\n                    sx={{ py: 0, flex: 1 }}\n                    size={'small'}\n                    type=\"text\"\n                    value={current}\n                    onChange={(e) => onChange(+e.target.value)}\n                    label=\"Miliseconds\"\n                    data-test=\"shift-gap\"\n                />\n                <ButtonGroup sx={{ flex: 1 }}>\n                    <Button sx={{ flex: 1, px: 1 }} onClick={() => onChange(current + 50)} data-test=\"shift-gap+0.05s\">\n                        +50\n                    </Button>\n                    <Button sx={{ flex: 1, px: 1 }} onClick={() => onChange(current + 500)} data-test=\"shift-gap+0.5s\">\n                        +500\n                    </Button>\n                    <Button sx={{ flex: 1, px: 1 }} onClick={() => onChange(current + 1000)} data-test=\"shift-gap+1s\">\n                        +1000\n                    </Button>\n                </ButtonGroup>\n            </Box>\n        </Box>\n    );\n}\n","import { Box, Button, ButtonGroup, TextField, Typography } from '@mui/material';\nimport { msec } from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/formatMs';\nimport { PlayerRef } from 'Scenes/Game/Singing/Player';\nimport { seconds } from 'interfaces';\n\ninterface Props {\n    onChange: (shift: seconds) => void;\n    current: seconds;\n    player: PlayerRef;\n    finalGap: number | undefined;\n}\n\nexport default function ShiftVideoGap({ current, onChange, player, finalGap }: Props) {\n    return (\n        <Box sx={{ flex: 1 }}>\n            <Typography variant={'h6'}>Video Gap shift (final: {msec((finalGap ?? 0) * 1000, player)})</Typography>\n            <Box sx={{ display: 'flex', gap: 1, mt: 1 }}>\n                <ButtonGroup sx={{ flex: 1 }}>\n                    <Button\n                        sx={{ flex: 1, px: 1.25 }}\n                        onClick={() => onChange(current - 10)}\n                        data-test=\"shift-video-gap-10s\">\n                        -10\n                    </Button>\n                    <Button\n                        sx={{ flex: 1, px: 1.25 }}\n                        onClick={() => onChange(current - 5)}\n                        data-test=\"shift-video-gap-5s\">\n                        -5\n                    </Button>\n                    <Button\n                        sx={{ flex: 1, px: 1.25 }}\n                        onClick={() => onChange(current - 1)}\n                        data-test=\"shift-video-gap-1s\">\n                        -1\n                    </Button>\n                </ButtonGroup>\n                <TextField\n                    data-test=\"shift-video-gap\"\n                    sx={{ py: 0, flex: 1 }}\n                    size={'small'}\n                    type=\"text\"\n                    value={current}\n                    onChange={(e) => onChange(+e.target.value)}\n                    label=\"Seconds\"\n                    // helperText={}\n                />\n                <ButtonGroup sx={{ flex: 1 }}>\n                    <Button\n                        sx={{ flex: 1, px: 1.25 }}\n                        onClick={() => onChange(current + 1)}\n                        data-test=\"shift-video-gap+1s\">\n                        +1\n                    </Button>\n                    <Button\n                        sx={{ flex: 1, px: 1.25 }}\n                        onClick={() => onChange(current + 5)}\n                        data-test=\"shift-video-gap+5s\">\n                        +5\n                    </Button>\n                    <Button\n                        sx={{ flex: 1, px: 1.25 }}\n                        onClick={() => onChange(current + 10)}\n                        data-test=\"shift-video-gap+10s\">\n                        +10\n                    </Button>\n                </ButtonGroup>\n            </Box>\n        </Box>\n    );\n}\n","import { NotesSection, Section, Song } from 'interfaces';\nimport getSongBeatLength from 'Songs/utils/getSongBeatLength';\nimport isNotesSection from 'Songs/utils/isNotesSection';\n\nexport const HEADSTART_MS = 1000;\n\nconst shortenNoteSections = (sections: NotesSection[]): NotesSection[] =>\n    sections.map((section) => {\n        if (section.notes.length === 0) {\n            debugger;\n        }\n        return {\n            ...section,\n            start: section.notes[0].start,\n        };\n    });\n\nconst getSectionEnd = (section: NotesSection) => {\n    const lastNote = section.notes.at(-1)!;\n    return lastNote.start + lastNote.length;\n};\n\nconst addPauseSections = (sections: NotesSection[], padSizeBeats = 10): Section[] => {\n    let lastEnd = 0;\n    let sectionsWithPauses: Section[] = [];\n\n    sections.forEach((section) => {\n        const spaceBetweenSections = section.start - lastEnd;\n\n        if (spaceBetweenSections > padSizeBeats) {\n            sectionsWithPauses.push({ type: 'pause', start: lastEnd, end: section.start - padSizeBeats });\n            lastEnd = section.start - padSizeBeats;\n        }\n        sectionsWithPauses.push({ ...section, start: lastEnd });\n        lastEnd = getSectionEnd(section);\n    });\n\n    return sectionsWithPauses;\n};\n\n// Triest its best to add enough headstart to sections so the player can see the lyrics and notes\n// in advance. If possible, will also make the section a bit longer so it doesn't end abruptly\nexport default function normaliseSectionPaddings(song: Song): Song {\n    const beatLength = getSongBeatLength(song);\n    const desiredPadding = Math.round(HEADSTART_MS / beatLength);\n    // const minPadding = Math.round(MIN_HEADSTART_MS / beatLength);\n\n    return {\n        ...song,\n        tracks: song.tracks.map((track) => ({\n            ...track,\n            sections: addPauseSections(shortenNoteSections(track.sections.filter(isNotesSection)), desiredPadding),\n        })),\n    };\n}\n","import { Section, Song } from 'interfaces';\nimport { HEADSTART_MS } from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseSectionPaddings';\nimport getSongBeatLength from 'Songs/utils/getSongBeatLength';\nimport isNotesSection from 'Songs/utils/isNotesSection';\n\nconst shiftSections = (sections: Section[], shiftBeats: number): Section[] =>\n    sections.map((section, index) => {\n        if (isNotesSection(section)) {\n            return {\n                ...section,\n                start: index === 0 ? 0 : Math.max(0, section.start + shiftBeats), // first section might be 0\n                notes: section.notes.map((note) => ({ ...note, start: note.start + shiftBeats })),\n            };\n        } else {\n            return {\n                ...section,\n                start: Math.max(0, section.start + shiftBeats), // first section might be 0\n                end: Math.max(0, section.end + shiftBeats), // first section might be 0\n            };\n        }\n    });\n\nexport default function addHeadstart(song: Song): Song {\n    const beatLength = getSongBeatLength(song);\n    const desiredHeadstart = Math.round(HEADSTART_MS / beatLength);\n    const actualHeadstart = Math.floor(\n        (song.gap - desiredHeadstart * beatLength < 0 ? song.gap : desiredHeadstart * beatLength) / beatLength,\n    );\n\n    const gap = song.gap - actualHeadstart * beatLength;\n\n    return {\n        ...song,\n        gap,\n        tracks: song.tracks.map((track) => ({ ...track, sections: shiftSections(track.sections, actualHeadstart) })),\n    };\n}\n","import { Section, Song } from 'interfaces';\nimport getSongBeatLength from 'Songs/utils/getSongBeatLength';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { getFirstNoteStartFromSections } from 'Songs/utils/notesSelectors';\n\nconst shiftSections = (sections: Section[], shiftBeats: number): Section[] =>\n    sections\n        .map((section, index) => {\n            if (isNotesSection(section)) {\n                return {\n                    ...section,\n                    start: index === 0 ? 0 : Math.max(0, section.start - shiftBeats), // first section might be 0\n                    notes: section.notes.map((note) => ({ ...note, start: note.start - shiftBeats })),\n                };\n            } else {\n                return {\n                    ...section,\n                    start: Math.max(0, section.start - shiftBeats), // first section might be 0\n                    end: Math.max(0, section.end - shiftBeats), // first section might be 0\n                };\n            }\n        })\n        .filter((section) => isNotesSection(section) || section.start - section.end > 0); // clear empty pause sections\n\nexport default function normaliseGap(song: Song): Song {\n    const beatLength = getSongBeatLength(song);\n\n    const earliestTrack = song.tracks.reduce((current, track, index) => {\n        const currentNoteStart = getFirstNoteStartFromSections(song.tracks[current].sections);\n        const thisNoteStart = getFirstNoteStartFromSections(track.sections);\n        return currentNoteStart > thisNoteStart ? index : current;\n    }, 0);\n\n    const firstSection = song.tracks[earliestTrack].sections.find(isNotesSection);\n\n    if (!firstSection) {\n        console.error('There are no notes sections in the song, wat', song.tracks);\n        return song;\n    }\n\n    const shiftBeats = firstSection.start + (firstSection.notes[0].start - firstSection.start);\n\n    const gap = Math.floor(song.gap + shiftBeats * beatLength);\n\n    return {\n        ...song,\n        gap,\n        tracks: song.tracks.map((track) => ({ ...track, sections: shiftSections(track.sections, shiftBeats) })),\n    };\n}\n","import { Note, Song } from 'interfaces';\nimport isNotesSection from 'Songs/utils/isNotesSection';\n\nconst normaliseSpaces = (notes: Note[]): Note[] => {\n    notes.forEach((note, index) => {\n        if (note.lyrics.startsWith(' ')) {\n            note.lyrics = note.lyrics.trim();\n\n            if (index > 0) {\n                notes[index - 1].lyrics = notes[index - 1].lyrics + ' ';\n            }\n        }\n    });\n\n    return notes;\n};\n\nexport default function normaliseLyricSpaces(song: Song) {\n    return {\n        ...song,\n        tracks: song.tracks.map((track) => ({\n            ...track,\n            sections: track.sections.map((section) =>\n                isNotesSection(section)\n                    ? {\n                          ...section,\n                          notes: normaliseSpaces(section.notes),\n                      }\n                    : section,\n            ),\n        })),\n    };\n}\n","import { MutableRefObject, useEffect } from 'react';\nimport YouTube from 'react-youtube';\n\nexport default function usePlayerVolume(playerRef: MutableRefObject<YouTube | null>, volume: number | undefined) {\n    useEffect(() => {\n        playerRef.current?.getInternalPlayer()?.setVolume(Math.round((volume ?? 0.5) * 100));\n    }, [playerRef, volume]);\n}\n","import { MutableRefObject, useEffect, useState } from 'react';\nimport YouTube from 'react-youtube';\n\n/**\n * For some reason YouTube player would start the song but not change the player state, making the game not\n * start.\n *\n * This hooks \"detects\" that and return the key prop value for <YouTube /> component - if it's UNSTARTED\n * for more than a timeout, a new key will be generated to reload the entire player (and try again).\n */\nfunction useUnstuckOnStartSong(currentStatus: number) {\n    const [playerKey, setPlayerKey] = useState(1);\n    useEffect(() => {\n        if (currentStatus === YouTube.PlayerState.UNSTARTED) {\n            const timeout = setTimeout(() => {\n                setPlayerKey((current) => current + 1);\n            }, 5000 + playerKey * 2500);\n\n            return () => {\n                clearTimeout(timeout);\n            };\n        }\n    });\n\n    return playerKey;\n}\n\n/**\n * For some reason once YouTube player enters BUFFERING state, it gets stuck even when internet is\n * back available. Seeking to some timestamp unstucks it.\n *\n * \"Fix\": If player enters BUFFERING status, wait until internet is available, then go back a couple\n * of seconds of the song to force the player to start playing\n */\nfunction useUnstuckOnBuffering(playerRef: MutableRefObject<YouTube | null>, currentStatus: number) {\n    useEffect(() => {\n        if (currentStatus === YouTube.PlayerState.BUFFERING) {\n            const interval = setInterval(async () => {\n                if (navigator.onLine) {\n                    clearInterval(interval);\n\n                    const seconds = await playerRef.current?.getInternalPlayer()!.getCurrentTime()!;\n                    playerRef.current?.getInternalPlayer()?.seekTo(Math.max(seconds - 2, 0), true);\n                }\n            }, 500);\n\n            return () => {\n                clearInterval(interval);\n            };\n        }\n    });\n}\n\nexport default function useUnstuckYouTubePlayer(playerRef: MutableRefObject<YouTube | null>, currentStatus: number) {\n    useUnstuckOnBuffering(playerRef, currentStatus);\n\n    return useUnstuckOnStartSong(currentStatus);\n}\n","import usePlayerVolume from 'hooks/usePlayerVolume';\nimport useUnstuckYouTubePlayer from 'hooks/useUnstuckYouTubePlayer';\nimport { seconds } from 'interfaces';\nimport { ForwardedRef, forwardRef, useEffect, useImperativeHandle, useRef, useState } from 'react';\nimport YouTube from 'react-youtube';\n\nexport enum VideoState {\n    UNSTARTED = 'UNSTARTED',\n    ENDED = 'ENDED',\n    PLAYING = 'PLAYING',\n    PAUSED = 'PAUSED',\n    BUFFERING = 'BUFFERING',\n    CUED = 'CUED',\n}\n\nconst stateMap = {\n    [YouTube.PlayerState.UNSTARTED]: VideoState.UNSTARTED,\n    [YouTube.PlayerState.ENDED]: VideoState.ENDED,\n    [YouTube.PlayerState.PLAYING]: VideoState.PLAYING,\n    [YouTube.PlayerState.PAUSED]: VideoState.PAUSED,\n    [YouTube.PlayerState.BUFFERING]: VideoState.BUFFERING,\n    [YouTube.PlayerState.CUED]: VideoState.CUED,\n} as const;\n\ninterface Props {\n    video: string;\n    autoplay?: boolean;\n    controls?: boolean;\n    disablekb?: boolean;\n    volume?: number;\n    startAt?: number;\n    onStateChange: (state: VideoState) => void;\n    width: number;\n    height: number;\n}\n\nexport interface LoadVideByIdOpts {\n    videoId: string;\n    startSeconds: number;\n    endSeconds: number;\n}\n\nexport interface VideoPlayerRef {\n    seekTo: (time: number) => void;\n    setPlaybackSpeed: (speed: number) => void;\n    setVolume: (newVolume: number) => void;\n    getCurrentTime: () => Promise<number>;\n    loadVideoById: (opts: LoadVideByIdOpts) => void;\n    setSize: (w: number, h: number) => void;\n    playVideo: () => void;\n    pauseVideo: () => void;\n    getDuration: () => Promise<number>;\n}\n\nexport default forwardRef(function YoutubeVideoPlayer(\n    { video, autoplay, startAt, controls, disablekb, volume, width, height, onStateChange }: Props,\n    ref: ForwardedRef<VideoPlayerRef>,\n) {\n    const player = useRef<YouTube | null>(null);\n    const [currentStatus, setCurrentStatus] = useState(YouTube.PlayerState.UNSTARTED);\n\n    const playerKey = useUnstuckYouTubePlayer(player, currentStatus);\n    usePlayerVolume(player, volume);\n    useEffect(() => {\n        if (!player.current) {\n            return;\n        }\n\n        player.current.getInternalPlayer()!.setSize(width, height);\n    }, [player, width, height, video, playerKey]);\n\n    useImperativeHandle(ref, () => ({\n        setSize: (w, h) => player.current?.getInternalPlayer()!.setSize(w, h),\n        seekTo: (timeSec: seconds) => player.current?.getInternalPlayer()!.seekTo(timeSec, true),\n        setPlaybackSpeed: (speed: number) => player.current?.getInternalPlayer()!.setPlaybackRate(speed),\n        setVolume: (newVolume: number) => player.current?.getInternalPlayer()!.setVolume(newVolume),\n        getCurrentTime: () => player.current?.getInternalPlayer()!.getCurrentTime()!,\n        loadVideoById: (opts) => player.current?.getInternalPlayer()!.loadVideoById(opts),\n        playVideo: () => player.current?.getInternalPlayer()!.playVideo(),\n        pauseVideo: () => player.current?.getInternalPlayer()!.pauseVideo(),\n        getDuration: () => player.current?.getInternalPlayer()!.getDuration()!,\n    }));\n\n    return (\n        <YouTube\n            title=\" \"\n            key={`${video}-${playerKey}`}\n            ref={player}\n            videoId={video}\n            opts={{\n                width: '0',\n                height: '0',\n                playerVars: {\n                    autoplay: autoplay ? 1 : 0,\n                    rel: 0,\n                    fs: 0,\n                    controls: controls ? 1 : 0,\n                    start: startAt ?? 0,\n                    end: 0,\n                    disablekb: disablekb ? 1 : 0,\n                    modestbranding: 1,\n                },\n            }}\n            onStateChange={(e) => {\n                setCurrentStatus(e.data);\n                onStateChange?.(stateMap[e.data]);\n            }}\n        />\n    );\n});\n","import {\n    ComponentProps,\n    ForwardedRef,\n    forwardRef,\n    useEffect,\n    useImperativeHandle,\n    useMemo,\n    useRef,\n    useState,\n} from 'react';\n\nimport Youtube, { VideoPlayerRef, VideoState } from './Youtube';\n\ntype Props = ComponentProps<typeof Youtube>;\n\nexport default forwardRef(function DirectVideoPlayer(\n    { video, autoplay, startAt, controls, disablekb, volume, width, height, onStateChange }: Props,\n    ref: ForwardedRef<VideoPlayerRef>,\n) {\n    const player = useRef<HTMLVideoElement | null>(null);\n    const [size, setSize] = useState({ w: width, h: height });\n    const [status, setStatus] = useState(VideoState.UNSTARTED);\n\n    useEffect(() => {\n        const createCallback = (status: VideoState) => () => setStatus(status);\n        const playerRef = player.current;\n\n        const onPlay = createCallback(VideoState.PLAYING);\n        const onPause = createCallback(VideoState.PAUSED);\n        const onEnded = createCallback(VideoState.ENDED);\n        // const onLoadstart = createCallback(VideoState.BUFFERING);\n\n        playerRef?.addEventListener('playing', onPlay);\n        playerRef?.addEventListener('pause', onPause);\n        playerRef?.addEventListener('ended', onEnded);\n        // playerRef?.addEventListener('loadstart', onLoadstart);\n\n        return () => {\n            playerRef?.removeEventListener('playing', onPlay);\n            playerRef?.removeEventListener('pause', onPause);\n            playerRef?.removeEventListener('ended', onEnded);\n            // playerRef?.removeEventListener('loadstart', onLoadstart);\n        };\n    }, [player.current, setStatus]);\n\n    useEffect(() => {\n        onStateChange?.(status);\n    }, [status, onStateChange]);\n\n    const playerApi = useMemo<VideoPlayerRef>(\n        () => ({\n            setSize: (w, h) => setSize({ w, h }),\n            seekTo: (time: number) => {\n                player.current && (player.current.currentTime = time);\n\n                return time;\n            },\n            setPlaybackSpeed: () => undefined,\n            setVolume: () => undefined,\n            getCurrentTime: () => {\n                return Promise.resolve(player.current?.currentTime ?? 0);\n            },\n            loadVideoById: () => undefined,\n            playVideo: () => player.current?.play(),\n            pauseVideo: () => player.current?.pause(),\n            getDuration: () => Promise.resolve(player.current?.duration ?? 0),\n        }),\n        [player],\n    );\n\n    useEffect(() => {\n        playerApi.setSize(width, height);\n    }, [width, height, playerApi]);\n\n    useEffect(() => {\n        startAt !== undefined && playerApi.seekTo(startAt);\n    }, [startAt, playerApi]);\n\n    useImperativeHandle(ref, () => playerApi);\n\n    return (\n        <video width={size.w} height={size.h} autoPlay={autoplay ?? true} controls={controls} ref={player}>\n            <source src={video} />\n        </video>\n    );\n});\n","export default \"__VITE_ASSET__0d248451__\"","import { ComponentProps, ForwardedRef, forwardRef } from 'react';\n\nimport DirectVideo from 'Elements/VideoPlayer/DirectVideo';\nimport Youtube, { VideoPlayerRef } from './Youtube';\nimport dummyVideo from './dummy.mp4';\n\ntype Props = ComponentProps<typeof Youtube>;\n\nexport default forwardRef(function OfflineVideoPlayer(\n    { video, controls, ...restProps }: Props,\n    ref: ForwardedRef<VideoPlayerRef>,\n) {\n    return <DirectVideo ref={ref} video={dummyVideo} controls {...restProps} />;\n});\n","import 'core-js/es/array/at';\nimport { ComponentProps, ForwardedRef, forwardRef } from 'react';\nimport OfflineVideoPlayer from './Offline';\nimport YoutubeVideoPlayer, { VideoPlayerRef } from './Youtube';\n\nconst VideoPlayer = forwardRef(\n    (props: ComponentProps<typeof YoutubeVideoPlayer>, ref: ForwardedRef<VideoPlayerRef>) => {\n        if (import.meta.env.VITE_REACT_APP_OFFLINE) {\n            return <OfflineVideoPlayer {...props} ref={ref} />;\n        } else {\n            return <YoutubeVideoPlayer {...props} ref={ref} />;\n        }\n    },\n);\n\nexport default VideoPlayer;\n\nexport { VideoState } from './Youtube';\nexport type { VideoPlayerRef } from './Youtube';\n","import styled from '@emotion/styled';\nimport completedAnimation from 'Elements/Menu/completed-animation.json';\nimport Lottie from 'lottie-react';\nimport { ComponentProps } from 'react';\nimport tuple from 'utils/tuple';\n\nexport const Heading = styled.h1`\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    position: relative;\n`;\n\nconst SCompletedAnim = styled(Lottie)`\n    display: inline-block;\n    width: 10rem;\n    height: 10rem;\n    margin: -3rem -2rem -3rem -3rem;\n`;\n\n// needs to be a \"stable\" array - reference can't change\nconst completedAnimationSegment = tuple([0, 50]);\n\nexport const CompletedAnim = (\n    props: Omit<ComponentProps<typeof SCompletedAnim>, 'initialSegment' | 'animationData' | 'loop'>,\n) => (\n    <SCompletedAnim\n        {...props}\n        initialSegment={completedAnimationSegment}\n        animationData={completedAnimation}\n        loop={false}\n    />\n);\n","import { css } from '@emotion/react';\nimport styled from '@emotion/styled';\nimport { Laptop, Person, PhoneAndroid, PhoneIphone, PhotoCamera, QrCode, Usb } from '@mui/icons-material';\nimport { MenuButton } from 'Elements/Menu';\nimport { MicIconBlue, MicIconRed } from 'Elements/MicIcon';\nimport { focused } from 'Elements/cssMixins';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { MicSetupPreference, MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\n\ninterface Props {\n    onPreferenceSelected: (preference: (typeof MicSetupPreference)[number]) => void;\n    previouslySelected: string | null;\n    skipText?: string;\n    onBack?: () => void;\n}\n\nfunction SelectPreference({ onPreferenceSelected, previouslySelected, onBack, skipText }: Props) {\n    const [mobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n\n    const { register } = useKeyboardNav({ onBackspace: onBack });\n    return (\n        <>\n            <Option\n                {...register(\n                    'remote-mics',\n                    () => onPreferenceSelected('remoteMics'),\n                    undefined,\n                    previouslySelected === 'remoteMics',\n                )}>\n                <OptionIconContainer>\n                    <PhoneAndroid />\n                    <PhoneIphone />\n                </OptionIconContainer>\n                <div>\n                    {mobilePhoneMode ? 'Connect other phones' : 'Use Smartphones'}\n                    <OptionDescription>\n                        Use{' '}\n                        <strong>\n                            <PhotoCamera />\n                            Camera app\n                        </strong>{' '}\n                        to scan a{' '}\n                        <strong>\n                            <QrCode /> QR code\n                        </strong>{' '}\n                        that will open Remote Mic website - no need to download an app!\n                    </OptionDescription>\n                </div>\n            </Option>\n            <Option\n                {...register(\n                    'built-in',\n                    () => onPreferenceSelected('built-in'),\n                    undefined,\n                    previouslySelected === 'built-in',\n                )}>\n                <OptionIconContainer>\n                    <Person />\n                    {mobilePhoneMode ? <PhoneIphone /> : <Laptop />}\n                </OptionIconContainer>\n                <div>\n                    This {mobilePhoneMode ? \"device's\" : \"computer's\"} microphone\n                    <OptionDescription>\n                        Great to <strong>test</strong> the app, <strong>sing alone</strong> or don't care about the\n                        rivalry at the party\n                    </OptionDescription>\n                </div>\n            </Option>\n            <hr />\n            {!mobilePhoneMode && (\n                <Option\n                    {...register('mics', () => onPreferenceSelected('mics'), undefined, previouslySelected === 'mics')}>\n                    <OptionIconContainer>\n                        <MicIconBlue />\n                        <MicIconRed />\n                    </OptionIconContainer>\n                    <div>\n                        SingStar (-ish) microphones\n                        <OptionDescription>\n                            Select this option and <Usb /> connect your Mics to the computer. It should be selected{' '}\n                            <strong>automatically</strong>.\n                        </OptionDescription>\n                    </div>\n                </Option>\n            )}\n            <Option\n                {...register(\n                    'advanced',\n                    () => onPreferenceSelected('advanced'),\n                    undefined,\n                    previouslySelected === 'advanced',\n                )}>\n                <OptionIconContainer>\n                    <MicIconBlue />\n                    <PhoneIphone />\n                </OptionIconContainer>\n                <div>\n                    Advanced (manual) setup\n                    <OptionDescription>\n                        Assign the specific device to a player manually, e.g. if you don't have regular SingStar\n                        microphones.\n                    </OptionDescription>\n                </div>\n            </Option>\n            <hr />\n            <MenuButton\n                {...register('skip', () => onPreferenceSelected('skip'), undefined, previouslySelected === 'skip')}>\n                {skipText || 'Skip'}\n            </MenuButton>\n        </>\n    );\n}\n\nconst OptionDescription = styled.div<{ focused?: boolean }>`\n    padding: 0 3rem 0 6rem;\n    font-size: 1.6rem;\n    max-height: 0;\n    overflow: clip;\n    transition: 300ms;\n\n    svg {\n        font-size: 1.4rem;\n    }\n    opacity: 0;\n`;\n\nconst OptionIconContainer = styled.div`\n    position: relative;\n    margin: 0rem 0.6rem 0 2.5rem;\n    transition: 300ms;\n\n    svg {\n        transition: 300ms;\n        width: 3.6rem;\n        height: 3.6rem;\n        color: rgba(${styles.colors.players[1].text});\n    }\n\n    svg:first-of-type {\n        top: 0.6rem;\n        left: 1.25rem;\n        position: absolute;\n        color: rgba(${styles.colors.players[0].text});\n        z-index: 100;\n        transform: scaleX(-1);\n    }\n`;\n\nconst moreInfoMixin = css`\n    height: 16.5rem;\n    background: black;\n    ${focused};\n\n    ${OptionDescription} {\n        padding-top: 1.6rem;\n        max-height: 10rem;\n        opacity: 1;\n    }\n\n    ${OptionIconContainer} {\n        transform: scale(1.75);\n    }\n`;\n\nconst Option = styled(MenuButton)<{ focused?: boolean }>`\n    display: flex;\n    align-items: center;\n\n    :hover {\n        ${moreInfoMixin};\n    }\n\n    ${(props) => (props.focused ? moreInfoMixin : '')};\n`;\n\nexport default SelectPreference;\n","import InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport { FPSCountSetting } from 'Scenes/Settings/SettingsState';\nimport { useEffect, useState } from 'react';\nimport tuple from 'utils/tuple';\n\nexport const usePlayerMicData = (\n    playerNumber: number,\n    intervalMs = 1000 / FPSCountSetting.get(),\n    onMeasure: ([volume, frequency]: [number, number]) => void,\n) => {\n    useEffect(() => {\n        const interval = setInterval(() => {\n            const playerVolume = InputManager.getPlayerVolume(playerNumber) ?? 0;\n            const playerFrequency = InputManager.getPlayerFrequency(playerNumber) ?? 0;\n            onMeasure([playerVolume, Array.isArray(playerFrequency) ? playerFrequency[0] : playerFrequency]);\n        }, intervalMs);\n\n        return () => {\n            clearInterval(interval);\n        };\n    }, [playerNumber, intervalMs, onMeasure]);\n};\n\nconst usePlayerMic = (\n    playerNumber: number,\n    intervalMs = 1000 / FPSCountSetting.get(),\n    onMeasure?: ([volume, frequency]: [number, number]) => void,\n) => {\n    const [data, setData] = useState(tuple([0, 0]));\n\n    usePlayerMicData(playerNumber, intervalMs, setData);\n\n    useEffect(() => {\n        if (onMeasure) {\n            onMeasure(data);\n        }\n    }, [data, onMeasure]);\n\n    return data;\n};\n\nexport default usePlayerMic;\n","import styled from '@emotion/styled';\nimport PlayersManager from 'Players/PlayersManager';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { usePlayerMicData } from 'hooks/players/usePlayerMic';\nimport { ForwardedRef, forwardRef, useCallback, useState } from 'react';\n\nconst VolumeIndicatorBase = styled.div<{ color: string }>`\n    background: linear-gradient(270deg, rgba(${(props) => props.color}, 1) 0%, rgba(${(props) => props.color}, 0) 100%);\n    height: 100%;\n    width: 100%;\n    position: absolute;\n    right: 0;\n    top: 0;\n    background-repeat: repeat-y;\n    transform-origin: right;\n    z-index: 1;\n    pointer-events: none;\n`;\n\nexport const VolumeIndicator = forwardRef(\n    (\n        { volume, playerNumber, ...rest }: { playerNumber: number; volume: number },\n        ref: ForwardedRef<HTMLDivElement | null>,\n    ) => {\n        const player = PlayersManager.getPlayer(playerNumber);\n        const percent = `${Math.min(1, volume * 20)}`;\n        const color = styles.colors.players[player.number].text;\n\n        return <VolumeIndicatorBase color={color} {...rest} style={{ transform: `scaleX(${percent})` }} ref={ref} />;\n    },\n);\n\nexport const PlayerMicCheck = ({ playerNumber, ...props }: { playerNumber: number }) => {\n    const [elem, setElem] = useState<HTMLDivElement | null>();\n\n    const cb = useCallback(\n        ([volume]: [number, number]) => {\n            if (elem) {\n                const percent = `${Math.min(1, volume * 20)}`;\n\n                elem.style.transform = `scaleX(${percent})`;\n            }\n        },\n        [elem],\n    );\n\n    usePlayerMicData(playerNumber, undefined, cb);\n    const color = styles.colors.players[playerNumber].text;\n\n    return <VolumeIndicatorBase {...props} color={color} ref={setElem} />;\n};\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport WebRTCServer, { isWebsockets } from 'RemoteMic/Network/WebRTCServer';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { QRCodeSVG } from 'qrcode.react';\nimport { useEffect } from 'react';\nimport { useRoute } from 'wouter';\n\nconst linkObject = new URL(window.location.href);\nif (isWebsockets) {\n    linkObject.searchParams.set('transport', 'websocket');\n}\n\nfunction ConnectRemoteMic() {\n    // Validate if the component is rendered in a remote mic or in the \"main\" game via the URL\n    const [match, params] = useRoute<{ roomId: string }>('/remote-mic/:roomId');\n    linkObject.pathname = `/remote-mic/${match ? params.roomId : WebRTCServer.getRoomId()}`;\n    const link = linkObject.href;\n\n    useEffect(() => {\n        if (!match) {\n            WebRTCServer.start();\n        }\n    }, [match]);\n\n    return (\n        <Container>\n            <QRCode>\n                <QRCodeSVG value={link} width=\"100%\" height=\"100%\" includeMargin />\n            </QRCode>\n            <Description>\n                <QRCodeInstruction>\n                    <h3>Use your phone as a microphone</h3>\n                    <ol>\n                        <li>\n                            Open <b>Camera App</b> on your phone\n                        </li>\n                        <li>\n                            Point the camera to the <b>QR Code</b> on the left\n                        </li>\n                        <li>\n                            Open <b>the link</b> that should appear\n                        </li>\n                        <li>Follow the instructions</li>\n                    </ol>\n                </QRCodeInstruction>\n                <CopyLinkInstruction>\n                    <h4>Or copy and send the link</h4>\n                    <InputCopyContainer>\n                        <InputCopy disabled value={link} data-test=\"server-link-input\" />\n                        <CopyButton\n                            onClick={() => {\n                                navigator.clipboard.writeText(link);\n                            }}>\n                            Copy\n                        </CopyButton>\n                    </InputCopyContainer>\n                </CopyLinkInstruction>\n            </Description>\n        </Container>\n    );\n}\nconst QRCodeInstruction = styled.div`\n    flex: 1;\n`;\n\nconst CopyLinkInstruction = styled.div`\n    flex: 0;\n`;\n\nconst InputCopyContainer = styled.div`\n    position: relative;\n    margin-top: 0.5rem;\n`;\n\nconst CopyButton = styled.button`\n    cursor: pointer;\n    position: absolute;\n    padding: 0 2rem;\n    right: 0;\n    height: 100%;\n    box-sizing: border-box;\n\n    background: ${styles.colors.text.active};\n\n    ${typography};\n    font-weight: bold;\n    font-size: 2.2rem;\n    border: 0;\n\n    :active {\n        background-color: black;\n    }\n`;\n\nconst InputCopy = styled.input`\n    padding: 1rem;\n    box-sizing: border-box;\n    background: grey;\n    border: none;\n    width: 100%;\n    font-size: 1.3rem;\n`;\n\nconst Container = styled.div`\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    align-items: stretch;\n    flex: 1;\n    gap: 2%;\n\n    @media (max-width: 560px) {\n        flex-direction: column;\n    }\n`;\n\nconst QRCode = styled.div`\n    flex: 0.6;\n    @media (max-width: 560px) {\n        flex: 0;\n    }\n`;\n\nconst Description = styled.div`\n    @media (max-width: 560px) {\n        display: none;\n    }\n    flex: 1;\n\n    display: flex;\n    flex-direction: column;\n\n    b {\n        font-weight: bold;\n        ${typography};\n        color: ${styles.colors.text.active};\n    }\n\n    h3 {\n        margin-bottom: 1.9rem;\n    }\n    h4 {\n        margin: 1.25rem 0;\n    }\n\n    ol {\n        padding-left: 2.3rem;\n        margin: 1.25rem 0;\n        list-style: decimal inside;\n    }\n    li {\n        color: white;\n        font-size: 1.9rem;\n        line-height: 3.2rem;\n    }\n`;\n\nexport default ConnectRemoteMic;\n","import events from 'GameEvents/GameEvents';\nimport { useEventListenerSelector } from 'GameEvents/hooks';\nimport inputSourceListManager from 'Scenes/SelectInput/InputSources';\nimport { InputSource } from 'Scenes/SelectInput/InputSources/interfaces';\nimport { useEffect } from 'react';\n\nexport interface SourceInputDefault {\n    list: InputSource[];\n    getDefault: () => string | null;\n}\n\nexport type SourceMap = Record<string, SourceInputDefault>;\n\nexport function useMicrophoneList(load = false) {\n    const inputs = useEventListenerSelector(events.inputListChanged, () => inputSourceListManager.getInputList());\n\n    useEffect(() => {\n        if (load) {\n            inputSourceListManager.loadMics();\n        }\n    }, [load]);\n\n    return inputs;\n}\n","import { nextIndex, nextValue } from 'Elements/Switcher';\nimport events from 'GameEvents/GameEvents';\nimport { useEventListenerSelector } from 'GameEvents/hooks';\nimport PlayersManager from 'Players/PlayersManager';\nimport InputSources from 'Scenes/SelectInput/InputSources';\nimport { InputSourceList, InputSourceNames } from 'Scenes/SelectInput/InputSources/interfaces';\nimport { useEffect } from 'react';\nimport tuple from 'utils/tuple';\n\nexport function usePlayerInput(playerNumber: number, sources: Record<InputSourceNames, InputSourceList>) {\n    const sourceList = Object.keys(sources) as Array<InputSourceNames>;\n    const [selectedPlayerInput, playerInputData] = useEventListenerSelector(\n        [events.playerInputChanged, events.inputListChanged],\n        () => {\n            const playerInput = PlayersManager.getPlayer(playerNumber).input;\n\n            if (!playerInput) return tuple([null, null]);\n            return tuple([playerInput, InputSources.getInputForPlayerSelected(playerInput)]);\n        },\n    );\n\n    useEffect(() => {\n        if (playerInputData === null) {\n            const source = sourceList[0];\n            const input = sources[source].getDefault();\n            if (input) {\n                PlayersManager.getPlayer(playerNumber).changeInput(sourceList[0], input.channel, input.deviceId);\n            }\n        }\n    });\n\n    const cycleSource = (startingIndex?: number) => {\n        const nextSource = nextValue(sourceList, selectedPlayerInput?.source ?? sourceList[0]);\n\n        const input = startingIndex ? sources[nextSource].list[startingIndex] : sources[nextSource].getDefault();\n\n        PlayersManager.getPlayer(playerNumber).changeInput(nextSource, input?.channel, input?.deviceId);\n    };\n    const cycleInput = () => {\n        if (!selectedPlayerInput) return;\n        const list = sources[selectedPlayerInput.source].list;\n        const currentIndex = playerInputData ? list.findIndex((item) => item.id === playerInputData.id) : 0;\n        const newIndex = nextIndex(list, currentIndex);\n        if (newIndex === 0) {\n            cycleSource(0);\n        } else {\n            const input = list[newIndex];\n\n            PlayersManager.getPlayer(playerNumber).changeInput(\n                selectedPlayerInput.source,\n                input?.channel,\n                input?.deviceId,\n            );\n        }\n    };\n\n    return tuple([selectedPlayerInput?.source ?? null, cycleSource, playerInputData, cycleInput]);\n}\n","import events from 'GameEvents/GameEvents';\nimport { useEventEffect } from 'GameEvents/hooks';\nimport PlayersManager from 'Players/PlayersManager';\nimport { RemoteMicrophoneInputSource } from 'Scenes/SelectInput/InputSources/Remote';\nimport { useRef } from 'react';\n\nexport function useRemoteMicAutoselect() {\n    const nextPlayerToAutoSwitch = useRef(0);\n\n    useEventEffect(events.remoteMicConnected, ({ id }) => {\n        console.log('useRemoteMicAutoselect', id);\n        PlayersManager.getPlayer(nextPlayerToAutoSwitch.current).changeInput(\n            RemoteMicrophoneInputSource.inputName,\n            0,\n            id,\n        );\n        nextPlayerToAutoSwitch.current = (nextPlayerToAutoSwitch.current + 1) % PlayersManager.getPlayers().length;\n    });\n}\n","export default function isWindows() {\n    return navigator?.userAgent?.includes?.('Win') ?? false;\n}\n","import styled from '@emotion/styled';\nimport { MenuButton } from 'Elements/Menu';\nimport { Switcher } from 'Elements/Switcher';\nimport { PlayerMicCheck } from 'Elements/VolumeIndicator';\nimport events from 'GameEvents/GameEvents';\nimport { useEventListenerSelector } from 'GameEvents/hooks';\nimport PlayersManager, { PlayerEntity } from 'Players/PlayersManager';\nimport ConnectRemoteMic from 'Scenes/ConnectRemoteMic/ConnectRemoteMic';\nimport { MicrophoneInputSource } from 'Scenes/SelectInput/InputSources/Microphone';\nimport { useMicrophoneList } from 'Scenes/SelectInput/hooks/useMicrophoneList';\nimport { usePlayerInput } from 'Scenes/SelectInput/hooks/usePlayerInput';\nimport { useRemoteMicAutoselect } from 'Scenes/SelectInput/hooks/useRemoteMicAutoselect';\nimport { MicSetupPreference } from 'Scenes/Settings/SettingsState';\nimport UserMediaEnabled from 'UserMedia/UserMediaEnabled';\nimport { useMicrophoneStatus } from 'UserMedia/hooks';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { useEffect } from 'react';\nimport { ValuesType } from 'utility-types';\nimport isChromium from 'utils/isChromium';\nimport isWindows from 'utils/isWindows';\n\ninterface Props {\n    onSetupComplete: (complete: boolean) => void;\n    onBack: () => void;\n    onSave: () => void;\n    closeButtonText: string;\n    changePreference: (pref: ValuesType<typeof MicSetupPreference>) => void;\n}\n\nconst PlayerSelector = (props: {\n    player: PlayerEntity;\n    inputs: ReturnType<typeof useMicrophoneList>;\n    register: ReturnType<typeof useKeyboardNav>['register'];\n}) => {\n    const player = props.player;\n    const [source, cycleSource, input, cycleInput] = usePlayerInput(player.number, props.inputs);\n    return (\n        <>\n            <SwitcherWithPlayerHeader\n                {...props.register(`player-${player.number}-source`, cycleSource)}\n                label={<span className=\"ph-no-capture\">{player.getName()} Source</span>}\n                value={source}\n            />\n            <SwitcherWithMicCheck\n                {...props.register(`player-${player.number}-input`, cycleInput)}\n                label=\"Input\"\n                value={input?.label}>\n                <MicCheck playerNumber={player.number} />\n            </SwitcherWithMicCheck>\n        </>\n    );\n};\n\nfunction Advanced(props: Props) {\n    const inputs = useMicrophoneList(true);\n    const status = useMicrophoneStatus();\n\n    useEffect(() => {\n        props.onSetupComplete(status === 'accepted');\n    }, [status]);\n\n    useRemoteMicAutoselect();\n\n    const { register } = useKeyboardNav({ onBackspace: props.onBack });\n\n    const selectedInputs = useEventListenerSelector(events.playerInputChanged, () => PlayersManager.getInputs());\n\n    const micInputs = selectedInputs.filter((input) => input.source === MicrophoneInputSource.inputName);\n    const isDifferentMics = new Set(micInputs.map((input) => input.deviceId)).size > 1;\n\n    const players = PlayersManager.getPlayers();\n\n    return (\n        <>\n            <UserMediaEnabled fallback={<h2>Please allow access to the microphone so we can show them.</h2>}>\n                <ConnectRemoteMic />\n                {players.map((player) => (\n                    <PlayerSelector inputs={inputs} player={player} key={player.number} register={register} />\n                ))}\n                <hr />\n                {micInputs.length > 1 && isDifferentMics && (\n                    <h3 data-test=\"mic-mismatch-warning\">Using different microphone devices is not yet supported</h3>\n                )}\n                {micInputs.length > 1 && isChromium() && isWindows() && (\n                    <h3>\n                        <strong>Chrome</strong> is known for not handling SingStar mics well. If you notice any\n                        problems, try using an alternative browser (eg. <strong>MS Edge</strong> or{' '}\n                        <strong>Firefox</strong>)\n                    </h3>\n                )}\n            </UserMediaEnabled>\n            <MenuButton {...register('back-button', props.onBack)}>Back to Input Selection</MenuButton>\n            <MenuButton {...register('save-button', props.onSave)}>{props.closeButtonText}</MenuButton>\n        </>\n    );\n}\n\nconst MicCheck = styled(PlayerMicCheck)`\n    opacity: 0.75;\n    width: 50%;\n    height: calc(100% - 0.5rem);\n    margin: 0.25rem;\n`;\n\nconst SwitcherWithMicCheck = styled(Switcher)`\n    position: relative;\n`;\n\nconst SwitcherWithPlayerHeader = styled(Switcher)`\n    background: none;\n`;\n\nexport default Advanced;\n","import styled from '@emotion/styled';\nimport { PlayerMicCheck } from 'Elements/VolumeIndicator';\nimport PlayersManager from 'Players/PlayersManager';\n\ninterface Props {\n    names?: string[];\n}\n\nfunction MicCheck({ names }: Props) {\n    return (\n        <MicCheckContainer>\n            {PlayersManager.getPlayers().map((player) => (\n                <Indicator data-test={`mic-check-p${player.number}`} key={player.number}>\n                    <PlayerMicCheck playerNumber={player.number} />\n                    <span className=\"ph-no-capture\">{names?.[player.number] ?? player.getName()}</span>\n                </Indicator>\n            ))}\n        </MicCheckContainer>\n    );\n}\n\nconst MicCheckContainer = styled.div`\n    display: flex;\n    gap: 1.25rem;\n\n    div {\n        flex: 1;\n    }\n`;\n\nconst Indicator = styled.div`\n    position: relative;\n    border: 0.1rem solid white;\n    padding: 1rem 3rem;\n    background: black;\n\n    text-align: center;\n    gap: 1.25rem;\n    font-size: 2.3rem;\n    color: white;\n`;\n\nexport default MicCheck;\n","import styled from '@emotion/styled';\nimport { MenuButton } from 'Elements/Menu';\nimport { nextIndex, Switcher } from 'Elements/Switcher';\nimport events from 'GameEvents/GameEvents';\nimport { useEventEffect, useEventListenerSelector } from 'GameEvents/hooks';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport PlayersManager from 'Players/PlayersManager';\nimport { getInputId } from 'Players/utils';\nimport { useEffect } from 'react';\nimport { useMicrophoneList } from 'Scenes/SelectInput/hooks/useMicrophoneList';\nimport inputSourceListManager from 'Scenes/SelectInput/InputSources';\nimport { MicrophoneInputSource } from 'Scenes/SelectInput/InputSources/Microphone';\nimport MicCheck from 'Scenes/SelectInput/MicCheck';\nimport { MicSetupPreference } from 'Scenes/Settings/SettingsState';\nimport UserMediaEnabled from 'UserMedia/UserMediaEnabled';\nimport { ValuesType } from 'utility-types';\nimport { InputSource } from '../InputSources/interfaces';\n\ninterface Props {\n    onSetupComplete: (complete: boolean) => void;\n    onBack: () => void;\n    onSave: () => void;\n    changePreference: (pref: ValuesType<typeof MicSetupPreference>) => void;\n    closeButtonText: string;\n}\n\nfunction BuiltIn(props: Props) {\n    const { register } = useKeyboardNav({ onBackspace: props.onBack });\n\n    const { Microphone } = useMicrophoneList(true);\n\n    const selectedMic = useEventListenerSelector([events.playerInputChanged, events.inputListChanged], () => {\n        const selected = PlayersManager.getInputs().find((input) => input.source === 'Microphone');\n        const Mics = inputSourceListManager.getInputList().Microphone.list; // get \"fresh\" list from\n\n        if (selected) {\n            return Mics.find((mic) => mic.id === getInputId(selected))?.label ?? '';\n        }\n        return '';\n    });\n\n    const setMic = (input: InputSource) => {\n        PlayersManager.getPlayers().forEach((player) =>\n            player.changeInput(MicrophoneInputSource.inputName, input.channel, input.deviceId),\n        );\n    };\n\n    const autoselect = () => {\n        if (selectedMic === '') {\n            const defaultDevice = Microphone.getDefault();\n            if (defaultDevice) {\n                setMic(defaultDevice);\n            }\n        }\n    };\n\n    useEffect(autoselect, []);\n    useEventEffect(events.inputListChanged, autoselect);\n\n    const cycleMic = () => {\n        const currentIndex = Microphone.list.findIndex((mic) => mic.label === selectedMic);\n\n        if (currentIndex > -1) {\n            const input = Microphone.list[nextIndex(Microphone.list, currentIndex)];\n            setMic(input);\n        }\n    };\n\n    useEffect(() => {\n        props.onSetupComplete(!!selectedMic);\n    }, [selectedMic]);\n\n    return (\n        <>\n            <UserMediaEnabled\n                fallback={<h2>Please allow access to the microphone so the default one can be selected.</h2>}>\n                {!selectedMic && <h3>The default device is being selected.</h3>}\n                {selectedMic && (\n                    <>\n                        <Header>\n                            <h3>You'll sing using</h3>\n                            <h4>(click to change)</h4>\n                        </Header>\n                        <Switcher {...register('selected-mic', cycleMic)} label=\"Mic\" value={selectedMic} />\n                        <h4>\n                            Built-in microphones can pick up music from the game. For more accurate scores, try using\n                            your{' '}\n                            <button onClick={() => props.changePreference('remoteMics')}>\n                                smartphone as a microphone\n                            </button>\n                            .\n                        </h4>\n                    </>\n                )}\n                <MicCheck />\n            </UserMediaEnabled>\n            <MenuButton {...register('back-button', props.onBack)}>Back to Input Selection</MenuButton>\n            <MenuButton\n                {...register('save-button', props.onSave, undefined, true, { disabled: !selectedMic })}\n                disabled={!selectedMic}>\n                {props.closeButtonText}\n            </MenuButton>\n        </>\n    );\n}\n\nconst Header = styled.div`\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-end;\n`;\n\nexport default BuiltIn;\n","import { MenuButton } from 'Elements/Menu';\nimport events from 'GameEvents/GameEvents';\nimport { useEventListenerSelector } from 'GameEvents/hooks';\nimport PlayersManager from 'Players/PlayersManager';\nimport ConnectRemoteMic from 'Scenes/ConnectRemoteMic/ConnectRemoteMic';\nimport InputSources from 'Scenes/SelectInput/InputSources';\nimport MicCheck from 'Scenes/SelectInput/MicCheck';\nimport { useRemoteMicAutoselect } from 'Scenes/SelectInput/hooks/useRemoteMicAutoselect';\nimport { MicSetupPreference } from 'Scenes/Settings/SettingsState';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { useEffect } from 'react';\nimport { ValuesType } from 'utility-types';\n\ninterface Props {\n    onSetupComplete: (complete: boolean) => void;\n    onBack: () => void;\n    onSave: () => void;\n    closeButtonText: string;\n    changePreference: (pref: ValuesType<typeof MicSetupPreference>) => void;\n}\n\nfunction RemoteMics(props: Props) {\n    const { register } = useKeyboardNav({ onBackspace: props.onBack });\n\n    useRemoteMicAutoselect();\n\n    const players = useEventListenerSelector(\n        // Subscribing to inputListChanged otherwise as it's InputManager.getInputs returns dummy input as the input\n        // list is not yet updated with the connected remote mic.\n        // The event sequence is wrongly remoteMicConnected -> playerInputChanged -> inputListChanged - needs to be fixed\n        // e.g. remove remoteMicConnected event?\n        [events.inputListChanged, events.playerInputChanged],\n        () => {\n            return PlayersManager.getInputs()\n                .map((input) => (input.source === 'Remote Microphone' ? input : null))\n                .map((input) => (input ? InputSources.getInputForPlayerSelected(input) : null));\n        },\n    );\n\n    const onContinue = () => {\n        props.onSave();\n    };\n\n    const isComplete = !!players[0]?.label && !!players[1]?.label;\n\n    useEffect(() => {\n        props.onSetupComplete(isComplete);\n    }, [isComplete]);\n\n    return (\n        <>\n            <ConnectRemoteMic />\n            <h4>You can connect multiple phones in advance.</h4>\n\n            <h4>You will be able to connect phones later.</h4>\n            <MicCheck />\n            <MenuButton {...register('back-button', props.onBack)}>Back to Input Selection</MenuButton>\n            <MenuButton {...register('save-button', onContinue, undefined, true)}>{props.closeButtonText}</MenuButton>\n        </>\n    );\n}\n\nexport default RemoteMics;\n","import { CircularProgress } from '@mui/material';\nimport { MenuButton } from 'Elements/Menu';\nimport events from 'GameEvents/GameEvents';\nimport { useEventEffect, useEventListenerSelector } from 'GameEvents/hooks';\nimport PlayersManager from 'Players/PlayersManager';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport InputSources from 'Scenes/SelectInput/InputSources';\nimport { MicrophoneInputSource } from 'Scenes/SelectInput/InputSources/Microphone';\nimport MicCheck from 'Scenes/SelectInput/MicCheck';\nimport { useMicrophoneList } from 'Scenes/SelectInput/hooks/useMicrophoneList';\nimport { MicSetupPreference } from 'Scenes/Settings/SettingsState';\nimport UserMediaEnabled from 'UserMedia/UserMediaEnabled';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { useEffect, useState } from 'react';\nimport { ValuesType } from 'utility-types';\nimport isChromium from 'utils/isChromium';\nimport isWindows from 'utils/isWindows';\n\ninterface Props {\n    onSetupComplete: (complete: boolean) => void;\n    onBack: () => void;\n    onSave: () => void;\n    closeButtonText: string;\n    changePreference: (pref: ValuesType<typeof MicSetupPreference>) => void;\n}\n\nfunction SingStarMics(props: Props) {\n    const { register } = useKeyboardNav({ onBackspace: props.onBack });\n    const { Microphone } = useMicrophoneList(true);\n    const [showAdvancedTip, setShowAdvancedTip] = useState(false);\n\n    const isSetup = useEventListenerSelector([events.playerInputChanged, events.inputListChanged], () => {\n        const inputs = PlayersManager.getInputs();\n\n        const isSameDeviceId = [...new Set(inputs.map((input) => input.deviceId))].length === 1;\n        const isMicInput = !inputs.find((input) => input.source !== 'Microphone');\n        const areAllPreferred = !inputs.find(\n            (input) => InputSources.getInputForPlayerSelected(input)!.preferred === undefined,\n        );\n\n        return isSameDeviceId && isMicInput && areAllPreferred;\n    });\n\n    useEffect(() => {\n        if (isSetup) {\n            InputManager.startMonitoring();\n        }\n        return () => {\n            InputManager.stopMonitoring();\n        };\n    }, [isSetup]);\n\n    const onContinue = () => {\n        props.onSave();\n    };\n\n    // Look for proper microphones in the list when the list changes\n    const [listChanged, setListChanged] = useState(false);\n    useEventEffect(events.inputListChanged, (initial) => {\n        const preferred = Microphone.list.filter((input) => input.preferred !== undefined);\n        if (preferred.length === 2 && preferred[0].deviceId === preferred[1].deviceId) {\n            preferred.forEach((input) => {\n                PlayersManager.getPlayer(input.preferred!).changeInput(\n                    MicrophoneInputSource.inputName,\n                    input.channel,\n                    input.deviceId,\n                );\n            });\n        }\n        if (!initial) {\n            setListChanged(true);\n        }\n    });\n\n    useEffect(() => {\n        props.onSetupComplete(isSetup);\n    }, [isSetup]);\n\n    useEffect(() => {\n        if (isSetup) {\n            setShowAdvancedTip(false);\n        } else {\n            const timeout = setTimeout(() => setShowAdvancedTip(true), 2500);\n\n            return () => clearTimeout(timeout);\n        }\n    }, [isSetup]);\n\n    return (\n        <>\n            <UserMediaEnabled fallback={<h2>Please allow access to the microphone so we can find SingStar ones.</h2>}>\n                {!isSetup && (\n                    <>\n                        <h3>\n                            <CircularProgress size=\"0.85em\" /> Connect your SingStar microphones.\n                        </h3>\n                        <h4 data-test=\"setup-not-completed\">\n                            It can take a couple of seconds to detect after you connect them.\n                        </h4>\n                        {listChanged && (\n                            <h4>\n                                <h4 data-test=\"list-change-info\">\n                                    Available microphones list has changed, but no SingStar mics were found. Try{' '}\n                                    <button onClick={() => props.changePreference('advanced')}>Advanced</button> setup.\n                                </h4>\n                            </h4>\n                        )}\n                        {showAdvancedTip && (\n                            <>\n                                {!listChanged && (\n                                    <h4 data-test=\"advanced-tip\">\n                                        If detection doesn't happen, try{' '}\n                                        <button onClick={() => props.changePreference('advanced')}>Advanced</button>{' '}\n                                        section in the previous menu.\n                                    </h4>\n                                )}\n                                {isChromium() && isWindows() && (\n                                    <h4>\n                                        <strong>Chrome</strong> is known for not handling SingStar mics well. If you\n                                        notice any problems, try using an alternative browser (eg.{' '}\n                                        <strong>MS Edge</strong> or <strong>Firefox</strong>)\n                                    </h4>\n                                )}\n                            </>\n                        )}\n                    </>\n                )}\n                {isSetup && (\n                    <>\n                        <h2 data-test=\"setup-completed\">\n                            <strong>SingStar</strong> microphone connected!\n                        </h2>\n\n                        <MicCheck names={['Blue', 'Red']} />\n                    </>\n                )}\n            </UserMediaEnabled>\n\n            <MenuButton {...register('back-button', props.onBack)}>Back to Input Selection</MenuButton>\n            <MenuButton\n                {...register('save-button', onContinue, undefined, true, { disabled: !isSetup })}\n                data-test=\"save-button\">\n                {props.closeButtonText}\n            </MenuButton>\n        </>\n    );\n}\n\nexport default SingStarMics;\n","import { useEffect } from 'react';\nimport { MicSetupPreference } from 'Scenes/Settings/SettingsState';\nimport { ValuesType } from 'utility-types';\n\ninterface Props {\n    onSetupComplete: (complete: boolean) => void;\n    onBack: () => void;\n    onSave: () => void;\n    closeButtonText: string;\n    changePreference: (pref: ValuesType<typeof MicSetupPreference>) => void;\n}\n\nfunction Skip(props: Props) {\n    useEffect(() => {\n        props.onSave();\n    }, []);\n\n    return null;\n}\n\nexport default Skip;\n","import { CompletedAnim, Heading } from 'Elements/Menu/Heading';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport SelectPreference from 'Scenes/SelectInput/SelectPreference';\nimport Advanced from 'Scenes/SelectInput/Variants/Advanced';\nimport BuiltIn from 'Scenes/SelectInput/Variants/BuiltIn';\nimport RemoteMics from 'Scenes/SelectInput/Variants/RemoteMics';\nimport SingStarMics from 'Scenes/SelectInput/Variants/SingStarMics';\nimport Skip from 'Scenes/SelectInput/Variants/Skip';\nimport { MicSetupPreference, MicSetupPreferenceSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport posthog from 'posthog-js';\nimport { useEffect, useState } from 'react';\nimport { ValuesType } from 'utility-types';\nimport startViewTransition from 'utils/startViewTransition';\n\ninterface Props {\n    onFinish?: (pref: ValuesType<typeof MicSetupPreference>) => void;\n    onBack?: () => void;\n    smooth?: boolean;\n    closeButtonText: string;\n    skipText?: string;\n    playerNames?: string[];\n}\n\nconst LAST_SELECTED_KEY = 'Previously selected input type';\n\nconst previouslySelected = localStorage.getItem(LAST_SELECTED_KEY);\n\nfunction SelectInputView({ onFinish, closeButtonText, playerNames, onBack, skipText }: Props) {\n    const [preference, setPreference] = useState<ValuesType<typeof MicSetupPreference>>(null);\n    const [isComplete, setIsComplete] = useState(false);\n\n    useEffect(() => {\n        const wasMonitoring = InputManager.monitoringStarted();\n        InputManager.startMonitoring();\n        return () => {\n            !wasMonitoring && InputManager.stopMonitoring();\n        };\n    }, []);\n\n    const [storedPreference, setStoredPreference] = useSettingValue(MicSetupPreferenceSetting);\n\n    const storePreference = (...args: Parameters<typeof setPreference>) => {\n        startViewTransition(() => {\n            setPreference(...args);\n        });\n    };\n\n    const onSave = (pref: ValuesType<typeof MicSetupPreference>) => () => {\n        // Keep currently selected preference unless nothing (null) is selected - then store `skip` directly\n        // skip is needed to mark that user explicitly didn't select anything\n        setStoredPreference(pref === 'skip' ? storedPreference ?? 'skip' : pref);\n\n        if (pref) {\n            localStorage.setItem(LAST_SELECTED_KEY, pref);\n            posthog.capture('sourcePreferenceSet', { source: pref });\n        }\n\n        onFinish?.(pref);\n    };\n    const back = () => {\n        startViewTransition(() => {\n            setPreference(null);\n            setIsComplete(false);\n        });\n    };\n\n    return (\n        <>\n            <Heading>\n                {isComplete ? (\n                    <>\n                        <CompletedAnim /> Setup completed!\n                    </>\n                ) : (\n                    'How do you want to sing?'\n                )}\n            </Heading>\n            {(preference === null || preference === 'skip') && (\n                <SelectPreference\n                    onPreferenceSelected={storePreference}\n                    previouslySelected={previouslySelected}\n                    onBack={onBack}\n                    skipText={skipText}\n                />\n            )}\n            {preference === 'remoteMics' && (\n                <RemoteMics\n                    onSetupComplete={setIsComplete}\n                    onBack={back}\n                    onSave={onSave('remoteMics')}\n                    closeButtonText={closeButtonText}\n                    changePreference={setPreference}\n                />\n            )}\n            {preference === 'mics' && (\n                <SingStarMics\n                    onSetupComplete={setIsComplete}\n                    onBack={back}\n                    onSave={onSave('mics')}\n                    closeButtonText={closeButtonText}\n                    changePreference={setPreference}\n                />\n            )}\n            {preference === 'built-in' && (\n                <BuiltIn\n                    onSetupComplete={setIsComplete}\n                    onBack={back}\n                    onSave={onSave('built-in')}\n                    closeButtonText={closeButtonText}\n                    changePreference={setPreference}\n                />\n            )}\n            {preference === 'advanced' && (\n                <Advanced\n                    onSave={onSave('advanced')}\n                    onSetupComplete={setIsComplete}\n                    onBack={back}\n                    closeButtonText={closeButtonText}\n                    changePreference={setPreference}\n                />\n            )}\n            {preference === 'skip' && (\n                <Skip\n                    onSetupComplete={setIsComplete}\n                    onBack={back}\n                    onSave={onSave('skip')}\n                    closeButtonText={closeButtonText}\n                    changePreference={setPreference}\n                />\n            )}\n        </>\n    );\n}\n\nexport default SelectInputView;\n","import { MenuContainer } from 'Elements/Menu';\nimport Modal from 'Elements/Modal';\nimport SelectInputView from 'Scenes/SelectInput/SelectInputView';\n\ninterface Props {\n    onClose: () => void;\n    closeButtonText: string;\n}\n\nexport default function SelectInputModal({ onClose, closeButtonText }: Props) {\n    return (\n        <Modal onClose={onClose}>\n            <MenuContainer>\n                <SelectInputView\n                    onBack={onClose}\n                    onFinish={onClose}\n                    closeButtonText={closeButtonText}\n                    skipText={'Back'}\n                />\n            </MenuContainer>\n        </Modal>\n    );\n}\n","import styled from '@emotion/styled';\nimport { MenuButton, MenuContainer } from 'Elements/Menu';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { useEffect, useRef, useState } from 'react';\nimport SelectInputModal from 'Scenes/SelectInput/SelectInputModal';\nimport InputLag from 'Scenes/Settings/InputLag';\n\ninterface Props {\n    onResume: () => void;\n    onExit: () => void;\n    onRestart: () => void;\n}\n\nexport default function PauseMenu({ onResume, onExit, onRestart }: Props) {\n    const menuRef = useRef<null | HTMLButtonElement>(null);\n    const inputLagRef = useRef<HTMLInputElement | null>(null);\n\n    useEffect(() => {\n        menuRef.current?.focus();\n    }, [menuRef]);\n\n    const [isInputModalOpen, setIsInputModalOpen] = useState(false);\n\n    const { register } = useKeyboardNav({ enabled: !isInputModalOpen });\n\n    return (\n        <Container>\n            <MenuContainer>\n                <MenuButton {...register('button-resume-song', onResume)} ref={menuRef}>\n                    Resume song\n                </MenuButton>\n                <MenuButton {...register('button-restart-song', onRestart)}>Restart song</MenuButton>\n                <MenuButton {...register('button-exit-song', onExit)}>Exit song</MenuButton>\n                <MenuButton {...register('input-settings', () => setIsInputModalOpen(true))}>\n                    Microphones settings\n                </MenuButton>\n                <hr />\n                <InputLag ref={inputLagRef} {...register('input-lag', () => inputLagRef.current?.focus())} />\n            </MenuContainer>\n            {isInputModalOpen && (\n                <SelectInputModal onClose={() => setIsInputModalOpen(false)} closeButtonText={'Back to Pause Menu'} />\n            )}\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    position: absolute;\n    z-index: 10;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n\n    display: flex;\n\n    align-items: center;\n    justify-content: center;\n`;\n","import { Song, SongPreview } from 'interfaces';\nimport beatToMs from 'Scenes/Game/Singing/GameState/Helpers/beatToMs';\nimport { getFirstNoteStartFromSections } from 'Songs/utils/notesSelectors';\n\nexport default function getSongFirstNoteMs(song: Song | SongPreview): number {\n    const firstNote = Math.min(\n        ...song.tracks.map((track) =>\n            'sections' in track ? getFirstNoteStartFromSections(track.sections) : track.start,\n        ),\n    );\n    return beatToMs(firstNote, song) + song.gap;\n}\n","import { seconds, Song, SongPreview } from 'interfaces';\nimport getSongFirstNoteMs from 'Songs/utils/getSongFirstNoteMs';\nimport isDev from 'utils/isDev';\nimport isE2E from 'utils/isE2E';\n\nexport const SKIP_INTRO_MS = isDev() || isE2E() ? 1_000 : 8_000;\n\nexport default function getSkipIntroTime(song: Song | SongPreview): seconds {\n    return Math.floor((getSongFirstNoteMs(song) - SKIP_INTRO_MS) / 1000);\n}\n","import { Song, SongPreview } from 'interfaces';\nimport getSongFirstNoteMs from 'Songs/utils/getSongFirstNoteMs';\n\nconst SKIP_INTRO_THRESHOLD_MS = 20_000;\n\nexport default function songHasLongIntro(song: Song | SongPreview) {\n    const lyricStartMs = getSongFirstNoteMs(song);\n\n    return lyricStartMs - (song.videoGap ?? 0) * 1000 > SKIP_INTRO_THRESHOLD_MS;\n}\n","import styled from '@emotion/styled';\nimport { VideoPlayerRef } from 'Elements/VideoPlayer';\nimport { typography } from 'Elements/cssMixins';\nimport GameState from 'Scenes/Game/Singing/GameState/GameState';\nimport { MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport getSkipIntroTime, { SKIP_INTRO_MS } from 'Songs/utils/getSkipIntroTime';\nimport getSongFirstNoteMs from 'Songs/utils/getSongFirstNoteMs';\nimport useKeyboard from 'hooks/useKeyboard';\nimport useKeyboardHelp from 'hooks/useKeyboardHelp';\nimport posthog from 'posthog-js';\nimport { useMemo } from 'react';\nimport songHasLongIntro from 'utils/songHasLongIntro';\n\ninterface Props {\n    playerRef: VideoPlayerRef | null;\n    isEnabled: boolean;\n}\n\nfunction SkipIntro({ playerRef, isEnabled }: Props) {\n    const [mobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n    const song = GameState.getSong()!;\n    const hasLongIntro = useMemo(() => songHasLongIntro(song), [song]);\n    const songFirstNoteMs = useMemo(() => getSongFirstNoteMs(song), [song]);\n    const shouldBeVisible = GameState.getCurrentTime(false) < songFirstNoteMs - SKIP_INTRO_MS * 1.2;\n\n    const canSkip = isEnabled && shouldBeVisible && hasLongIntro;\n\n    const skipIntro = () => {\n        playerRef?.seekTo(getSkipIntroTime(song));\n\n        const { artist, title } = GameState.getSong()!;\n        posthog.capture('introSkipped', { name: `${artist} - ${title}`, artist, title });\n    };\n    useKeyboard({ accept: skipIntro }, canSkip);\n\n    const help = useMemo(\n        () => ({\n            accept: 'Skip Intro',\n            back: 'Pause Menu',\n        }),\n        [],\n    );\n    useKeyboardHelp(help, canSkip);\n\n    return !mobilePhoneMode && canSkip ? (\n        <Container visible={canSkip} data-test=\"skip-intro-info\">\n            Press <Kbd>Enter</Kbd> to skip the intro\n        </Container>\n    ) : null;\n}\n\nconst Container = styled.div<{ visible: boolean }>`\n    ${typography};\n    pointer-events: none;\n    position: fixed;\n    bottom: 29rem;\n    transform: scale(${(props) => (props.visible ? 1 : 0)});\n    opacity: ${(props) => (props.visible ? 1 : 0)};\n    text-align: center;\n    font-size: 5rem;\n    text-shadow: 0 0 3.5rem black;\n    width: 100%;\n    z-index: 4;\n    padding: 0.5rem;\n    transition: ease 500ms;\n`;\n\nconst Kbd = styled.kbd<{ disabled?: boolean }>`\n    margin: 0.2rem;\n    padding: 0.2rem 2rem;\n    border-radius: 1.3rem;\n    border: 0.5rem solid rgb(204, 204, 204);\n    border-bottom-color: rgb(150, 150, 150);\n    border-right-color: rgb(150, 150, 150);\n    line-height: 1.4;\n    display: inline-block;\n    background-color: rgb(247, 247, 247);\n    text-shadow: 0 1rem 0 #fff;\n\n    opacity: ${(props) => (props.disabled ? 0.25 : 1)};\n`;\n\nexport default SkipIntro;\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport GameState from 'Scenes/Game/Singing/GameState/GameState';\nimport beatToMs from 'Scenes/Game/Singing/GameState/Helpers/beatToMs';\nimport { MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport { getLastNoteEnd } from 'Songs/utils/notesSelectors';\nimport useDebounce from 'hooks/useDebounce';\nimport useKeyboard from 'hooks/useKeyboard';\nimport useKeyboardHelp from 'hooks/useKeyboardHelp';\nimport posthog from 'posthog-js';\nimport React, { useMemo, useState } from 'react';\nimport { useInterval } from 'react-use';\n\ninterface Props {\n    onSongEnd: () => void;\n    isEnabled: boolean;\n}\n\nconst SHOW_OUTRO_THRESHOLD_MS = 15_000;\n\nfunction SkipOutro({ onSongEnd, isEnabled }: Props) {\n    const [mobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n    const duration = GameState.getDuration();\n\n    const singingEndBeat = useMemo(\n        () => Math.max(...GameState.getPlayers().map((player) => getLastNoteEnd(player.getLastNotesSection()))),\n        [],\n    );\n\n    const canSkip = useMemo(() => {\n        const singingEndTime = beatToMs(singingEndBeat, GameState.getSong()!);\n\n        return isEnabled && duration * 1000 > singingEndTime + SHOW_OUTRO_THRESHOLD_MS;\n    }, [duration, singingEndBeat, isEnabled]);\n\n    const [currentBeat, setCurrentBeat] = useState(0);\n    const [skipping, setSkipping] = useState(false);\n\n    useInterval(() => setCurrentBeat(GameState.getCurrentBeat()), 1_000);\n\n    const shouldBeVisible = useDebounce(canSkip && currentBeat > singingEndBeat, 5_000) && !skipping;\n\n    const skipOutro = () => {\n        setSkipping(true);\n        setTimeout(onSongEnd, 700);\n\n        const { artist, title } = GameState.getSong()!;\n        posthog.capture('outroSkipped', { name: `${artist} - ${title}`, artist, title });\n    };\n    useKeyboard({ accept: skipOutro }, shouldBeVisible);\n\n    const help = useMemo(\n        () => ({\n            accept: 'Skip Outro',\n            back: 'Pause Menu',\n        }),\n        [],\n    );\n    useKeyboardHelp(help, shouldBeVisible);\n\n    return !mobilePhoneMode && canSkip ? (\n        <Container visible={shouldBeVisible}>\n            Press <Kbd>Enter</Kbd> to skip the outro\n        </Container>\n    ) : null;\n}\n\nconst Container = styled.div<{ visible: boolean }>`\n    ${typography};\n    pointer-events: none;\n    position: fixed;\n    bottom: 29rem;\n    transform: scale(${(props) => (props.visible ? 1 : 0)});\n    opacity: ${(props) => (props.visible ? 1 : 0)};\n    text-align: center;\n    font-size: 5rem;\n    text-shadow: 0 0 3.5rem black;\n    width: 100%;\n    z-index: 4;\n    padding: 0.5rem;\n    transition: ease 500ms;\n`;\n\nconst Kbd = styled.kbd<{ disabled?: boolean }>`\n    margin: 0.2rem;\n    padding: 0.2rem 2rem;\n    border-radius: 1.3rem;\n    border: 0.5rem solid rgb(204, 204, 204);\n    border-bottom-color: rgb(150, 150, 150);\n    border-right-color: rgb(150, 150, 150);\n    line-height: 1.4;\n    display: inline-block;\n    background-color: rgb(247, 247, 247);\n    text-shadow: 0 1rem 0 #fff;\n\n    opacity: ${(props) => (props.disabled ? 0.25 : 1)};\n`;\n\nexport default React.memo(SkipOutro);\n","import styled from '@emotion/styled';\nimport { getFirstNoteStartFromSections, getLastNoteEndFromSections } from 'Songs/utils/notesSelectors';\nimport { PlayerSetup } from 'interfaces';\nimport { uniq } from 'lodash-es';\nimport { useMemo } from 'react';\nimport GameState from '../../GameState/GameState';\nimport styles from '../Drawing/styles';\n\ninterface Props {\n    players: PlayerSetup[];\n}\n\nfunction DurationBar({ players }: Props) {\n    const currentTime = GameState.getCurrentTime(false);\n    const beatLength = GameState.getSongBeatLength();\n    const duration = GameState.getDuration();\n    const song = GameState.getSong()!;\n\n    const firstNotes = useMemo(\n        () =>\n            uniq(\n                song.tracks\n                    .filter((v, index) => players.find((player) => player.track === index))\n                    .map(({ sections }) => getFirstNoteStartFromSections(sections) * beatLength + song.gap),\n            ),\n        [song, beatLength, players],\n    );\n    const lastNotes = useMemo(\n        () =>\n            uniq(\n                song.tracks\n                    .filter((v, index) => players.find((player) => player.track === index))\n                    .map(({ sections }) => getLastNoteEndFromSections(sections) * beatLength + song.gap),\n            ),\n        [song, beatLength, players],\n    );\n\n    const durationMs = duration * 1000;\n\n    if (!currentTime || !duration) return null;\n\n    return (\n        <Bar>\n            {firstNotes.map((note) => (\n                <Marker key={note} position={note / durationMs} />\n            ))}\n            {lastNotes.map((note) => (\n                <Marker key={note} position={note / durationMs} />\n            ))}\n            <BarFill fill={currentTime / durationMs} />\n        </Bar>\n    );\n}\n\nconst Bar = styled.div`\n    position: absolute;\n    height: 0.6rem;\n    width: 100%;\n    background: rgba(0, 0, 0, 0.5);\n    left: 0;\n    top: calc(50% - 0.3rem);\n`;\n\nconst BaseMarker = styled(Bar)`\n    top: 0;\n    margin-left: -0.25rem;\n    width: 0.5rem;\n    background: ${styles.colors.text.active};\n    opacity: 75%;\n`;\n\nconst Marker = (props: { position: number }) => (\n    <BaseMarker style={{ left: `${Math.min(props.position * 100, 100)}%` }} />\n);\n\nconst BaseBarFill = styled(Bar)`\n    top: 0;\n    background: white;\n    opacity: 50%;\n`;\n\nconst BarFill = (props: { fill: number }) => (\n    <BaseBarFill style={{ width: `${Math.round(props.fill * 10_000) / 100}%` }} />\n);\n\nexport default DurationBar;\n","import styled from '@emotion/styled';\nimport PlayersManager from 'Players/PlayersManager';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport { useEffect, useState } from 'react';\n\ninterface Props {\n    playerNumber: number;\n}\n\nexport const useDevicePing = (deviceId?: string) => {\n    const [latency, setLatency] = useState<number | null>(null);\n\n    useEffect(() => {\n        const interval = setInterval(() => {\n            const remoteMic = RemoteMicManager.getRemoteMicById(deviceId ?? '');\n\n            setLatency(remoteMic ? remoteMic.getLatency() : null);\n        }, 1000);\n\n        return () => {\n            clearInterval(interval);\n        };\n    }, [deviceId]);\n\n    return latency;\n};\n\nfunction Ping({ playerNumber, ...restProps }: Props) {\n    const latency = useDevicePing(PlayersManager.getPlayer(playerNumber).input?.deviceId);\n\n    return <>{latency !== null ? <PingContainer {...restProps}>{latency}ms</PingContainer> : ''}</>;\n}\nexport default Ping;\n\nconst PingContainer = styled.span`\n    position: absolute;\n    right: 4rem;\n    bottom: 0.5rem;\n    font-size: 1.75rem;\n`;\n","import styled from '@emotion/styled';\nimport { ThumbUpAlt } from '@mui/icons-material';\nimport ErrorIcon from '@mui/icons-material/Error';\nimport SignalCellularAltIcon from '@mui/icons-material/SignalCellularAlt';\nimport WarningIcon from '@mui/icons-material/Warning';\nimport { typography } from 'Elements/cssMixins';\nimport { inputStatus } from 'Scenes/Game/Singing/Input/Interface';\n\ninterface Props {\n    status: inputStatus;\n    tooltipPosition?: 'start' | 'end';\n}\n\nfunction PlayerStatus({ status, tooltipPosition = 'end', ...restProps }: Props) {\n    return (\n        <StatusContainer {...restProps}>\n            {status === 'ok' ? (\n                <ThumbUpAlt data-test=\"status-ok\" />\n            ) : status === 'unavailable' ? (\n                <UnavailableIcon data-test=\"status-unavailable\" />\n            ) : (\n                <UnstableIcon data-test=\"status-unstable\" />\n            )}\n            {status === 'unavailable' ? (\n                <StatusDescription position={tooltipPosition}>\n                    <span>\n                        The device is <strong>disconnected</strong>. Reconnect it, please.\n                    </span>\n                </StatusDescription>\n            ) : status === 'unstable' ? (\n                <StatusDescription position={tooltipPosition}>\n                    <span>\n                        The connection seems <strong>unstable</strong>. Connect to the same Wifi.\n                    </span>\n                </StatusDescription>\n            ) : null}\n        </StatusContainer>\n    );\n}\nexport default PlayerStatus;\n\nconst StatusContainer = styled.span`\n    position: absolute;\n    right: 0.5rem;\n    top: 0.5rem;\n    font-size: 3rem;\n    z-index: 10;\n    svg {\n        width: 3rem;\n        height: 3rem;\n        text-shadow: black;\n    }\n`;\n\nconst OkIcon = styled(SignalCellularAltIcon)`\n    fill: #ffffff;\n    stroke: black;\n    stroke-width: 1px;\n`;\n\nconst UnavailableIcon = styled(ErrorIcon)`\n    fill: #ff0000;\n`;\n\nconst UnstableIcon = styled(WarningIcon)`\n    fill: #f89400;\n    stroke: black;\n`;\n\nconst StatusDescription = styled.div<{ position: Props['tooltipPosition'] }>`\n    ${typography};\n    position: absolute;\n    ${(props) => (props.position === 'end' ? 'left: 100%' : 'right: 150%')};\n    top: -0.5rem;\n    font-size: 1.5rem;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    width: 25rem;\n    background: rgba(0, 0, 0, 0.75);\n    padding: 0.5rem;\n    margin-left: 2rem;\n`;\n","import { useEffect, useState } from 'react';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport { inputStatus } from 'Scenes/Game/Singing/Input/Interface';\n\nconst usePlayerMicStatus = (\n    playerNumber: number,\n    intervalMs = 333,\n    onMeasure?: ([volume, frequency]: [number, number]) => void,\n) => {\n    const [data, setData] = useState<inputStatus>('ok');\n\n    useEffect(() => {\n        const interval = setInterval(() => {\n            setData(InputManager.getInputStatus(playerNumber));\n        }, intervalMs);\n\n        return () => {\n            clearInterval(interval);\n        };\n    }, [playerNumber, intervalMs, onMeasure]);\n\n    return data;\n};\n\nexport default usePlayerMicStatus;\n","import styled from '@emotion/styled';\nimport { VolumeIndicator } from 'Elements/VolumeIndicator';\nimport { PlayerEntity } from 'Players/PlayersManager';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport Ping from 'Scenes/SingASong/SongSelection/SongSettings/MicCheck/Ping';\nimport PlayerStatus from 'Scenes/SingASong/SongSelection/SongSettings/MicCheck/Status';\nimport usePlayerMicStatus from 'hooks/players/usePlayerMicStatus';\n\ninterface Props {\n    player: PlayerEntity;\n    bottom?: boolean;\n}\n\nfunction LyricsVolumeIndicator({ player, bottom = false }: Props) {\n    const playerVolume = InputManager.getPlayerVolume(player.number);\n    const status = usePlayerMicStatus(player.number);\n\n    return (\n        <Container>\n            {status !== 'unavailable' && <VolumeIndicator playerNumber={player.number} volume={playerVolume} />}\n            <StyledPlayerStatus status={status} tooltipPosition=\"start\" />\n            <StyledPing playerNumber={player.number} />\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    position: absolute;\n    width: 20rem;\n    right: 0;\n    top: 0;\n    height: 100%;\n`;\n\nconst StyledPlayerStatus = styled(PlayerStatus)`\n    top: auto;\n    right: 1rem;\n    bottom: 1rem;\n`;\nconst StyledPing = styled(Ping)`\n    z-index: 2;\n    font-size: 2rem;\n    margin-right: 1rem;\n    -webkit-text-stroke: 0.1rem black;\n    bottom: 1.5rem;\n`;\n\nexport default LyricsVolumeIndicator;\n","import styled from '@emotion/styled';\nimport SwapHorizIcon from '@mui/icons-material/SwapHoriz';\nimport { PlayerEntity } from 'Players/PlayersManager';\nimport LyricsVolumeIndicator from 'Scenes/Game/Singing/GameOverlay/Components/LyricsVolumeIndicator';\nimport { MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { getFirstNoteStartFromSections } from 'Songs/utils/notesSelectors';\nimport { Note } from 'interfaces';\nimport { ComponentProps, Fragment, PropsWithChildren } from 'react';\nimport GameState from '../../GameState/GameState';\nimport styles from '../Drawing/styles';\n\ninterface Props {\n    player: PlayerEntity;\n    bottom?: boolean;\n    playerChanges: number[][];\n    effectsEnabled: boolean;\n}\n\nfunction Lyrics({ player, playerChanges, bottom = false, effectsEnabled }: Props) {\n    const playerState = GameState.getPlayer(player.number)!;\n    const [mobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n    const playerColor = styles.colors.players[player.number].text;\n    const thisPlayerChanges = playerChanges[playerState.getTrackIndex()] ?? [];\n    const section = playerState.getCurrentSection();\n    const nextSection = playerState.getNextSection();\n    const subsequentSection = playerState.getNextSection(2);\n    const currentBeat = GameState.getCurrentBeat();\n    const beatLength = GameState.getSongBeatLength();\n\n    const previousChange = Math.max(0, ...thisPlayerChanges.filter((beat) => beat <= section?.start ?? -Infinity));\n    const nextChange = thisPlayerChanges.find((beat) => beat > section?.start ?? Infinity) ?? Infinity;\n    const timeToNextChange = (nextChange - currentBeat) * beatLength;\n\n    const passTheMicProgress = (nextChange - currentBeat) / (nextChange - previousChange);\n\n    const shouldBlink = timeToNextChange < 2500;\n\n    const hasNotes = isNotesSection(section);\n\n    const beatsBetweenSectionAndNote = hasNotes ? getFirstNoteStartFromSections([section]) - section.start : 0;\n\n    return (\n        <LyricsContainer shouldBlink={shouldBlink} bottom={bottom}>\n            {!mobilePhoneMode && effectsEnabled && <LyricsVolumeIndicator player={player} />}\n            {timeToNextChange < Infinity && (\n                <PassTheMicProgress\n                    color={playerColor}\n                    progress={passTheMicProgress <= 1 ? passTheMicProgress * 100 : 0}\n                />\n            )}\n            {hasNotes ? (\n                <>\n                    <LyricsLine data-test={`lyrics-current-player-${player.number}`} effectsEnabled={effectsEnabled}>\n                        <HeadstartContainer>\n                            <Headstart\n                                color={playerColor}\n                                percent={Math.min(2, (currentBeat - section.start) / beatsBetweenSectionAndNote)}\n                            />\n                        </HeadstartContainer>\n                        {section?.notes.map((note) => {\n                            const fill = effectsEnabled\n                                ? Math.max(0, Math.min(2, (currentBeat - note.start) / note.length))\n                                : currentBeat >= note.start\n                                ? 1\n                                : 0;\n                            return (\n                                <LyricContainer type={note.type} key={note.start}>\n                                    <LyricActiveContainer>\n                                        <LyricActive fill={fill} color={playerColor}>\n                                            {note.lyrics.trim()}\n                                        </LyricActive>\n                                        {note.lyrics.endsWith(' ') && ' '}\n                                    </LyricActiveContainer>\n                                    {note.lyrics}\n                                </LyricContainer>\n                            );\n                        })}\n                        {nextSection?.start === nextChange && <PassTheMicSymbol shouldShake />}\n                    </LyricsLine>\n                </>\n            ) : (\n                <LyricsLine effectsEnabled={effectsEnabled}>&nbsp;</LyricsLine>\n            )}\n            {isNotesSection(nextSection) ? (\n                <LyricsLine nextLine data-test={`lyrics-next-player-${player.number}`} effectsEnabled={effectsEnabled}>\n                    {nextSection.notes.map((note) => (\n                        <Fragment key={note.start}>{note.lyrics}</Fragment>\n                    ))}\n                    {subsequentSection?.start === nextChange && <PassTheMicSymbol />}\n                </LyricsLine>\n            ) : (\n                <LyricsLine effectsEnabled={effectsEnabled} nextLine>\n                    &nbsp;\n                </LyricsLine>\n            )}\n        </LyricsContainer>\n    );\n}\n\nconst HeadstartContainer = styled.span`\n    position: relative;\n    height: 0;\n`;\n\nconst BaseHeadstart = styled.span`\n    position: absolute;\n    width: 15rem;\n    height: 3.1rem;\n    margin: 0.7rem 0;\n    right: 10rem;\n`;\n\nconst Headstart = ({ percent, color }: { percent: number; color: string }) => (\n    <BaseHeadstart\n        style={{\n            transformOrigin: 'right',\n            transform: `scaleX(${Math.min(1, 2 - percent)})`,\n            right: `${Math.max(0, 1 - percent) * 15}rem`,\n            background: `linear-gradient(270deg, rgba(${color}, 1) 0%, rgba(${color}, 0.5) 25%, rgba(${color}, 0) 100%)`,\n        }}\n    />\n);\n\nconst LyricsContainer = styled.div<{ shouldBlink: boolean; bottom: boolean }>`\n    @keyframes blink {\n        100% {\n            background-color: rgba(0, 0, 0, ${(props) => (props.bottom ? '0.85' : '0.5')});\n        }\n        30% {\n            background-color: rgba(0, 0, 0, ${(props) => (props.bottom ? '0.85' : '0.5')});\n        }\n        50% {\n            background-color: rgba(200, 200, 200, ${(props) => (props.bottom ? '0.85' : '0.5')});\n        }\n        30% {\n            background-color: rgba(0, 0, 0, ${(props) => (props.bottom ? '0.85' : '0.5')});\n        }\n        0% {\n            background-color: rgba(0, 0, 0, ${(props) => (props.bottom ? '0.85' : '0.5')});\n        }\n    }\n\n    box-sizing: border-box;\n\n    padding: 1rem;\n    background: rgba(0, 0, 0, ${(props) => (props.bottom ? '0.9' : '0.5')});\n    width: 100%;\n    text-align: center;\n    line-height: 1;\n    margin: 2rem 0;\n    position: relative;\n    ${(props) => (props.shouldBlink ? `animation: blink 350ms ease-in-out infinite both;` : ``)}\n`;\n\nconst LyricContainer = styled.span<{ type: Note['type'] }>`\n    font-style: ${(props) => (props.type === 'freestyle' ? 'italic' : 'normal')};\n`;\n\nconst LyricActiveContainer = styled.span`\n    position: absolute;\n    z-index: 1;\n`;\nconst BaseLyricActive = styled.span``;\n\nconst LyricActive = ({ fill, color, children }: PropsWithChildren<{ fill: number; color: string }>) => (\n    <BaseLyricActive\n        style={{\n            clipPath: `inset(0 ${(1 - (fill === 0 ? 0 : fill + 0.05)) * 100}% -5rem 0)`,\n            color: `rgb(${color})`,\n        }}>\n        {children}\n    </BaseLyricActive>\n);\n\nconst BasePassTheMicProgress = styled.div<{ color: string }>`\n    position: absolute;\n    height: 1rem;\n    background: rgb(${(props) => props.color});\n    width: 100%;\n`;\n\nconst PassTheMicProgress = (props: { progress: number } & ComponentProps<typeof BasePassTheMicProgress>) => (\n    <BasePassTheMicProgress\n        style={{\n            transformOrigin: 'left',\n            transform: `scaleX(${props.progress / 100})`,\n        }}\n        color={props.color}\n    />\n);\n\nconst PassTheMicSymbol = styled(SwapHorizIcon, { shouldForwardProp: (prop) => prop !== 'shouldShake' })<{\n    shouldShake?: boolean;\n}>`\n    @keyframes shake {\n        10%,\n        90% {\n            transform: translate3d(-0.1rem, 0, 0);\n        }\n\n        20%,\n        80% {\n            transform: translate3d(0.2rem, 0, 0);\n        }\n\n        30%,\n        50%,\n        70% {\n            transform: translate3d(-0.4rem, 0, 0);\n        }\n\n        40%,\n        60% {\n            transform: translate3d(0.4rem, 0, 0);\n        }\n    }\n\n    ${(props) => props.shouldShake && 'animation: shake 0.92s cubic-bezier(0.36, 0.07, 0.19, 0.97) both infinite;'}\n    margin-left: 2rem;\n    ${(props) => (props.shouldShake ? `fill: ${styles.colors.text.active};` : '')}\n    font-size: ${(props) => (props.shouldShake ? 4 : 3)}rem;\n`;\nconst LyricsLine = styled.div<{ nextLine?: boolean; effectsEnabled: boolean }>`\n    font-size: ${({ nextLine, effectsEnabled }) => (effectsEnabled ? 3.5 + (nextLine ? 0 : 1) : 2)}rem;\n    height: ${({ effectsEnabled }) => (effectsEnabled ? 4.5 : 2)}rem;\n    ${({ effectsEnabled }) => (!effectsEnabled ? '-webkit-text-stroke-width: 2px' : '')};\n\n    color: ${({ nextLine }) => (nextLine ? styles.colors.text.inactive : styles.colors.text.default)};\n\n    font-family: 'Comic Sans MS', 'Comic Sans';\n    z-index: 10;\n`;\n\nexport default Lyrics;\n","interface Props {\n    score: number;\n}\n\nexport const formatter = new Intl.NumberFormat(undefined, { maximumFractionDigits: 0 });\n\nexport default function ScoreText({ score }: Props) {\n    return <>{formatter.format(score)}</>;\n}\n","import { PlayerNote } from 'interfaces';\nimport styles from '../../styles';\n\nexport function getColor(\n    ctx: CanvasRenderingContext2D,\n    playerNumber: number,\n    isStar: boolean,\n    isHit: boolean,\n    isPerfect: boolean,\n) {\n    if (isPerfect && isStar) {\n        return styles.colors.players[playerNumber].starPerfect;\n    } else if (isPerfect) {\n        return styles.colors.players[playerNumber].perfect;\n    } else if (isStar && isHit) {\n        return styles.colors.players[playerNumber].star;\n    } else if (isHit) {\n        return styles.colors.players[playerNumber].hit;\n    } else {\n        return styles.colors.players[playerNumber].miss;\n    }\n}\n\nexport default function getNoteColor(\n    ctx: CanvasRenderingContext2D,\n    playerNumber: number,\n    isHit: boolean,\n    playerNote: PlayerNote,\n) {\n    return getColor(ctx, playerNumber, playerNote.note.type === 'star', isHit, playerNote.isPerfect);\n}\n","export default function triangle(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    angle: number,\n    color: string | CanvasGradient | CanvasPattern,\n    alpha: number = 1,\n) {\n    ctx.save();\n\n    // move to the center of the canvas\n    const finalX = x - width / 2;\n    const finalY = y - height / 2;\n\n    ctx.translate(finalX, finalY);\n\n    // rotate the canvas to the specified degrees\n    ctx.rotate((angle * Math.PI) / 180);\n\n    ctx.globalAlpha = alpha;\n    ctx.fillStyle = color;\n    ctx.beginPath();\n    ctx.moveTo(0 - width / 2, height / 2);\n    ctx.lineTo(width / 2, height / 2);\n    ctx.lineTo(width / 2, 0);\n    ctx.lineTo(width / 2, 0 - height / 2);\n    ctx.fill();\n    ctx.globalAlpha = 1;\n    ctx.restore();\n}\n","const spreadValue = (initial: number, spread: number) => initial - spread + Math.random() * spread * 2;\n\nexport default spreadValue;\n\nexport const randomSign = () => Math.sign(Math.random() - 0.5);\n","import triangle from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/triangle';\nimport spreadValue from 'Scenes/Game/Singing/GameOverlay/Drawing/Particles/utils';\nimport Particle from '../interfaces';\n\nconst baseTtlMs = 300;\nconst ttlSpreadMs = 50;\n\nconst velocityModifier = 1.3;\n\nexport default class SungTriangle implements Particle {\n    public finished = false;\n\n    private ttl;\n    private startingTtl;\n    private velocityX;\n    private velocityY;\n    private width;\n    private initialAngle;\n    private heightModifier;\n\n    constructor(private x: number, private y: number, private color: string) {\n        this.startingTtl = this.ttl = spreadValue(baseTtlMs, ttlSpreadMs);\n        this.velocityX = velocityModifier * Math.random() - velocityModifier / 2;\n        this.velocityY = velocityModifier * Math.random() - velocityModifier / 2;\n        this.width = 25;\n        this.initialAngle = 180 - Math.random() * 360;\n        this.heightModifier = 0.5 + Math.random() / 2;\n    }\n    public tick = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement, delta: number) => {\n        const percentage = 1 - this.ttl / this.startingTtl;\n        const ticksLeft = this.ttl;\n\n        const width = this.width * percentage;\n        const height = this.width * this.heightModifier * percentage;\n\n        const x = this.x - width / 2 + ticksLeft * this.velocityX;\n        const y = this.y + height / 2 + ticksLeft * this.velocityY;\n\n        triangle(ctx, x, y, width, height, this.initialAngle + ticksLeft, this.color, 0.7 * percentage);\n\n        this.ttl = this.ttl - delta;\n        this.finished = this.ttl <= 0;\n    };\n}\n","export const randomFloat = (from: number, to: number) => {\n    return from + Math.random() * (to - from);\n};\n\nexport const randomInt = (from: number, to: number) => Math.round(randomFloat(from, to));\n","import { FrequencyRecord, PlayerNote, Section, Song } from 'interfaces';\nimport isNotesSection from 'Songs/utils/isNotesSection';\n\nexport const pitchPadding = 6;\n\nexport const NOTE_HEIGHT = 30;\nexport const BIG_NOTE_HEIGHT = NOTE_HEIGHT + 6;\n\nexport default function calculateData({\n    canvas,\n    currentSectionIndex,\n    song,\n    songBeatLength,\n    minPitch,\n    maxPitch,\n    track,\n    paddingVertical,\n}: DrawingData) {\n    const sections = song.tracks[track].sections;\n    const currentSection = sections[currentSectionIndex];\n    const nextSection = sections[currentSectionIndex + 1];\n\n    // If the ratio is higher than 16/9 (e.g. 21/9), pad the excess horizontal space\n    // so in the end the notes are drawn over the same area as it would be on 16/9\n    const pixelsOverRatio = Math.max(0, (canvas.width - canvas.height * (16 / 9)) / 2);\n\n    const paddingHorizontal = 10 + (canvas.width - 2 * pixelsOverRatio) * 0.15 + pixelsOverRatio;\n    const lastNote = isNotesSection(currentSection) ? currentSection?.notes?.at(-1) : undefined;\n    const sectionEndBeat = isNotesSection(currentSection)\n        ? nextSection?.start ?? lastNote!.start + lastNote!.length\n        : currentSection.end;\n    const timeSectionGap = currentSection.start * songBeatLength;\n    const maxTime = (sectionEndBeat - currentSection.start) * songBeatLength;\n\n    const canvasHeight = canvas.height - 2 * paddingVertical;\n\n    const pitchStepHeight = (canvasHeight / 2 - 20 - NOTE_HEIGHT) / (maxPitch - minPitch + pitchPadding * 2);\n\n    return {\n        canvasHeight,\n        paddingHorizontal,\n        currentSection,\n        sectionEndBeat,\n        timeSectionGap,\n        maxTime,\n        pitchStepHeight,\n    };\n}\n\nexport interface DrawingData {\n    playerNumber: number;\n    song: Song;\n    songBeatLength: number;\n    minPitch: number;\n    maxPitch: number;\n    canvas: HTMLCanvasElement;\n    currentTime: number;\n    currentSectionIndex: number;\n    frequencies: FrequencyRecord[];\n    playerNotes: PlayerNote[];\n    currentPlayerNotes: PlayerNote[];\n    track: number;\n\n    currentBeat: number;\n    paddingVertical: number;\n    currentSection: Section | undefined; // `undefined` can happen with `sectionShift` parameter\n}\n","function simpleRoundRect(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    radius: number,\n    fill: boolean,\n    stroke: boolean,\n) {\n    const actualWidth = Math.max(width, height / 2);\n    const actualRadius = Math.min(actualWidth / 2, height / 2, radius);\n\n    ctx.beginPath();\n    ctx.moveTo(x + actualRadius, y);\n    ctx.lineTo(x + actualWidth - actualRadius, y);\n    ctx.quadraticCurveTo(x + actualWidth, y, x + actualWidth, y + actualRadius);\n    ctx.lineTo(x + actualWidth, y + height - actualRadius);\n    ctx.quadraticCurveTo(x + actualWidth, y + height, x + actualWidth - actualRadius, y + height);\n    ctx.lineTo(x + actualRadius, y + height);\n    ctx.quadraticCurveTo(x, y + height, x, y + height - actualRadius);\n    ctx.lineTo(x, y + actualRadius);\n    ctx.quadraticCurveTo(x, y, x + actualRadius, y);\n    ctx.closePath();\n    if (fill) {\n        ctx.fill();\n    }\n    if (stroke) {\n        ctx.stroke();\n    }\n}\n\nexport default function roundRect(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    radius: number,\n    fill: boolean,\n    stroke: boolean,\n    glass = 0.1,\n) {\n    simpleRoundRect(ctx, x, y, width, height, radius, fill, stroke);\n\n    if (fill && glass > 0) {\n        ctx.save();\n        simpleRoundRect(ctx, x, y, width, height, radius, false, false);\n        ctx.clip();\n\n        ctx.fillStyle = `rgba(255,255,255,${glass})`;\n        ctx.fillRect(x, y, width, height / 2.2);\n\n        ctx.restore();\n    }\n}\n","export default function applyColor(\n    ctx: CanvasRenderingContext2D,\n    style: { fill: string; stroke: string; lineWidth: number },\n) {\n    ctx.fillStyle = style.fill;\n    ctx.strokeStyle = style.stroke;\n    ctx.lineWidth = style.lineWidth;\n}\n","import roundRect from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/roundRect';\nimport applyColor from 'Scenes/Game/Singing/GameOverlay/Drawing/applyColor';\nimport { Note } from 'interfaces';\nimport styles from '../../../styles';\n\nexport default function drawRawNote(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    noteType: Note['type'],\n) {\n    if (noteType === 'star') {\n        applyColor(ctx, styles.colors.lines.star);\n    } else if (noteType === 'freestyle' || noteType === 'rap') {\n        applyColor(ctx, styles.colors.lines.freestyle);\n    } else {\n        applyColor(ctx, styles.colors.lines.normal);\n    }\n\n    ctx.shadowBlur = 10;\n    ctx.shadowColor = 'rgb(31,31,31)';\n    ctx.shadowOffsetX = 0;\n    ctx.shadowOffsetY = 0;\n    roundRect(ctx!, x, y, width, height, 100, true, true, 0.075);\n\n    ctx.shadowBlur = 0;\n    ctx.shadowOffsetX = 0;\n    ctx.shadowOffsetY = 0;\n}\n","import applyColor from 'Scenes/Game/Singing/GameOverlay/Drawing/applyColor';\nimport roundRect from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/roundRect';\nimport * as test from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/utils/getNoteColor';\n\nexport default function drawRawPlayerNote(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    playerNumber: number,\n    isHit: boolean,\n    isPerfect: boolean,\n    isStar: boolean,\n) {\n    applyColor(ctx, test.getColor(ctx, playerNumber, isStar, isHit, isPerfect));\n\n    ctx.shadowBlur = 5;\n    ctx.shadowColor = 'rgba(31,31,31, .7)';\n    ctx.shadowOffsetX = 1;\n    ctx.shadowOffsetY = 1;\n    roundRect(ctx!, x, y, width, height, 100, true, true, isHit ? 0.15 : 0);\n    ctx.shadowBlur = 0;\n    ctx.shadowOffsetX = 0;\n    ctx.shadowOffsetY = 0;\n}\n","import { BIG_NOTE_HEIGHT, NOTE_HEIGHT } from 'Scenes/Game/Singing/GameOverlay/Drawing/calculateData';\nimport drawRawNote from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/Elements/note';\nimport drawRawPlayerNote from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/Elements/playerNote';\n\nconst SHADOW_PAD = 10;\n\nexport const smallNoteFragments = {\n    start: { x: 0, y: 0, w: NOTE_HEIGHT / 2 + SHADOW_PAD, h: NOTE_HEIGHT + SHADOW_PAD * 2 },\n    middle: { x: NOTE_HEIGHT / 2 + SHADOW_PAD, y: 0, w: 1, h: NOTE_HEIGHT + SHADOW_PAD * 2 },\n    end: {\n        x: NOTE_HEIGHT / 2 + 1 + SHADOW_PAD,\n        y: 0,\n        w: NOTE_HEIGHT / 2 + SHADOW_PAD,\n        h: NOTE_HEIGHT + SHADOW_PAD * 2,\n    },\n};\nexport const bigNoteFragments = {\n    start: { x: 0, y: 0, w: BIG_NOTE_HEIGHT / 2 + SHADOW_PAD, h: BIG_NOTE_HEIGHT + SHADOW_PAD * 2 },\n    middle: { x: BIG_NOTE_HEIGHT / 2 + SHADOW_PAD, y: 0, w: 1, h: BIG_NOTE_HEIGHT + SHADOW_PAD * 2 },\n    end: {\n        x: BIG_NOTE_HEIGHT / 2 + 1 + SHADOW_PAD,\n        y: 0,\n        w: BIG_NOTE_HEIGHT / 2 + SHADOW_PAD,\n        h: BIG_NOTE_HEIGHT + SHADOW_PAD * 2,\n    },\n};\n\nconst spriteMap = {\n    blueMiss: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 0, false, false, false),\n        width: NOTE_HEIGHT + 1,\n        height: NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: smallNoteFragments,\n    },\n    blueHit: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 0, true, false, false),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    bluePerfect: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 0, true, true, false),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    blueStarMiss: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 0, false, false, true),\n        width: NOTE_HEIGHT + 1,\n        height: NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: smallNoteFragments,\n    },\n    blueStarHit: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 0, true, false, true),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    blueStarPerfect: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 0, true, true, true),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    redMiss: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 1, false, false, false),\n        width: NOTE_HEIGHT + 1,\n        height: NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: smallNoteFragments,\n    },\n    redHit: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 1, true, false, false),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    redPerfect: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 1, true, true, false),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    redStarMiss: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 1, false, false, true),\n        width: NOTE_HEIGHT + 1,\n        height: NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: smallNoteFragments,\n    },\n    redStarHit: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 1, true, false, true),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    redStarPerfect: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 1, true, true, true),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    noteNormal: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawNote(ctx, x, y, w, h, 'normal'),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    noteStar: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawNote(ctx, x, y, w, h, 'star'),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    noteFreestyle: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawNote(ctx, x, y, w, h, 'freestyle'),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    noteRap: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawNote(ctx, x, y, w, h, 'rap'),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n};\n\nexport type SpriteNames = keyof typeof spriteMap;\n\nexport default spriteMap;\n","// In tests this function is mocked so it creates node-canvas object\nexport default function createCanvas(w: number, h: number) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w;\n    canvas.height = h;\n\n    return canvas;\n}\n","import { add } from 'lodash-es';\nimport spriteMap, {\n    smallNoteFragments,\n    SpriteNames,\n} from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/spriteMap';\nimport createCanvas from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/utils/createCanvas';\n\nconst maxWidth = Math.max(...Object.values(spriteMap).map((sprite) => sprite.padding * 2 + sprite.width));\nconst height = Object.values(spriteMap)\n    .map((sprite) => sprite.padding * 2 + sprite.height)\n    .reduce(add, 0);\n\nconst cachedCanvas = createCanvas(maxWidth, height);\nconst ctx = cachedCanvas.getContext('2d')!;\n\nlet currentHeight = 0;\nconst positions = Object.entries(spriteMap)\n    .map(([name, sprite]) => {\n        const pads = sprite.padding * 2;\n        const position = { name, x: 0, y: currentHeight, w: sprite.width + pads, h: sprite.height + pads };\n        currentHeight = currentHeight + sprite.height + pads;\n\n        return position;\n    })\n    .reduce(\n        (acc, position) => ({ ...acc, [position.name]: position }),\n        {} as Record<SpriteNames, { x: number; y: number; w: number; h: number }>,\n    );\n\ncurrentHeight = 0;\nObject.entries(spriteMap).forEach(([key, entry]) => {\n    entry.draw(ctx, entry.padding, currentHeight + entry.padding, entry.width, entry.height);\n    currentHeight = currentHeight + entry.padding * 2 + entry.height;\n});\n\nexport const getSprite = (sprite: SpriteNames, fragment: keyof typeof smallNoteFragments) => {\n    return {\n        canvas: cachedCanvas,\n        ctx,\n        x: positions[sprite].x + spriteMap[sprite].fragments[fragment].x,\n        y: positions[sprite].y + spriteMap[sprite].fragments[fragment].y,\n        w: spriteMap[sprite].fragments[fragment].w,\n        h: spriteMap[sprite].fragments[fragment].h,\n        padding: spriteMap[sprite].padding,\n    };\n};\n\nexport const drawSprite = (\n    destCtx: CanvasRenderingContext2D,\n    sprite: SpriteNames,\n    fragment: keyof typeof smallNoteFragments,\n    destX: number,\n    destY: number,\n    destW?: number,\n    destH?: number,\n    paddingWScale = 1,\n    paddingHScale = 1,\n) => {\n    const spriteData = getSprite(sprite, fragment);\n    const { canvas, w, h, y, x, padding } = spriteData;\n    const finalWPadding = padding * paddingWScale;\n    const finalHPadding = padding * paddingHScale;\n\n    destCtx.imageSmoothingEnabled = false;\n    destCtx.drawImage(canvas, x, y, w, h, destX - finalWPadding, destY - finalHPadding, destW ?? w, destH ?? h);\n    destCtx.imageSmoothingEnabled = true;\n\n    return spriteData;\n};\n","import { drawSprite, getSprite } from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/cachedSprites';\nimport { SpriteNames } from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/spriteMap';\n\nexport default function drawSpriteWithStartAndEnd(\n    ctx: CanvasRenderingContext2D,\n    spriteName: SpriteNames,\n    x: number,\n    y: number,\n    width: number,\n) {\n    const startData = getSprite(spriteName, 'start');\n\n    const actualWidth = Math.max(width, (startData.h - startData.padding * 2) / 2);\n\n    const widthScale = Math.min(1, actualWidth / 2 / (startData.w - startData.padding));\n    const endingsWidth = widthScale * startData.w;\n    const endingsSize = endingsWidth - startData.padding * widthScale;\n\n    const middleSize = actualWidth - 2 * endingsSize;\n\n    drawSprite(ctx, spriteName, 'start', x, y, endingsWidth, undefined, widthScale);\n    if (middleSize > 0) {\n        drawSprite(ctx, spriteName, 'middle', x + endingsWidth, y, middleSize, undefined, widthScale);\n    }\n    drawSprite(ctx, spriteName, 'end', x + middleSize + endingsWidth, y, endingsWidth, undefined, widthScale);\n}\n","import { Note } from 'interfaces';\nimport { capitalize } from 'lodash-es';\nimport { SpriteNames } from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/spriteMap';\nimport drawSpriteWithStartAndEnd from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/spriteWithStartAndEnd';\n\nconst getSpriteName = (noteType: Note['type']) => {\n    return `note${capitalize(noteType)}` as SpriteNames;\n};\n\nexport default function drawNote(ctx: CanvasRenderingContext2D, x: number, y: number, width: number, note: Note) {\n    const spriteName = getSpriteName(note.type);\n\n    drawSpriteWithStartAndEnd(ctx, spriteName, x, y, width);\n}\n","import { PlayerNote } from 'interfaces';\nimport roundRect from './roundRect';\n\nexport default function drawPlayerFrequencyTrace(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    playerNote: PlayerNote,\n) {\n    ctx.save();\n    roundRect(ctx, x, y, width, height, 100, false, false);\n    ctx.clip();\n\n    ctx.beginPath();\n    ctx.strokeStyle = 'rgba(255,255,255, .35)';\n    ctx.lineWidth = 3;\n    ctx.lineJoin = 'round';\n\n    ctx.moveTo(x, y + height / 2 - (playerNote.frequencyRecords[0].preciseDistance * height) / 3);\n    for (let i = 1; i < playerNote.frequencyRecords.length; i++) {\n        ctx.lineTo(\n            x + i * (width / (playerNote.frequencyRecords.length - 1)),\n            y + height / 2 - (playerNote.frequencyRecords[i].preciseDistance * height) / 3,\n        );\n    }\n    ctx.stroke();\n    ctx.closePath();\n\n    ctx.restore();\n    ctx.lineJoin = 'miter';\n}\n","import { PlayerNote } from 'interfaces';\nimport { SpriteNames } from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/spriteMap';\nimport drawSpriteWithStartAndEnd from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/spriteWithStartAndEnd';\n\nconst getSpriteName = (playerNumber: number, isHit: boolean, isPerfect: boolean, isStar: boolean) => {\n    let spriteName = playerNumber === 0 ? 'blue' : 'red';\n    if (isPerfect && isStar) {\n        spriteName = `${spriteName}StarPerfect`;\n    } else if (isPerfect) {\n        spriteName = `${spriteName}Perfect`;\n    } else if (isStar && isHit) {\n        spriteName = `${spriteName}StarHit`;\n    } else if (isHit) {\n        spriteName = `${spriteName}Hit`;\n    } else if (isStar && !isHit) {\n        spriteName = `${spriteName}StarMiss`;\n    } else {\n        spriteName = `${spriteName}Miss`;\n    }\n\n    return spriteName as SpriteNames;\n};\n\nexport default function drawPlayerNote(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    playerNumber: number,\n    isHit: boolean,\n    playerNote: PlayerNote,\n) {\n    const spriteName = getSpriteName(playerNumber, isHit, playerNote.isPerfect, playerNote.note.type === 'star');\n\n    drawSpriteWithStartAndEnd(ctx, spriteName, x, y, width);\n}\n","import Particle from './interfaces';\n\nclass ParticleManager {\n    private particles: Particle[] = [];\n    private lastTick = Date.now();\n\n    private getTimeDelta = (timeShift: number) => {\n        const currentTick = Date.now() - timeShift;\n        const delta = currentTick - this.lastTick;\n        this.lastTick = currentTick;\n\n        return delta;\n    };\n\n    public tick = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement, timeShift = 0) => {\n        const delta = this.getTimeDelta(timeShift);\n\n        this.particles.forEach((particle) => particle.tick(ctx, canvas, delta));\n\n        this.particles = this.particles.filter((particle) => !particle.finished);\n    };\n\n    public add = (particle: Particle) => this.particles.push(particle);\n}\n\nexport default new ParticleManager();\n","import triangle from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/triangle';\nimport spreadValue, { randomSign } from 'Scenes/Game/Singing/GameOverlay/Drawing/Particles/utils';\nimport Particle from '../interfaces';\n\nconst baseTtl = (50 / 60) * 1000;\nconst ttlSpread = (25 / 60) * 1000;\n\nconst velocityModifier = 0.3;\n\nexport default class TriangleParticle implements Particle {\n    public finished = false;\n\n    private ttl;\n    private startingTtl;\n    private velocityX;\n    private velocityY;\n    private width;\n    private initialAngle;\n    private heightModifier;\n\n    constructor(private x: number, private y: number, private color: string, private delay: number) {\n        this.startingTtl = this.ttl = spreadValue(baseTtl, ttlSpread);\n        this.velocityX = spreadValue(0.5, velocityModifier) * randomSign();\n        this.velocityY = spreadValue(0.5, velocityModifier) * randomSign();\n        this.width = 25;\n        this.initialAngle = 180 - Math.random() * 360;\n        this.heightModifier = 0.5 + Math.random() / 2;\n    }\n    public tick = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement, delta: number) => {\n        if (this.delay-- > 0) return;\n\n        const percentage = this.ttl / this.startingTtl;\n        const elapsedTicks = this.startingTtl - this.ttl;\n\n        const width = this.width * percentage;\n        const height = this.width * this.heightModifier * percentage;\n\n        const x = this.x - width / 2 + elapsedTicks * this.velocityX;\n        const y = this.y - height / 2 + elapsedTicks * this.velocityY;\n\n        triangle(ctx, x, y, width, height, this.initialAngle + elapsedTicks, this.color, 0.8 * percentage);\n\n        this.ttl = this.ttl - delta;\n        this.finished = this.ttl <= 0;\n    };\n}\n","import { Note } from 'interfaces';\nimport tinycolor from 'tinycolor2';\nimport ParticleManager from '../ParticleManager';\nimport Particle from '../interfaces';\nimport styles from '../styles';\nimport TriangleParticle from './Triangle';\n\nexport default class ExplodingNoteParticle implements Particle {\n    public finished = true;\n\n    constructor(\n        x: number,\n        y: number,\n        width: number,\n        playerNumber: number,\n        note: Note,\n        particleManager: typeof ParticleManager,\n    ) {\n        const color =\n            note.type === 'star'\n                ? styles.colors.players[playerNumber].star.fill\n                : styles.colors.players[playerNumber].perfect.fill;\n\n        const lightColor = tinycolor(color).lighten(15).toRgbString();\n        const darkColor = tinycolor(color).darken(15).toRgbString();\n\n        const density = width / 6;\n        for (let i = 0; i < density; i++) {\n            const rand = Math.random();\n            let finalColor = color;\n            if (rand > 0.66) finalColor = lightColor;\n            else if (rand > 0.33) finalColor = darkColor;\n\n            const finalY = y + 20 * (Math.random() - 0.5);\n\n            particleManager.add(new TriangleParticle(x + i * 5, finalY, finalColor, (density - i) / 10));\n        }\n    }\n    public tick = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement) => {};\n}\n","import { BIG_NOTE_HEIGHT } from 'Scenes/Game/Singing/GameOverlay/Drawing/calculateData';\nimport { Note } from 'interfaces';\nimport drawNote from '../Elements/note';\nimport Particle from '../interfaces';\n\nconst initialTtl = 200;\n\nexport default class FadeoutNote implements Particle {\n    public finished = false;\n    public ttl = initialTtl;\n\n    constructor(private x: number, private y: number, private width: number, private note: Note) {}\n\n    public tick = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement, delta: number) => {\n        const percentage = this.ttl / initialTtl;\n\n        ctx.save();\n        ctx.globalAlpha = percentage;\n        ctx.translate(0, BIG_NOTE_HEIGHT * (1 - percentage));\n\n        drawNote(ctx, this.x, this.y, this.width, this.note);\n\n        ctx.globalAlpha = 1;\n        ctx.restore();\n\n        this.ttl = this.ttl - delta;\n        this.finished = this.ttl <= 0;\n    };\n}\n","export default function loadImage(path: string): Promise<HTMLImageElement> {\n    return new Promise((resolve) => {\n        const image = new Image();\n        image.onload = () => resolve(image);\n        image.src = path;\n    });\n}\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAQAAAC0jZKKAAACPElEQVR4AbXXcW/TMBAF8EtCypa1LCDB9/98ILG1dKNNCOZZT8h6N4562eZTzH8/ni6dfWns4kqtvbMOT2tmv+0XasG/F1aTLFxd5lDcCS8o0tyX58K9bVA9WZe40LNNqLkevrJr1HvrC1vgQoM820/UqQZubQBKWDKjDJjP+wg41/J/eAOQsGb2rWDlvKzMTyEMaJvBIHNpBdswOfhoZ4VL2h3Irc+srSiJPYv9B1Mr3IHcCS2ZJTFf2+RZ1NEWD5PF7mmQ/nfs85I9klb4KrNCa2YkZitcXmVZpwL3zFtwpYH6l3cWtqDMPP+Fb+zWPthW6BvUIJmZuOTN7APqKOjB9vZAuAM6ArvFE9CSeI5Y1B7PPfAFMPKMKMWVZmbCzKusoveoKcODjQDzgx3c6GnUFnADOAFGV5V16B7PI2BkBRjgmf4IWBbYu8I6lPuhSa2w4xP8k7CF/l5Q7HuiZW9ST+wpjgKLvP9ed6gAJXztWcG/2CaAJ/tKlJSnm7RTTHHATQAnwAFKWCn/H3y2eH2L2ZfDIf06rXD8m768l//cAvzN/kBe709a8cPFQ4jXFA8hHpvVh1D9scmrqfbYrD/oO0s5caYrDvraqwlwW3811V6mvXUrLtOq6x+NYCt0vIqv/2hgcUPWqoFFRixlB9tEIxZHWKHJLmuGQraifijUMTbIq63QzDLGrh+8wVYO3rI6nzdohc+81H3cDHiijxvNfAJ9Wv855hJL5nnlB2Tw8ojzC7UelrXqk/cPn233eGpGsfAAAAAASUVORK5CYII=\"","import loadImage from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/utils/loadImage';\nimport Particle from '../interfaces';\nimport particleImage from './ray-particle.png';\n\nlet image: HTMLImageElement | null = null;\nlet imageLoaded = false;\n\nloadImage(particleImage).then((img) => {\n    image = img;\n    imageLoaded = true;\n});\n\nconst initialTtl = (50 / 60) * 1000;\nconst velocity = 0.05;\n\nconst WIDTH = 100;\nconst WIDTH_SPREAD = 4;\n\nconst pow = Math.pow;\n\nfunction easeOutQuart(x: number): number {\n    return 1 - pow(1 - x, 2);\n}\n\nexport default class RayParticle implements Particle {\n    public finished = false;\n\n    private ttl;\n    private velocityX;\n    private velocityY;\n    private maxWidth;\n\n    constructor(private x: number, private y: number, seed: number, widthModifier: number) {\n        this.ttl = initialTtl;\n        this.velocityX = velocity * Math.random() - velocity / 2;\n        this.velocityY = velocity * Math.random() - velocity / 2;\n        this.maxWidth =\n            Math.min(0.1 + widthModifier, 1) * (Math.sin(seed / 70) * WIDTH_SPREAD + (WIDTH - WIDTH_SPREAD));\n    }\n    public tick = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement, delta: number) => {\n        if (imageLoaded) {\n            const percentage = this.ttl / initialTtl;\n            let easing = easeOutQuart(1 - Math.min(1, (1 - percentage) * 6));\n\n            const mainRayWidth = (this.maxWidth * easing * 3) / 4;\n            const mainRayHeight = this.maxWidth * easing;\n\n            ctx.globalAlpha = easing * 0.35;\n            ctx.drawImage(image!, this.x - mainRayWidth / 2, this.y - mainRayHeight / 2, mainRayWidth, mainRayHeight);\n\n            easing = easeOutQuart(percentage);\n\n            const width = (easing * this.maxWidth) / 4;\n            const height = (easing * this.maxWidth) / 4;\n\n            const x = this.x - width / 2;\n            const y = this.y - height / 2;\n\n            const elapsedTicks = initialTtl - this.ttl;\n\n            ctx.globalAlpha = easing * 0.2;\n            ctx.drawImage(image!, x + elapsedTicks * this.velocityX, y + elapsedTicks * this.velocityY, width, height);\n            ctx.globalAlpha = 1;\n        }\n\n        this.ttl = this.ttl - delta;\n        this.finished = this.ttl <= 0;\n    };\n}\n","import Particle from '../interfaces';\n\nconst INTERVAL_PX = 20;\n\nexport default class VibratoParticle implements Particle {\n    public finished = false;\n    public ttl = (2 / 60) * 1000;\n\n    constructor(private x: number, private y: number, private w: number, private h: number, private seed: number) {}\n    public tick = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement, delta: number) => {\n        ctx.strokeStyle = 'rgba(255,255,255,.25)';\n        ctx.lineWidth = 2;\n\n        ctx.beginPath();\n\n        for (let i = 0; i < this.w; i++) {\n            const x = this.x + this.w - i;\n            const deltaY = (this.h / 2 + 2) * Math.sin(x / INTERVAL_PX + this.seed / 250);\n            ctx.lineTo(x, this.y + this.h / 2 + deltaY);\n        }\n\n        ctx.stroke();\n\n        ctx.beginPath();\n\n        for (let i = 0; i < this.w; i++) {\n            const x = this.x + this.w - i;\n            const deltaY = -1 * (this.h / 2 + 2) * Math.sin(x / INTERVAL_PX + this.seed / 250);\n            ctx.lineTo(x, this.y + this.h / 2 + deltaY);\n        }\n\n        ctx.stroke();\n\n        this.ttl = this.ttl - delta;\n        this.finished = this.ttl <= 0;\n    };\n}\n","import events from 'GameEvents/GameEvents';\nimport PlayersManager from 'Players/PlayersManager';\nimport getNoteColor from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/utils/getNoteColor';\nimport SungTriangle from 'Scenes/Game/Singing/GameOverlay/Drawing/Particles/SungTriangle';\nimport { FPSCountSetting, GraphicSetting } from 'Scenes/Settings/SettingsState';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { noDistanceNoteTypes } from 'consts';\nimport { Note, NotesSection, PlayerNote } from 'interfaces';\nimport { randomFloat } from 'utils/randomValue';\nimport GameState from '../../GameState/GameState';\nimport getPlayerNoteDistance from '../../Helpers/getPlayerNoteDistance';\nimport debugPitches from './Elements/debugPitches';\nimport drawNote from './Elements/note';\nimport drawPlayerFrequencyTrace from './Elements/playerFrequencyTrace';\nimport drawPlayerNote from './Elements/playerNote';\nimport ParticleManager from './ParticleManager';\nimport ExplodingNoteParticle from './Particles/ExplodingNote';\nimport FadeoutNote from './Particles/FadeoutNote';\nimport RayParticle from './Particles/Ray';\nimport VibratoParticle from './Particles/Vibrato';\nimport calculateData, { BIG_NOTE_HEIGHT, DrawingData, NOTE_HEIGHT, pitchPadding } from './calculateData';\n\nfunction getPlayerNoteAtBeat(playerNotes: PlayerNote[], beat: number) {\n    return playerNotes.find((note) => note.start <= beat && note.start + note.length >= beat);\n}\n\nexport default class CanvasDrawing {\n    private loop = false;\n    private pauseTime = 0;\n    private pausedOn = 0;\n\n    public constructor(\n        private canvas: HTMLCanvasElement,\n        private verticalMargin: number = 0,\n        private scaleFactor: number = 1,\n    ) {}\n    public start = () => {\n        events.sectionChange.subscribe(this.onSectionEnd);\n        this.loop = true;\n\n        this.drawFrame();\n    };\n\n    public pause = () => {\n        this.end();\n        this.pausedOn = Date.now();\n    };\n\n    public resume = () => {\n        this.pauseTime += Date.now() - this.pausedOn;\n        this.start();\n    };\n\n    public isPlaying = () => this.loop;\n\n    public drawFrame = () => {\n        const startTime = Date.now();\n        const ctx = this.canvas.getContext('2d');\n        if (!ctx) return;\n\n        ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\n        const players = PlayersManager.getPlayers();\n        players.forEach((player, index) => {\n            this.drawPlayer(player.number, index, players.length, ctx);\n        });\n\n        ParticleManager.tick(ctx, this.canvas, this.pauseTime);\n\n        if (FPSCountSetting.get() === 30) {\n            const endTime = Date.now();\n            const baseTimeout = 1000 / 30;\n            const finalTimeout = endTime - startTime > baseTimeout ? baseTimeout : baseTimeout - (endTime - startTime);\n            if (this.loop) setTimeout(this.drawFrame, finalTimeout, FPSCountSetting.get());\n        }\n        if (FPSCountSetting.get() !== 30) {\n            if (this.loop) window.requestAnimationFrame(this.drawFrame);\n        }\n    };\n\n    public end = () => {\n        this.loop = false;\n        events.sectionChange.unsubscribe(this.onSectionEnd);\n    };\n\n    private drawPlayer = (playerNumber: number, index: number, playerCount: number, ctx: CanvasRenderingContext2D) => {\n        const drawingData = this.getDrawingData(playerNumber);\n        const { currentSection } = calculateData(drawingData);\n        if (!isNotesSection(currentSection)) return;\n\n        const displacements = this.calculateDisplacements(currentSection, drawingData);\n\n        this.drawNotesToSing(ctx, drawingData, displacements);\n        this.drawSungNotes(ctx, drawingData, displacements);\n\n        if (GraphicSetting.get() === 'high') {\n            this.drawFlare(ctx, drawingData, displacements);\n        }\n\n        false && debugPitches(ctx!, drawingData);\n    };\n\n    private drawNotesToSing = (\n        ctx: CanvasRenderingContext2D,\n        drawingData: DrawingData,\n        displacements: Record<number, [number, number]>,\n    ) => {\n        if (!isNotesSection(drawingData.currentSection)) return;\n\n        drawingData.currentSection.notes.forEach((note) => {\n            const { x, y, w, h } = this.getNoteCoords(drawingData, note, note.pitch, true, displacements[note.start]);\n\n            drawNote(ctx, x, y, w, note);\n        });\n    };\n\n    private drawSungNotes = (\n        ctx: CanvasRenderingContext2D,\n        drawingData: DrawingData,\n        displacements: Record<number, [number, number]>,\n    ) => {\n        if (!isNotesSection(drawingData.currentSection)) return;\n\n        drawingData.currentPlayerNotes.forEach((playerNote) => {\n            const distance = getPlayerNoteDistance(playerNote);\n\n            const { x, y, w, h } = this.getNoteCoords(\n                drawingData,\n                playerNote,\n                playerNote.note.pitch + distance,\n                distance === 0,\n                displacements[playerNote.note.start],\n            );\n            if (distance > 0 || w > h / 2.5) {\n                drawPlayerNote(ctx, x, y, w, drawingData.playerNumber, distance === 0, playerNote);\n\n                if (playerNote.vibrato) {\n                    ParticleManager.add(new VibratoParticle(x, y, w, h, drawingData.currentTime));\n                }\n\n                if (\n                    distance === 0 &&\n                    playerNote.frequencyRecords.length > 3 &&\n                    !noDistanceNoteTypes.includes(playerNote.note.type)\n                ) {\n                    drawPlayerFrequencyTrace(ctx, x, y, w, h, playerNote);\n                }\n            }\n        });\n    };\n\n    private drawFlare = (\n        ctx: CanvasRenderingContext2D,\n        drawingData: DrawingData,\n        displacements: Record<number, [number, number]>,\n    ) => {\n        if (!isNotesSection(drawingData.currentSection)) return;\n\n        const lastNote = getPlayerNoteAtBeat(\n            drawingData.currentPlayerNotes,\n            drawingData.currentBeat - 185 / drawingData.songBeatLength,\n        );\n\n        if (lastNote && lastNote.distance === 0) {\n            const displacement = displacements[lastNote.note.start] || [0, 0];\n\n            const { x, y, w, h } = this.getNoteCoords(drawingData, lastNote, lastNote.note.pitch, true, displacement);\n            const preciseDistance = noDistanceNoteTypes.includes(lastNote.note.type)\n                ? 0\n                : lastNote.frequencyRecords.at(-1)!.preciseDistance;\n\n            const finalX = x + w;\n            const finalY = this.getPreciseY(y, h, preciseDistance);\n\n            ParticleManager.add(new RayParticle(finalX, finalY, drawingData.currentTime, 1));\n\n            ParticleManager.add(\n                new SungTriangle(\n                    randomFloat(Math.max(x, finalX - 50), finalX),\n                    finalY,\n                    getNoteColor(ctx, drawingData.playerNumber, true, lastNote).fill,\n                ),\n            );\n        }\n    };\n\n    private onSectionEnd = (playerNumber: number) => {\n        const drawingData = this.getDrawingData(playerNumber, -1);\n        if (!isNotesSection(drawingData.currentSection)) return;\n\n        this.fadeoutNotes(drawingData.currentSection, drawingData);\n        this.explodeNotes(drawingData.currentSection, drawingData);\n    };\n\n    private fadeoutNotes = (section: NotesSection, drawingData: DrawingData) => {\n        if (GraphicSetting.get() === 'high') {\n            section.notes.forEach((note) => {\n                const { x, y, w, h } = this.getNoteCoords(drawingData, note, note.pitch, true);\n\n                ParticleManager.add(new FadeoutNote(x, y, w, note));\n            });\n        }\n    };\n\n    private explodeNotes = (section: NotesSection, drawingData: DrawingData) => {\n        if (GraphicSetting.get() === 'high') {\n            const notesToExplode = drawingData.playerNotes.filter(\n                (note) =>\n                    (note.distance === 0 || noDistanceNoteTypes.includes(note.note.type)) &&\n                    section.notes.includes(note.note),\n            );\n\n            notesToExplode.forEach((note) => {\n                const { x, y, w, h } = this.getNoteCoords(drawingData, note, note.note.pitch, true);\n                ParticleManager.add(\n                    new ExplodingNoteParticle(x, y + h / 2, w, drawingData.playerNumber, note.note, ParticleManager),\n                );\n            });\n        }\n    };\n\n    private calculateDisplacements = (currentSection: NotesSection, drawingData: DrawingData) => {\n        const displacements: Record<number, [number, number]> = {};\n\n        if (GraphicSetting.get() === 'high') {\n            currentSection.notes.forEach((note) => {\n                const sungNotesStreak = drawingData.playerNotes\n                    .filter((sungNote) => sungNote.note.start === note.start)\n                    .filter(\n                        (sungNote) =>\n                            sungNote.note.start + sungNote.note.length + 30 >= drawingData.currentBeat &&\n                            sungNote.distance === 0,\n                    )\n                    .map((sungNote) =>\n                        sungNote.start + 30 < drawingData.currentBeat\n                            ? sungNote.length - (drawingData.currentBeat - 30 - sungNote.start)\n                            : sungNote.length,\n                    )\n                    .reduce((currLength, sungNoteLength) => Math.min(currLength + sungNoteLength, 30), 0);\n\n                const displacementRange = Math.max(0, (sungNotesStreak - 5) / (note.type === 'star' ? 3 : 5));\n                const displacementX = (Math.random() - 0.5) * displacementRange;\n                const displacementY = (Math.random() - 0.5) * displacementRange;\n\n                displacements[note.start] = [displacementX, displacementY];\n            });\n        } else {\n            currentSection.notes.forEach((note) => {\n                displacements[note.start] = [0, 0];\n            });\n        }\n\n        return displacements;\n    };\n\n    private getDrawingData = (playerNumber: number, sectionShift = 0): DrawingData => {\n        const playerState = GameState.getPlayer(playerNumber)!;\n        const player = PlayersManager.getPlayer(playerNumber);\n        const currentSectionIndex = playerState.getCurrentSectionIndex() + sectionShift ?? 0;\n        const song = GameState.getSong()!;\n        const track = playerState.getTrackIndex();\n        const currentSection = song.tracks[track].sections[currentSectionIndex];\n        const playerNotes = playerState.getPlayerNotes();\n\n        return {\n            playerNumber: player.number,\n            song,\n            songBeatLength: GameState.getSongBeatLength(),\n            minPitch: playerState.getMinPitch(),\n            maxPitch: playerState.getMaxPitch(),\n            canvas: this.canvas,\n            currentTime: GameState.getCurrentTime(),\n            frequencies: playerState.getPlayerFrequencies(),\n            playerNotes,\n            currentPlayerNotes: playerNotes.filter((note) => note.note.start >= (currentSection?.start ?? Infinity)),\n            track: playerState.getTrackIndex(),\n            currentBeat: GameState.getCurrentBeat(),\n            currentSectionIndex,\n            currentSection,\n            paddingVertical: this.verticalMargin,\n        };\n    };\n\n    private getNoteCoords = (\n        drawingData: DrawingData,\n        { start, length }: Pick<Note, 'start' | 'length'>,\n        pitch: number,\n        big: boolean,\n        displacement: [number, number] = [0, 0],\n    ) => {\n        const { sectionEndBeat, currentSection, paddingHorizontal, canvasHeight, pitchStepHeight } =\n            calculateData(drawingData);\n\n        const regionPaddingTop = drawingData.playerNumber * (canvasHeight / 2) + drawingData.paddingVertical;\n\n        const sectionStart = isNotesSection(currentSection) ? currentSection.notes[0].start : 1;\n\n        const beatLength = (this.canvas.width - 2 * paddingHorizontal) / (sectionEndBeat - sectionStart);\n\n        const [dx, dy] = big ? displacement : [0, 0];\n        const pitchY = pitchStepHeight * (drawingData.maxPitch - pitch + pitchPadding);\n\n        return {\n            x: Math.floor(paddingHorizontal + beatLength * (start - sectionStart) + dx),\n            y: Math.floor(regionPaddingTop + 10 + pitchY + dy - (big ? 3 : 0)),\n            w: Math.floor(beatLength * length),\n            h: big ? BIG_NOTE_HEIGHT : NOTE_HEIGHT,\n        };\n    };\n\n    private getPreciseY = (y: number, h: number, preciseDistance: number) => y + h / 2 - (preciseDistance * h) / 3;\n}\n","import styled from '@emotion/styled';\nimport { VideoPlayerRef, VideoState } from 'Elements/VideoPlayer';\nimport PlayersManager from 'Players/PlayersManager';\nimport SkipIntro from 'Scenes/Game/Singing/GameOverlay/Components/SkipIntro';\nimport SkipOutro from 'Scenes/Game/Singing/GameOverlay/Components/SkipOutro';\nimport { MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport { GAME_MODE, PlayerSetup, Song } from 'interfaces';\nimport { useEffect, useRef } from 'react';\nimport GameState from '../GameState/GameState';\nimport DurationBar from './Components/DurationBar';\nimport Lyrics from './Components/Lyrics';\nimport ScoreText from './Components/ScoreText';\nimport CanvasDrawing from './Drawing';\n\ninterface Props {\n    song: Song;\n    currentStatus: VideoState;\n    width: number;\n    height: number;\n    onSongEnd: () => void;\n    playerSetups: PlayerSetup[];\n    duration: number;\n    effectsEnabled: boolean;\n    playerChanges: number[][];\n    videoPlayerRef: VideoPlayerRef | null;\n    isPauseMenuVisible: boolean;\n}\n\nconst MAX_RENDER_RESOLUTION_W = 1920;\n\nfunction GameOverlay({\n    currentStatus,\n    width,\n    height,\n    playerSetups,\n    onSongEnd,\n    playerChanges,\n    effectsEnabled,\n    videoPlayerRef,\n    isPauseMenuVisible,\n}: Props) {\n    const [mobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n    const canvas = useRef<HTMLCanvasElement | null>(null);\n    const drawer = useRef<CanvasDrawing | null>(null);\n    const lyrics = useRef<HTMLDivElement | null>(null);\n\n    useEffect(() => {\n        GameState.startInputMonitoring();\n\n        return () => {\n            GameState.stopInputMonitoring();\n        };\n    }, []);\n\n    const overlayWidth = MAX_RENDER_RESOLUTION_W;\n    const overlayHeight = overlayWidth * (height / width);\n\n    const overlayScaleFactor = overlayHeight / height;\n    const resolutionScaleFactor = overlayWidth / MAX_RENDER_RESOLUTION_W;\n\n    useEffect(() => {\n        if (!canvas.current || !lyrics.current) return;\n\n        drawer.current = new CanvasDrawing(\n            canvas.current,\n            lyrics.current.offsetHeight * overlayScaleFactor,\n            resolutionScaleFactor,\n        );\n        drawer.current.start();\n\n        return () => {\n            drawer.current?.end();\n        };\n    }, [canvas.current, lyrics.current?.offsetHeight, overlayScaleFactor]);\n\n    useEffect(() => {\n        if (isPauseMenuVisible && drawer.current?.isPlaying()) {\n            drawer.current?.pause();\n        } else if (!isPauseMenuVisible && !drawer.current?.isPlaying()) {\n            drawer.current?.resume();\n        }\n    }, [isPauseMenuVisible]);\n\n    useEffect(() => {\n        if (currentStatus === VideoState.ENDED && onSongEnd) {\n            onSongEnd();\n        }\n    }, [currentStatus, onSongEnd]);\n\n    const players = PlayersManager.getPlayers();\n    const showMultipleLines = !mobilePhoneMode && players.length === 2;\n\n    return (\n        <Screen>\n            <GameCanvas>\n                <canvas ref={canvas} width={overlayWidth} height={overlayHeight} />\n            </GameCanvas>\n            {effectsEnabled && (\n                <>\n                    <SkipIntro playerRef={videoPlayerRef} isEnabled={!isPauseMenuVisible} />\n                    <SkipOutro onSongEnd={onSongEnd} isEnabled={!isPauseMenuVisible} />\n                </>\n            )}\n            <DurationBar players={playerSetups} />\n            {showMultipleLines && (\n                <Lyrics player={players[0]} playerChanges={playerChanges} effectsEnabled={effectsEnabled} />\n            )}\n            <Scores>\n                {effectsEnabled && (\n                    <>\n                        {GameState.getSingSetup()?.mode === GAME_MODE.CO_OP ? (\n                            <span data-test=\"players-score\" data-score={GameState.getPlayerScore(0)}>\n                                <ScoreText score={GameState.getPlayerScore(0)} />\n                            </span>\n                        ) : (\n                            <>\n                                <span data-test=\"player-0-score\" data-score={GameState.getPlayerScore(0)}>\n                                    <ScoreText score={GameState.getPlayerScore(0)} />\n                                </span>\n                                <span data-test=\"player-1-score\" data-score={GameState.getPlayerScore(1)}>\n                                    <ScoreText score={GameState.getPlayerScore(1)} />\n                                </span>\n                            </>\n                        )}\n                    </>\n                )}\n            </Scores>\n            <div ref={lyrics}>\n                <Lyrics\n                    player={players[showMultipleLines ? 1 : 0]}\n                    playerChanges={playerChanges}\n                    bottom\n                    effectsEnabled={effectsEnabled}\n                />\n            </div>\n        </Screen>\n    );\n}\n\nexport default GameOverlay;\n\nconst Screen = styled.div`\n    height: 100%;\n    color: white;\n    -webkit-text-stroke: 0.2rem black;\n    font-weight: bold;\n    position: relative;\n    display: flex;\n    flex-direction: column;\n`;\n\nconst GameCanvas = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n\n    canvas {\n        width: 100%;\n        height: 100%;\n    }\n`;\n\nconst Scores = styled.div`\n    flex: 1;\n    height: 100%;\n    box-sizing: border-box;\n    font-size: 5.5rem;\n    display: flex;\n    justify-content: center;\n    gap: 4rem;\n    padding-right: 4rem;\n    flex-direction: column;\n    text-align: right;\n    z-index: 1;\n`;\n","import { PlayerSetup, SingSetup, Song } from 'interfaces';\nimport {\n    ForwardedRef,\n    MutableRefObject,\n    forwardRef,\n    useCallback,\n    useEffect,\n    useImperativeHandle,\n    useMemo,\n    useRef,\n    useState,\n} from 'react';\n\nimport styled from '@emotion/styled';\nimport VideoPlayer, { VideoPlayerRef, VideoState } from 'Elements/VideoPlayer';\nimport { FPSCountSetting, InputLagSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport useKeyboard from 'hooks/useKeyboard';\nimport useKeyboardHelp from 'hooks/useKeyboardHelp';\nimport PauseMenu from './GameOverlay/Components/PauseMenu';\nimport GameOverlay from './GameOverlay/GameOverlay';\nimport GameState from './GameState/GameState';\n\ninterface Props {\n    singSetup: SingSetup;\n    song: Song;\n    width: number;\n    height: number;\n    autoplay?: boolean;\n    showControls?: boolean;\n    onTimeUpdate?: (newTime: number) => void;\n    onSongEnd: () => void;\n    onStatusChange?: (status: VideoState) => void;\n    players: PlayerSetup[];\n    playerChanges?: number[][];\n\n    effectsEnabled?: boolean;\n    restartSong?: () => void;\n}\n\nexport interface PlayerRef {\n    play: () => void;\n    pause: () => void;\n    seekTo: (time: number) => void;\n    setPlaybackSpeed: (speed: number) => void;\n}\n\nfunction usePlayerSetDuration(playerRef: MutableRefObject<VideoPlayerRef | null>, currentStatus: VideoState) {\n    const [duration, setDuration] = useState(0);\n    useEffect(() => {\n        if (playerRef.current && currentStatus === VideoState.PLAYING && duration === 0) {\n            playerRef.current.getDuration().then((dur: number) => {\n                setDuration(dur);\n                GameState.setDuration(dur);\n            });\n        }\n    }, [duration, playerRef, currentStatus]);\n\n    return duration;\n}\n\nfunction Player(\n    {\n        song,\n        width,\n        height,\n        autoplay = true,\n        showControls = false,\n        onTimeUpdate,\n        onSongEnd,\n        onStatusChange,\n        players,\n        playerChanges = [[], []],\n        effectsEnabled = true,\n        singSetup,\n        restartSong,\n    }: Props,\n    ref: ForwardedRef<PlayerRef>,\n) {\n    const player = useRef<VideoPlayerRef | null>(null);\n    const [currentTime, setCurrentTime] = useState(0);\n    const [currentStatus, setCurrentStatus] = useState(VideoState.UNSTARTED);\n    const [inputLag] = useSettingValue(InputLagSetting);\n\n    useEffect(() => {\n        GameState.setSong(song);\n        GameState.setSingSetup(singSetup);\n    }, [song, singSetup]);\n\n    useEffect(() => {\n        if (!player.current) {\n            return;\n        }\n        if (currentStatus === VideoState.PLAYING) {\n            const interval = setInterval(async () => {\n                if (!player.current) return;\n\n                const time = Math.max(0, (await player.current.getCurrentTime()) * 1000 - inputLag);\n                setCurrentTime(time);\n                onTimeUpdate?.(time);\n                GameState.setCurrentTime(time);\n                GameState.update();\n            }, 1000 / FPSCountSetting.get());\n\n            return () => clearInterval(interval);\n        }\n    }, [player, onTimeUpdate, currentStatus, inputLag]);\n\n    const duration = usePlayerSetDuration(player, currentStatus);\n\n    useImperativeHandle(ref, () => ({\n        seekTo: (time: number) => player.current!.seekTo(time),\n        setPlaybackSpeed: (speed: number) => player.current!.setPlaybackSpeed(speed),\n        play: () => player.current!.playVideo(),\n        pause: () => player.current!.pauseVideo(),\n    }));\n\n    const onStateChangeCallback = useCallback(\n        (state: VideoState) => {\n            setCurrentStatus(state);\n            onStatusChange?.(state);\n        },\n        [setCurrentStatus, onStatusChange],\n    );\n\n    useKeyboard(\n        {\n            back: () =>\n                currentStatus === VideoState.PAUSED ? player.current?.playVideo() : player.current?.pauseVideo(),\n        },\n        true,\n        [currentStatus],\n    );\n\n    const help = useMemo(\n        () => ({\n            back: 'Pause Menu',\n        }),\n        [],\n    );\n    useKeyboardHelp(help, effectsEnabled);\n\n    const isPauseMenuVisible = effectsEnabled && currentStatus === VideoState.PAUSED && onSongEnd !== undefined;\n\n    return (\n        <Container>\n            {isPauseMenuVisible && (\n                <PauseMenu onExit={onSongEnd} onResume={() => player.current?.playVideo()} onRestart={restartSong!} />\n            )}\n            {currentStatus !== VideoState.UNSTARTED && (\n                <Overlay>\n                    <GameOverlay\n                        isPauseMenuVisible={isPauseMenuVisible}\n                        effectsEnabled={effectsEnabled}\n                        playerChanges={playerChanges}\n                        duration={duration}\n                        currentStatus={currentStatus}\n                        song={song}\n                        width={width}\n                        height={height}\n                        onSongEnd={onSongEnd}\n                        playerSetups={players}\n                        videoPlayerRef={player.current}\n                    />\n                </Overlay>\n            )}\n            <PlayerContainer>\n                <VideoPlayer\n                    ref={player}\n                    video={song.video}\n                    width={width}\n                    height={height}\n                    controls={showControls}\n                    autoplay={autoplay}\n                    disablekb={process.env.NODE_ENV !== 'development'}\n                    volume={song.volume}\n                    startAt={song.videoGap ?? 0}\n                    onStateChange={onStateChangeCallback}\n                />\n            </PlayerContainer>\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    position: relative;\n`;\n\nconst Overlay = styled.div`\n    position: absolute;\n    z-index: 1;\n    background-color: rgba(0, 0, 0, 0.2);\n    pointer-events: none;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n`;\n\nconst PlayerContainer = styled.div`\n    overflow: hidden;\n    height: 100%;\n`;\n\nexport default forwardRef(Player);\n","import styled from '@emotion/styled';\nimport { Box, Grid, Typography } from '@mui/material';\nimport AdjustPlayback from 'Scenes/Convert/Steps/SyncLyricsToVideo/Components/AdjustPlayback';\nimport EditSection, { ChangeRecord } from 'Scenes/Convert/Steps/SyncLyricsToVideo/Components/EditSection';\nimport ListTracks from 'Scenes/Convert/Steps/SyncLyricsToVideo/Components/ListTracks';\nimport ManipulateBpm from 'Scenes/Convert/Steps/SyncLyricsToVideo/Components/ManipulateBpm';\nimport ShiftGap from 'Scenes/Convert/Steps/SyncLyricsToVideo/Components/ShiftGap';\nimport ShiftVideoGap from 'Scenes/Convert/Steps/SyncLyricsToVideo/Components/ShiftVideoGap';\nimport addHeadstart from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/addHeadstart';\nimport normaliseGap from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseGap';\nimport normaliseLyricSpaces from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseLyricSpaces';\nimport normaliseSectionPaddings from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseSectionPaddings';\nimport Player, { PlayerRef } from 'Scenes/Game/Singing/Player';\nimport getSongBeatLength from 'Songs/utils/getSongBeatLength';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { getFirstNoteStartFromSections } from 'Songs/utils/notesSelectors';\nimport { GAME_MODE, SingSetup, Song } from 'interfaces';\nimport { cloneDeep } from 'lodash-es';\nimport { useEffect, useMemo, useRef, useState } from 'react';\n\ninterface Props {\n    song: Song;\n    onUpdate?: (song: Song) => void;\n    visible: boolean;\n}\n\nconst shiftGap = (song: Song, gapShift: number): Song => ({ ...song, gap: song.gap + gapShift });\nconst shiftVideoGap = (song: Song, gapShift: number): Song => ({ ...song, videoGap: (song.videoGap ?? 0) + gapShift });\nconst setBpm = (song: Song, bpm: number): Song => ({ ...song, bpm });\n\nconst applyChanges = (song: Song, changes: ChangeRecord[]) => ({\n    ...song,\n    tracks: song.tracks.map((track, trackIndex) => {\n        const changeList = changes.filter((change) => change.track === trackIndex);\n\n        let sections = [...track.sections].filter(isNotesSection);\n\n        changeList.forEach((change) => {\n            if (change.type === 'delete') {\n                sections = sections.filter((_, index) => index !== change.section);\n            } else if (change.type === 'shift') {\n                const shift = change.shift - getFirstNoteStartFromSections([sections[change.section]]);\n                sections = sections.map((section, index) => {\n                    if (index < change.section) return section;\n\n                    return { ...section, notes: section.notes.map((note) => ({ ...note, start: note.start + shift })) };\n                });\n            }\n        });\n\n        return { ...track, sections };\n    }),\n});\n\nconst applyTrackNames = (song: Song, trackNames: (string | undefined)[]): Song => ({\n    ...song,\n    tracks: song.tracks.map((track, index) => ({\n        ...track,\n        name: trackNames[index] ?? track.name,\n    })),\n});\n\nconst playerWidth = 800;\nconst playerHeight = (playerWidth / 16) * 9;\n\nexport default function EditSong({ song, onUpdate, visible }: Props) {\n    const player = useRef<PlayerRef | null>(null);\n    const [currentTime, setCurrentTime] = useState<number>(0);\n\n    const [gapShift, setGapShift] = useState<number>(0);\n    const [videoGapShift, setVideoGapShift] = useState<number>(0);\n    const [overrideBpm, setOverrideBpm] = useState<number>(song.bpm);\n    const [playerKey, setPlayerKey] = useState(0);\n    const [changeRecords, setChangeRecords] = useState<ChangeRecord[]>([]);\n    const [effectsEnabled, setEffectsEnabled] = useState<boolean>(false);\n    const [trackNames, setTrackNames] = useState(song.tracks.map((track) => track.name ?? undefined));\n\n    const newSong = useMemo(() => {\n        let processed = cloneDeep(song);\n\n        processed = normaliseGap(processed);\n        processed = addHeadstart(processed);\n        processed = normaliseSectionPaddings(processed);\n        processed = shiftGap(processed, gapShift);\n        processed = shiftVideoGap(processed, videoGapShift);\n        processed = setBpm(processed, overrideBpm);\n        processed = applyChanges(processed, changeRecords);\n        processed = applyTrackNames(processed, trackNames);\n        processed = normaliseSectionPaddings(processed);\n        processed = normaliseLyricSpaces(processed);\n\n        return processed;\n    }, [gapShift, videoGapShift, song, overrideBpm, changeRecords, trackNames]);\n\n    useEffect(() => {\n        onUpdate?.(newSong);\n    }, [onUpdate, newSong]);\n\n    const singSetup = useMemo<SingSetup>(\n        () => ({\n            id: 'test',\n            mode: GAME_MODE.DUEL,\n            players: [\n                { number: 0, track: 0 },\n                { number: 1, track: song.tracks.length - 1 },\n            ],\n            tolerance: 6,\n        }),\n        [song],\n    );\n\n    let beatLength: number | undefined;\n    beatLength = getSongBeatLength(newSong);\n\n    useEffect(() => {\n        if (!visible) {\n            player.current?.pause();\n        }\n    }, [visible]);\n\n    return (\n        <Grid container spacing={2} sx={{ display: visible ? undefined : 'none' }}>\n            <Grid item xs={8} data-test=\"player-container\">\n                <Box sx={{ width: playerWidth, height: playerHeight }}>\n                    <Player\n                        key={playerKey}\n                        song={newSong}\n                        showControls\n                        autoplay={false}\n                        width={playerWidth}\n                        height={playerHeight}\n                        ref={player}\n                        onTimeUpdate={setCurrentTime}\n                        players={singSetup.players}\n                        effectsEnabled={effectsEnabled}\n                        singSetup={singSetup}\n                        onSongEnd={() => undefined}\n                    />\n                </Box>\n            </Grid>\n            <Grid item xs={4}>\n                <Typography variant={'h5'} mb={2}>\n                    Playback controls\n                </Typography>\n                {player.current && (\n                    <AdjustPlayback\n                        player={player.current}\n                        currentTime={currentTime}\n                        effectsEnabled={effectsEnabled}\n                        onEffectsToggle={() => setEffectsEnabled((current) => !current)}\n                    />\n                )}\n                {!player.current && <h2>Start the song to see the manipulation form</h2>}\n            </Grid>\n            {player.current && (\n                <>\n                    <Grid item xs={8}>\n                        {/*<Typography variant={'h5'} mb={2}>*/}\n                        {/*    Basic adjustments*/}\n                        {/*</Typography>*/}\n                        <Box sx={{ display: 'flex', gap: 5, flex: 1 }}>\n                            <ShiftVideoGap\n                                player={player.current}\n                                onChange={(newShift) => {\n                                    const delta = newShift - videoGapShift;\n                                    setVideoGapShift(newShift);\n                                    // video gap is not automatically added to gap, need to adjust it here directly\n                                    setGapShift((current) => current + delta * 1000);\n                                }}\n                                current={videoGapShift}\n                                finalGap={newSong.videoGap}\n                            />\n                            <ShiftGap\n                                player={player.current}\n                                onChange={setGapShift}\n                                current={gapShift}\n                                finalGap={newSong.gap}\n                            />\n                        </Box>\n                    </Grid>\n                    <Grid item xs={4}>\n                        <HelpText>\n                            Use <strong>Video shift gap</strong> to crop the beginning of the video if it starts with an\n                            intro.\n                        </HelpText>\n                        <HelpText>\n                            Use <strong>Shift gap</strong> to sync the start of the lyrics to the video. You can lower\n                            the <strong>Playback speed</strong> above to make sure you got it just right.\n                        </HelpText>\n                    </Grid>\n                    <Grid item xs={8}>\n                        <Typography variant={'h5'} mb={2}>\n                            Advanced\n                        </Typography>\n                        <ManipulateBpm\n                            player={player.current}\n                            onChange={setOverrideBpm}\n                            current={overrideBpm}\n                            song={newSong}\n                            key={newSong.gap}\n                        />\n                        <ListTracks player={player.current} song={newSong} beatLength={beatLength} />\n                    </Grid>\n                    <Grid item xs={4}>\n                        <HelpText>\n                            If the lyrics desynchronise over time, probably the tempo (BPM) of the lyrics is wrong.\n                        </HelpText>\n                        <HelpText>\n                            You can either use <strong>Last note end time</strong> - enter the millisecond when the last\n                            note should end (seek through the video for the moment as <strong>Current time</strong>{' '}\n                            panel show the exact millisecond) and a suggested BPM value will appear below.\n                        </HelpText>\n                        <HelpText>\n                            <strong>Tempo (BPM)</strong> field allows to fine-tune the tempo.\n                        </HelpText>\n                    </Grid>\n                    <Grid item xs={8}>\n                        <EditSection\n                            song={newSong}\n                            currentTime={currentTime}\n                            beatLength={beatLength}\n                            player={player.current}\n                            onRecordChange={setChangeRecords}\n                            onTrackNameChange={(track, newName) =>\n                                setTrackNames((current) => {\n                                    const newNames = [...current];\n                                    newNames[track] = newName === '' ? undefined : newName;\n\n                                    return newNames;\n                                })\n                            }\n                        />\n                    </Grid>\n                    <Grid item xs={4}>\n                        <HelpText>\n                            If the lyrics there are more lyrics than in the video or there are longer/shorter interludes\n                            between verses, you can <strong>Edit verses</strong>.\n                        </HelpText>\n                        <HelpText>Select a verse by clicking on it.</HelpText>\n                        <HelpText>\n                            You can either <strong>Change its start beat</strong> (which will \"move in time\" the verse\n                            and all subsequent ones) or <strong>Delete it</strong> (it won't affect the timing of other\n                            verses).\n                        </HelpText>\n                        <HelpText>\n                            <strong>List of changes</strong> on the right allows you to see and undo the actions one by\n                            one.\n                        </HelpText>\n                    </Grid>\n                </>\n            )}\n        </Grid>\n    );\n}\n\nconst HelpText = styled.p`\n    font-size: 0.85rem;\n    margin-bottom: 1rem;\n    line-height: 1.25rem;\n    strong {\n        font-weight: bold;\n    }\n`;\n","import { Box } from '@mui/material';\nimport { Song } from 'interfaces';\nimport EditSong from 'Scenes/Convert/Steps/SyncLyricsToVideo/EditSong';\n\ninterface Props {\n    onChange: (data: Song) => void;\n    data?: Song;\n    visible: boolean;\n}\n\nexport default function SyncLyricsToVideo(props: Props) {\n    return (\n        <Box data-test=\"sync-lyrics\">\n            {props.data && props.data.video.length < 15 && !!props.data.tracks?.[0]?.sections?.length && (\n                <EditSong song={props.data} onUpdate={props.onChange} visible={props.visible} />\n            )}\n        </Box>\n    );\n}\n","import styled from '@emotion/styled';\nimport { Alert, AlertTitle, Box, Button, Step, StepButton, StyledEngineProvider } from '@mui/material';\nimport Stepper from '@mui/material/Stepper';\nimport { useBackground } from 'Elements/LayoutWithBackground';\nimport NormalizeFontSize from 'Elements/NormalizeFontSize';\nimport AuthorAndVid, { AuthorAndVidEntity } from 'Scenes/Convert/Steps/AuthorAndVid';\nimport BasicData, { BasicDataEntity } from 'Scenes/Convert/Steps/BasicData';\nimport SongMetadata, { SongMetadataEntity } from 'Scenes/Convert/Steps/SongMetadata';\nimport SyncLyricsToVideo from 'Scenes/Convert/Steps/SyncLyricsToVideo';\nimport SongDao from 'Songs/SongDao';\nimport useSongIndex from 'Songs/hooks/useSongIndex';\nimport convertTxtToSong, { getVideoId } from 'Songs/utils/convertTxtToSong';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport { Song } from 'interfaces';\nimport { useEffect, useMemo, useRef, useState } from 'react';\nimport { Link } from 'wouter';\n\ninterface Props {\n    song?: Song;\n}\n\nconst steps = ['basic-data', 'author-and-video', 'sync', 'metadata'] as const;\nexport default function Convert({ song }: Props) {\n    const { data: songs } = useSongIndex(true);\n    useBackground(false);\n    const navigate = useSmoothNavigate();\n    useBackgroundMusic(false);\n    const [currentStep, setCurrentStep] = useState(0);\n\n    const [basicData, setBasicData] = useState<BasicDataEntity>({ sourceUrl: song?.sourceUrl ?? '', txtInput: '' });\n    const [authorAndVid, setAuthorAndVid] = useState<AuthorAndVidEntity>({\n        author: song?.author ?? '',\n        authorUrl: song?.authorUrl ?? '',\n        video: song?.video ? `https://www.youtube.com/watch?v=${song.video}` : '',\n    });\n    const [metadataEntity, setMetadataEntity] = useState<SongMetadataEntity>({\n        artist: song?.artist ?? '',\n        title: song?.title ?? '',\n        realBpm: song?.realBpm ? String(song.realBpm) : '',\n        year: song?.year ?? '',\n        language: song?.language ?? '',\n        volume: song?.volume ?? 0,\n        previewStart: song?.previewStart ?? undefined,\n        previewEnd: song?.previewEnd ?? undefined,\n        genre: song?.genre,\n    });\n\n    const [editedSong, setEditedSong] = useState<Song | undefined>(song);\n\n    const error = useRef<string>('');\n    const conversionResult: Song | undefined = useMemo(() => {\n        try {\n            if (song)\n                return {\n                    ...song,\n                    video: getVideoId(authorAndVid.video) || song.video,\n                    author: authorAndVid.author,\n                    authorUrl: authorAndVid.authorUrl,\n                    sourceUrl: basicData.sourceUrl,\n                };\n            if (!basicData.txtInput) return undefined;\n            return convertTxtToSong(\n                basicData.txtInput,\n                authorAndVid.video,\n                authorAndVid.author,\n                authorAndVid.authorUrl,\n                basicData.sourceUrl,\n            );\n        } catch (e: any) {\n            error.current = e.message;\n            console.error(e);\n        }\n        return undefined;\n    }, [\n        basicData.txtInput,\n        authorAndVid.video,\n        authorAndVid.author,\n        authorAndVid.authorUrl,\n        basicData.sourceUrl,\n        song,\n    ]);\n\n    const possibleDuplicate = useMemo(\n        () =>\n            !song &&\n            conversionResult &&\n            songs?.find(\n                (addedSong) => SongDao.generateSongFile(addedSong) === SongDao.generateSongFile(conversionResult),\n            ),\n        [songs, conversionResult, song],\n    );\n\n    useEffect(() => {\n        if (conversionResult) {\n            if (!!conversionResult.video && !authorAndVid.video) {\n                setAuthorAndVid((current) => ({\n                    ...current,\n                    video: `https://www.youtube.com/watch?v=${conversionResult.video}`,\n                }));\n            }\n            if (!!conversionResult.author && !authorAndVid.author) {\n                setAuthorAndVid((current) => ({\n                    ...current,\n                    author: current.author || conversionResult?.author || '',\n                    authorUrl: current.authorUrl || conversionResult?.authorUrl || '',\n                }));\n            }\n            if (!!conversionResult.sourceUrl && !basicData.sourceUrl) {\n                setBasicData((current) => ({\n                    ...current,\n                    sourceUrl: conversionResult.sourceUrl!,\n                }));\n            }\n            (\n                [\n                    'year',\n                    'language',\n                    'realBpm',\n                    'genre',\n                    'artist',\n                    'title',\n                    'volume',\n                    'previewStart',\n                    'previewEnd',\n                ] as const\n            ).forEach((property) => {\n                if (!!conversionResult[property] && !metadataEntity[property]) {\n                    setMetadataEntity((current) => ({\n                        ...current,\n                        [property]: conversionResult[property],\n                    }));\n                }\n            });\n        }\n    }, [\n        conversionResult,\n        metadataEntity.year,\n        metadataEntity.language,\n        metadataEntity.realBpm,\n        metadataEntity.genre,\n        metadataEntity.artist,\n        metadataEntity.volume,\n        metadataEntity.title,\n        metadataEntity.previewStart,\n        metadataEntity.previewEnd,\n        basicData.sourceUrl,\n        authorAndVid.video,\n    ]);\n\n    const isBasicInfoCompleted = !!basicData.txtInput || !!song;\n    const isAuthorAndVidCompleted = !!authorAndVid.video;\n\n    const isNextStepAvailable = steps[currentStep] === 'author-and-video' ? isAuthorAndVidCompleted : true;\n\n    const finalSong: Song = {\n        ...editedSong!,\n        ...metadataEntity,\n        author: authorAndVid.author,\n        authorUrl: authorAndVid.authorUrl,\n        realBpm: +metadataEntity.realBpm,\n        sourceUrl: basicData.sourceUrl,\n    };\n\n    return (\n        <StyledEngineProvider injectFirst>\n            <NormalizeFontSize />\n            <Container>\n                {!song && (\n                    <div style={{ marginBottom: '1rem' }}>\n                        <Link to=\"/\">\n                            <a>Return to the main menu</a>\n                        </Link>\n                    </div>\n                )}\n                <Stepper activeStep={currentStep} sx={{ mb: 2 }} nonLinear={!!song}>\n                    <Step key={0} completed={isBasicInfoCompleted}>\n                        <StepButton color=\"inherit\" onClick={() => setCurrentStep(0)}>\n                            Basic Info\n                        </StepButton>\n                    </Step>\n                    <Step key={1} completed={isAuthorAndVidCompleted}>\n                        <StepButton color=\"inherit\" onClick={() => setCurrentStep(1)}>\n                            Author and video data\n                        </StepButton>\n                    </Step>\n                    <Step key={2}>\n                        <StepButton color=\"inherit\" onClick={() => setCurrentStep(2)}>\n                            Sync lyrics to video\n                        </StepButton>\n                    </Step>\n                    <Step key={3}>\n                        <StepButton color=\"inherit\" onClick={() => setCurrentStep(3)}>\n                            Fill song metadata\n                        </StepButton>\n                    </Step>\n                </Stepper>\n\n                {possibleDuplicate && (\n                    <Alert severity=\"warning\" data-test=\"possible-duplicate\">\n                        <AlertTitle>Possible duplicate</AlertTitle>\n                        There is already a song with similar artist and/or name:{' '}\n                        <b>\n                            {possibleDuplicate.artist} - {possibleDuplicate.title}\n                        </b>\n                    </Alert>\n                )}\n                <form\n                    onSubmit={(e) => {\n                        e.preventDefault();\n                        if (currentStep < steps.length - 1) setCurrentStep((current) => current + 1);\n                        else if (steps.at(currentStep) === 'metadata') {\n                            SongDao.store(finalSong!).then(() =>\n                                navigate(`/edit?search=${encodeURIComponent(finalSong!.title)}`),\n                            );\n                        }\n                    }}>\n                    {steps.at(currentStep) === 'basic-data' && (\n                        <BasicData\n                            shouldAutoImport={!isAuthorAndVidCompleted}\n                            isTxtRequired={!song}\n                            onAutoImport={setAuthorAndVid}\n                            onChange={setBasicData}\n                            data={basicData}\n                        />\n                    )}\n\n                    {steps.at(currentStep) === 'author-and-video' && (\n                        <AuthorAndVid\n                            songArtist={conversionResult?.artist}\n                            songTitle={conversionResult?.title}\n                            onChange={setAuthorAndVid}\n                            data={authorAndVid}\n                        />\n                    )}\n\n                    {conversionResult && ( // Keep the component even if in different step so it preserves the state\n                        <SyncLyricsToVideo\n                            onChange={setEditedSong}\n                            data={conversionResult}\n                            visible={steps.at(currentStep) === 'sync'}\n                        />\n                    )}\n\n                    {steps.at(currentStep) === 'metadata' && (\n                        <SongMetadata\n                            videoGap={editedSong?.videoGap}\n                            onChange={setMetadataEntity}\n                            data={metadataEntity}\n                            songArtist={conversionResult?.artist}\n                            songTitle={conversionResult?.title}\n                            videoId={conversionResult!.video}\n                        />\n                    )}\n                    <Box sx={{ display: 'flex', justifyContent: 'flex-end' }}>\n                        <Button\n                            data-test=\"previous-button\"\n                            sx={{ mt: 2, align: 'right' }}\n                            onClick={() => setCurrentStep((current) => current - 1)}\n                            disabled={currentStep === 0}>\n                            Previous\n                        </Button>\n                        {steps.at(currentStep) === 'metadata' ? (\n                            <Button\n                                data-test=\"save-button\"\n                                sx={{ mt: 2, align: 'right' }}\n                                type=\"submit\"\n                                variant={'contained'}>\n                                Save\n                            </Button>\n                        ) : (\n                            <Button\n                                data-test=\"next-button\"\n                                sx={{ mt: 2, align: 'right' }}\n                                variant={'contained'}\n                                type=\"submit\"\n                                disabled={!isNextStepAvailable || currentStep === steps.length - 1}>\n                                Next\n                            </Button>\n                        )}\n                    </Box>\n                </form>\n            </Container>\n        </StyledEngineProvider>\n    );\n}\n\nconst Container = styled.div`\n    background: white;\n    margin: 30px auto 0;\n    width: 1260px;\n    height: 100%;\n`;\n","import { Song } from 'interfaces';\nimport getSongFirstNoteMs from 'Songs/utils/getSongFirstNoteMs';\n\nexport default function fixVideoGap(song: Song) {\n    const firstNote = getSongFirstNoteMs(song);\n\n    return {\n        ...song,\n        videoGap: Math.round(Math.max(0, Math.min(song.videoGap ?? 0, firstNote / 1000 - 15))),\n    };\n}\n","import addHeadstart from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/addHeadstart';\nimport fixVideoGap from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/fixVideoGap';\nimport normaliseGap from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseGap';\nimport normaliseLyricSpaces from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseLyricSpaces';\nimport normaliseSectionPaddings from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseSectionPaddings';\nimport SongDao from 'Songs/SongDao';\nimport { Song } from 'interfaces';\nimport { useEffect, useState } from 'react';\n\nconst processSong = (song: Song) => {\n    let processed = normaliseGap(song);\n    processed = addHeadstart(processed);\n    processed = normaliseSectionPaddings(processed);\n    processed = normaliseLyricSpaces(processed);\n    processed = fixVideoGap(processed);\n\n    return processed;\n};\n\nexport default function useSong(fileName: string) {\n    const [song, setSong] = useState<Song | null>(null);\n\n    useEffect(() => {\n        SongDao.get(fileName).then((loadedSong) => setSong(loadedSong ? processSong(loadedSong) : loadedSong));\n    }, [fileName]);\n\n    return {\n        data: song,\n    };\n}\n","import styled from '@emotion/styled';\nimport Convert from 'Scenes/Convert/Convert';\nimport useSong from 'Songs/hooks/useSong';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport { Link } from 'wouter';\n\ninterface Props {\n    file: string;\n}\n\nexport default function Edit(props: Props) {\n    useBackgroundMusic(false);\n    const song = useSong(props.file);\n\n    if (!song.data) return <>Loading</>;\n\n    return (\n        <Container>\n            <div>\n                <Link to=\"/edit\">\n                    <a>Return to the song list</a>\n                </Link>\n            </div>\n            <Convert song={song.data} />\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    margin: 30px auto 0 auto;\n    width: 1260px;\n    height: 100%;\n    background: white;\n`;\n","import { SongTXTKeys, typesMap } from 'Songs/utils/convertTxtToSong';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { Note, Song } from 'interfaces';\nimport { invert } from 'lodash-es';\nimport { ValuesType } from 'utility-types';\n\nexport const txtTypesMap = invert(typesMap) as any as Record<ValuesType<typeof typesMap>, keyof typeof typesMap>;\n\nfunction toTxtValue(key: SongTXTKeys, value: string | string[] | number | undefined) {\n    if (value === undefined) return undefined;\n    return `#${key}:${\n        typeof value === 'number'\n            ? value.toString(10).replace('.', ',')\n            : Array.isArray(value)\n            ? value.join(', ')\n            : value\n    }`;\n}\n\nconst notesToText = (notes: Note[]) =>\n    notes\n        .map((note) => `${txtTypesMap[note.type]} ${note.start} ${note.length} ${note.pitch} ${note.lyrics}`)\n        .join('\\n');\n\nexport default function convertSongToTxt(song: Song) {\n    const parsedValues: Record<keyof Omit<Song, 'tracks' | 'bar'>, string | undefined> = {\n        artist: toTxtValue('ARTIST', song.artist),\n        title: toTxtValue('TITLE', song.title),\n        author: toTxtValue('CREATOR', song.author),\n        authorUrl: toTxtValue('CREATORURL', song.authorUrl),\n        bpm: toTxtValue('BPM', song.bpm),\n        realBpm: toTxtValue('REALBPM', song.realBpm),\n        year: toTxtValue('YEAR', song.year),\n        sourceUrl: toTxtValue('SOURCEURL', song.sourceUrl),\n        previewStart: toTxtValue('PREVIEWSTART', song.previewStart),\n        previewEnd: toTxtValue('PREVIEWEND', song.previewEnd),\n        video: toTxtValue('VIDEOID', song.video),\n        videoGap: toTxtValue('VIDEOGAP', song.videoGap),\n        volume: toTxtValue('VOLUME', song.volume),\n        genre: toTxtValue('GENRE', song.genre),\n        language: toTxtValue('LANGUAGE', song.language),\n        lastUpdate: toTxtValue('LASTUPDATE', song.lastUpdate),\n        edition: toTxtValue('EDITION', song.edition),\n        gap: toTxtValue('GAP', song.gap),\n    };\n    const trackNames = song.tracks.map((track) => track.name ?? null);\n\n    const lines: string[] = [];\n    song.tracks\n        .map((track) => track.sections)\n        .forEach(([first, ...sections]) => {\n            lines.push(isNotesSection(first) ? notesToText(first.notes) : `- ${first.start} ${first.end}`);\n\n            sections.forEach((section) =>\n                lines.push(\n                    isNotesSection(section)\n                        ? `- ${section.start}\\n${notesToText(section.notes)}`\n                        : `- ${section.start} ${section.end}`,\n                ),\n            );\n        });\n\n    return Object.values(parsedValues)\n        .concat(trackNames.filter(Boolean).length ? toTxtValue('TRACKNAMES', JSON.stringify(trackNames)) : [])\n        .concat(lines)\n        .concat('E')\n        .filter((value) => value !== undefined)\n        .join('\\n');\n}\n","import styled from '@emotion/styled';\nimport { DataObject, Delete, Download, Edit as EditIcon, Visibility, VisibilityOff } from '@mui/icons-material';\nimport { Button, Grid, IconButton } from '@mui/material';\nimport { useBackground } from 'Elements/LayoutWithBackground';\nimport NormalizeFontSize from 'Elements/NormalizeFontSize';\nimport SongDao from 'Songs/SongDao';\nimport useSongIndex from 'Songs/hooks/useSongIndex';\nimport convertSongToTxt from 'Songs/utils/convertSongToTxt';\nimport { format } from 'date-fns';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport { SongPreview } from 'interfaces';\nimport MaterialReactTable, { MRT_ColumnDef } from 'material-react-table';\nimport { useMemo } from 'react';\nimport { Link } from 'wouter';\n\ninterface Props {}\n\nexport default function SongList(props: Props) {\n    useBackground(false);\n    useBackgroundMusic(false);\n    const { data, reload } = useSongIndex(true);\n\n    const initialSearch = new URLSearchParams(window.location.search)?.get('search');\n\n    const columns: MRT_ColumnDef<SongPreview>[] = useMemo(\n        () => [\n            {\n                accessorKey: 'artist',\n                header: 'Artist',\n            },\n            {\n                accessorKey: 'title',\n                header: 'Title',\n            },\n            {\n                accessorKey: 'year',\n                header: 'Year',\n                size: 100,\n            },\n            {\n                accessorKey: 'language',\n                header: 'Language',\n                size: 100,\n            },\n            {\n                accessorKey: 'video',\n                header: 'Video',\n                size: 100,\n            },\n            {\n                accessorKey: 'lastUpdate',\n                header: 'Last Update',\n                Cell: ({ cell }) => {\n                    const val = cell.getValue<string>();\n\n                    return val && <abbr title={val}>{format(new Date(val), 'LLL do y')}</abbr>;\n                },\n            },\n            {\n                accessorKey: 'local',\n                header: 'Local',\n                Cell: ({ cell }) => (cell.getValue<boolean>() ? `` : ''),\n            },\n            {\n                accessorKey: 'isDeleted',\n                header: 'Deleted',\n                Cell: ({ cell }) => (cell.getValue<boolean>() ? `` : ''),\n                size: 100,\n            },\n        ],\n        [],\n    );\n    if (!data) return <>Loading</>;\n\n    return (\n        <Container>\n            <NormalizeFontSize />\n            <Grid container>\n                <Grid item xs={3}>\n                    <Link to=\"/\">\n                        <a>Return to main menu</a>\n                    </Link>\n                </Grid>\n                <Grid item xs={3}>\n                    <h3>{data.length} songs</h3>\n                </Grid>\n                <Grid item xs={6} display={'flex'} alignItems={'center'} justifyContent={'flex-end'}>\n                    <Link to=\"/convert\">\n                        <Button data-test=\"convert-song\" variant={'contained'}>\n                            Import UltraStar .TXT\n                        </Button>\n                    </Link>\n                </Grid>\n            </Grid>\n            <MaterialReactTable\n                data={data}\n                columns={columns}\n                getRowId={(song) => song.file}\n                positionActionsColumn=\"last\"\n                enableRowActions\n                renderRowActions={({ row }) => (\n                    <>\n                        <IconButton\n                            title=\"Edit the song\"\n                            href={`/edit/${encodeURIComponent(row.original.file)}`}\n                            data-test=\"edit-song\"\n                            data-song={row.original.file}>\n                            <EditIcon />\n                        </IconButton>\n                        <IconButton\n                            title=\"Download .txt file\"\n                            onClick={async () => {\n                                const songData = await SongDao.get(row.original.file);\n                                const txt = convertSongToTxt(songData);\n\n                                const anchor = document.createElement('a');\n                                anchor.href = `data:plain/text;charset=utf-8,${encodeURIComponent(txt)}`;\n                                anchor.download = SongDao.generateSongFile(songData, 'txt');\n                                document.body.appendChild(anchor);\n                                anchor.click();\n                                document.body.removeChild(anchor);\n                            }}\n                            data-test=\"download-song\"\n                            data-song={row.original.file}>\n                            <Download />\n                        </IconButton>\n                        <IconButton\n                            title=\"Download .json file\"\n                            onClick={async () => {\n                                const songData = await SongDao.get(row.original.file);\n                                const json = JSON.stringify(songData, undefined, 2);\n\n                                const anchor = document.createElement('a');\n                                anchor.href = `data:application/json;charset=utf-8,${encodeURIComponent(json)}`;\n                                anchor.download = SongDao.generateSongFile(songData);\n                                document.body.appendChild(anchor);\n                                anchor.click();\n                                document.body.removeChild(anchor);\n                            }}\n                            data-test=\"download-song-json\"\n                            data-song={row.original.file}>\n                            <DataObject />\n                        </IconButton>\n                        {!row.original.isDeleted && (\n                            <IconButton\n                                title=\"Hide the song\"\n                                onClick={async () => {\n                                    await SongDao.softDeleteSong(row.original.file);\n                                    reload();\n                                }}\n                                data-test=\"hide-song\"\n                                data-song={row.original.file}>\n                                <VisibilityOff />\n                            </IconButton>\n                        )}\n                        {row.original.isDeleted && (\n                            <IconButton\n                                title=\"Restore the song\"\n                                onClick={async () => {\n                                    await SongDao.restoreSong(row.original.file);\n                                    reload();\n                                }}\n                                data-test=\"restore-song\"\n                                data-song={row.original.file}>\n                                <Visibility />\n                            </IconButton>\n                        )}\n                        <IconButton\n                            title=\"Delete the song\"\n                            onClick={async () => {\n                                const proceed = window.confirm(`Are you sure you want to delete this song?`);\n\n                                if (proceed) {\n                                    await SongDao.deleteSong(row.original.file);\n                                    reload();\n                                }\n                            }}\n                            data-test=\"delete-song\"\n                            disabled={!row.original.local}\n                            data-song={row.original.file}>\n                            <Delete />\n                        </IconButton>\n                    </>\n                )}\n                initialState={{\n                    density: 'compact',\n                    columnVisibility: { local: false, isDeleted: false, video: false },\n                    globalFilter: initialSearch,\n                    showGlobalFilter: true,\n                }}\n                enableDensityToggle={false}\n                enableFullScreenToggle={false}\n            />\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    margin: 0 auto;\n    height: 100%;\n    width: 1260px;\n    background: white;\n    padding: 60px 20px 0 20px;\n`;\n","import { css } from '@emotion/react';\nimport styled from '@emotion/styled';\nimport { CheckBox, CheckBoxOutlineBlank, Warning } from '@mui/icons-material';\nimport { MenuButton } from 'Elements/Menu';\nimport MenuWithLogo from 'Elements/MenuWithLogo';\nimport { typography } from 'Elements/cssMixins';\nimport { ExcludedLanguagesSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport useSongIndex from 'Songs/hooks/useSongIndex';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { SongPreview } from 'interfaces';\nimport { useEffect, useMemo } from 'react';\nimport CountUp from 'react-countup';\nimport isE2E from 'utils/isE2E';\nimport languageNameToIsoCode from 'utils/languageNameToIsoCode';\n\nexport const useLanguageList = (list: SongPreview[]) => {\n    return useMemo(() => {\n        const langs: Record<string, { name: string; count: number }> = {};\n\n        list.forEach((song) => {\n            if (!song.language) return;\n            const songLangs = Array.isArray(song.language) ? song.language : [song.language];\n\n            songLangs.forEach((lang) => {\n                const langId = lang.toLowerCase();\n                if (!langs[langId]) {\n                    langs[langId] = { name: lang, count: 0 };\n                }\n                langs[langId].count = langs[langId].count + 1;\n            });\n        });\n\n        const languages = Object.values(langs);\n        languages.sort((a, b) => b.count - a.count);\n\n        return languages;\n    }, [list]);\n};\n\ninterface Props {\n    onClose: () => void;\n    closeText: string;\n}\n\nconst MIN_SONGS_COUNT = isE2E() ? 0 : 3;\n\nfunction ExcludeLanguagesView({ onClose, closeText }: Props) {\n    const { register } = useKeyboardNav({ onBackspace: onClose });\n\n    const [excludedLanguages, setExcludedLanguages] = useSettingValue(ExcludedLanguagesSetting);\n    const { data } = useSongIndex();\n    const availableLanguages = useLanguageList(data);\n    const languageList = useMemo(\n        () => availableLanguages.filter(({ name, count }) => languageNameToIsoCode(name) && count >= MIN_SONGS_COUNT),\n        [availableLanguages],\n    );\n    const otherSongCount = useMemo(\n        () =>\n            availableLanguages\n                .filter(({ name }) => !languageList.find((lang) => lang.name === name))\n                .reduce((acc, { count }) => acc + count, 0),\n        [availableLanguages, languageList],\n    );\n\n    const songCount = languageList\n        .filter(({ name }) => !excludedLanguages?.includes(name))\n        .reduce((acc, { count }) => acc + count, 0);\n\n    const toggleLanguage = (language: string) => {\n        if (excludedLanguages === null) setExcludedLanguages([language]);\n        else if (!excludedLanguages.includes(language)) setExcludedLanguages([...excludedLanguages, language]);\n        else setExcludedLanguages(excludedLanguages.filter((lang) => lang !== language));\n    };\n\n    useEffect(() => {\n        if (excludedLanguages === null && navigator?.languages) {\n            let languageNames = new Intl.DisplayNames(['en'], { type: 'language' });\n            const preferredLanguages = navigator?.languages\n                .map((lang) => languageNames.of(lang)?.toLowerCase()!)\n                .filter(Boolean);\n\n            const toExclude = languageList\n                .map((lang) => lang.name)\n                .filter((lang) => !preferredLanguages.some((preferred) => preferred.includes(lang.toLowerCase())))\n                .filter((lang) => lang !== 'English'); // Always have English selected as default\n\n            if (toExclude.length) {\n                setExcludedLanguages(toExclude);\n            }\n        }\n    }, [excludedLanguages, languageList]);\n\n    const areAllLanguagesExcluded = excludedLanguages?.length === languageList.length;\n\n    return (\n        <MenuWithLogo>\n            <h1>Select Song Languages</h1>\n            <LanguageListContainer>\n                {languageList.map(({ name, count }) => {\n                    const excluded = excludedLanguages?.includes(name) ?? false;\n                    return (\n                        <LanguageEntry\n                            key={name}\n                            excluded={excluded}\n                            {...register(`lang-${name}`, () => toggleLanguage(name))}>\n                            <Check>{excluded ? <CheckBoxOutlineBlank /> : <CheckBox />}</Check>\n                            <span>\n                                <LanguageName>{name}</LanguageName> ({count} songs)\n                            </span>\n                            <LanguageFlagBackground excluded={excluded}>\n                                <img src={`https://flagcdn.com/${languageNameToIsoCode(name)}.svg`} alt={name} />\n                            </LanguageFlagBackground>\n                        </LanguageEntry>\n                    );\n                })}\n                {otherSongCount > 0 && (\n                    <Disclaimer>\n                        and <strong>{otherSongCount} songs</strong> in other languages\n                    </Disclaimer>\n                )}\n            </LanguageListContainer>\n            <h3>\n                You can always update the selection in <strong>Manage Songs</strong> menu\n            </h3>\n            <NextButtonContainer>\n                <MenuButton\n                    {...register('close-exclude-languages', onClose, undefined, true, {\n                        disabled: areAllLanguagesExcluded,\n                    })}>\n                    {closeText}\n                </MenuButton>\n                <Disclaimer>\n                    The list will contain{' '}\n                    <strong>\n                        <CountUp duration={1} preserveValue end={songCount + otherSongCount} />\n                    </strong>{' '}\n                    songs\n                </Disclaimer>\n                {areAllLanguagesExcluded && (\n                    <Disclaimer data-test=\"all-languages-excluded-warning\">\n                        <strong>\n                            <Warning />\n                        </strong>{' '}\n                        You excluded all the languages, pick at least one\n                    </Disclaimer>\n                )}\n            </NextButtonContainer>\n        </MenuWithLogo>\n    );\n}\n\nconst NextButtonContainer = styled.div`\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n`;\n\nconst Disclaimer = styled.h4`\n    text-align: right;\n`;\n\nconst Check = styled.div`\n    svg {\n        width: 4rem;\n        height: 4rem;\n    }\n`;\n\nconst LanguageListContainer = styled.div`\n    margin-top: 2rem;\n`;\nconst LanguageName = styled.span`\n    transition: 300ms;\n`;\n\nconst LanguageFlagBackground = styled.div<{ excluded: boolean }>`\n    transition: 300ms;\n    opacity: 0.95;\n    ${(props) =>\n        props.excluded\n            ? css`\n                  filter: grayscale(0.6);\n                  opacity: 0.5;\n              `\n            : ''}\n\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    img {\n        width: 17rem;\n        height: 10rem;\n        object-fit: cover;\n    }\n    overflow: hidden;\n    width: 17rem;\n    height: 10rem;\n`;\n\nconst LanguageEntry = styled(MenuButton)<{ excluded: boolean; focused: boolean }>`\n    ${(props) =>\n        props.excluded\n            ? css`\n                  ${props.focused ? '' : 'background: rgba(0, 0, 0, 0.55)'};\n                  text-decoration: line-through white;\n                  opacity: 0.5;\n              `\n            : ''}\n    ${typography};\n    display: flex;\n    align-items: center;\n    gap: 2rem;\n    font-size: 3rem;\n    padding-left: 3rem;\n\n    position: relative;\n\n    width: 100%;\n`;\n\nexport default ExcludeLanguagesView;\n","import { captureException } from '@sentry/react';\nimport { ExcludedLanguagesSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport useSongIndex from 'Songs/hooks/useSongIndex';\nimport { isAfter } from 'date-fns';\nimport { SongPreview } from 'interfaces';\nimport { uniq } from 'lodash-es';\nimport { useDeferredValue, useMemo, useState } from 'react';\nimport clearString from 'utils/clearString';\n\nexport interface SongGroup {\n    letter: string;\n    songs: Array<{ index: number; song: SongPreview }>;\n    isNew?: boolean;\n}\n\nexport interface AppliedFilters {\n    yearBefore?: number;\n    yearAfter?: number;\n    language?: string;\n    excludeLanguages?: string[];\n    search?: string;\n    updatedAfter?: string;\n    duet?: boolean | null;\n}\n\nexport function isEmptyFilters(filters: AppliedFilters) {\n    return (\n        (!filters.language || filters.language === '') &&\n        (!filters.search || filters.search === '') &&\n        (filters.duet === undefined || filters.duet === null) &&\n        !filters.yearBefore &&\n        !filters.yearAfter\n    );\n}\n\nexport interface FiltersData {\n    language: {\n        current: string;\n        available: string[];\n    };\n    status: {\n        allSongs: number;\n        visible: number;\n    };\n}\n\ntype FilterFunc = (songList: SongPreview[], ...args: any) => SongPreview[];\n\nconst filteringFunctions: Record<keyof AppliedFilters, FilterFunc> = {\n    language: (songList, language: string) => {\n        if (language === '') return songList;\n\n        return songList.filter((song) => {\n            const songLangs = Array.isArray(song.language) ? song.language : [song.language!];\n\n            return songLangs.includes(language);\n        });\n    },\n    excludeLanguages: (songList, languages: string[] = []) => {\n        if (languages.length === 0) return songList;\n\n        return songList.filter((song) => {\n            const songLangs = Array.isArray(song.language) ? song.language : [song.language!];\n\n            return !songLangs.every((songLang) => languages.includes(songLang!));\n        });\n    },\n    search: (songList, search: string) => {\n        const cleanSearch = clearString(search);\n\n        return cleanSearch.length ? songList.filter((song) => song.search.includes(cleanSearch)) : songList;\n    },\n    duet: (songList, duet: boolean | null) => {\n        if (duet === null) return songList;\n\n        return songList.filter((song) => (duet ? song.tracksCount > 1 : song.tracksCount === 1));\n    },\n    yearBefore: (songList, yearBefore: number) => {\n        if (!yearBefore) return songList;\n\n        return songList.filter((song) => Number(song.year) < yearBefore);\n    },\n    yearAfter: (songList, yearAfter: number) => {\n        if (!yearAfter) return songList;\n\n        return songList.filter((song) => Number(song.year) >= yearAfter);\n    },\n    updatedAfter: (songList, after: string) => {\n        if (!after) return songList;\n        const dateAfter = new Date(after);\n\n        return songList.filter((song) => song.lastUpdate && isAfter(new Date(song.lastUpdate), dateAfter));\n    },\n};\n\nconst applyFilters = (list: SongPreview[], appliedFilters: AppliedFilters): SongPreview[] => {\n    if (clearString(appliedFilters?.search ?? '').length) {\n        return filteringFunctions.search(list, appliedFilters.search);\n    }\n    return Object.entries(appliedFilters)\n        .filter((filters): filters is [keyof AppliedFilters, FilterFunc] => filters[0] in filteringFunctions)\n        .reduce((songList, [name, value]) => filteringFunctions[name](songList, value), list);\n};\n\nexport const useLanguageFilter = (list: SongPreview[]) => {\n    return useMemo(() => uniq(['', ...list.map((song) => song.language ?? 'Unknown')].flat()), [list]);\n};\n\nexport const useSongListFilter = (list: SongPreview[]) => {\n    const availableLanguages = useLanguageFilter(list);\n    const [excludedLanguages] = useSettingValue(ExcludedLanguagesSetting);\n\n    const [filters, setFilters] = useState<AppliedFilters>({ excludeLanguages: excludedLanguages ?? [] });\n    const deferredFilters = useDeferredValue(filters);\n\n    const prefilteredList = useMemo(\n        () => applyFilters(list, { excludeLanguages: excludedLanguages ?? [] }),\n        [list, excludedLanguages],\n    );\n    const filteredList = useMemo(\n        () =>\n            applyFilters(list, {\n                ...deferredFilters,\n                excludeLanguages: excludedLanguages ?? [],\n            }),\n        [list, deferredFilters, excludedLanguages],\n    );\n\n    const filtersData: FiltersData = {\n        language: {\n            current: filters.language ?? '',\n            available: availableLanguages,\n        },\n        status: {\n            allSongs: list.length,\n            visible: filteredList.length,\n        },\n    };\n\n    return { filters, filteredList, filtersData, prefilteredList, setFilters };\n};\n\nexport default function useSongList() {\n    const songList = useSongIndex();\n\n    const { filters, filtersData, filteredList, prefilteredList, setFilters } = useSongListFilter(songList.data);\n\n    const groupedSongList = useMemo(() => {\n        if (filteredList.length === 0) return [];\n\n        const groups: SongGroup[] = [];\n\n        if (!filters.search) {\n            const newSongs = filteredList.filter((song) => song.isNew);\n\n            if (newSongs.length) {\n                groups.push({\n                    letter: 'New',\n                    isNew: true,\n                    songs: newSongs.map((song) => ({ song, index: filteredList.indexOf(song) })),\n                });\n            }\n        }\n\n        filteredList.forEach((song, index) => {\n            try {\n                const firstCharacter = isFinite(+song.artist[0]) ? '0-9' : song.artist[0].toUpperCase();\n                let group = groups.find((group) => group.letter === firstCharacter);\n                if (!group) {\n                    group = { letter: firstCharacter, songs: [] };\n                    groups.push(group);\n                }\n\n                group.songs.push({ index: index, song });\n            } catch (e) {\n                console.error(e);\n                captureException(e);\n            }\n        });\n\n        return groups;\n    }, [filteredList, filters.search]);\n\n    return {\n        prefilteredList,\n        groupedSongList,\n        songList: filteredList,\n        filtersData,\n        filters,\n        setFilters,\n        isLoading: songList.isLoading,\n    };\n}\n","import { randomInt } from 'utils/randomValue';\n\nconst MAX_REMEMBERED_SONGS_COUNT = 30;\nexport default function selectRandomSong(\n    songCount: number,\n    previouslySelectedSongs: number[],\n    maxRememberedCount = MAX_REMEMBERED_SONGS_COUNT,\n) {\n    let newIndex;\n    if (previouslySelectedSongs.length < songCount) {\n        const possibleOptions = [...Array(songCount).keys()].filter((id) => !previouslySelectedSongs.includes(id));\n\n        newIndex = possibleOptions[randomInt(0, possibleOptions.length - 1)];\n    } else {\n        newIndex = randomInt(0, songCount - 1);\n\n        previouslySelectedSongs.length = 0;\n    }\n\n    if (previouslySelectedSongs.length >= maxRememberedCount) {\n        previouslySelectedSongs.shift();\n    }\n    previouslySelectedSongs.push(newIndex);\n\n    return newIndex;\n}\n","import { useEffect, useRef, type MutableRefObject } from 'react';\n\n/**\n * a type-safe version of the `usePrevious` hook described here:\n * @see {@link https://reactjs.org/docs/hooks-faq.html#how-to-get-the-previous-props-or-state}\n */\nexport default function usePrevious<T>(value: T): MutableRefObject<T>['current'] {\n    const ref = useRef<T>(value);\n    useEffect(() => {\n        ref.current = value;\n    }, [value]);\n    return ref.current;\n}\n","import { HelpEntry } from 'Scenes/KeyboardHelp/Context';\nimport selectRandomSong from 'Scenes/SingASong/SongSelection/Hooks/selectRandomSong';\nimport { AppliedFilters, SongGroup } from 'Scenes/SingASong/SongSelection/Hooks/useSongList';\nimport { menuBack, menuEnter, menuNavigate } from 'SoundManager';\nimport useKeyboard from 'hooks/useKeyboard';\nimport useKeyboardHelp from 'hooks/useKeyboardHelp';\nimport usePrevious from 'hooks/usePrevious';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport { chunk, throttle } from 'lodash-es';\nimport posthog from 'posthog-js';\nimport { useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport tuple from 'utils/tuple';\n\nconst useTwoDimensionalNavigation = (groups: SongGroup[] = [], itemsPerRow: number) => {\n    const [cursorPosition, setCursorPosition] = useState<[number, number]>([0, 0]);\n    const songIndexMatrix = useMemo(\n        () =>\n            groups\n                .map(({ songs }) =>\n                    chunk(\n                        songs.map((song) => song.index),\n                        itemsPerRow,\n                    ),\n                )\n                .flat(),\n        [groups],\n    );\n    const songGroupMatrix = useMemo(\n        () =>\n            groups\n                .map(({ songs, letter }) =>\n                    chunk(\n                        songs.map(() => letter),\n                        itemsPerRow,\n                    ),\n                )\n                .flat(),\n        [groups],\n    );\n    const previousMatrix = usePrevious(songIndexMatrix ?? []);\n\n    const isAtLastColumn = cursorPosition[0] === songIndexMatrix[cursorPosition[1]]?.length - 1;\n\n    const moveToSong = useCallback(\n        (songIndex: number) => {\n            const y = songIndexMatrix.findIndex((columns) => columns.includes(songIndex));\n            const x = songIndexMatrix[y]?.indexOf(songIndex);\n            if (x >= 0 && y >= 0) {\n                setCursorPosition([x ?? 0, y ?? 0]);\n            } else {\n                setCursorPosition([0, 0]);\n            }\n        },\n        [songIndexMatrix],\n    );\n\n    const positionToValue = <T>([x, y]: [number, number], matrix: T[][], def: T) => {\n        if (groups.length === 0) return def;\n        const row = matrix[y];\n        return row?.[x] ?? row?.at(-1) ?? matrix?.[0]?.[0] ?? def;\n    };\n    const positionToSongIndex = ([x, y]: [number, number], matrix: number[][] = songIndexMatrix) => {\n        return positionToValue([x, y], matrix, 0);\n    };\n    const positionToGroup = ([x, y]: [number, number], matrix: string[][] = songGroupMatrix) => {\n        return positionToValue([x, y], matrix, 'A');\n    };\n\n    useEffect(() => {\n        const previousFocusedSong = positionToSongIndex(cursorPosition, previousMatrix);\n        const currentFocusedSong = positionToSongIndex(cursorPosition, songIndexMatrix);\n        if (previousMatrix.length && previousFocusedSong !== currentFocusedSong) {\n            moveToSong(previousFocusedSong);\n        }\n    }, [cursorPosition, songIndexMatrix, previousMatrix, isAtLastColumn]);\n\n    const moveCursor = (plane: 'x' | 'y', delta: number) => {\n        menuNavigate.play();\n        setCursorPosition(([x, y]) => {\n            let newX = x;\n            let newY = y;\n            if (plane === 'y') {\n                newY = y + delta;\n            } else {\n                if (songIndexMatrix[y] === undefined) {\n                    debugger;\n                }\n                const maxXInRow = songIndexMatrix[y].length - 1;\n                newX = Math.min(x, maxXInRow) + delta;\n                if (newX < 0) {\n                    newY = (songIndexMatrix.length + y - 1) % songIndexMatrix.length;\n                    newX = songIndexMatrix[newY].length - 1;\n                } else if (newX > maxXInRow) {\n                    newY = y + 1;\n                    newX = 0;\n                }\n            }\n            return [newX % itemsPerRow, (songIndexMatrix.length + newY) % songIndexMatrix.length];\n        });\n    };\n\n    const focusedSong = positionToSongIndex(cursorPosition);\n    const focusedGroup = positionToGroup(cursorPosition);\n\n    return tuple([focusedSong, focusedGroup, cursorPosition, moveCursor, moveToSong, isAtLastColumn]);\n};\n\nexport const useSongSelectionKeyboardNavigation = (\n    enabled: boolean,\n    groupedSongs: SongGroup[] = [],\n    onEnter: () => void,\n    songCount: number,\n    appliedFilters: AppliedFilters,\n    songsPerRow: number,\n) => {\n    const navigate = useSmoothNavigate();\n    // We need to record how user entered (from which \"side\") and how left and based on that update the selection.\n    // Eg if user was at the last column, entered playlists, and returned to the last column (by clicking left)\n    // then effectively the selection shouldn't change\n    const [showPlaylistsState, setShowPlaylistsState] = useState<[boolean, 'left' | 'right' | null]>([false, null]);\n    const previousPlaylistsState = usePrevious(showPlaylistsState);\n    const [arePlaylistsVisible, leavingKey] = showPlaylistsState;\n\n    const [focusedSong, focusedGroup, cursorPosition, moveCursor, moveToSong, isAtLastColumn] =\n        useTwoDimensionalNavigation(groupedSongs, songsPerRow);\n    const isAtFirstColumn = cursorPosition[0] === 0;\n\n    const handleEnter = () => {\n        menuEnter.play();\n        onEnter();\n    };\n\n    const [blockBack, setBlockBack] = useState(false);\n    const previousSearch = usePrevious(appliedFilters.search);\n    useLayoutEffect(() => {\n        if (previousSearch && !appliedFilters.search) {\n            setBlockBack(true);\n            const timeout = setTimeout(() => setBlockBack(false), 2_000);\n\n            return () => {\n                clearTimeout(timeout);\n                setBlockBack(false);\n            };\n        }\n    }, [appliedFilters.search]);\n\n    const handleBackspace = () => {\n        if (!blockBack && !appliedFilters.search) {\n            menuBack.play();\n            navigate('/');\n        }\n    };\n\n    const navigateToGroup = useCallback(\n        throttle(\n            (direction: 1 | -1, currentGroup: number) => {\n                const nextGroupIndex = (groupedSongs.length + currentGroup + direction) % groupedSongs.length;\n\n                moveToSong(groupedSongs[nextGroupIndex].songs[0].index);\n                menuNavigate.play();\n            },\n            700,\n            { trailing: false },\n        ),\n        [groupedSongs],\n    );\n\n    const navigateVertically = (e: KeyboardEvent | undefined, direction: 1 | -1) => {\n        if (!e?.repeat) {\n            moveCursor('y', direction);\n        } else {\n            const currentlySelectedGroupIndex = groupedSongs.findIndex(\n                (group) => !!group.songs.find((song) => song.index === focusedSong),\n            );\n            navigateToGroup(direction, currentlySelectedGroupIndex);\n        }\n    };\n\n    const navigateHorizontally = (direction: 1 | -1, ignoreFilters = false) => {\n        if (!ignoreFilters && direction === 1 && isAtLastColumn && !arePlaylistsVisible) {\n            setShowPlaylistsState([true, 'right']);\n        } else if (!ignoreFilters && direction === -1 && isAtFirstColumn && !arePlaylistsVisible) {\n            setShowPlaylistsState([true, 'left']);\n        } else {\n            moveCursor('x', direction);\n        }\n    };\n\n    const randomlySelectedSongs = useRef<number[]>([]);\n    const randomSong = () => {\n        const newIndex = selectRandomSong(songCount, randomlySelectedSongs.current);\n        moveToSong(newIndex);\n    };\n\n    useKeyboard(\n        {\n            accept: handleEnter,\n            down: (e) => navigateVertically(e, 1),\n            up: (e) => navigateVertically(e, -1),\n            left: () => navigateHorizontally(-1),\n            right: () => navigateHorizontally(1),\n            back: handleBackspace,\n            random: () => {\n                randomSong();\n                posthog.capture('selectRandom');\n            },\n        },\n        enabled && !arePlaylistsVisible,\n        [groupedSongs, cursorPosition, arePlaylistsVisible, appliedFilters, blockBack],\n    );\n\n    const help = useMemo<HelpEntry>(\n        () => ({\n            'horizontal-vertical': null,\n            accept: null,\n            back: null,\n            shiftR: null,\n            remote: ['search'],\n        }),\n        [],\n    );\n    useKeyboardHelp(help, enabled);\n\n    const closePlaylist = useCallback(\n        (leavingKey: 'left' | 'right') => {\n            setShowPlaylistsState([false, leavingKey]);\n            // if (leavingKey === 'right') navigateHorizontally(1);\n        },\n        [setShowPlaylistsState, navigateHorizontally, groupedSongs, cursorPosition],\n    );\n\n    useLayoutEffect(() => {\n        const [previousShowFilters, enteringKey] = previousPlaylistsState;\n        if (previousShowFilters && !arePlaylistsVisible) {\n            if (enteringKey === leavingKey) navigateHorizontally(leavingKey === 'right' ? 1 : -1, true);\n        }\n    }, [arePlaylistsVisible, leavingKey, isAtFirstColumn, isAtLastColumn, ...cursorPosition]);\n\n    return tuple([focusedSong, focusedGroup, moveToSong, arePlaylistsVisible, closePlaylist]);\n};\n","import useSongList from 'Scenes/SingASong/SongSelection/Hooks/useSongList';\nimport { useSongSelectionKeyboardNavigation } from 'Scenes/SingASong/SongSelection/Hooks/useSongSelectionKeyboardNavigation';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport { useEffect, useState } from 'react';\nimport { randomInt } from 'utils/randomValue';\n\nexport default function useSongSelection(preselectedSong: string | null, songsPerRow: number) {\n    const { songList, prefilteredList, groupedSongList, filtersData, setFilters, filters, isLoading } = useSongList();\n    const navigate = useSmoothNavigate();\n    const [keyboardControl, setKeyboardControl] = useState(true);\n\n    const [focusedSong, focusedGroup, moveToSong, showFilters, setShowFilters] = useSongSelectionKeyboardNavigation(\n        keyboardControl,\n        groupedSongList,\n        () => setKeyboardControl(false),\n        songList.length,\n        filters,\n        songsPerRow,\n    );\n\n    const [preselected, setPreselected] = useState(false);\n    useEffect(() => {\n        if (!preselected && songList.length) {\n            const preselectedSongIndex = songList.findIndex((song) => song.file === preselectedSong);\n            const firstNewSongIndex = songList.findIndex((song) => song.isNew);\n\n            let songIndex = randomInt(0, songList.length - 1);\n            if (preselectedSongIndex > -1) songIndex = preselectedSongIndex;\n            else if (firstNewSongIndex > -1) songIndex = preselectedSongIndex;\n\n            moveToSong(songIndex);\n            setPreselected(true);\n        }\n    }, [songList, moveToSong, preselectedSong]);\n\n    useEffect(() => {\n        if (preselected && songList.length && songList[focusedSong]) {\n            navigate(`/game/${encodeURIComponent(songList[focusedSong].file)}`, { replace: true, smooth: false });\n        }\n    }, [preselected, focusedSong, songList]);\n\n    const songPreview = songList?.[focusedSong];\n    return {\n        prefilteredList,\n        groupedSongList,\n        focusedSong,\n        focusedGroup,\n        moveToSong,\n        setKeyboardControl,\n        keyboardControl,\n        songPreview,\n        songList: songList ?? [],\n        filtersData,\n        filters,\n        setFilters,\n        showFilters,\n        setShowFilters,\n        isLoading,\n    };\n}\n","import styled from '@emotion/styled';\nimport { Button } from 'Elements/Button';\nimport { typography } from 'Elements/cssMixins';\nimport { useLanguageList } from 'Scenes/ExcludeLanguages/ExcludeLanguagesView';\nimport { AppliedFilters } from 'Scenes/SingASong/SongSelection/Hooks/useSongList';\nimport { addDays } from 'date-fns';\nimport useKeyboard from 'hooks/useKeyboard';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { SongPreview } from 'interfaces';\nimport { useEffect, useMemo } from 'react';\n\ninterface PlaylistEntry {\n    name: string;\n    filters: AppliedFilters;\n}\n\nconst usePlaylists = (songs: SongPreview[]): PlaylistEntry[] => {\n    const songLanguages = useLanguageList(songs);\n    return useMemo(\n        () =>\n            [\n                { name: 'All', filters: {} },\n                { name: songLanguages[0].name, filters: { language: songLanguages[0].name } } as PlaylistEntry,\n                songLanguages[1] ? { name: songLanguages[1].name, filters: { language: songLanguages[1].name } } : null,\n                { name: 'Classics', filters: { yearBefore: 1995 } },\n                { name: 'Modern', filters: { yearAfter: 1995 } },\n                { name: 'Duets', filters: { duet: true } },\n                { name: 'New', filters: { updatedAfter: addDays(new Date(), -31).toISOString() } },\n            ].filter((playlist): playlist is PlaylistEntry => playlist !== null),\n        [songLanguages],\n    );\n};\n\ninterface Props {\n    prefilteredList: SongPreview[];\n    setFilters: (filters: AppliedFilters) => void;\n    closePlaylist: (leavingKey: 'left' | 'right') => void;\n    active: boolean;\n}\n\nexport default function Playlists({ setFilters, active, closePlaylist, prefilteredList }: Props) {\n    const playlists = usePlaylists(prefilteredList);\n\n    const { register, focused, focusElement } = useKeyboardNav({\n        enabled: active,\n        additionalHelp: {\n            // It's possible to leave the playlists with left/right\n            vertical: undefined,\n            'horizontal-vertical': null,\n        },\n    });\n\n    useEffect(() => {\n        if (focused) {\n            const playlist = playlists.find((list) => `playlist-${list.name}` === focused);\n            playlist && setFilters(playlist.filters);\n        }\n    }, [focused, playlists]);\n\n    useKeyboard(\n        {\n            left: () => closePlaylist('left'),\n            right: () => closePlaylist('right'),\n        },\n        active,\n    );\n\n    return (\n        <Container data-test=\"song-list-playlists\">\n            {playlists.map((playlist) => (\n                <Playlist\n                    key={playlist.name}\n                    {...register(`playlist-${playlist.name}`, () => focusElement(`playlist-${playlist.name}`))}\n                    {...(!active ? { focused: false, active: `playlist-${playlist.name}` === focused } : {})}>\n                    {playlist.name}\n                </Playlist>\n            ))}\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    background: rgba(0, 0, 0, 0.7);\n    width: 100vh;\n    transform-origin: top right;\n    transform: rotate(-90deg);\n    position: absolute;\n    left: -100vh;\n    top: 0;\n    font-size: 3.6rem;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: row-reverse;\n\n    h2 {\n        ${typography};\n        margin: 0;\n    }\n`;\n\nconst Playlist = styled(Button)<{ active?: boolean }>`\n    font-size: 3rem;\n    flex: 1;\n    padding: 1.5rem;\n    ${(props) => props.active === false && `opacity: .5;`}\n`;\n","import styled from '@emotion/styled';\nimport { Input } from 'Elements/Input';\nimport { REGULAR_ALPHA_CHARS } from 'hooks/useKeyboard';\nimport { useEffect, useRef, useState } from 'react';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport { AppliedFilters } from 'Scenes/SingASong/SongSelection/Hooks/useSongList';\n\ninterface Props {\n    onSongFiltered: (filters: AppliedFilters) => void;\n    filters: AppliedFilters;\n    showFilters: boolean;\n}\nexport default function QuickSearch({ onSongFiltered, filters }: Props) {\n    const searchInput = useRef<HTMLInputElement | null>(null);\n    const [isFocused, setIsFocused] = useState(false);\n\n    const onLeave = () => {\n        searchInput.current?.blur();\n    };\n\n    useHotkeys('down', onLeave, { enabled: isFocused, enableOnTags: ['INPUT'] });\n\n    const focusSearch = (key?: string) => {\n        const searchLength = filters.search?.length ?? 0;\n        if (searchLength > 1) {\n            onSongFiltered({\n                ...filters,\n                search: ' ',\n            });\n        } else if (searchLength === 0 && key) {\n            onSongFiltered({\n                ...filters,\n                search: key,\n            });\n        }\n\n        searchInput.current?.focus();\n    };\n\n    useHotkeys(\n        REGULAR_ALPHA_CHARS,\n        (e) => {\n            focusSearch(e.key);\n        },\n        { enabled: !isFocused },\n    );\n\n    useHotkeys(\n        'Backspace',\n        (e) => {\n            focusSearch();\n        },\n        { enabled: !isFocused },\n    );\n    const setSearch = (value: string) => {\n        onSongFiltered({\n            ...filters,\n            search: value.trim(),\n        });\n    };\n\n    useEffect(() => {\n        searchInput.current?.focus();\n    }, [searchInput]);\n\n    return (\n        <Container data-test=\"song-list-search\">\n            <FilterItem large>\n                <form\n                    data-test=\"filters-search-form\"\n                    onSubmit={(e) => {\n                        e.preventDefault();\n                        searchInput.current?.blur();\n                    }}>\n                    <Input\n                        onFocus={() => setIsFocused(true)}\n                        onBlur={() => setIsFocused(false)}\n                        focused={isFocused}\n                        label=\"Search\"\n                        value={filters.search ?? ''}\n                        onChange={setSearch}\n                        ref={searchInput}\n                        data-test=\"filters-search\"\n                    />\n                </form>\n            </FilterItem>\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    background: rgba(0, 0, 0, 0.7);\n    padding: 2rem;\n    font-size: 3rem;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: row;\n    gap: 2rem;\n    position: fixed;\n    z-index: 200;\n    top: 4.5rem;\n    left: 30rem;\n    right: 30rem;\n`;\n\nconst FilterItem = styled.div<{ large?: boolean }>`\n    flex: ${(props) => (props.large ? 1.5 : 1)};\n`;\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport { useEffect, useState } from 'react';\nimport { MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\n\ninterface Props {\n    keyboardControl: boolean;\n}\n\nconst SHOW_TIP_TIMEOUT_MS = 10_000;\n\nexport default function SelectRandomTip({ keyboardControl }: Props) {\n    const [isVisible, setIsVisible] = useState(false);\n    useEffect(() => {\n        if (!keyboardControl) {\n            setIsVisible(false);\n        } else {\n            const timeout = setTimeout(() => setIsVisible(true), SHOW_TIP_TIMEOUT_MS);\n\n            return () => clearTimeout(timeout);\n        }\n    }, [keyboardControl]);\n\n    const [mobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n\n    if (mobilePhoneMode) {\n        return null;\n    }\n\n    return (\n        <Container visible={isVisible}>\n            Can't decide? Click <Kbd>Shift</Kbd> + <Kbd>R</Kbd> to pick random song\n        </Container>\n    );\n}\n\nconst Container = styled.div<{ visible: boolean }>`\n    @keyframes shake {\n        2.5%,\n        22.5% {\n            transform: translate3d(-0.1rem, 0, 0);\n        }\n\n        5%,\n        20% {\n            transform: translate3d(0.2rem, 0, 0);\n        }\n\n        7.5%,\n        12.5%,\n        17.5% {\n            transform: translate3d(-0.4rem, 0, 0);\n        }\n\n        10%,\n        15% {\n            transform: translate3d(0.4rem, 0, 0);\n        }\n    }\n    animation: shake 5s both infinite;\n    ${typography};\n    pointer-events: none;\n    position: fixed;\n    transform: scale(${(props) => (props.visible ? 1 : 0)});\n    opacity: ${(props) => (props.visible ? 1 : 0)};\n    text-align: center;\n    font-size: 4.8rem;\n    text-shadow: 0 0 3.5rem black, 0 0 3.5rem black, 0 0 3.5rem black, 0 0 3.5rem black, 0 0 3.5rem black,\n        0 0 3.5rem black, 0 0 3.5rem black;\n    width: 100%;\n    z-index: 4;\n    padding: 2.5rem;\n    transition: ease 500ms;\n`;\n\nconst Kbd = styled.kbd<{ disabled?: boolean }>`\n    margin: 0.1rem;\n    padding: 0.2rem 2rem;\n    border-radius: 1.5rem;\n    border: 0.6rem solid rgb(204, 204, 204);\n    border-bottom-color: rgb(150, 150, 150);\n    border-right-color: rgb(150, 150, 150);\n    line-height: 1.4;\n    display: inline-block;\n    background-color: rgb(247, 247, 247);\n    text-shadow: 0 0.5rem 0 #fff;\n\n    opacity: ${(props) => (props.disabled ? 0.25 : 1)};\n`;\n","import events from 'GameEvents/GameEvents';\nimport { useEventEffect } from 'GameEvents/hooks';\nimport { SongStats, fetchSongStats, getSongKey, storeSongStats } from 'Songs/stats/common';\nimport { SongPreview } from 'interfaces';\nimport { useEffect, useState } from 'react';\n\nexport const useSongStats = (song: Pick<SongPreview, 'artist' | 'title'>) => {\n    const [stats, setStats] = useState<SongStats | null>(null);\n\n    const storageKey = getSongKey(song);\n\n    const setSongStats = async () => {\n        setStats(await fetchSongStats(song));\n    };\n\n    useEffect(() => {\n        setSongStats();\n    }, [storageKey]);\n\n    useEventEffect(events.songStatStored, setSongStats);\n\n    return stats;\n};\n\nexport const useEditScore = (song: Pick<SongPreview, 'artist' | 'title'>) => {\n    return async (singId: string, score: number, oldName: string, newName: string) => {\n        const storageKey = getSongKey(song);\n        const data = await fetchSongStats(song);\n\n        const newScores = data.scores.map((record) => {\n            if (record.setup.id !== singId) return record;\n\n            const newScores = record.scores.map((previousScore) => {\n                if (previousScore.name !== oldName || previousScore.score !== score) return previousScore;\n\n                return { name: newName.trim(), score };\n            });\n\n            return { ...record, scores: newScores };\n        });\n\n        const newData = { ...data, scores: newScores };\n\n        await storeSongStats(song, newData);\n        events.songScoreUpdated.dispatch(storageKey, newData, newName.trim());\n    };\n};\n","import { css } from '@emotion/react';\nimport styled from '@emotion/styled';\nimport PeopleAltIcon from '@mui/icons-material/PeopleAlt';\nimport { typography } from 'Elements/cssMixins';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { useSongStats } from 'Songs/stats/hooks';\nimport { addDays, isAfter } from 'date-fns';\nimport { SongPreview } from 'interfaces';\nimport { ComponentProps, ReactNode, useCallback } from 'react';\n\ninterface Props extends ComponentProps<typeof SongCardContainer> {\n    song: SongPreview;\n    focused: boolean;\n    index?: number;\n    expanded?: boolean;\n    background?: boolean;\n    handleClick?: (index: number) => void;\n    video?: ReactNode;\n}\nexport const FinalSongCard = ({\n    song,\n    focused,\n    video,\n    children,\n    index,\n    handleClick,\n    background = true,\n    expanded = false,\n    ...restProps\n}: Props) => {\n    const onClickCallback = useCallback(() => (handleClick ? handleClick(index!) : undefined), [handleClick, index]);\n\n    return (\n        <SongCardContainer {...restProps} onClick={handleClick ? onClickCallback : undefined}>\n            {background && (\n                <SongCardBackground\n                    style={{\n                        backgroundImage: `url('https://i3.ytimg.com/vi/${song.video}/hqdefault.jpg')`,\n                    }}\n                    focused={focused}\n                    expanded={expanded}\n                />\n            )}\n            <SongInfo expanded={expanded}>\n                {!expanded && <SongCardStatsIndicator song={song} />}\n                {song.tracksCount > 1 && !expanded && (\n                    <MultiTrackIndicator data-test=\"multitrack-indicator\">\n                        <PeopleAltIcon />\n                        &nbsp; Duet\n                    </MultiTrackIndicator>\n                )}\n                <SongListEntryDetailsArtist expanded={expanded}>{song.artist}</SongListEntryDetailsArtist>\n                <SongListEntryDetailsTitle expanded={expanded}>{song.title}</SongListEntryDetailsTitle>\n                {expanded && (\n                    <>\n                        {song.author && (\n                            <SongAuthor expanded={expanded}>\n                                by&nbsp;\n                                {song.authorUrl ? (\n                                    <a href={song.authorUrl} target=\"_blank\" rel=\"noreferrer\">\n                                        {song.author}\n                                    </a>\n                                ) : (\n                                    song.author\n                                )}\n                            </SongAuthor>\n                        )}\n                        <SongListEntryStats song={song} />\n                    </>\n                )}\n            </SongInfo>\n            {children}\n            {video}\n        </SongCardContainer>\n    );\n};\n\nconst SongInfo = styled.div<{ expanded: boolean }>`\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    z-index: 1;\n    box-sizing: border-box;\n\n    flex-direction: column;\n\n    ${(props) =>\n        props.expanded &&\n        css`\n            align-items: flex-start;\n            justify-content: flex-start;\n        `}\n`;\n\nexport const SongCardContainer = styled.div`\n    font-size: 4.5rem;\n\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    flex-direction: column;\n    box-sizing: border-box;\n    position: relative;\n    padding: 1.3rem;\n\n    border: 0.1rem black solid;\n    border-radius: 0.5rem;\n`;\n\nexport const SongCardBackground = styled.div<{ focused: boolean; expanded: boolean }>`\n    position: absolute;\n    z-index: -1;\n    inset: 0;\n    ${(props) =>\n        props.theme.graphicSetting === 'high'\n            ? css`\n                  background-size: ${props.focused ? 100 : 110}%;\n                  ${!props.focused ? 'filter: grayscale(90%);' : ''}\n                  ${props.expanded ? 'filter: blur(10px);' : ''}\n                  transition: 300ms;\n                  opacity: ${props.focused ? 1 : 0.8};\n              `\n            : css`\n                  background-size: 100%;\n                  opacity: ${props.focused ? 1 : 0.6};\n              `}\n    background-position: center center;\n`;\n\nexport const SongListEntryDetails = styled.span<{ expanded?: boolean }>`\n    background: rgba(0, 0, 0, 0.7);\n\n    width: auto;\n    display: inline-block;\n    padding: 0.5rem;\n    ${typography};\n\n    text-align: right;\n    font-size: ${({ expanded }) => (expanded ? '6rem' : '2.7rem')};\n`;\n\nexport const SongListEntryDetailsArtist = styled(SongListEntryDetails)`\n    color: ${styles.colors.text.active};\n`;\n\nexport const SongListEntryDetailsTitle = styled(SongListEntryDetails)`\n    margin-top: ${(props) => (props.expanded ? '1.5rem' : '0.5rem')};\n    color: white;\n`;\n\nconst SongAuthor = styled(SongListEntryDetailsTitle)`\n    font-size: 3rem;\n    margin-top: 3rem;\n`;\n\nexport const SongCardStatsIndicator = ({ song }: { song: SongPreview }) => {\n    const stats = useSongStats(song);\n    const lastPlayed = stats?.scores?.at(-1)?.date ?? false;\n\n    const playedToday = lastPlayed && isAfter(new Date(lastPlayed), addDays(new Date(), -1));\n\n    return stats?.plays ? (\n        <SongStatIndicator data-test=\"song-stat-indicator\">\n            {playedToday ? 'Played today' : stats.plays}\n        </SongStatIndicator>\n    ) : null;\n};\n\nconst SongStatIndicator = styled.div`\n    position: absolute;\n    top: 0.5rem;\n    right: 0.5rem;\n    padding: 0 1rem;\n    height: 2.75rem;\n    min-width: 2.75rem;\n    box-sizing: border-box;\n    border-radius: 5rem;\n    color: white;\n    background: rgba(0, 0, 0, 0.75);\n    font-size: 1.4rem;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    text-transform: uppercase;\n`;\nconst MultiTrackIndicator = styled(SongStatIndicator)`\n    left: 0.5rem;\n    right: auto;\n\n    svg {\n        width: 1.75rem;\n        height: 1.75rem;\n    }\n`;\n\nexport const SongListEntryStats = ({ song }: { song: SongPreview }) => {\n    const stats = useSongStats(song);\n\n    return (\n        <SongAuthor>\n            {stats?.plays ? `Played ${stats.plays} time${stats.plays > 1 ? 's' : ''}` : 'Never played yet'}\n        </SongAuthor>\n    );\n};\n","import styled from '@emotion/styled';\nimport SwapHorizIcon from '@mui/icons-material/SwapHoriz';\nimport { Button } from 'Elements/Button';\nimport { nextIndex, nextValue, Switcher } from 'Elements/Switcher';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { GAME_MODE, SingSetup, SongPreview } from 'interfaces';\nimport createPersistedState from 'use-persisted-state';\nimport { ValuesType } from 'utility-types';\nimport isDev from 'utils/isDev';\nimport { v4 } from 'uuid';\n\ninterface Props {\n    songPreview: SongPreview;\n    onNextStep: (setup: SingSetup) => void;\n    keyboardControl: boolean;\n    onExitKeyboardControl: () => void;\n}\n\nconst gameModeNames = {\n    [GAME_MODE.DUEL]: 'Duel',\n    [GAME_MODE.PASS_THE_MIC]: 'Pass The Mic',\n    [GAME_MODE.CO_OP]: 'Cooperation',\n};\n\nconst difficultyNames = ['Hard', 'Medium', 'Easy'];\n\nif (isDev()) {\n    difficultyNames.push('Debug 4');\n    difficultyNames.push('Debug 5');\n    difficultyNames.push('Debug 6');\n}\n\n// added -v3 to the key as the value to handle default selection if it wasnt changed\nconst useSetGameMode = createPersistedState<ValuesType<typeof GAME_MODE> | null>('song_settings-game_mode-v3');\nconst useSetTolerance = createPersistedState<number>('song_settings-tolerance-v2');\n\nexport default function GameSettings({ songPreview, onNextStep, keyboardControl, onExitKeyboardControl }: Props) {\n    const [rememberedMode, setMode] = useSetGameMode(null);\n    const mode = rememberedMode ?? (songPreview.tracksCount > 1 ? GAME_MODE.CO_OP : GAME_MODE.DUEL);\n    const [tolerance, setTolerance] = useSetTolerance(1);\n\n    const handleNextButton = () => {\n        const singSetup = {\n            id: v4(),\n            players: [],\n            mode,\n            tolerance: tolerance + 1,\n        };\n        onNextStep(singSetup);\n    };\n\n    const changeMode = () => {\n        setMode(nextValue(Object.values(GAME_MODE), mode));\n    };\n\n    const changeTolerance = () => setTolerance((current) => nextIndex(difficultyNames, current, -1));\n\n    const { register } = useKeyboardNav({ enabled: keyboardControl, onBackspace: onExitKeyboardControl });\n\n    return (\n        <>\n            <GSSwitcher\n                {...register('difficulty-setting', changeTolerance, 'Change difficulty')}\n                label=\"Difficulty\"\n                value={difficultyNames[tolerance]}\n                data-test-value={difficultyNames[tolerance]}\n            />\n            <GSSwitcher\n                {...register('game-mode-setting', changeMode, 'Change mode')}\n                label=\"Mode\"\n                value={gameModeNames[mode]}\n                data-test-value={gameModeNames[mode]}\n            />\n            <ModeDescription>\n                {mode === GAME_MODE.DUEL && 'Face off against each other - person that earns more points wins.'}\n                {mode === GAME_MODE.CO_OP &&\n                    'Join forces and sing together - your points will be added up to a single pool.'}\n                {mode === GAME_MODE.PASS_THE_MIC && (\n                    <>\n                        For more than 2 players - split into groups and pass the microphone within the group when\n                        prompted with <SwapHorizIcon /> symbol.\n                    </>\n                )}\n            </ModeDescription>\n            <PlayButton {...register('next-step-button', handleNextButton, undefined, true)}>Next </PlayButton>\n        </>\n    );\n}\n\nconst PlayButton = styled(Button)`\n    padding: 0.5rem 9rem;\n    font-size: 4.3rem;\n    width: 50rem;\n`;\n\nconst ModeDescription = styled.h3`\n    max-width: 50rem;\n    margin: -1rem 0 1rem !important;\n    padding: 1.5rem;\n    background: rgba(0, 0, 0, 0.7);\n    box-sizing: border-box;\n`;\n\nconst GSSwitcher = styled(Switcher)`\n    font-size: 4.3rem;\n    padding: 1rem;\n    min-width: 50rem;\n    box-sizing: border-box;\n`;\n","import styled from '@emotion/styled';\nimport { Warning } from '@mui/icons-material';\nimport events from 'GameEvents/GameEvents';\nimport { useEventListenerSelector } from 'GameEvents/hooks';\nimport PlayersManager from 'Players/PlayersManager';\nimport usePlayerMic from 'hooks/players/usePlayerMic';\nimport { useCallback, useEffect, useRef, useState } from 'react';\n\nexport default function NoiseDetection() {\n    const inputs = useEventListenerSelector(events.playerInputChanged, () => PlayersManager.getInputs());\n    const isBuiltIn = inputs.some((input) => input.source === 'Microphone');\n\n    const measures = useRef<Array<[number, number]>>([]);\n    const handleMeasure = useCallback((data: [number, number]) => {\n        measures.current.push(data);\n    }, []);\n\n    usePlayerMic(0, 50, handleMeasure);\n\n    const [noiseDetected, setNoiseDetected] = useState(false);\n    useEffect(() => {\n        const interval = setInterval(\n            () => {\n                const noDetection = measures.current.filter(([, freq]) => freq === 0);\n                const detection = measures.current.filter(([, freq]) => freq > 0);\n                const avgNoDetectionVolume =\n                    noDetection.reduce((acc, [volume]) => acc + volume, 0) / (noDetection.length + 1);\n                const avgDetectionVolume =\n                    detection.reduce((acc, [volume]) => acc + volume, 0) / (detection.length + 1);\n\n                // The logic is that if the singing measures and non-singing measures have similar volume, then there's\n                // something playing in the background that is picked up as singing. If someone is singing into the mic\n                // the non-singing measures are usually quiet compared to singing measures.\n                const isNoisy =\n                    detection.length > noDetection.length * 0.1 &&\n                    avgDetectionVolume > 0.01 &&\n                    avgNoDetectionVolume > 0.01 &&\n                    avgDetectionVolume - avgNoDetectionVolume < avgNoDetectionVolume / 2;\n\n                setNoiseDetected(isNoisy);\n                measures.current.length = 0;\n            },\n            noiseDetected ? 5000 : 2500,\n        );\n\n        return () => clearInterval(interval);\n    }, [noiseDetected]);\n\n    return (\n        <NoiseWarningContainer visible={noiseDetected}>\n            <h2>\n                <strong>\n                    <Warning />\n                </strong>{' '}\n                Noise detected\n            </h2>\n            <hr />\n            <h4>\n                This might make singing inaccurate. Make sure your microphone doesn't pick up the music.{' '}\n                {isBuiltIn && (\n                    <>\n                        Alternatively, use your <strong>smartphone as a microphone</strong> instead.\n                    </>\n                )}\n            </h4>\n        </NoiseWarningContainer>\n    );\n}\n\nconst NoiseWarningContainer = styled.div<{ visible: boolean }>`\n    opacity: ${(props) => (props.visible ? 1 : 0)};\n    transition: 300ms;\n    background: rgba(0, 0, 0, 0.75);\n    padding: 1rem;\n    max-width: 50rem;\n    position: relative;\n    top: -1rem;\n    left: -0.5rem;\n`;\n","import styled from '@emotion/styled';\nimport { PlayerMicCheck } from 'Elements/VolumeIndicator';\nimport { PlayerEntity } from 'Players/PlayersManager';\nimport Ping from 'Scenes/SingASong/SongSelection/SongSettings/MicCheck/Ping';\nimport PlayerStatus from 'Scenes/SingASong/SongSelection/SongSettings/MicCheck/Status';\nimport usePlayerMicStatus from 'hooks/players/usePlayerMicStatus';\n\ninterface Props {\n    player: PlayerEntity;\n}\nexport default function SinglePlayer({ player }: Props) {\n    const status = usePlayerMicStatus(player.number);\n\n    return (\n        <Indicator key={player.number} data-test={`indicator-player-${player.number}`}>\n            <Ping playerNumber={player.number} />\n            <PlayerStatus status={status} />\n            {status !== 'unavailable' && <PlayerMicCheck playerNumber={player.number} />}\n            <PlayerName className=\"ph-no-capture\">{player.getName()}</PlayerName>\n        </Indicator>\n    );\n}\n\nconst Indicator = styled.div`\n    position: relative;\n    border: 0.1rem solid white;\n    padding: 1rem 3rem;\n    background: black;\n    width: 80%;\n\n    text-align: center;\n    gap: 1.25rem;\n    font-size: 2.3rem;\n    color: white;\n\n    -webkit-text-stroke: 1px black;\n`;\n\nconst PlayerName = styled.span`\n    position: relative;\n    z-index: 1;\n`;\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport events from 'GameEvents/GameEvents';\nimport { useEventListener, useEventListenerSelector } from 'GameEvents/hooks';\nimport PlayersManager from 'Players/PlayersManager';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport NoiseDetection from 'Scenes/SingASong/SongSelection/SongSettings/MicCheck/NoiseDetection';\nimport SinglePlayer from 'Scenes/SingASong/SongSelection/SongSettings/MicCheck/SinglePlayer';\nimport { useEffect } from 'react';\n\nexport default function MicCheck() {\n    // Force update when the name changes\n    useEventListener(events.playerNameChanged);\n\n    useEffect(() => {\n        InputManager.startMonitoring();\n    }, []);\n\n    const inputs = useEventListenerSelector(events.playerInputChanged, () => PlayersManager.getInputs());\n    const isSetup = inputs.some((input) => input.source !== 'Dummy');\n\n    return (\n        <Container>\n            <MicChecksContainer>\n                Microphone Check\n                {isSetup ? (\n                    PlayersManager.getPlayers().map((player) => <SinglePlayer key={player.number} player={player} />)\n                ) : (\n                    <>\n                        <Indicator>Mic not setup</Indicator>\n                        <h4>Singing will be emulated</h4>\n                        <h5>You can setup in the Next step</h5>\n                    </>\n                )}\n            </MicChecksContainer>\n            <NoiseDetection />\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    display: flex;\n    font-size: 3rem;\n    ${typography};\n    margin-bottom: 8.6rem;\n    gap: 3.5rem;\n`;\n\nconst MicChecksContainer = styled.div`\n    gap: 1.25rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n`;\n\nconst Indicator = styled.div`\n    position: relative;\n    border: 0.1rem solid white;\n    padding: 1rem 3rem;\n    background: black;\n    width: 80%;\n\n    text-align: center;\n    gap: 1.25rem;\n    font-size: 2.3rem;\n    color: white;\n`;\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport { Input } from 'Elements/Input';\nimport { nextIndex } from 'Elements/Switcher';\nimport {\n    ComponentProps,\n    ForwardedRef,\n    forwardRef,\n    KeyboardEventHandler,\n    ReactNode,\n    useImperativeHandle,\n    useMemo,\n    useRef,\n    useState,\n} from 'react';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\n\ninterface Props extends ComponentProps<typeof Input> {\n    label: ReactNode;\n    value: string;\n    onChange: (value: string) => void;\n    disabled?: boolean;\n    options: string[];\n    placeholder?: string;\n    keyboardNavigationChangeFocus?: (direction: -1 | 1) => void;\n    onBlur?: () => void;\n    className?: string;\n}\n\nexport const Autocomplete = forwardRef(\n    (\n        {\n            options,\n            focused,\n            label,\n            value,\n            onChange,\n            disabled,\n            placeholder,\n            keyboardNavigationChangeFocus,\n            onBlur,\n            className,\n            ...restProps\n        }: Props,\n        forwardedRef: ForwardedRef<HTMLInputElement | null>,\n    ) => {\n        const inputRef = useRef<HTMLInputElement>(null);\n        useImperativeHandle(forwardedRef, () => inputRef.current!);\n\n        const autocompleteMenu = useRef<HTMLDivElement>(null);\n\n        const [isInputFocused, setIsInputFocused] = useState(false);\n        const [focusedOption, setFocusedOption] = useState(-1);\n\n        const filteredOptions = useMemo(\n            () =>\n                options.filter(\n                    (option) => option.toLowerCase().trim().includes(value.toLowerCase().trim()) && option !== value,\n                ),\n            [options, value],\n        );\n\n        const handleKeyDown: KeyboardEventHandler<HTMLInputElement> = (e) => {\n            if (e.code === 'ArrowUp' || e.code === 'ArrowDown') {\n                if (filteredOptions.length) {\n                    e.preventDefault();\n                    const newIndex = nextIndex(filteredOptions, focusedOption, e.code === 'ArrowUp' ? -1 : 1);\n                    setFocusedOption(newIndex);\n\n                    const option = autocompleteMenu.current?.querySelector(\n                        `[data-index=\"${newIndex}\"]`,\n                    ) as HTMLDivElement;\n\n                    option?.scrollIntoView({ behavior: 'smooth', block: 'center' });\n                } else {\n                    inputRef.current?.blur();\n                    keyboardNavigationChangeFocus?.(e.code === 'ArrowUp' ? -1 : 1);\n                }\n            } else if (e.code === 'Enter') {\n                const option = filteredOptions[focusedOption];\n                if (option) {\n                    setFocusedOption(-1);\n                    onChange(option);\n                } else {\n                    inputRef.current?.blur();\n                }\n            }\n        };\n\n        const handleBlur = () => {\n            setTimeout(() => {\n                setIsInputFocused(false);\n                onBlur?.();\n            }, 300);\n        };\n\n        return (\n            <Container className={className}>\n                <Input\n                    onFocus={() => setIsInputFocused(true)}\n                    onBlur={handleBlur}\n                    onKeyDown={handleKeyDown}\n                    onChange={onChange}\n                    value={value}\n                    focused={focused}\n                    label={label}\n                    disabled={disabled}\n                    ref={inputRef}\n                    placeholder={placeholder}\n                    {...restProps}\n                />\n                {isInputFocused && !!filteredOptions.length && (\n                    <AutocompleteMenu ref={autocompleteMenu} role=\"listbox\">\n                        {filteredOptions.map((option, index) => (\n                            <AutocompleteMenuitem\n                                role=\"listitem\"\n                                data-index={index}\n                                data-focused={index === focusedOption}\n                                key={option}\n                                focused={index === focusedOption}\n                                onClick={() => {\n                                    onChange(option);\n                                    setFocusedOption(-1);\n                                    inputRef.current?.blur();\n                                }}>\n                                {option}\n                            </AutocompleteMenuitem>\n                        ))}\n                    </AutocompleteMenu>\n                )}\n            </Container>\n        );\n    },\n);\n\nconst Container = styled.div`\n    position: relative;\n`;\n\nconst AutocompleteMenu = styled.div`\n    margin-top: 0.1em;\n    position: absolute;\n    width: 100%;\n    background: black;\n    max-height: ${(1 + 2 * 0.3) * 4}em;\n    overflow-y: auto;\n    z-index: 2;\n`;\n\nconst AutocompleteMenuitem = styled.div<{ focused: boolean }>`\n    ${typography};\n    padding: 0.3em;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    color: ${(props) => (props.focused ? styles.colors.text.active : 'white')};\n    cursor: pointer;\n`;\n\ninterface TestWrapperProps {\n    label: string;\n    options: string[];\n    focused: boolean;\n}\n\nexport const AutocompleteTestWrapper = ({ label, options, focused }: TestWrapperProps) => {\n    const [value, setValue] = useState('');\n    return <Autocomplete value={value} onChange={setValue} label={label} options={options} focused={focused} />;\n};\n","import styled from '@emotion/styled';\nimport { Autocomplete } from 'Elements/Autocomplete';\nimport { Switcher } from 'Elements/Switcher';\nimport events from 'GameEvents/GameEvents';\nimport { useEventListener } from 'GameEvents/hooks';\nimport { PlayerEntity } from 'Players/PlayersManager';\nimport { MAX_NAME_LENGTH } from 'consts';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { PlayerSetup, SongPreview } from 'interfaces';\nimport { useRef, useState } from 'react';\n\ninterface Props {\n    multipleTracks: boolean;\n    player: PlayerEntity;\n    songPreview: SongPreview;\n    onChange: (setup: PlayerSetup) => void;\n    setup: PlayerSetup;\n    playerNames: string[];\n    register: ReturnType<typeof useKeyboardNav>['register'];\n}\n\nconst getTrackName = (tracks: SongPreview['tracks'], index: number) => tracks[index]?.name ?? `Track ${index + 1}`;\n\nexport default function SinglePlayer({\n    multipleTracks,\n    player,\n    songPreview,\n    playerNames,\n    register,\n    onChange,\n    setup,\n}: Props) {\n    const [inputTouched, setInputTouched] = useState(false);\n    const nameRef = useRef<HTMLInputElement | null>(null);\n    // Force update when the name changes\n    useEventListener(events.playerNameChanged);\n\n    const togglePlayerTrack = () =>\n        onChange({ number: player.number, track: (setup.track + 1) % songPreview.tracksCount });\n\n    const onNameChange = (newName: string) => {\n        setInputTouched(true);\n        player.setName(newName);\n    };\n\n    const isDefaultName = !inputTouched;\n    const currentName = player.getName();\n\n    return (\n        <>\n            <PlayerName\n                maxLength={MAX_NAME_LENGTH}\n                className=\"ph-no-capture\"\n                value={isDefaultName ? '' : currentName}\n                placeholder={isDefaultName ? currentName : undefined}\n                options={playerNames}\n                onChange={onNameChange}\n                label=\"Name:\"\n                ref={nameRef}\n                {...register(`player-${player.number}-name`, () => nameRef.current?.focus())}\n            />\n            {multipleTracks && (\n                <Track\n                    {...register(`player-${player.number}-track-setting`, togglePlayerTrack, 'Change track')}\n                    label=\"Track\"\n                    value={getTrackName(songPreview.tracks, setup.track)}\n                    data-test-value={setup.track + 1}\n                />\n            )}\n        </>\n    );\n}\n\nconst PlayerName = styled(Autocomplete)`\n    input {\n        font-size: 4.5rem;\n    }\n\n    [role='listbox'] {\n        max-height: ${6 * (4.5 + 0.3)}rem;\n    }\n`;\nconst Track = styled(Switcher)`\n    font-size: 4.5rem;\n    padding: 1.1rem;\n`;\n","import styled from '@emotion/styled';\nimport { Button } from 'Elements/Button';\nimport { typography } from 'Elements/cssMixins';\nimport PlayersManager from 'Players/PlayersManager';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport SelectInputModal from 'Scenes/SelectInput/SelectInputModal';\nimport { MicSetupPreferenceSetting, MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport SinglePlayer from 'Scenes/SingASong/SongSelection/SongSettings/PlayerSettings/SinglePlayer';\nimport { PLAYER_NAMES_SESSION_STORAGE_KEY } from 'hooks/players/consts';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { PlayerSetup, SongPreview } from 'interfaces';\nimport { useEffect, useMemo, useState } from 'react';\n\ninterface Props {\n    songPreview: SongPreview;\n    onNextStep: (players: PlayerSetup[]) => void;\n    keyboardControl: boolean;\n    onExitKeyboardControl: () => void;\n}\n\nexport default function PlayerSettings({ songPreview, onNextStep, keyboardControl, onExitKeyboardControl }: Props) {\n    const players = PlayersManager.getPlayers();\n    const [storedPreference] = useSettingValue(MicSetupPreferenceSetting);\n\n    const playerNames = useMemo<string[]>(\n        () => JSON.parse(sessionStorage.getItem(PLAYER_NAMES_SESSION_STORAGE_KEY)!) ?? [],\n        [],\n    );\n\n    const [mobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n    const multipleTracks = !mobilePhoneMode && players.length === 2 && songPreview.tracksCount > 1;\n    const [playerSetup, setPlayerSetup] = useState<PlayerSetup[]>(\n        players.map((player, index) => ({\n            number: player.number,\n            track: multipleTracks ? Math.min(index, songPreview.tracksCount - 1) : 0,\n        })),\n    );\n\n    const updatePlayer = (playerNumber: number) => (newSetup: PlayerSetup) => {\n        setPlayerSetup((current) => current.map((setup) => (setup.number === playerNumber ? newSetup : setup)));\n    };\n\n    const [showModal, setShowModal] = useState(false);\n\n    useEffect(() => {\n        if (!showModal) {\n            InputManager.startMonitoring();\n        }\n    }, [showModal]);\n\n    const { register, focusElement } = useKeyboardNav({\n        enabled: keyboardControl && !showModal,\n        onBackspace: onExitKeyboardControl,\n    });\n\n    const startSong = () => {\n        onNextStep(playerSetup);\n    };\n\n    const areInputsConfigured = !!storedPreference && storedPreference !== 'skip';\n\n    return (\n        <>\n            {showModal && (\n                <SelectInputModal\n                    closeButtonText={areInputsConfigured ? 'Continue to the song' : 'Continue to player setup'}\n                    onClose={() => {\n                        setShowModal(false);\n\n                        if (areInputsConfigured) {\n                            focusElement('play');\n                        }\n                    }}\n                />\n            )}\n            {playerSetup.map((setup, index) => (\n                <PlayerSettingContainer key={setup.number}>\n                    <PlayerSettingTitle>Player {index + 1}</PlayerSettingTitle>\n                    <div>\n                        <SinglePlayer\n                            multipleTracks={multipleTracks}\n                            player={PlayersManager.getPlayer(setup.number)}\n                            setup={setup}\n                            onChange={updatePlayer(setup.number)}\n                            playerNames={playerNames}\n                            register={register}\n                            songPreview={songPreview}\n                        />\n                    </div>\n                </PlayerSettingContainer>\n            ))}\n            {areInputsConfigured && (\n                <PlayButton {...register('play-song-button', startSong, undefined, true)}>Play</PlayButton>\n            )}\n            <PlayButton {...register('select-inputs-button', () => setShowModal(true), undefined, false)}>\n                Setup mics\n            </PlayButton>\n        </>\n    );\n}\n\nconst PlayerSettingContainer = styled.div`\n    display: flex;\n    flex-direction: row;\n`;\n\nconst PlayButton = styled(Button)<{ focused: boolean }>`\n    padding: 0.5rem 9rem;\n    font-size: 4.3rem;\n`;\n\nconst PlayerSettingTitle = styled.span`\n    ${typography};\n    padding: 1.3rem;\n    font-size: 4.5rem;\n`;\n","import styled from '@emotion/styled';\nimport events from 'GameEvents/GameEvents';\nimport GameSettings from 'Scenes/SingASong/SongSelection/SongSettings/GameSettings';\nimport MicCheck from 'Scenes/SingASong/SongSelection/SongSettings/MicCheck';\nimport PlayerSettings from 'Scenes/SingASong/SongSelection/SongSettings/PlayerSettings';\nimport { PlayerSetup, SingSetup, SongPreview } from 'interfaces';\nimport { useState } from 'react';\n\ninterface Props {\n    songPreview: SongPreview;\n    onPlay: (setup: SingSetup & { file: string; video: string }) => void;\n    keyboardControl: boolean;\n    onExitKeyboardControl: () => void;\n}\n\nexport default function SongSettings({ songPreview, onPlay, keyboardControl, onExitKeyboardControl }: Props) {\n    const [singSetup, setSingSetup] = useState<SingSetup | null>(null);\n    const [step, setStep] = useState<'song' | 'players'>('song');\n\n    const onSongStepFinish = (setup: SingSetup) => {\n        setSingSetup(setup);\n        setStep('players');\n    };\n    const startSong = (players: PlayerSetup[]) => {\n        if (!singSetup) return;\n        const finalSetup = {\n            ...singSetup,\n            players: players,\n        };\n        events.songStarted.dispatch(songPreview, finalSetup);\n        onPlay({ file: songPreview.file, video: songPreview.video, ...finalSetup });\n    };\n    return (\n        <Container>\n            <MicCheck />\n            <GameConfiguration>\n                {step === 'song' && (\n                    <GameSettings\n                        songPreview={songPreview}\n                        onNextStep={onSongStepFinish}\n                        keyboardControl={keyboardControl}\n                        onExitKeyboardControl={onExitKeyboardControl}\n                    />\n                )}\n                {step === 'players' && (\n                    <PlayerSettings\n                        songPreview={songPreview}\n                        onNextStep={startSong}\n                        keyboardControl={keyboardControl}\n                        onExitKeyboardControl={() => setStep('song')}\n                    />\n                )}\n            </GameConfiguration>\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    display: flex;\n    flex-direction: row;\n    align-items: flex-end;\n    justify-content: space-between;\n    width: 100%;\n\n    hr {\n        margin: 1rem;\n        opacity: 0.25;\n    }\n`;\n\nconst GameConfiguration = styled.div`\n    width: auto;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    gap: 1.25rem;\n`;\n","import { throttle } from 'lodash-es';\nimport { useCallback, useEffect, useState } from 'react';\n\nexport default function useViewportSize() {\n    // Learn more here: https://joshwcomeau.com/react/the-perils-of-rehydration/\n    const [windowSize, setWindowSize] = useState<{\n        width: number | undefined;\n        height: number | undefined;\n    }>({\n        width: undefined,\n        height: undefined,\n    });\n\n    const handleResize = useCallback(\n        throttle(() => {\n            setWindowSize({\n                width: window.document.body.clientWidth,\n                height: window.visualViewport!.height,\n            });\n        }, 1000),\n        [],\n    );\n\n    useEffect(() => {\n        window.addEventListener('resize', handleResize);\n        handleResize();\n\n        return () => window.removeEventListener('resize', handleResize);\n    }, []);\n\n    return { ...windowSize, handleResize };\n}\n","import { css } from '@emotion/react';\nimport styled from '@emotion/styled';\nimport { useTheme } from '@mui/material';\nimport VideoPlayer, { VideoPlayerRef, VideoState } from 'Elements/VideoPlayer';\nimport { FinalSongCard } from 'Scenes/SingASong/SongSelection/SongCard';\nimport SongSettings from 'Scenes/SingASong/SongSelection/SongSettings';\nimport useDebounce from 'hooks/useDebounce';\nimport useViewportSize from 'hooks/useViewportSize';\nimport { SingSetup, SongPreview } from 'interfaces';\nimport { ComponentProps, PropsWithChildren, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'react';\n\ninterface Props {\n    songPreview: SongPreview;\n    onPlay: (setup: SingSetup & { file: string; video: string }) => void;\n    keyboardControl: boolean;\n    onExitKeyboardControl: () => void;\n    top: number;\n    left: number;\n    width: number;\n    height: number;\n    focusEffect: boolean;\n}\n\nconst PREVIEW_LENGTH = 30;\n\nexport default function SongPreviewComponent({\n    songPreview,\n    top,\n    left,\n    width,\n    height,\n    keyboardControl,\n    onExitKeyboardControl,\n    onPlay,\n    focusEffect,\n}: Props) {\n    const [showVideo, setShowVideo] = useState(false);\n    const player = useRef<VideoPlayerRef | null>(null);\n    const { width: windowWidth, height: windowHeight } = useViewportSize();\n\n    const expanded = keyboardControl;\n\n    // need to use layout effect otherwise newly selected song name is displayed briefly before the element is removed\n    useLayoutEffect(() => {\n        setShowVideo(false);\n    }, [songPreview.video]);\n\n    const start = songPreview.previewStart ?? (songPreview.videoGap ?? 0) + 60;\n    const end = songPreview.previewEnd ?? start + PREVIEW_LENGTH;\n    const undebounced = useMemo(\n        () => [songPreview.video, start, end, songPreview.volume] as const,\n        [songPreview.video, start, end, songPreview.volume],\n    );\n    const [videoId, previewStart, previewEnd, volume] = useDebounce(undebounced, 350);\n\n    useEffect(() => {\n        player.current?.loadVideoById({\n            videoId: videoId,\n            startSeconds: previewStart,\n            endSeconds: previewEnd,\n        });\n    }, [videoId, player, previewStart, previewEnd]);\n\n    const finalWidth = expanded ? windowWidth! : width;\n    const finalHeight = expanded ? Math.min((windowWidth! / 20) * 9, windowHeight! * (4 / 5)) : height;\n\n    useEffect(() => {\n        player.current?.setSize(finalWidth, (finalWidth / 16) * 9);\n    }, [finalWidth, keyboardControl]);\n\n    return (\n        <>\n            {expanded && <Backdrop onClick={onExitKeyboardControl} />}\n            {!expanded && showVideo && (\n                <SongBPMIndicator width={finalWidth} height={finalHeight} left={left} top={top} song={songPreview} />\n            )}\n            <SongPreviewContainer\n                background={expanded || showVideo}\n                video={\n                    <Video show={showVideo} expanded={expanded} height={finalHeight}>\n                        <VideoPlayer\n                            width={0}\n                            height={0}\n                            disablekb\n                            ref={player}\n                            video={''}\n                            volume={volume}\n                            onStateChange={(state) => {\n                                if (state === VideoState.ENDED) {\n                                    player.current?.seekTo(start);\n                                    player.current?.playVideo();\n                                } else if (state === VideoState.PLAYING) {\n                                    setShowVideo(true);\n                                }\n                            }}\n                        />\n                    </Video>\n                }\n                focused\n                song={songPreview}\n                top={top}\n                left={left}\n                width={finalWidth}\n                height={finalHeight}\n                showVideo={showVideo}\n                expanded={expanded}\n                data-test=\"song-preview\"\n                data-song={songPreview.file}>\n                {expanded && (\n                    <Content>\n                        <SongSettings\n                            songPreview={songPreview}\n                            onPlay={onPlay}\n                            keyboardControl={keyboardControl}\n                            onExitKeyboardControl={onExitKeyboardControl}\n                        />\n                    </Content>\n                )}\n            </SongPreviewContainer>\n        </>\n    );\n}\n\nconst BaseSongPreviewContainer = styled(FinalSongCard)<{\n    width: number;\n    height: number;\n    expanded: boolean;\n    showVideo: boolean;\n}>`\n    --preview-padding: 5rem;\n    width: ${(props) => props.width}px;\n    height: ${(props) => props.height}px;\n    position: absolute;\n    z-index: ${(props) => (props.expanded ? 201 : 3)};\n    overflow: hidden;\n    visibility: ${(props) => (props.expanded || props.showVideo ? 'visible' : 'hidden')};\n\n    ${(props) =>\n        props.expanded\n            ? css`\n                  border: 0;\n                  border-radius: 0;\n                  position: fixed;\n\n                  padding: var(--preview-padding);\n              `\n            : css`\n                  pointer-events: none;\n                  ${props.showVideo && props.theme.graphicSetting === 'high'\n                      ? 'animation: rhythmPulse 1s infinite'\n                      : 'scale: 1.2'};\n              `};\n\n    @keyframes rhythmPulse {\n        0% {\n            transform: scale(1.2);\n        }\n        15% {\n            transform: scale(1.25);\n        }\n        100% {\n            transform: scale(1.2);\n        }\n    }\n`;\n\ninterface SongPreviewContainerProps\n    extends ComponentProps<typeof BaseSongPreviewContainer>,\n        PropsWithChildren<{\n            top: number;\n            left: number;\n            song: SongPreview;\n        }> {}\n\nconst SongPreviewContainer = (props: SongPreviewContainerProps) => {\n    const realBpm = props.song.realBpm ?? (props.song.bpm > 300 ? props.song.bpm / 4 : props.song.bpm / 2);\n\n    return (\n        <BaseSongPreviewContainer\n            style={{\n                top: props.expanded ? `calc(50vh - ${props.height}px / 2)` : props.top,\n                left: props.expanded ? 0 : props.left,\n                animationDuration: `${60 / realBpm}s`,\n            }}\n            {...props}\n        />\n    );\n};\n\nconst Backdrop = styled.div`\n    position: fixed;\n    top: 0;\n    left: 0;\n    background: rgba(0, 0, 0, 0.8);\n    width: 100vw;\n    height: 100vh;\n    z-index: 201;\n`;\n\nconst Video = styled.div<{ show: boolean; expanded: boolean; height: number }>`\n    position: absolute;\n    top: 0;\n    left: 0;\n    div {\n        opacity: ${({ show }) => (show ? 1 : 0)};\n        transition: ${({ show, expanded }) => (show || expanded ? 1000 : 0)}ms;\n    }\n    ${(props) => !props.expanded && 'background-image: none !important;'}\n    ${(props) => !props.expanded && 'border-radius: 0.5rem;'}\n    ${(props) => props.expanded && `margin-top: calc(-1 * (100vw / 16 * 9) / 2 + ${props.height / 2}px);`}\n`;\n\nconst ContentBase = styled.div`\n    inset: auto var(--preview-padding);\n    position: fixed; /* makes sure Autocomplete dropdown doesn't get clipped */\n    z-index: 100;\n\n    border-radius: 0.5rem;\n`;\n\nconst Content = ContentBase;\n\nconst BaseSongBPMIndicator = styled.div<{ width: number; height: number }>`\n    background: white;\n    width: ${(props) => props.width}px;\n    height: ${(props) => props.height}px;\n    z-index: 2;\n    top: 0;\n    left: 0;\n    position: absolute;\n    animation: bpm 1s infinite;\n    border-radius: 0.5rem;\n    pointer-events: none;\n\n    @keyframes bpm {\n        0% {\n            transform: scale(1.15);\n            opacity: 1;\n        }\n        100% {\n            transform: scale(1.45);\n            opacity: 0;\n        }\n    }\n`;\n\nconst SongBPMIndicator = (\n    props: {\n        top: number;\n        left: number;\n        song: SongPreview;\n    } & ComponentProps<typeof BaseSongBPMIndicator>,\n) => {\n    const theme = useTheme();\n\n    if (theme.graphicSetting === 'low') return null;\n\n    const realBpm = props.song.realBpm ?? (props.song.bpm > 300 ? props.song.bpm / 4 : props.song.bpm / 2);\n    return (\n        <BaseSongBPMIndicator\n            width={props.width}\n            height={props.height}\n            style={{\n                left: props.left,\n                top: props.top,\n                animationDuration: `${60 / realBpm}s`,\n            }}\n        />\n    );\n};\n","import { useEffect } from 'react';\n\nlet mounts = 0;\n\nexport default function useBlockScroll() {\n    useEffect(() => {\n        document.body.classList.add('blockOverflow');\n        document.documentElement.classList.add('blockOverflow');\n        mounts++;\n\n        return () => {\n            mounts--;\n\n            if (mounts === 0) {\n                document.body.classList.remove('blockOverflow');\n                document.documentElement.classList.remove('blockOverflow');\n            }\n        };\n    }, []);\n}\n","import { css } from '@emotion/react';\nimport styled from '@emotion/styled';\nimport { CircularProgress } from '@mui/material';\nimport { useBackground } from 'Elements/LayoutWithBackground';\nimport { focused, typography } from 'Elements/cssMixins';\nimport events from 'GameEvents/GameEvents';\nimport { useEventEffect } from 'GameEvents/hooks';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport useSongSelection from 'Scenes/SingASong/SongSelection/Hooks/useSongSelection';\nimport Playlists from 'Scenes/SingASong/SongSelection/Playlists';\nimport QuickSearch from 'Scenes/SingASong/SongSelection/QuickSearch';\nimport SelectRandomTip from 'Scenes/SingASong/SongSelection/SelectRandomTip';\nimport { FinalSongCard } from 'Scenes/SingASong/SongSelection/SongCard';\nimport SongPreview from 'Scenes/SingASong/SongSelection/SongPreview';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport useBlockScroll from 'hooks/useBlockScroll';\nimport { REGULAR_ALPHA_CHARS } from 'hooks/useKeyboard';\nimport usePrevious from 'hooks/usePrevious';\nimport useViewportSize from 'hooks/useViewportSize';\nimport { KeyHandler } from 'hotkeys-js';\nimport { SingSetup } from 'interfaces';\nimport { memo, useCallback, useEffect, useRef, useState } from 'react';\nimport { useHotkeys } from 'react-hotkeys-hook';\n\ninterface Props {\n    onSongSelected: (songSetup: SingSetup & { file: string; video: string }) => void;\n    preselectedSong: string | null;\n}\n\nconst focusMultiplier = 1.2;\nconst MAX_SONGS_PER_ROW = 4;\n\nexport default function SongSelection({ onSongSelected, preselectedSong }: Props) {\n    const [mobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n    const songsPerRow = mobilePhoneMode ? MAX_SONGS_PER_ROW - 1 : MAX_SONGS_PER_ROW;\n\n    useBackgroundMusic(false);\n    useBackground(true);\n    useBlockScroll();\n\n    const [{ previewTop, previewLeft, previewWidth, previewHeight }, setPositions] = useState({\n        previewTop: 0,\n        previewLeft: 0,\n        previewWidth: 0,\n        previewHeight: 0,\n    });\n    const {\n        focusedGroup,\n        focusedSong,\n        moveToSong,\n        groupedSongList,\n        keyboardControl,\n        songPreview,\n        setKeyboardControl,\n        setFilters,\n        filters,\n        setShowFilters,\n        showFilters,\n        prefilteredList,\n        isLoading,\n    } = useSongSelection(preselectedSong, songsPerRow);\n\n    const onSearchSong: KeyHandler = (e) => {\n        e.stopPropagation();\n        e.preventDefault();\n\n        setFilters({\n            search: e.key,\n        });\n    };\n    useHotkeys(REGULAR_ALPHA_CHARS, onSearchSong, { enabled: !filters.search && keyboardControl });\n\n    const onRemoteSearch = useCallback(\n        (search: string) => {\n            if (keyboardControl) {\n                setFilters({ search });\n            }\n        },\n        [keyboardControl],\n    );\n    useEventEffect(events.remoteSongSearch, onRemoteSearch);\n\n    const list = useRef<HTMLDivElement | null>(null);\n    const { width, handleResize } = useViewportSize();\n    const previouslyFocusedGroup = usePrevious(focusedGroup);\n    const previouslyFocusedSong = usePrevious(focusedSong);\n\n    useEffect(() => {\n        const selector = (group: string, index: number) => `[data-group-letter=\"${group}\"] [data-index=\"${index}\"]`;\n        handleResize(); // Recalculate width/height to account possible scrollbar appearing\n\n        const previousSong = list.current?.querySelector(\n            selector(previouslyFocusedGroup, previouslyFocusedSong),\n        ) as HTMLDivElement;\n        const song = list.current?.querySelector(selector(focusedGroup, focusedSong)) as HTMLDivElement;\n        if (song) {\n            if (!previousSong || previousSong.offsetTop !== song.offsetTop) {\n                song.scrollIntoView?.({\n                    behavior: 'smooth',\n                    inline: 'center',\n                    block: 'center',\n                });\n            }\n            setPositions({\n                previewLeft: song.offsetLeft,\n                previewTop: song.offsetTop,\n                previewWidth: song.offsetWidth,\n                previewHeight: song.offsetHeight,\n            });\n        }\n    }, [width, list, focusedSong, focusedGroup, groupedSongList]);\n\n    const expandSong = useCallback(() => setKeyboardControl(false), [setKeyboardControl]);\n\n    if (!groupedSongList || !width) return <>Loading</>;\n\n    if (isLoading) {\n        return (\n            <LoaderContainer>\n                <CircularProgress size=\"15em\" color=\"secondary\" />\n            </LoaderContainer>\n        );\n    }\n\n    return (\n        <Container songsPerRow={songsPerRow}>\n            {filters.search ? (\n                <QuickSearch showFilters={showFilters} onSongFiltered={setFilters} filters={filters} />\n            ) : (\n                <SelectRandomTip keyboardControl={keyboardControl} />\n            )}\n            <SongListContainer ref={list} active={keyboardControl} data-test=\"song-list-container\" dim={showFilters}>\n                {groupedSongList.length === 0 && <NoSongsFound>No songs found</NoSongsFound>}\n                {songPreview && (\n                    <SongPreview\n                        songPreview={songPreview}\n                        onPlay={onSongSelected}\n                        keyboardControl={!keyboardControl}\n                        onExitKeyboardControl={() => setKeyboardControl(true)}\n                        top={previewTop}\n                        left={previewLeft}\n                        width={previewWidth}\n                        height={previewHeight}\n                        focusEffect={!showFilters}\n                    />\n                )}\n                {groupedSongList.map((group) => (\n                    <SongsGroupContainer\n                        {...(showFilters || !keyboardControl ? { 'data-unfocusable': true } : {})}\n                        key={group.letter}\n                        data-group-letter={group.letter}\n                        highlight={group.letter === 'New'}>\n                        <SongsGroupHeader>{group.letter}</SongsGroupHeader>\n                        <SongsGroup>\n                            {group.songs.map(({ song, index }) => (\n                                <SongListEntry\n                                    key={song.file}\n                                    song={song}\n                                    handleClick={focusedSong === index ? expandSong : moveToSong}\n                                    focused={!showFilters && keyboardControl && index === focusedSong}\n                                    index={index}\n                                    data-index={index}\n                                    data-focused={!showFilters && keyboardControl && index === focusedSong}\n                                    data-test={`song-${song.file}${group.isNew ? '-new-group' : ''}`}\n                                />\n                            ))}\n                        </SongsGroup>\n                    </SongsGroupContainer>\n                ))}\n            </SongListContainer>\n            <Playlists\n                setFilters={setFilters}\n                active={showFilters}\n                closePlaylist={setShowFilters}\n                prefilteredList={prefilteredList}\n            />\n        </Container>\n    );\n}\n\nconst Container = styled.div<{ songsPerRow: number }>`\n    view-transition-name: song-list-container;\n    display: flex;\n    flex-direction: row;\n    max-height: 100vh;\n    --song-list-gap: 3.5rem;\n    --song-item-width: ${(props) =>\n        `calc(${100 / props.songsPerRow}% - ((${props.songsPerRow - 1} / ${\n            props.songsPerRow\n        }) * var(--song-list-gap)))`};\n    --song-item-ratio: calc(16 / 9 * (4 / ${(props) => props.songsPerRow}));\n`;\n\nconst SongsGroupContainer = styled.div<{ highlight: boolean }>`\n    padding: 0 4.5rem 0 11rem;\n    ${(props) =>\n        props.highlight &&\n        css`\n            background: rgba(0, 0, 0, 0.5);\n            padding-bottom: 3rem;\n            border-bottom: 0.2rem solid black;\n\n            ${SongsGroupHeader} {\n                @keyframes new-song-group-header {\n                    0%,\n                    100% {\n                        transform: scale(1);\n                    }\n                    50% {\n                        transform: scale(1.1);\n                    }\n                }\n                animation: new-song-group-header 600ms ease-in-out infinite both;\n                background: #ffffff;\n            }\n        `}\n`;\n\nconst NoSongsFound = styled.div`\n    ${typography};\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex: 1;\n\n    font-size: 10rem;\n`;\n\nconst SongsGroupHeader = styled.div`\n    ${typography};\n    display: inline-block;\n    padding: 0.5rem 1rem;\n    margin-bottom: 2rem;\n    font-size: 3.5rem;\n    position: sticky;\n    z-index: 1;\n    top: calc(-1 * var(--song-list-gap));\n    color: ${styles.colors.text.active};\n    background: rgba(0, 0, 0, 0.7);\n`;\n\nconst SongListContainer = styled.div<{ active: boolean; dim: boolean }>`\n    position: relative;\n    flex: 1 1 auto;\n    display: flex;\n    flex-direction: column;\n    gap: var(--song-list-gap);\n    padding: 4.5rem 0;\n    overflow-y: auto;\n    overflow-x: clip;\n    box-sizing: border-box;\n    min-height: 100vh;\n    max-height: 100vh;\n    ::-webkit-scrollbar {\n        display: none;\n    }\n    transition: opacity 500ms;\n    opacity: ${(props) => (props.dim ? 0.5 : 1)};\n`;\n\nconst SongsGroup = styled.div`\n    display: flex;\n    flex-direction: row;\n    flex-wrap: wrap;\n    gap: var(--song-list-gap);\n`;\n\nconst SongListEntry = memo(styled(FinalSongCard)`\n    cursor: pointer;\n    flex-basis: var(--song-item-width);\n    aspect-ratio: var(--song-item-ratio);\n\n    ${(props) =>\n        props.theme.graphicSetting === 'high' &&\n        css`\n            transition: 300ms;\n        `}\n    transform: scale(${(props) => (props.focused ? focusMultiplier : 1)});\n    ${(props) => props.focused && 'z-index: 2;'}\n    ${(props) => props.focused && focused}\n\n    content-visibility: auto;\n    contain-intrinsic-size: calc(var(--song-item-width) * (1 / var(--song-item-ratio)));\n`);\n\nconst LoaderContainer = styled.div`\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100vh;\n`;\n","import ExcludeLanguagesView from 'Scenes/ExcludeLanguages/ExcludeLanguagesView';\nimport { ExcludedLanguagesSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport SongSelection from 'Scenes/SingASong/SongSelection/SongSelection';\nimport { ComponentProps, useState } from 'react';\n\nfunction SingASong(props: ComponentProps<typeof SongSelection>) {\n    const [excludedLanguages, setExcludedLanguages] = useSettingValue(ExcludedLanguagesSetting);\n    const [languageSelection, setLanguageSelection] = useState(excludedLanguages === null);\n    const goBack = () => {\n        setExcludedLanguages(excludedLanguages ?? []);\n        setLanguageSelection(false);\n    };\n\n    return languageSelection ? (\n        <ExcludeLanguagesView onClose={goBack} closeText=\"Continue to Song Selection\" />\n    ) : (\n        <SongSelection {...props} />\n    );\n}\n\nexport default SingASong;\n","import { useEffect } from 'react';\n\nexport default function useFullscreen() {\n    useEffect(() => {\n        try {\n            process.env.NODE_ENV !== 'development' && document.body.requestFullscreen().catch(console.info);\n        } catch (e) {}\n    }, []);\n}\n","import styled from '@emotion/styled';\nimport { PropsWithChildren } from 'react';\nimport { CSSTransition } from 'react-transition-group';\n\ninterface Props {\n    show: boolean;\n    children: React.ReactNode;\n}\n\nexport default function TransitionWrapper({ show, children }: PropsWithChildren<Props>) {\n    return (\n        <CSSTransition<HTMLDivElement> in={show} timeout={1000} classNames=\"fade\" unmountOnExit>\n            {() => <Box>{children}</Box>}\n        </CSSTransition>\n    );\n}\n\nconst Box = styled.div`\n    transition: opacity 1000ms;\n\n    // enter from\n    &.fade-enter {\n        opacity: 0;\n    }\n\n    // enter to\n    &.fade-enter-active {\n        opacity: 1;\n    }\n\n    // exit from\n    &.fade-exit {\n        opacity: 1;\n    }\n\n    // exit to\n    &.fade-exit-active {\n        opacity: 0;\n    }\n`;\n","export default \"__VITE_ASSET__0906c539__\"","const sleep = (ms: number) => new Promise<void>((resolve) => setTimeout(resolve, ms));\n\nexport default sleep;\n","import styled from '@emotion/styled';\nimport { CheckCircleOutline } from '@mui/icons-material';\nimport { CircularProgress } from '@mui/material';\nimport { typography } from 'Elements/cssMixins';\nimport events from 'GameEvents/GameEvents';\nimport { useEventEffect, useEventListenerSelector } from 'GameEvents/hooks';\nimport PlayersManager from 'Players/PlayersManager';\nimport SinglePlayer from 'Scenes/SingASong/SongSelection/SongSettings/MicCheck/SinglePlayer';\nimport { waitFinished } from 'SoundManager';\nimport backgroundMusic from 'assets/459342__papaninkasettratat__cinematic-music-short.mp3';\nimport { SyntheticEvent, useEffect, useRef, useState } from 'react';\nimport CountUp from 'react-countup';\nimport sleep from 'utils/sleep';\n\ninterface Props {\n    onFinish: () => void;\n}\n\nconst AUTOSTART_TIMEOUT_S = 15;\n\nfunction WaitForReadiness({ onFinish }: Props) {\n    const audio = useRef<HTMLAudioElement>(null);\n    const [areAllPlayersReady, setAreAllPlayersReady] = useState(false);\n\n    const [confirmedPlayers, setConfirmedPlayers] = useState<string[]>([]);\n    useEventEffect(events.readinessConfirmed, (deviceId) => {\n        setConfirmedPlayers((current) => [...current, deviceId]);\n    });\n\n    const players = useEventListenerSelector([events.inputListChanged, events.readinessConfirmed], () => {\n        return PlayersManager.getPlayers().map(\n            (player, index) => [player.input.deviceId!, player.getName(), player] as const,\n        );\n    });\n\n    useEffect(() => {\n        (async () => {\n            // can't use `areAllPlayersReady` as it would need to be specified as useEffect dependency\n            let allInputsReady = false;\n            const inputsReady = PlayersManager.requestReadiness().then(() => {\n                allInputsReady = true;\n                setAreAllPlayersReady(true);\n            });\n            const minTimeElapsed = sleep(1_500);\n            const maxTimeElapsed = sleep(AUTOSTART_TIMEOUT_S * 1_000);\n\n            // Only start the music if waiting for readiness takes some time\n            await sleep(250);\n            if (!allInputsReady) {\n                await audio?.current?.play();\n            }\n\n            await Promise.race([Promise.all([inputsReady, minTimeElapsed]), maxTimeElapsed]);\n            if (!audio?.current?.paused) waitFinished.play();\n            await sleep(500);\n            audio?.current?.pause();\n            await sleep(1000);\n            onFinish();\n        })();\n    }, []);\n\n    const playerStatuses = players.map(([deviceId, name, player]) => ({\n        confirmed: confirmedPlayers.includes(deviceId),\n        name,\n        player: player,\n    }));\n\n    return (\n        <>\n            {!areAllPlayersReady && (\n                <WaitingForReady>\n                    <span>\n                        Waiting for all players to click <strong>\"Ready\"</strong>\n                    </span>\n                    <PlayerList>\n                        {playerStatuses.map(({ confirmed, name, player }, index) => (\n                            <PlayerEntry\n                                className=\"ph-no-capture\"\n                                key={index}\n                                data-test=\"player-confirm-status\"\n                                data-name={name}\n                                data-confirmed={confirmed}>\n                                <ConfirmStatus>\n                                    {confirmed ? <CheckCircleOutline /> : <CircularProgress color=\"info\" size=\"1em\" />}\n                                </ConfirmStatus>{' '}\n                                <SinglePlayer player={player} />\n                            </PlayerEntry>\n                        ))}\n                    </PlayerList>\n                    <TimeoutMessage>\n                        The song will start automatically in{' '}\n                        <strong>\n                            <CountUp\n                                end={0}\n                                start={AUTOSTART_TIMEOUT_S}\n                                duration={AUTOSTART_TIMEOUT_S}\n                                useEasing={false}\n                            />\n                        </strong>\n                    </TimeoutMessage>\n                </WaitingForReady>\n            )}\n            <audio\n                src={backgroundMusic}\n                ref={audio}\n                hidden\n                autoPlay={false}\n                onPlay={(e: SyntheticEvent<HTMLAudioElement>) => {\n                    e.currentTarget.volume = 0.8;\n                }}\n            />\n        </>\n    );\n}\n\nconst WaitingForReady = styled.div`\n    top: 0;\n    left: 0;\n    z-index: 1000;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    gap: 5rem;\n\n    font-size: 5rem;\n    ${typography};\n`;\n\nconst TimeoutMessage = styled.span`\n    font-size: 5rem;\n`;\n\nconst PlayerList = styled.div`\n    //margin-top: 5rem;\n    display: flex;\n    flex-direction: column;\n    gap: 5rem;\n    width: 50rem;\n`;\n\nconst PlayerEntry = styled.div`\n    display: flex;\n    align-items: center;\n    //justify-content: center;\n    gap: 2rem;\n    transform: scale(1.5);\n`;\n\nconst ConfirmStatus = styled.span`\n    svg {\n        width: 5rem;\n        height: 5rem;\n        stroke: black;\n    }\n`;\n\nexport default WaitForReadiness;\n","import { NotesSection, Section, Song } from 'interfaces';\nimport { cloneDeep, range } from 'lodash-es';\nimport getSongBeatLength from 'Songs/utils/getSongBeatLength';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { getFirstNoteStartFromSections, getLastNoteEndFromSections } from 'Songs/utils/notesSelectors';\n\nconst MAX_SECTION_PAUSE_MS = 250;\n\nconst getSingableBeats = (sections: Section[], start: number = 0, end: number = Infinity) =>\n    sections\n        .filter(isNotesSection)\n        .filter((section) => getFirstNoteStartFromSections([section]) >= start)\n        .filter((section) => getLastNoteEndFromSections([section]) <= end)\n        .reduce((current, section) => current + section.notes.reduce((length, note) => length + note.length, 0), 0);\n\n// Join sections into segments - group of sections that have shorter than MAX_SECTION_PAUSE_MS pause between\nexport const segmentSections = (sections: Section[], beatLength: number): NotesSection[][] => {\n    const [firstSection, ...noteSections] = sections.filter(isNotesSection);\n\n    const segments: NotesSection[][] = [[firstSection]];\n\n    noteSections.forEach((section) => {\n        const lastSegment = segments.at(-1)!;\n\n        const lastSectionEnd = getLastNoteEndFromSections(lastSegment);\n        const firstSectionNoteStart = getFirstNoteStartFromSections([section]);\n        const difference = firstSectionNoteStart - lastSectionEnd;\n\n        if (difference * beatLength > MAX_SECTION_PAUSE_MS) {\n            segments.push([section]);\n        } else {\n            lastSegment.push(section);\n        }\n    });\n\n    return segments;\n};\n\nconst sum = (acc: number, elem: number) => acc + elem;\n\nconst calculateAmplitude = (groups: number[][]) => {\n    const sums = groups.map((group) => group.reduce(sum, 0));\n    return Math.max(...sums) - Math.min(...sums);\n};\n\nconst shiftSolution = (groups: number[][], at: number): number[][] => {\n    const result = cloneDeep(groups);\n    const takeFromLeft = (pos: number) => {\n        if (result[pos - 1].length < 2) return;\n        const left = result[pos - 1].pop()!;\n        result[pos].push(left);\n    };\n    const takeFromRight = (pos: number) => {\n        if (result[pos + 1]?.length < 2) return;\n        const [first, ...rest] = result[pos + 1];\n        result[pos].push(first);\n        result[pos + 1] = rest;\n    };\n\n    at % 2 === 1 ? takeFromLeft(Math.ceil(at / 2)) : takeFromRight(Math.ceil(at / 2));\n\n    return result;\n};\n\nconst arrSum = (arr: number[]) => arr.reduce(sum, 0);\n\nexport default function generatePlayerChanges(song: Song): number[][] {\n    const CHANGES_COUNT = 9;\n    const beatLength = getSongBeatLength(song);\n\n    return song.tracks.map((track) => {\n        if (track.sections.length < 3) return [];\n\n        const segments = segmentSections(track.sections, beatLength);\n\n        // array of groups of singable beats count -- each element is the total singable beats in a segment\n        // The goal is to for the groups to have as similar total count of singable beats as possible\n        let result: number[][] = [];\n\n        // todo replace this hacky algorithm with https://en.wikipedia.org/wiki/Multiway_number_partitioning\n        // STEP1:   Build initial groups by calculating \"ideal\" group length (aka amount of singable beats)\n        //          And try to have them as close to the ideal as possible (by either overflowing or \"underflowing\")\n        let currentBuffer = [getSingableBeats(segments[0])]; // A candidate for the next group\n        for (let i = 0; i < segments.length - 2; i++) {\n            // get the last segment already put in the result\n            const lastSegment = segments[result.flat().length - 1] ?? [];\n            // How many beats are left to sing\n            const singableBeats = getSingableBeats(track.sections, getLastNoteEndFromSections(lastSegment) ?? 0);\n            const idealSize = singableBeats / (1 + CHANGES_COUNT - result.length);\n\n            const segmentSingableBeatsCount = getSingableBeats(segments[i + 1]);\n\n            const bufferSum = arrSum(currentBuffer);\n\n            if (bufferSum + segmentSingableBeatsCount < idealSize) {\n                // If adding the current segment to the candidate doesn't move us past the ideal size, just add it\n                currentBuffer = [...currentBuffer, segmentSingableBeatsCount];\n            } else if (idealSize - bufferSum < bufferSum + segmentSingableBeatsCount - idealSize) {\n                // If the candidate is closer to ideal size, add it as a new group\n                result.push(currentBuffer);\n                currentBuffer = [segmentSingableBeatsCount];\n            } else {\n                // If the candidate with currently inspected segment is closer to ideal size, add it as a new group\n                result.push([...currentBuffer, segmentSingableBeatsCount]);\n                currentBuffer = [];\n            }\n        }\n\n        // STEP2:   Try to make groups more even by trying to move segments between groups and checking if it\n        //          resulted in smaller differences between longest and shortest group (aka amplitude)\n        for (let i = 0; i < 100; i++) {\n            const currentAmplitude = calculateAmplitude(result);\n            // Create alternative results (by shifting one segment between groups in either way)\n            // Note this doesn't guarantee creating best results as moving multiple segments at the same time\n            // isn't accounted for\n            const candidates = range((result.length - 2) * 2 + 2).map((at) => shiftSolution(result, at));\n            const candidatesAmplitudes = candidates.map(calculateAmplitude);\n            const minimalAmplitude = Math.min(...candidatesAmplitudes);\n            if (currentAmplitude <= minimalAmplitude) break; // If no results are better, give up\n            const minimalAmplitudeIndex = candidatesAmplitudes.indexOf(minimalAmplitude);\n            result = candidates[minimalAmplitudeIndex];\n        }\n\n        return result\n            .map((group) => group.length)\n            .reduce<number[]>((acc, length) => [...acc, (acc.at(-1) ?? 0) + length], [])\n            .map((index) => getLastNoteEndFromSections(segments[index - 1]));\n    });\n}\n","import { QrCode2 } from '@mui/icons-material';\nimport { useRef } from 'react';\nimport { randomInt } from 'utils/randomValue';\n\nconst data = [\n    <>\n        You can follow the updates and give feedback on the game through the Facebook Page:{' '}\n        <a href=\"https://www.facebook.com/allkaraoke.party\" target=\"_blank\" rel=\"noreferrer\">\n            <strong>fb.com/AllKaraoke.Party</strong>\n        </a>\n    </>,\n    <>\n        Start typing a name of a song in <strong>Song Selection</strong> to active Search feature\n    </>,\n    <>\n        Narrow down songs through <strong>playlists</strong> on the right in Song Selection\n    </>,\n    <>\n        Select <strong>Pass The Mic</strong> Game Mode to share the microphones and sing in a team\n    </>,\n    <>\n        Your scores and <strong>stats are saved</strong> in this browser - they will be available for the next party!\n    </>,\n    <>\n        You can remove irrelevant songs from the Song Selection in <strong>Edit Songs</strong> page\n    </>,\n    <>\n        If the game feels a bit jaggy with low FPS, check out <strong>Settings</strong> page\n    </>,\n    <>\n        Party is only getting started? Play <strong>Jukebox</strong> for the music and to see what songs are available\n    </>,\n    <>\n        Research shows that <strong>duet songs</strong> are that bit more fun than simple one-track ones\n    </>,\n    <>\n        Want to sing a <strong>new song</strong>? Find UltraStar version of it and import it with\n        <br />\n        <strong>Convert Ultrastar .txt</strong>\n    </>,\n    <>\n        The <strong>white pulse</strong> around selected song in Song Selection tries to match song's tempo\n    </>,\n    <>\n        Entire game (besides add/edit song) is navigable with <strong>Keyboard</strong>\n    </>,\n    <>\n        You can hide or show keyboard navigation help with <kbd>H</kbd> key\n    </>,\n    <>\n        In Song Selection, hold <kbd></kbd> or <kbd></kbd> to jump to the next letter\n    </>,\n    <>\n        Add <strong>vibrato</strong> to the notes you sing to get additional <strong>bonus points</strong>\n    </>,\n    <>\n        You can control the game with your phone - click on the{' '}\n        <strong>\n            <QrCode2 />\n            QR Code Icon\n        </strong>{' '}\n        on the top right and follow the instructions\n    </>,\n];\n\ninterface Props {\n    as?: any;\n}\n\nexport const GameTip = ({ as = 'h4', ...restProps }: Props) => {\n    const randomValue = useRef(randomInt(0, data.length - 1));\n    // const randomValue = useRef(randomInt(0, 0));\n\n    const Component = as;\n    return <Component {...restProps}>{data[randomValue.current]}</Component>;\n};\n","import styled from '@emotion/styled';\nimport CameraManager from 'Camera/CameraManager';\nimport { useEffect, useRef, useState } from 'react';\nimport { captureException } from '@sentry/react';\n\ninterface Props {}\n\nfunction CameraRoll({ ...props }: Props) {\n    const [videoSrc, setVideoSrc] = useState('');\n    const video = useRef<HTMLVideoElement | null>(null);\n\n    useEffect(() => {\n        // Seems it needs some time to process the video, otherwise invalid URL is returned\n        const timeout = setTimeout(() => {\n            setVideoSrc(CameraManager.getVideo());\n        }, 1000);\n\n        return () => {\n            clearTimeout(timeout);\n        };\n    }, []);\n\n    useEffect(() => {\n        try {\n            if (video.current) video.current.playbackRate = 16;\n        } catch (e) {\n            captureException(e);\n        }\n    }, [videoSrc]);\n\n    return (\n        <Container {...props}>\n            <Video src={videoSrc} ref={video} loop autoPlay className=\"ph-no-capture\" />\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    width: 80rem;\n    height: 60rem;\n`;\n\nconst Video = styled.video`\n    object-fit: cover;\n    width: 100%;\n    height: 100%;\n`;\n\nexport default CameraRoll;\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport { Song, SongPreview } from 'interfaces';\nimport styles from './Singing/GameOverlay/Drawing/styles';\n\ninterface Props {\n    width: number;\n    height: number;\n    songData: SongPreview | Song;\n    children: React.ReactNode;\n    background?: React.ReactNode;\n}\n\nexport default function SongPage({ songData, background, width, height, children, ...restProps }: Props) {\n    return (\n        <FocusedSongContainer video={songData.video} width={width} height={height} {...restProps}>\n            <BackgroundImage video={songData.video} blur />\n            {background && <Background>{background}</Background>}\n            <ContentLayer>\n                <FocusedSongData>\n                    <SongTitle>{songData.title}</SongTitle>\n                    <br />\n                    <SongArtist>{songData.artist}</SongArtist>\n                    <br />\n                    {songData.author && (\n                        <SongCreator>\n                            by&nbsp;\n                            {songData.authorUrl ? <a href={songData.authorUrl}>{songData.author}</a> : songData.author}\n                        </SongCreator>\n                    )}\n                    {children}\n                </FocusedSongData>\n            </ContentLayer>\n        </FocusedSongContainer>\n    );\n}\n\nconst FocusedSongContainer = styled.div<{ video: string; width: number; height: number }>(\n    (props) => `\n    width: ${props.width}px;\n    top: 0;\n    height: ${props.height}px;\n    overflow-y: hidden;\n    background: black;\n    position: relative;\n`,\n);\n\nconst Background = styled.div`\n    z-index: 1;\n    top: 0;\n    left: 0;\n    position: absolute;\n    width: 100%;\n    height: 100%;\n`;\n\nconst BaseBackgroundImage = styled(Background)<{ blur: boolean; video: string }>`\n    background-size: cover;\n    background-position: center center;\n\n    filter: ${(props) => (props.blur ? 'blur(0.5rem)' : 'none')};\n`;\n\nconst BackgroundImage = (props: { blur: boolean; video: string }) => (\n    <BaseBackgroundImage\n        style={{ backgroundImage: `url('https://i3.ytimg.com/vi/${props.video}/hqdefault.jpg')` }}\n        {...props}\n    />\n);\n\nconst ContentLayer = styled.div`\n    z-index: 2;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    pointer-events: none;\n`;\n\nconst FocusedSongData = styled.div`\n    position: relative;\n    margin: 0 auto;\n    color: white;\n    max-width: 144rem;\n    height: 100%;\n    pointer-events: none;\n`;\n\nexport const ContentElement = styled.span`\n    background: rgba(0, 0, 0, 0.5);\n    display: inline-block;\n    backdrop-filter: blur(0.5rem);\n    ${typography};\n    padding: 0.5rem 2rem;\n    margin: 0 0 1rem 2rem;\n`;\n\nconst SongTitle = styled(ContentElement)`\n    color: ${styles.colors.text.active};\n    margin-top: 2rem;\n    font-size: 4.5rem;\n`;\n\nconst SongArtist = styled(ContentElement)`\n    font-size: 3.5rem;\n`;\n\nconst SongCreator = styled(ContentElement)`\n    font-size: 2rem;\n`;\n","import styled from '@emotion/styled';\nimport { buttonFocused } from 'Elements/Button';\nimport { formatter } from 'Scenes/Game/Singing/GameOverlay/Components/ScoreText';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { MAX_POINTS, sumDetailedScore } from 'Scenes/Game/Singing/GameState/Helpers/calculateScore';\nimport { PlayerScore } from 'Scenes/Game/Singing/PostGame/PostGameView';\nimport { ContentElement } from 'Scenes/Game/SongPage';\nimport { HighScoreEntity, SingSetup } from 'interfaces';\nimport CountUp from 'react-countup';\n\ninterface Props {\n    player: PlayerScore;\n    revealHighScore: boolean;\n    setAnimDone: (playerNumber: number) => void;\n    useColors?: boolean;\n    playerNumber: number;\n    highestScore: number;\n    highScores: HighScoreEntity[];\n    singSetup: SingSetup;\n}\n\nconst MAX_POINTS_ANIM_LENGTH = 6;\nconst MIN_POINTS_ANIM_LENGTH = 3;\n\nfunction PlayerScoreView({\n    playerNumber,\n    player,\n    highestScore,\n    highScores,\n    singSetup,\n    useColors = true,\n    revealHighScore,\n    setAnimDone,\n}: Props) {\n    const playerScore = sumDetailedScore(player.detailedScore[0]);\n    const isHighScore = (playerName: string) =>\n        highScores.some((score) => score.singSetupId === singSetup.id && score.name === playerName);\n\n    return (\n        <>\n            <ScoreTextPlayer\n                color={useColors ? styles.colors.players[playerNumber].text : ``}\n                data-test={`player-${playerNumber}-name`}\n                className=\"ph-no-capture\">\n                {player.name}\n            </ScoreTextPlayer>\n            <br />\n            <ScoreTextScore\n                highscore={revealHighScore && isHighScore(player.name)}\n                color={useColors ? styles.colors.players[playerNumber].text : ``}\n                win={revealHighScore && playerScore === highestScore}\n                data-test={`player-${playerNumber}-score`}\n                data-score={playerScore}>\n                <CountUp\n                    end={playerScore}\n                    formattingFn={formatter.format}\n                    onEnd={() => setAnimDone(playerNumber)}\n                    duration={Math.max(MIN_POINTS_ANIM_LENGTH, (playerScore / MAX_POINTS) * MAX_POINTS_ANIM_LENGTH)}\n                />\n                <HighScoreBadge highscore={revealHighScore && isHighScore(player.name)}>High score!</HighScoreBadge>\n            </ScoreTextScore>\n            <br />\n            <br />\n        </>\n    );\n}\n\nconst ScoreTextPlayer = styled(ContentElement)<{ color: string }>`\n    padding-left: 10rem;\n    padding-right: 10rem;\n    font-size: 3.5rem;\n    color: rgb(${(props) => props.color});\n`;\n\nconst ScoreTextScore = styled(ScoreTextPlayer)<{ win: boolean; highscore: boolean; color: string }>`\n    font-size: ${(props) => (props.win ? '10.5rem' : '5.5rem')};\n    color: ${(props) => (props.win ? styles.colors.text.active : 'white')};\n    //color: white;\n    transition: 400ms ease-in-out;\n    position: relative;\n`;\n\nconst HighScoreBadge = styled.span<{ highscore: boolean }>`\n    position: absolute;\n    top: -1.5rem;\n    right: -10rem;\n\n    font-size: 3rem;\n    -webkit-text-stroke: 0.1rem black;\n    color: ${styles.colors.text.default};\n    padding: 0.5rem 1rem;\n    border-radius: 1.5rem;\n\n    ${(props) => props.highscore && buttonFocused};\n\n    opacity: ${(props) => (props.highscore ? '1' : '0')};\n    transition: 400ms;\n`;\n\nexport default PlayerScoreView;\n","import styled from '@emotion/styled';\nimport { Button } from 'Elements/Button';\nimport { sumDetailedScore } from 'Scenes/Game/Singing/GameState/Helpers/calculateScore';\nimport { PlayerScore } from 'Scenes/Game/Singing/PostGame/PostGameView';\nimport CameraRoll from 'Scenes/Game/Singing/PostGame/Views/Results/CameraRoll';\nimport PlayerScoreView from 'Scenes/Game/Singing/PostGame/Views/Results/PlayerScore';\nimport CameraManager from 'Camera/CameraManager';\nimport useKeyboard from 'hooks/useKeyboard';\nimport useKeyboardHelp from 'hooks/useKeyboardHelp';\nimport { GAME_MODE, HighScoreEntity, SingSetup } from 'interfaces';\nimport { useMemo, useState } from 'react';\n\ninterface Props {\n    onNextStep: () => void;\n    players: PlayerScore[];\n    highScores: HighScoreEntity[];\n    singSetup: SingSetup;\n}\n\nfunction ResultsView({ onNextStep, players, highScores, singSetup }: Props) {\n    useKeyboard({\n        accept: onNextStep,\n    });\n    const help = useMemo(\n        () => ({\n            accept: 'Next',\n        }),\n        [],\n    );\n    useKeyboardHelp(help, true);\n\n    const isCoop = singSetup.mode === GAME_MODE.CO_OP;\n    const finalPlayers = isCoop ? [{ ...players[0], name: players.map((player) => player.name).join(', ') }] : players;\n\n    const [finishedAnims, setFinishedAnims] = useState(finalPlayers.map(() => false));\n    const isAnimDone = finishedAnims.every((anim) => anim);\n\n    const playerScores = finalPlayers.map((player) => sumDetailedScore(player.detailedScore[0]));\n    const highestScore = Math.max(...playerScores);\n\n    return (\n        <>\n            <ScoresContainer>\n                {finalPlayers.map((player, number) => (\n                    <PlayerScoreView\n                        playerNumber={player.playerNumber}\n                        useColors={!isCoop}\n                        revealHighScore={isAnimDone}\n                        setAnimDone={(which) =>\n                            setFinishedAnims((current) => {\n                                current[which] = true;\n                                return [...current];\n                            })\n                        }\n                        key={number}\n                        player={player}\n                        highScores={highScores}\n                        highestScore={highestScore}\n                        singSetup={singSetup}\n                    />\n                ))}\n            </ScoresContainer>\n            <SongSelectionButton onClick={onNextStep} focused data-test=\"highscores-button\">\n                Next\n            </SongSelectionButton>\n            {CameraManager.getPermissionStatus() && <StyledPhotoRoll />}\n        </>\n    );\n}\n\nconst ScoresContainer = styled.div`\n    position: absolute;\n    top: 20rem;\n    width: 100%;\n    text-align: center;\n`;\n\nconst SongSelectionButton = styled(Button)<{ focused: boolean }>`\n    position: absolute;\n    bottom: 4rem;\n    right: 2rem;\n    width: 40rem;\n    font-size: 1.9vw;\n`;\n\nconst StyledPhotoRoll = styled(CameraRoll)`\n    position: absolute;\n    top: calc(50% - 30rem);\n    left: 95rem;\n    transform: scale(0.75);\n`;\n\nexport default ResultsView;\n","import { PLAYER_NAMES_SESSION_STORAGE_KEY } from 'hooks/players/consts';\nimport { useMemo } from 'react';\n\nexport default function useRecentPlayerNames() {\n    return useMemo<string[]>(() => JSON.parse(sessionStorage.getItem(PLAYER_NAMES_SESSION_STORAGE_KEY)!) ?? [], []);\n}\n","import { Autocomplete } from 'Elements/Autocomplete';\nimport useRecentPlayerNames from 'hooks/players/useRecentPlayerNames';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { HighScoreEntity } from 'interfaces';\nimport { useRef, useState } from 'react';\n\ninterface Props {\n    index: number;\n    singSetupId: string;\n    score: HighScoreEntity;\n    register: ReturnType<typeof useKeyboardNav>['register'];\n    onSave: (singId: string, score: number, oldName: string, newName: string) => void;\n}\n\nfunction HighScoreRename({ score, register, singSetupId, onSave, index }: Props) {\n    const inputRef = useRef<HTMLInputElement | null>(null);\n    const [newName, setNewName] = useState('');\n    const playerNames = useRecentPlayerNames();\n\n    const onBlur = () => {\n        if (newName.trim().length && newName.trim() !== score.name)\n            onSave(singSetupId, score.score, score.name, newName);\n    };\n\n    return (\n        <Autocomplete\n            className=\"ph-no-capture\"\n            options={playerNames}\n            onChange={setNewName}\n            onBlur={onBlur}\n            value={newName}\n            label=\"\"\n            ref={inputRef}\n            {...register(`highscore-rename-${index}`, () => inputRef.current?.focus())}\n            placeholder={score.name}\n            data-test={`input-edit-highscore`}\n            data-original-name={score.name}\n        />\n    );\n}\n\nexport default HighScoreRename;\n","import styled from '@emotion/styled';\nimport { Button } from 'Elements/Button';\nimport { typography } from 'Elements/cssMixins';\nimport ScoreText from 'Scenes/Game/Singing/GameOverlay/Components/ScoreText';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { useEditScore } from 'Songs/stats/hooks';\nimport { format } from 'date-fns';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { HighScoreEntity, SingSetup, Song } from 'interfaces';\nimport HighScoreRename from './HighScoreRename';\n\ninterface Props {\n    onNextStep: () => void;\n    singSetup: SingSetup;\n    highScores: HighScoreEntity[];\n    song: Song;\n}\n\nfunction HighScoresView({ onNextStep, highScores, singSetup, song }: Props) {\n    const { register } = useKeyboardNav();\n    const editScore = useEditScore(song);\n\n    return (\n        <>\n            <ScoresContainer data-test=\"highscores-container\">\n                {highScores.map((score, index) => (\n                    <ScoreContainer isCurrentSing={score.singSetupId === singSetup.id} key={index}>\n                        <ScorePosition>{index + 1}</ScorePosition>\n\n                        <ScorePlayerName>\n                            {score.singSetupId === singSetup.id ? (\n                                <HighScoreRename\n                                    index={index}\n                                    score={score}\n                                    register={register}\n                                    singSetupId={singSetup.id}\n                                    onSave={editScore}\n                                />\n                            ) : (\n                                score.name\n                            )}\n                        </ScorePlayerName>\n                        <ScoreScore>\n                            <ScoreText score={score.score} />\n                        </ScoreScore>\n                        <ScoreDate>{format(new Date(score.date), 'LLL do y')}</ScoreDate>\n                    </ScoreContainer>\n                ))}\n            </ScoresContainer>\n            <SongSelectionButton {...register('play-next-song-button', onNextStep, undefined, true)}>\n                Select song\n            </SongSelectionButton>\n        </>\n    );\n}\n\nconst ScoresContainer = styled.div`\n    position: absolute;\n    top: 20rem;\n    width: 100%;\n    text-align: center;\n    padding: 0 16rem;\n    box-sizing: border-box;\n`;\n\nconst ScoreContainer = styled.div<{ isCurrentSing: boolean }>`\n    position: relative;\n    ${typography};\n    font-size: 3.2rem;\n    display: flex;\n    background: ${(props) => (props.isCurrentSing ? 'rgba(0,0,0,.9)' : 'rgba(0,0,0,.5)')};\n    margin-bottom: 2rem;\n    padding: ${(props) => (props.isCurrentSing ? `0 1.5rem` : `1rem 3.2rem`)};\n    align-items: center;\n`;\nconst ScorePosition = styled.div`\n    padding: 0 1.6rem;\n    color: ${styles.colors.text.active};\n`;\nconst ScorePlayerName = styled.div`\n    text-align: left;\n    flex: 1;\n    padding: 1.6rem;\n`;\nconst ScoreScore = styled.div`\n    padding: 0 1rem;\n`;\nconst ScoreDate = styled.div`\n    position: absolute;\n    font-size: 2rem;\n    bottom: -1rem;\n    right: -1.6rem;\n    background: black;\n    padding: 0.5rem;\n`;\n\nconst SongSelectionButton = styled(Button)<{ focused: boolean }>`\n    position: absolute;\n    bottom: 4rem;\n    right: 2rem;\n    width: 40rem;\n    font-size: 1.9vw;\n`;\n\nexport default HighScoresView;\n","import styled from '@emotion/styled';\nimport { GameTip } from 'Elements/GameTip';\nimport ResultsView from 'Scenes/Game/Singing/PostGame/Views/Results';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport { DetailedScore, SingSetup, Song } from 'interfaces';\nimport { useState } from 'react';\nimport SongPage from '../../SongPage';\nimport HighScoresView from './Views/HighScores';\n\nexport interface PlayerScore {\n    detailedScore: [DetailedScore, DetailedScore];\n    playerNumber: number;\n    name: string;\n}\n\ninterface HighScoreEntity {\n    singSetupId: string;\n    name: string;\n    score: number;\n    date: string;\n}\n\ninterface Props {\n    width: number;\n    height: number;\n    song: Song;\n    onClickSongSelection: () => void;\n    players: PlayerScore[];\n    singSetup: SingSetup;\n    highScores: HighScoreEntity[];\n}\n\nfunction PostGameView({ song, width, height, onClickSongSelection, players, highScores, singSetup }: Props) {\n    useBackgroundMusic(true);\n    const [step, setStep] = useState<'results' | 'highscores'>('results');\n\n    return (\n        <SongPage songData={song} width={width} height={height}>\n            <Container>\n                {step === 'results' && (\n                    <ResultsView\n                        onNextStep={() => setStep('highscores')}\n                        players={players}\n                        singSetup={singSetup}\n                        highScores={highScores}\n                    />\n                )}\n                {step === 'highscores' && (\n                    <HighScoresView\n                        onNextStep={onClickSongSelection}\n                        singSetup={singSetup}\n                        highScores={highScores}\n                        song={song}\n                    />\n                )}\n                <PostGameTip active />\n            </Container>\n        </SongPage>\n    );\n}\n\nconst Container = styled.div`\n    pointer-events: auto;\n`;\n\nexport default PostGameView;\n\nconst PostGameTip = styled(GameTip)<{ active: boolean }>`\n    transition: 300ms;\n    transform: scale(${({ active }) => (active ? 1 : 0)});\n    position: absolute;\n    bottom: 20rem;\n    font-size: 3.2rem;\n    line-height: 1.25;\n    color: white;\n    text-align: center;\n    background: rgba(0, 0, 0, 0.75);\n    width: 100%;\n    box-sizing: border-box;\n\n    padding: 2rem 10rem;\n\n    kbd {\n        padding: 0.12rem 0.9rem;\n        border-radius: 1rem;\n        border: 0.5rem solid rgb(204, 204, 204);\n        border-bottom-color: rgb(150, 150, 150);\n        border-right-color: rgb(150, 150, 150);\n        color: rgb(51, 51, 51);\n        line-height: 1.4;\n        display: inline-block;\n        box-shadow: 0 0.1rem 0 rgba(0, 0, 0, 0.2), inset 0 0 0 0.2rem #ffffff;\n        background-color: rgb(247, 247, 247);\n        text-shadow: 0 0.1rem 0 #fff;\n        font-weight: normal;\n    }\n`;\n","import PlayersManager from 'Players/PlayersManager';\nimport PostGameView from 'Scenes/Game/Singing/PostGame/PostGameView';\nimport { useSongStats } from 'Songs/stats/hooks';\nimport { HighScoreEntity, SingSetup, Song } from 'interfaces';\nimport { useMemo } from 'react';\nimport GameState from '../GameState/GameState';\n\ninterface Props {\n    width: number;\n    height: number;\n    song: Song;\n    onClickSongSelection: () => void;\n    singSetup: SingSetup;\n}\n\nfunction useHighScores(song: Song, singSetup: SingSetup): HighScoreEntity[] {\n    const stats = useSongStats(song);\n\n    const highScores = useMemo(\n        () =>\n            stats?.scores\n                .filter(({ setup }) => setup.mode === singSetup.mode && setup.tolerance === singSetup.tolerance)\n                .map((score) =>\n                    score.scores.map((singleScore) => ({\n                        ...singleScore,\n                        date: score.date,\n                        singSetupId: score.setup.id,\n                    })),\n                )\n                .flat()\n                .sort((a, b) => b.score - a.score)\n                .slice(0, 5),\n        [stats, singSetup],\n    );\n\n    return highScores ?? [];\n}\n\nfunction PostGame({ song, width, height, onClickSongSelection, singSetup }: Props) {\n    const highScores = useHighScores(song, singSetup);\n    const playerScores = useMemo(\n        () =>\n            PlayersManager.getPlayers().map((player) => ({\n                name: player.getName(),\n                playerNumber: player.number,\n                detailedScore: GameState.getPlayerDetailedScore(player.number),\n            })),\n        [],\n    );\n\n    return (\n        <PostGameView\n            singSetup={singSetup}\n            song={song}\n            width={width}\n            height={height}\n            onClickSongSelection={onClickSongSelection}\n            players={playerScores}\n            highScores={highScores}\n        />\n    );\n}\n\nexport default PostGame;\n","import styled from '@emotion/styled';\nimport { useBackground } from 'Elements/LayoutWithBackground';\nimport { VideoState } from 'Elements/VideoPlayer';\nimport events from 'GameEvents/GameEvents';\nimport PlayersManager from 'Players/PlayersManager';\nimport GameState from 'Scenes/Game/Singing/GameState/GameState';\nimport WaitForReadiness from 'Scenes/Game/Singing/WaitForReadiness';\nimport useSong from 'Songs/hooks/useSong';\nimport useBlockScroll from 'hooks/useBlockScroll';\nimport useFullscreen from 'hooks/useFullscreen';\nimport { GAME_MODE, SingSetup } from 'interfaces';\nimport { useMemo, useRef, useState } from 'react';\nimport TransitionWrapper from '../../../Elements/TransitionWrapper';\nimport useViewportSize from '../../../hooks/useViewportSize';\nimport generatePlayerChanges from './Helpers/generatePlayerChanges';\nimport Player, { PlayerRef } from './Player';\nimport PostGame from './PostGame/PostGame';\n\ninterface Props {\n    video: string;\n    songFile: string;\n    singSetup: SingSetup;\n    returnToSongSelection: () => void;\n    restartSong: () => void;\n}\nfunction Singing({ video, songFile, singSetup, returnToSongSelection, restartSong }: Props) {\n    useFullscreen();\n    useBlockScroll();\n    const player = useRef<PlayerRef | null>(null);\n    const song = useSong(songFile);\n\n    const { width, height } = useViewportSize();\n    const [isEnded, setIsEnded] = useState(false);\n    const [playerState, setPlayerState] = useState(VideoState.UNSTARTED);\n\n    const playerChanges = useMemo(() => {\n        if (!song.data) return [];\n        if (singSetup.mode !== GAME_MODE.PASS_THE_MIC) return song.data.tracks.map(() => []);\n\n        return generatePlayerChanges(song.data);\n    }, [song.data, singSetup]);\n\n    const [isTransitionTimeout, setIsTransitionTimeout] = useState(false);\n\n    useBackground(!isTransitionTimeout);\n\n    if (!width || !height || !song.data) return <>Loading</>;\n\n    if (isEnded) {\n        return (\n            <PostGame\n                width={width}\n                height={height}\n                song={song.data}\n                onClickSongSelection={returnToSongSelection}\n                singSetup={singSetup}\n            />\n        );\n    } else {\n        return (\n            <Container>\n                <BackgroundContainer>\n                    <TransitionWrapper show={!isTransitionTimeout && playerState === VideoState.UNSTARTED}>\n                        <>\n                            <Overlay video={video} width={width} height={height} />\n                            <WaitForReadiness\n                                onFinish={() => {\n                                    setIsTransitionTimeout(true);\n                                    player.current?.play();\n                                }}\n                            />\n                        </>\n                    </TransitionWrapper>\n                </BackgroundContainer>\n                <Player\n                    ref={player}\n                    onStatusChange={setPlayerState}\n                    playerChanges={playerChanges}\n                    players={singSetup.players}\n                    song={song.data}\n                    width={width}\n                    height={height}\n                    autoplay={false}\n                    onSongEnd={() => {\n                        const scores =\n                            GameState.getSingSetup()?.mode === GAME_MODE.CO_OP\n                                ? [\n                                      {\n                                          name: PlayersManager.getPlayers()\n                                              .map((player) => player.getName())\n                                              .join(', '),\n                                          score: GameState.getPlayerScore(0),\n                                      },\n                                  ]\n                                : PlayersManager.getPlayers().map((player) => ({\n                                      name: player.getName(),\n                                      score: GameState.getPlayerScore(player.number),\n                                  }));\n                        events.songEnded.dispatch(song.data!, singSetup, scores);\n                        setIsEnded(true);\n                    }}\n                    singSetup={singSetup}\n                    restartSong={restartSong}\n                />\n            </Container>\n        );\n    }\n}\n\nconst Container = styled.div`\n    position: relative;\n`;\n\nconst BackgroundContainer = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 10;\n    pointer-events: none;\n`;\n\nconst BaseOverlay = styled.div`\n    background-size: cover;\n    background-position: center center;\n    filter: blur(10px);\n`;\n\nconst Overlay = (props: { video: string; width: number; height: number }) => (\n    <BaseOverlay\n        style={{\n            backgroundImage: `url('https://i3.ytimg.com/vi/${props.video}/hqdefault.jpg')`,\n            width: `${props.width}px`,\n            height: `${props.height}px`,\n        }}\n    />\n);\n\nexport default Singing;\n","import CameraManager from 'Camera/CameraManager';\nimport SingASong from 'Scenes/SingASong/SingASong';\nimport useFullscreen from 'hooks/useFullscreen';\nimport { SingSetup } from 'interfaces';\nimport { useCallback, useState } from 'react';\nimport TransitionWrapper from '../../Elements/TransitionWrapper';\nimport Singing from './Singing/Singing';\n\ninterface Props {\n    file?: string;\n}\n\nfunction Game(props: Props) {\n    const [singSetup, setSingSetup] = useState<(SingSetup & { file: string; video: string }) | null>(null);\n    const [preselectedSong, setPreselectedSong] = useState<string | null>(props.file ?? null);\n    const [resetKey, setResetKey] = useState(0);\n\n    const handleSelect = useCallback(\n        (setup: SingSetup & { file: string; video: string }) => {\n            setSingSetup(setup);\n        },\n        [setSingSetup],\n    );\n\n    useFullscreen();\n\n    return (\n        <>\n            <TransitionWrapper show={!!singSetup}>\n                {singSetup && (\n                    <Singing\n                        restartSong={() => {\n                            CameraManager.restartRecord();\n                            setResetKey((current) => current + 1);\n                        }}\n                        key={resetKey}\n                        video={singSetup.video}\n                        songFile={singSetup.file}\n                        singSetup={singSetup}\n                        returnToSongSelection={() => {\n                            setPreselectedSong(singSetup.file);\n                            setSingSetup(null);\n                        }}\n                    />\n                )}\n            </TransitionWrapper>\n            <TransitionWrapper show={!singSetup}>\n                <SingASong onSongSelected={handleSelect} preselectedSong={preselectedSong} />\n            </TransitionWrapper>\n        </>\n    );\n}\nexport default Game;\n","import styled from '@emotion/styled';\nimport { Button } from 'Elements/Button';\nimport { useBackground } from 'Elements/LayoutWithBackground';\nimport VideoPlayer, { VideoState } from 'Elements/VideoPlayer';\nimport useSongIndex from 'Songs/hooks/useSongIndex';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport { SongPreview } from 'interfaces';\nimport { shuffle } from 'lodash-es';\nimport { useEffect, useState } from 'react';\nimport { Link } from 'wouter';\nimport useViewportSize from '../../hooks/useViewportSize';\nimport SongPage from '../Game/SongPage';\n\ninterface Props {}\n\nfunction Jukebox(props: Props) {\n    useBackground(false);\n    useBackgroundMusic(false);\n    const navigate = useSmoothNavigate();\n    const { width, height } = useViewportSize();\n    const [currentlyPlaying, setCurrentlyPlaying] = useState(0);\n    const songList = useSongIndex();\n\n    const [shuffledList, setShuffledList] = useState<SongPreview[]>([]);\n    const { register } = useKeyboardNav({ onBackspace: () => navigate('/') });\n\n    useEffect(() => songList.data && setShuffledList(shuffle(songList.data)), [songList.data]);\n\n    const playNext = () => songList.data && setCurrentlyPlaying((current) => (current + 1) % songList.data.length);\n\n    if (!shuffledList.length || !width || !height) return null;\n\n    const navigateUrl = `/game/${encodeURIComponent(shuffledList[currentlyPlaying].file)}`;\n\n    return (\n        <SongPage\n            width={width}\n            height={height}\n            songData={shuffledList[currentlyPlaying]}\n            data-test=\"jukebox-container\"\n            data-song={shuffledList[currentlyPlaying].file}\n            background={\n                <VideoPlayer\n                    autoplay\n                    controls\n                    width={width}\n                    height={height}\n                    volume={shuffledList[currentlyPlaying]?.volume}\n                    video={shuffledList[currentlyPlaying].video}\n                    startAt={shuffledList[currentlyPlaying].videoGap}\n                    onStateChange={(state) => {\n                        if (state === VideoState.ENDED) playNext();\n                    }}\n                />\n            }>\n            <SkipSongButton {...register('skip-button', playNext)}>Skip</SkipSongButton>\n            <Link to={navigateUrl}>\n                <PlayThisSongButton {...register('sing-button', () => navigate(navigateUrl), undefined, true)}>\n                    Sing this song\n                </PlayThisSongButton>\n            </Link>\n        </SongPage>\n    );\n}\n\nconst PlayThisSongButton = styled(Button)<{ focused: boolean }>`\n    bottom: 7rem;\n    right: 2rem;\n    width: 50rem;\n    position: absolute;\n    font-size: 1.9vw;\n`;\n\nconst SkipSongButton = styled(Button)<{ focused: boolean }>`\n    bottom: 15rem;\n    right: 2rem;\n    width: 30rem;\n    position: absolute;\n    font-size: 1.9vw;\n`;\n\nexport default Jukebox;\n","import MenuWithLogo from 'Elements/MenuWithLogo';\nimport SelectInputView from 'Scenes/SelectInput/SelectInputView';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\n\ninterface Props {\n    // file?: string;\n}\n\nfunction SelectInput(props: Props) {\n    const navigate = useSmoothNavigate();\n\n    return (\n        <MenuWithLogo>\n            <SelectInputView onFinish={() => navigate('/')} closeButtonText={'Go to main menu'} />\n        </MenuWithLogo>\n    );\n}\nexport default SelectInput;\n","import styled from '@emotion/styled';\nimport { Warning } from '@mui/icons-material';\nimport { FallbackRender } from '@sentry/react';\nimport { MenuButton } from 'Elements/Menu';\nimport MenuWithLogo from 'Elements/MenuWithLogo';\nimport localForage from 'localforage';\n\nexport const ErrorFallback: FallbackRender = ({ error, resetError }) => {\n    return (\n        <MenuWithLogo supportedBrowsers>\n            <h1>\n                <Warning fontSize=\"large\" /> An error occurred :(\n            </h1>\n            <h3>The game crashed with following error</h3>\n            <Pre>{error.message}</Pre>\n            <h3>\n                Help me fix it by reporting what exactly has happened at{' '}\n                <a href=\"https://github.com/Asvarox/allkaraoke\" target=\"_blank\" rel=\"noreferrer\">\n                    GitHub\n                </a>{' '}\n                or{' '}\n                <a href=\"https://www.facebook.com/allkaraoke.party\" target=\"_blank\" rel=\"noreferrer\">\n                    Facebook\n                </a>\n            </h3>\n            <MenuButton onClick={resetError}>Reset Error</MenuButton>\n            <h4>If that doesn't help</h4>\n            <MenuButton onClick={() => (window.location.href = window.location.origin)}>Reload the game</MenuButton>\n            <h4>If that doesn't help</h4>\n            <MenuButton\n                onClick={() => {\n                    if (\n                        window.confirm(\n                            'Are you sure? It will delete all custom songs and scores. Before doing that, try opening the game in an private window or another browser to make sure it will actually help',\n                        )\n                    ) {\n                        sessionStorage.clear();\n                        localStorage.clear();\n                        localForage.clear();\n                        window.location.href = window.location.origin;\n                    }\n                }}>\n                Clear all data\n            </MenuButton>\n        </MenuWithLogo>\n    );\n};\n\nexport const Pre = styled.span`\n    color: white;\n    font-family: monospace;\n`;\n","import { css } from '@emotion/react';\nimport { typography } from 'Elements/cssMixins';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\n\nexport default css`\n    h1 {\n        ${typography};\n        margin: 0;\n        text-align: center;\n        font-size: 4rem;\n        color: ${styles.colors.text.active};\n    }\n\n    h2 {\n        ${typography};\n        margin: 0;\n        font-size: 2.9rem;\n    }\n\n    h3 {\n        ${typography};\n        margin: 0;\n        font-size: 2.7rem;\n\n        strong {\n            color: ${styles.colors.text.active};\n        }\n    }\n\n    h4 {\n        ${typography};\n        margin: 0;\n        font-size: 2.2rem;\n        line-height: 1.15;\n    }\n\n    h5 {\n        ${typography};\n        margin: 0;\n        font-size: 1.6rem;\n        line-height: 1.5;\n    }\n\n    h6 {\n        ${typography};\n        margin: 0;\n        line-height: 1.5;\n        font-size: 1.3rem;\n    }\n\n    hr {\n        margin: 0.5rem 1rem;\n        opacity: 0.25;\n    }\n\n    h1,\n    h2,\n    h3,\n    h4,\n    h5 {\n        button {\n            ${typography};\n            background: none;\n            padding: 0;\n            margin: 0;\n            border: none;\n            font-size: inherit;\n            color: ${styles.colors.text.active};\n            text-decoration: underline;\n            cursor: pointer;\n        }\n\n        svg {\n            font-size: 0.8em;\n        }\n    }\n\n    a {\n        ${typography};\n        color: ${styles.colors.text.active};\n        text-decoration: underline;\n    }\n\n    strong {\n        color: ${styles.colors.text.active};\n    }\n`;\n","import styled from '@emotion/styled';\nimport styles from 'styles';\n\nexport const GameScreens = styled.div`\n    ${styles};\n`;\n","import useSongIndex from 'Songs/hooks/useSongIndex';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport { useEffect } from 'react';\n\ninterface GetSongBpmSearchEntry {\n    song_id: string;\n    song_title: string;\n    song_uri: string;\n    tempo: string;\n    time_sig: string;\n    key_of: string;\n    open_key: null;\n    artist: {\n        id: string;\n        name: string;\n        uri: string;\n        img: string;\n        genres: string[];\n        from: string;\n        mbid: string;\n    };\n    album: {\n        title: string;\n        uri: string;\n        img: string;\n        year: string;\n    };\n}\n\nexport default function GetSongsBPMs(props: {}) {\n    useBackgroundMusic(false);\n    const songList = useSongIndex();\n\n    useEffect(() => {\n        if (songList.data) {\n            const bpms: Record<string, GetSongBpmSearchEntry | null> = {};\n            (async () => {\n                for (const song of songList.data) {\n                    if (song.realBpm) continue;\n                    const params = [\n                        `lookup=song:${encodeURIComponent(song.title)}+artist:${encodeURIComponent(song.artist)}`,\n                        'type=both',\n                        `api_key=${import.meta.env.VITE_APP_GET_SONG_BPM_API_TOKEN!}`,\n                    ].join('&');\n\n                    const response = await fetch(`https://api.getsongbpm.com/search/?${params}`);\n                    const getSongBPMData: { search: GetSongBpmSearchEntry[] } = await response.json();\n\n                    bpms[song.file] = Array.isArray(getSongBPMData.search) ? getSongBPMData.search[0] || null : null;\n                }\n                console.log(bpms);\n            })();\n        }\n    }, [songList.data]);\n\n    return <>Copy resulting object to `scripts/scraped-bpm-data.json` file and run fillMetadata script</>;\n}\n","import useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport ExcludeLanguagesView from './ExcludeLanguagesView';\n\ninterface Props {}\n\nfunction ExcludeLanguages(props: Props) {\n    const navigate = useSmoothNavigate();\n    const goBack = () => navigate('/');\n\n    return <ExcludeLanguagesView onClose={goBack} closeText=\"Return to Main Menu\" />;\n}\n\nexport default ExcludeLanguages;\n","import { MenuButton } from 'Elements/Menu';\nimport MenuWithLogo from 'Elements/MenuWithLogo';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport { MouseEventHandler } from 'react';\nimport { Link } from 'wouter';\n\ninterface Props {}\n\nfunction ManageSongs(props: Props) {\n    const navigate = useSmoothNavigate();\n    const goBack = () => navigate('/');\n\n    const { register } = useKeyboardNav({ onBackspace: goBack });\n\n    const handleClick: (url: string) => MouseEventHandler<HTMLAnchorElement> = (url) => (e) => {\n        e.preventDefault();\n        navigate(url);\n    };\n\n    return (\n        <MenuWithLogo>\n            <h1>Manage Songs</h1>\n            <Link href=\"/exclude-languages\" onClick={handleClick('/exclude-languages')}>\n                <MenuButton {...register('exclude-languages', () => navigate('/exclude-languages'))}>\n                    Select Song Languages\n                </MenuButton>\n            </Link>\n            <Link href=\"/edit\" onClick={handleClick('/edit')}>\n                <MenuButton {...register('edit-songs', () => navigate('/edit'))}>Edit songs</MenuButton>\n            </Link>\n            <Link href=\"/convert\" onClick={handleClick('/convert')}>\n                <MenuButton {...register('convert-song', () => navigate('/convert'))}>\n                    Convert UltraStar .txt\n                </MenuButton>\n            </Link>\n            <hr />\n            <MenuButton {...register('back-button', goBack)}>Return To Main Menu</MenuButton>\n        </MenuWithLogo>\n    );\n}\n\nexport default ManageSongs;\n","import styled from '@emotion/styled';\nimport { MenuButton, MenuContainer } from 'Elements/Menu';\nimport { MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\n\nfunction SuggestMobilePhone() {\n    const [, setMobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n\n    const setPhoneMode = async () => {\n        try {\n            setMobilePhoneMode(true);\n            await document.body.requestFullscreen();\n            window.screen.orientation.unlock();\n            await window.screen.orientation.lock('landscape');\n        } catch (e) {\n            console.info(e);\n        }\n    };\n\n    return (\n        <Container>\n            <Modal>\n                <h1>Use Mobile Phone Mode?</h1>\n                <h3>\n                    The regular version of the game isn't optimal for smaller screens. Enable the Mobile Phone Mode to\n                    adjust the UI and gameplay elements. Use this, or connect other mobiles to sing songs.\n                </h3>\n                <h3>\n                    You can always change the setting in the <strong>Settings</strong> menu.\n                </h3>\n                <MenuButton focused onClick={setPhoneMode} data-test=\"enable-mobile-mode\">\n                    Enable Mobile Phone Mode\n                </MenuButton>\n                <MenuButton onClick={() => setMobilePhoneMode(false)} data-test=\"dismiss-mobile-mode\">\n                    Dismiss\n                </MenuButton>\n            </Modal>\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    position: fixed;\n    inset: 0;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n`;\n\nconst Modal = styled(MenuContainer)`\n    max-width: 150rem;\n    padding: calc(min(3vw, 4vh));\n    margin: auto;\n    h1 {\n        font-size: calc(min(4vw, 5vh));\n        margin-bottom: 0.75em;\n    }\n    h3 {\n        font-size: calc(min(3vw, 4vh));\n        line-height: 1.25;\n        margin-bottom: 1em;\n    }\n    ${MenuButton} {\n        font-size: calc(min(3vw, 4vh));\n        height: auto;\n        padding: calc(min(3vw, 4vh));\n    }\n`;\n\nexport default SuggestMobilePhone;\n","import MenuWithLogo from 'Elements/MenuWithLogo';\nimport SuggestMobileMode from 'Scenes/QuickSetup/SuggestMobileMode';\nimport SelectInputView from 'Scenes/SelectInput/SelectInputView';\nimport { MicSetupPreference, MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport { useMemo } from 'react';\nimport isDev from 'utils/isDev';\n\ninterface Props {\n    // file?: string;\n}\n\nfunction QuickSetup(props: Props) {\n    const [mobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n    const isMobile = useMemo(\n        () =>\n            window.matchMedia(\n                'only screen and (((max-width: 500px) and (max-aspect-ratio: 10/16)) or ((max-height: 500px) and (min-aspect-ratio: 16/10)))',\n            ).matches,\n        [],\n    );\n\n    const navigate = useSmoothNavigate();\n    const onFinish = async (pref: (typeof MicSetupPreference)[number]) => {\n        navigate('/');\n        if (!isDev() && mobilePhoneMode && document.fullscreenElement === null) {\n            try {\n                await document.body.requestFullscreen();\n                window.screen.orientation.unlock();\n                await window.screen.orientation.lock('landscape');\n            } catch (e) {\n                console.info(e);\n            }\n        }\n    };\n\n    return (\n        <>\n            {mobilePhoneMode === null && isMobile ? (\n                <SuggestMobileMode />\n            ) : (\n                <MenuWithLogo>\n                    <SelectInputView onFinish={onFinish} closeButtonText=\"Sing a song\" smooth={false} />\n                </MenuWithLogo>\n            )}\n        </>\n    );\n}\n\nexport default QuickSetup;\n","import styled from '@emotion/styled';\nimport { MenuButton } from 'Elements/Menu';\nimport MenuWithLogo from 'Elements/MenuWithLogo';\nimport { nextValue, Switcher } from 'Elements/Switcher';\nimport events from 'GameEvents/GameEvents';\nimport { useEventListenerSelector } from 'GameEvents/hooks';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport { useEffect } from 'react';\nimport { useUpdate } from 'react-use';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport { DefaultRemoteMicPermission, RemoteMicPermissions, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport { useDevicePing } from 'Scenes/SingASong/SongSelection/SongSettings/MicCheck/Ping';\n\ninterface Props {}\n\nfunction RemoteMicSettings(props: Props) {\n    useBackgroundMusic(false);\n    const navigate = useSmoothNavigate();\n    const goBack = () => navigate('/settings');\n\n    const { register } = useKeyboardNav({ onBackspace: goBack });\n\n    const [defaultPermission, setDefaultPermission] = useSettingValue(DefaultRemoteMicPermission);\n    const remoteMics = useEventListenerSelector(events.inputListChanged, () => RemoteMicManager.getRemoteMics());\n\n    const forceUpdate = useUpdate();\n    useEffect(() => RemoteMicManager.addListener(forceUpdate), [forceUpdate]);\n\n    return (\n        <MenuWithLogo>\n            <h1>Remote Microphone Settings</h1>\n            <Switcher\n                {...register('default-permission', () =>\n                    setDefaultPermission(nextValue(RemoteMicPermissions, defaultPermission)),\n                )}\n                label=\"Default permission\"\n                info={\n                    <>\n                        <strong>WRITE</strong> - player is able to navigate the menus remotely and assign themselves and\n                        other players to the game.\n                        <br />\n                        <br />\n                        <strong>READ</strong> - player will only be able to use the device as a microphone and otherwise\n                        have no control over the game.\n                    </>\n                }\n                value={defaultPermission.toUpperCase()}\n            />\n            <hr />\n            <h3>Connected devices permissions:</h3>\n            {remoteMics.map((mic) => {\n                const permission = RemoteMicManager.getPermission(mic.id);\n                return (\n                    <RemoteMicEntry\n                        key={mic.id}\n                        {...register(\n                            `mic-${mic.id}`,\n                            () => RemoteMicManager.setPermission(mic.id, nextValue(RemoteMicPermissions, permission)),\n                            'Change permissions',\n                        )}\n                        data-test=\"remote-mic-entry\"\n                        data-id={mic.id}\n                        value={permission}\n                        label={\n                            <EntryLabel>\n                                <RemoteMicId>{mic.id.slice(-4)}</RemoteMicId>\n                                <RemoteMicPing>\n                                    <DevicePing deviceId={mic.id} />\n                                </RemoteMicPing>\n                                <RemoteMicName className=\"ph-no-capture\">{mic.name}</RemoteMicName>\n                            </EntryLabel>\n                        }\n                    />\n                );\n            })}\n            {remoteMics.length === 0 && <h4>No remote microphones connected</h4>}\n            <hr />\n            <MenuButton {...register('back-button', goBack)}>Return To Settings</MenuButton>\n        </MenuWithLogo>\n    );\n}\n\nconst DevicePing = ({ deviceId }: { deviceId: string }) => {\n    const latency = useDevicePing(deviceId);\n\n    return latency === null ? null : <>{latency}ms</>;\n};\n\nconst EntryLabel = styled.span`\n    text-transform: uppercase;\n`;\n\nconst RemoteMicEntry = styled(Switcher)`\n    text-transform: uppercase;\n`;\n\nconst RemoteMicName = styled.span``;\nconst RemoteMicId = styled.span`\n    font-size: 1.5rem;\n    padding-right: 1rem;\n`;\nconst RemoteMicPing = styled.span`\n    font-size: 1.5rem;\n    padding-right: 2rem;\n    text-transform: none;\n`;\nexport default RemoteMicSettings;\n","import { css } from '@emotion/react';\nimport styled from '@emotion/styled';\nimport { MenuContainer } from 'Elements/Menu';\nimport { MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport { useCallback, useState } from 'react';\n\nconst FBEmbedCode = (width: number, height: number) => {\n    const settings = {\n        show_posts: true,\n        width,\n        height,\n        small_header: true,\n        adapt_container_width: true,\n        hide_cover: false,\n        show_facepile: false,\n        // tabs: 'timeline',\n        appId: 530120230391395,\n    };\n\n    const qs = Object.entries(settings)\n        .map(([k, v]) => `${k}=${String(v)}`)\n        .join('&');\n    return `\n<iframe src=\"https://www.facebook.com/plugins/page.php?href=https%3A%2F%2Fwww.facebook.com%2Fallkaraoke.party&${qs}\" width=\"${width}\" height=\"${height}\" style=\"border:none;overflow:hidden\" scrolling=\"no\" frameborder=\"0\" allowfullscreen=\"true\" allow=\"autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share\"></iframe>\n`;\n};\nfunction FacebookLink() {\n    const [mobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n\n    const [width, setWidth] = useState(200);\n    const fbRef = useCallback((node: HTMLDivElement) => {\n        setWidth(Math.round(node?.getBoundingClientRect().width) ?? 200);\n    }, []);\n\n    return (\n        <Container small={!!mobilePhoneMode}>\n            <div\n                dangerouslySetInnerHTML={{ __html: FBEmbedCode(350, 750) }}\n                style={{\n                    height: 750 * (width / 350),\n                    width: '100%',\n                    transformOrigin: 'left top',\n                    transform: `scale(${width / 350})`,\n                }}\n            />\n            <h5 ref={fbRef}>Get updates, and help by suggesting features and reporting bugs.</h5>\n        </Container>\n    );\n}\n\nconst Container = styled(MenuContainer)<{ small: boolean }>`\n    position: absolute;\n    top: 2rem;\n    right: 10rem;\n    width: 37rem;\n    margin: 0;\n    text-decoration: none;\n    text-align: justify;\n    ${(props) =>\n        props.small &&\n        css`\n            width: 25rem;\n            right: 1rem;\n\n            h2 {\n                font-size: 1.5rem;\n            }\n            h5 {\n                font-size: 1.15rem;\n            }\n        `}\n\n    view-transition-name: fb-notification;\n`;\n\nexport default FacebookLink;\n","import styled from '@emotion/styled';\nimport { useBackground } from 'Elements/LayoutWithBackground';\nimport { MenuButton } from 'Elements/Menu';\nimport MenuWithLogo from 'Elements/MenuWithLogo';\nimport { typography } from 'Elements/cssMixins';\nimport { BackgroundMusicSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport FacebookLink from 'Scenes/Welcome/FacebookLink';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport { MouseEventHandler } from 'react';\nimport { Link } from 'wouter';\n\nfunction Welcome() {\n    const [backgroundMusicSelection] = useSettingValue(BackgroundMusicSetting);\n    useBackground(true);\n\n    const navigate = useSmoothNavigate();\n\n    const handleClick: (url: string) => MouseEventHandler<HTMLAnchorElement> = (url) => (e) => {\n        e.preventDefault();\n        navigate(url);\n    };\n\n    useBackgroundMusic(/* true */ false);\n    const { register } = useKeyboardNav();\n    return (\n        <MenuWithLogo>\n            {backgroundMusicSelection !== 'Classic' && (\n                <BackgroundMusicCredit>\n                    <span>\n                        Bpm data and release year provided by{' '}\n                        <a target=\"_blank\" href=\"https://getsongbpm.com/\" rel=\"noreferrer\">\n                            GetSongBPM\n                        </a>\n                    </span>\n                    <span>Song: Funk Cool Groove (Music Today 80)</span>\n                    <span> Composed & Produced by : Anwar Amr</span>\n                    <span>\n                         Video Link:{' '}\n                        <a href=\"https://youtu.be/FGzzBbYRjFY\" target=\"_blank\" rel=\"noreferrer\">\n                            https://youtu.be/FGzzBbYRjFY\n                        </a>\n                    </span>\n                </BackgroundMusicCredit>\n            )}\n            <FacebookLink />\n            <>\n                <Link href=\"/game/\" onClick={handleClick('/game/')}>\n                    <MenuButton {...register('sing-a-song', () => navigate('/game/'))}>Sing a song</MenuButton>\n                </Link>\n                <Link href=\"/select-input\" onClick={handleClick('/select-input')}>\n                    <MenuButton {...register('select-input', () => navigate('/select-input'))}>\n                        Setup Microphones\n                    </MenuButton>\n                </Link>\n                <Link href=\"/settings\" onClick={handleClick('/settings')}>\n                    <MenuButton {...register('settings', () => navigate('/settings'))}>Settings</MenuButton>\n                </Link>\n                <Link href=\"/jukebox\" onClick={handleClick('/jukebox')}>\n                    <MenuButton {...register('jukebox', () => navigate('/jukebox'))}>Jukebox</MenuButton>\n                </Link>\n                <Link href=\"/manage-songs\" onClick={handleClick('/manage-songs')}>\n                    <MenuButton {...register('manage-songs', () => navigate('/manage-songs'))}>Manage Songs</MenuButton>\n                </Link>\n            </>\n        </MenuWithLogo>\n    );\n}\n\nconst BackgroundMusicCredit = styled.div`\n    ${typography};\n    text-decoration: none;\n    flex-direction: column;\n    display: flex;\n    font-size: 1rem;\n    gap: 1.25rem;\n    opacity: 0.85;\n    position: absolute;\n    bottom: 1rem;\n    left: 1rem;\n\n    view-transition-name: background-music-credit;\n`;\n\nexport default Welcome;\n","import { Fullscreen, FullscreenExit } from '@mui/icons-material';\nimport { IconButton, Tooltip } from '@mui/material';\nimport 'RemoteMic/eventListeners';\nimport { MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport 'Stats';\nimport { useEffect, useState } from 'react';\n\nfunction FullscreenButton() {\n    const [mobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n    const [isFullScreen, setIsFullScreen] = useState(document.fullscreenElement !== null);\n\n    useEffect(() => {\n        const onChange = () => {\n            setIsFullScreen(document.fullscreenElement !== null);\n        };\n        document.addEventListener('fullscreenchange', onChange);\n\n        return () => {\n            document.removeEventListener('fullscreenchange', onChange);\n        };\n    }, []);\n\n    return (\n        <Tooltip title=\"Toggle fullscreen\">\n            <IconButton\n                size=\"small\"\n                onClick={async () => {\n                    try {\n                        if (document.fullscreenElement === null) {\n                            await document.body.requestFullscreen();\n                            if (mobilePhoneMode) {\n                                window.screen.orientation.unlock();\n                                await window.screen.orientation.lock('landscape');\n                            }\n                        } else {\n                            await document.exitFullscreen();\n                            if (mobilePhoneMode) {\n                                window.screen.orientation.unlock();\n                            }\n                        }\n                    } catch (e) {\n                        console.info(e);\n                    }\n                }}>\n                {isFullScreen ? <FullscreenExit /> : <Fullscreen />}\n            </IconButton>\n        </Tooltip>\n    );\n}\nexport default FullscreenButton;\n","import { Button } from 'Elements/Button';\nimport { MenuContainer } from 'Elements/Menu';\nimport Modal from 'Elements/Modal';\nimport 'RemoteMic/eventListeners';\nimport ConnectRemoteMic from 'Scenes/ConnectRemoteMic/ConnectRemoteMic';\nimport 'Stats';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\n\ninterface Props {\n    closeModal: () => void;\n}\nfunction QRCodeModal({ closeModal }: Props) {\n    const { register } = useKeyboardNav({\n        onBackspace: closeModal,\n    });\n\n    return (\n        <Modal onClose={closeModal}>\n            <MenuContainer>\n                <ConnectRemoteMic />\n                <Button {...register('quick-connect-close', closeModal)}>Close</Button>\n            </MenuContainer>\n        </Modal>\n    );\n}\n\nexport default QRCodeModal;\n","import styled from '@emotion/styled';\nimport { QrCode2 } from '@mui/icons-material';\nimport { IconButton, Tooltip } from '@mui/material';\nimport 'RemoteMic/eventListeners';\nimport { MobilePhoneModeSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport 'Stats';\nimport FullscreenButton from 'Toolbar/Fullscreen';\nimport QRCodeModal from 'Toolbar/QRCodeModal';\nimport { useState } from 'react';\n\nfunction Toolbar() {\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [mobilePhoneMode, setMobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n\n    const closeModal = () => setIsModalOpen(false);\n\n    return (\n        <>\n            {isModalOpen && <QRCodeModal closeModal={closeModal} />}\n            <ToolbarContainer>\n                <FullscreenButton />\n                <Tooltip title=\"Connect phone\">\n                    <IconButton\n                        size=\"small\"\n                        onClick={() => setIsModalOpen((current) => !current)}\n                        data-test=\"quick-connect-phone\">\n                        <QrCode2 />\n                    </IconButton>\n                </Tooltip>\n                {/*<Tooltip title=\"Toggle Mobile Phone Mode\">*/}\n                {/*    <IconButton*/}\n                {/*        size=\"small\"*/}\n                {/*        onClick={async () => {*/}\n                {/*            try {*/}\n                {/*                setMobilePhoneMode(!mobilePhoneMode);*/}\n                {/*                await document.body.requestFullscreen();*/}\n                {/*                window.screen.orientation.unlock();*/}\n                {/*                await window.screen.orientation.lock('landscape');*/}\n                {/*            } catch (e) {*/}\n                {/*                console.info(e);*/}\n                {/*            }*/}\n                {/*        }}>*/}\n                {/*        {mobilePhoneMode ? <Laptop /> : <PhoneIphone />}*/}\n                {/*    </IconButton>*/}\n                {/*</Tooltip>*/}\n            </ToolbarContainer>\n        </>\n    );\n}\n\nconst ToolbarContainer = styled.div`\n    view-transition-name: toolbar;\n\n    cursor: pointer;\n    background: rgba(0, 0, 0, 0.75);\n    color: white;\n    padding: 0.2rem;\n    padding-left: 1rem;\n    margin: 0;\n    position: fixed;\n    top: 0;\n    right: 0;\n    z-index: 10000;\n    color: white;\n\n    svg {\n        fill: white;\n        width: 3.5rem;\n        height: 3.5rem;\n        transition: 200ms;\n\n        &:hover {\n            transform: scale(1.2);\n        }\n    }\n\n    display: flex;\n    gap: 0.75rem;\n    border-bottom-left-radius: 1.5rem;\n`;\n\nexport default Toolbar;\n","import { ErrorBoundary } from '@sentry/react';\nimport { KeyboardHelpProvider } from 'Scenes/KeyboardHelp/Context';\nimport RemoteMic from 'Scenes/RemoteMic/RemoteMic';\nimport Settings from 'Scenes/Settings/Settings';\nimport { Redirect, Route, Router, useLocation } from 'wouter';\nimport Convert from './Scenes/Convert/Convert';\nimport Edit from './Scenes/Edit/Edit';\nimport SongList from './Scenes/Edit/SongList';\nimport Game from './Scenes/Game/Game';\nimport Jukebox from './Scenes/Jukebox/Jukebox';\nimport SelectInput from './Scenes/SelectInput/SelectInput';\n\nimport { Global, css } from '@emotion/react';\nimport { Theme, ThemeProvider, createTheme } from '@mui/material';\nimport { ErrorFallback } from 'Elements/ErrorFallback';\nimport { GameScreens } from 'Elements/GameScreens';\nimport LayoutWithBackgroundProvider from 'Elements/LayoutWithBackground';\nimport GetSongsBPMs from 'Scenes/Edit/GetSongsBPMs';\nimport ExcludeLanguages from 'Scenes/ExcludeLanguages/ExcludeLanguages';\nimport ManageSongs from 'Scenes/ManageSongs/ManageSongs';\nimport QuickSetup from 'Scenes/QuickSetup/QuickSetup';\nimport RemoteMicSettings from 'Scenes/Settings/RemoteMicSettings';\nimport {\n    GraphicSetting,\n    MicSetupPreferenceSetting,\n    MobilePhoneModeSetting,\n    useSettingValue,\n} from 'Scenes/Settings/SettingsState';\nimport Welcome from 'Scenes/Welcome/Welcome';\nimport Toolbar from 'Toolbar/Toolbar';\nimport { useEffect, useMemo } from 'react';\n\nfunction App() {\n    const [mobilePhoneMode] = useSettingValue(MobilePhoneModeSetting);\n    const [graphicSetting] = useSettingValue(GraphicSetting);\n    const [setupPreference] = useSettingValue(MicSetupPreferenceSetting);\n    const [location, navigate] = useLocation();\n\n    const theme = useMemo<Theme>(\n        () =>\n            createTheme({\n                graphicSetting,\n            }),\n        [graphicSetting],\n    );\n\n    useEffect(() => {\n        if (setupPreference === null && location === '/') {\n            navigate('/quick-setup');\n        } else if (setupPreference !== null && location === '/quick-setup') {\n            navigate('/');\n        }\n    }, []);\n\n    return (\n        <ThemeProvider theme={theme}>\n            <Global\n                styles={css`\n                    :root {\n                        --zoom-multipler: ${mobilePhoneMode ? 1.4 : 1};\n                    }\n                `}\n            />\n            <ErrorBoundary fallback={ErrorFallback}>\n                <LayoutWithBackgroundProvider>\n                    <KeyboardHelpProvider>\n                        <Router>\n                            <GameScreens>\n                                <Toolbar />\n                                <Route path=\"/game/:file?\">\n                                    {({ file }) => <Game file={file ? decodeURIComponent(file) : undefined} />}\n                                </Route>\n                                <Route path=\"/jukebox\" component={Jukebox} />\n                                <Route path=\"/remote-mic/:roomId\">\n                                    {({ roomId }) => <RemoteMic roomId={roomId!} />}\n                                </Route>\n                                <Route path=\"/phone/:roomId\">\n                                    {({ roomId }) => <Redirect to={`/remote-mic/${roomId}`} />}\n                                </Route>\n                                <Route path=\"/quick-setup\" component={QuickSetup} />\n                                <Route path=\"/select-input\" component={SelectInput} />\n                                <Route path=\"/settings\" component={Settings} />\n                                <Route path=\"/settings/remote-mics\" component={RemoteMicSettings} />\n                                <Route path=\"/manage-songs\" component={ManageSongs} />\n                                <Route path=\"/exclude-languages\" component={ExcludeLanguages} />\n                                <Route path=\"/\" component={Welcome} />\n                            </GameScreens>\n                            <Route path=\"/convert\" component={() => <Convert />} />\n                            <Route path=\"/edit\" component={SongList} />\n                            <Route path=\"/edit/get-songs-bpms\" component={GetSongsBPMs} />\n                            <Route path=\"/edit/:filename\">{({ filename }) => <Edit file={filename!} />}</Route>\n                        </Router>\n                    </KeyboardHelpProvider>\n                </LayoutWithBackgroundProvider>\n            </ErrorBoundary>\n        </ThemeProvider>\n    );\n}\n\nexport default App;\n","import '@fontsource/roboto';\nimport '@fontsource/roboto/900.css';\nimport 'GameEvents/eventListeners';\nimport 'Stats';\nimport 'utils/exposeSingletons';\n\nimport { init } from '@sentry/react';\nimport posthog from 'posthog-js';\nimport { createRoot } from 'react-dom/client';\nimport { toast, ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport isDev from 'utils/isDev';\nimport isE2E from 'utils/isE2E';\nimport { v4 } from 'uuid';\nimport App from './App';\nimport './index.css';\n\nif (import.meta.env.VITE_APP_SENTRY_DSN_URL) {\n    init({\n        dsn: import.meta.env.VITE_APP_SENTRY_DSN_URL,\n\n        // Set tracesSampleRate to 1.0 to capture 100%\n        // of transactions for performance monitoring.\n        // We recommend adjusting this value in production\n        tracesSampleRate: 1.0,\n        environment: isDev() ? 'development' : isE2E() ? 'e2e' : 'production',\n    });\n}\n\nif (!isE2E() && import.meta.env.VITE_APP_POSTHOG_KEY) {\n    posthog.init(import.meta.env.VITE_APP_POSTHOG_KEY, {\n        debug: true,\n        api_host: 'https://allkaraoke-posthog.fly.dev',\n        test: isDev() || window.location.port !== '',\n        loaded: (ph) => {\n            let storedUser = localStorage.getItem('posthog-user-id');\n            if (!storedUser) {\n                storedUser = v4();\n                localStorage.setItem('posthog-user-id', storedUser);\n            }\n            ph.identify(storedUser);\n        },\n    });\n}\n\nconst container = document.getElementById('root');\nconst root = createRoot(container!);\n\nroot.render(\n    <>\n        <App />\n        <ToastContainer position={toast.POSITION.BOTTOM_LEFT} theme={'colored'} />\n    </>,\n);\n"],"names":["Listener","listeners","onUpdate","args","forEach","callback","addListener","listener","push","removeListener","filter","clearAllListeners","console","log","CAMERA_GRANT_KEY","storedGrant","localStorage","getItem","CameraManager","constructor","stream","recorder","videoData","permissionGranted","JSON","parse","requestPermissions","navigator","mediaDevices","getUserMedia","video","stopRecord","setItem","stringify","disable","startRecord","frameRate","settings","getVideoTracks","getSettings","width","height","canvas","srcObject","play","MediaRecorder","mimeType","ondataavailable","evt","data","start","getVideo","blob","Blob","type","URL","createObjectURL","_a","stop","_b","getTracks","track","clearData","length","restartRecord","getPermissionStatus","document","createElement","CameraManager$1","GameEvent","name","subscribers","lastParams","subscribe","getLast","unsubscribe","cb","dispatch","capture","Function","events","sectionChange","undefined","songStarted","songEnded","remoteMicConnected","remoteMicDisconnected","playerNameChanged","playerInputChanged","player","oldI","newI","old","source","new","inputListChanged","karaokeConnectionStatusChange","remoteMicPlayerSet","remoteMicMonitoringStarted","remoteMicMonitoringStopped","micMonitoringStarted","micMonitoringStopped","playerChangeRequested","songStatStored","songScoreUpdated","remoteMicSubscribed","remoteKeyboardPressed","remoteSongSearch","remoteMicListUpdated","remoteKeyboardLayout","remoteReadinessRequested","remoteMicPermissionsSet","readinessConfirmed","getPingTime","Date","now","pack","msgpackr","unpack","buffer","sendEvent","connection","payload","send","t","RemoteMicInput$2","frequencies","volumes","requestReadinessPromise","getChannelsCount","getFrequencies","freqs","Array","isArray","at","getVolumes","getInputLag","requestReadiness","Promise","resolve","off","on","startMonitoring","handleRTCData","stopMonitoring","RemoteMic$1","id","pingTime","pingInterval","getInput","input","setPlayerNumber","playerNumber","onDisconnect","clearInterval","setPermission","level","isPinging","latency","onPong","pingClient","setTimeout","getLatency","RemoteMicInput","Setting","defaultValue","driver","value","get","window","set","newValue","newListener","GraphicsLevel","GRAPHICS_LEVEL_KEY","GraphicSetting","MicSetupPreference","MIC_SETUP_PREFERENCE_KEY","MicSetupPreferenceSetting","FpsCount","FPSCountSetting","ExcludedLanguagesSetting","MobilePhoneModeSetting","InputLagSetting","RemoteMicPermissions","DefaultRemoteMicPermission","BackgroundMusic","BackgroundMusicSetting","useSettingValue","currentValue","setCurrentValue","useState","useEffect","abstractStorage","storeValue","key","getValue","val","storage","session","sessionStorage","RememberedAccessesKey","RememberedSubscriptionsKey","RemoteMicManager","remoteMics","micAccessMap","subscriptions","addRemoteMic","silent","remoteMic","RemoteMic","getPermission","removeRemoteMic","find","getRemoteMics","getRemoteMicById","broadcast","event","broadcastToChannel","channel","permission","addSubscription","Set","removeSubscription","remoteMicId","RemoteMicManager$1","CURRENT_VISIT_KEY","LAST_VISIT_KEY","VISIT_TIMEOUT_MS","currentTime","currentVisit","Number","isFirstVisit","defaultLastVisit","lastVisit","String","isNotesSection","section","notes","getFirstNoteStartFromSections","sections","firstNoteSection","Infinity","getLastNoteEndFromSections","lastSection","getLastNoteEnd","lastNote","getNoteAtBeat","beat","tolerance","note","ALPHANUMERIC_REGEX","clearString","str","toLowerCase","normalize","replace","generateSearchString","song","artist","title","getSongPreview","file","songData","local","tracksCount","tracks","map","search","localForage","createInstance","DELETED_SONGS_KEY","SongDao","finalIndex","indexWithDeletedSongs","store","generateSongFile","lastUpdate","toISOString","reloadIndex","fileName","localSong","getLocal","fetch","then","response","json","getIndex","includeDeleted","getCurrentIndex","getDeletedSongsList","extension","defaultIndex","storageIndex","deletedSongs","all","getLocalIndex","lastVisitDate","localSongs","includes","isNew","isAfter","isDeleted","sort","a","b","localeCompare","deleteSong","removeItem","softDeleteSong","deletedItems","restoreSong","item","decodeURIComponent","getKeys","specialKeys","keys","SongDao$1","ROOM_ID_KEY","WEBSOCKETS_SERVER","import","WebSocketServerTransport","pswd","close","connect","roomId","onConnect","onClose","WebSocket","binaryType","onopen","addEventListener","message","sender","conn","SenderWrapper","peer","socket","recipients","callbacksMap","Map","actualCallback","removeEventListener","delete","TheServer","transport","started","custom","deleted","language","getRoomId","v4","isE2E","isE2ETests","location","e2eOverrides","host","port","path","options","P2PServer","Peer","peerJSOptions","warn","state","disconnect","urlParams","URLSearchParams","toString","server","isWebsockets","DrawingTestInput","deviceId","setFrequency","getStatus","DrawingTestInput$1","DummyInput","timestamp","interval","isMonitoring","setInterval","Math","sin","cos","dummyInput","AubioStrategy","init","context","Pitch","aubio","detector","sampleRate","setTolerance","getFrequency","do","getSampleSize","UserMediaService","status","requestAndTrack","enumerateDevices","fnc","setStatus","result","e","newStatus","userMediaService","MicInput","startedMonitoring","echoCancellation","audio","exact","AudioContext","createMediaStreamSource","splitter","createChannelSplitter","analyserCh0","createAnalyser","fftSize","minDecibels","analyserCh1","strategy","dataCh0","Float32Array","dataCh1","getFloatTimeDomainData","calculateVolume","captureException","error","i","sum","sqrt","MicInput$1","mic","RemoteMicInput$1","getInputId","inputs","channels","label","DrawingTestInputSource","inputName","getDefault","getInputs","subscribeToListChange","unsubscribeToListChange","singstarWirelessMicMapper","test","singstarWiredMicMapper","singstarGenericMapper","getPreferred","ch","mapInputName","MicrophoneInputSource","_MicrophoneInputSource","inputList","devices","device","kind","getCapabilities","channelCount","max","range","preferred","flat","mapRemoteMicToInput","RemoteMicrophoneInputSource","InputManager","getInputStatus","PlayersManager","getPlayer","sourceNameToInput","getPlayerFrequency","getPlayerVolume","getPlayerInputLag","getPlayers","monitoringStarted","sourceName","InputManager$1","DummyInputSource","selectedPlayerInputToId","InputSourceListManager","initialiseInputSource","lazily","list","loadMics","Microphone","getInputList","getInputForPlayerSelected","returnDefault","InputSources","SELECTED_INPUTS_KEY","PlayerEntity","number","nameOverride","changeInput","restartMonitoringPromise","newInput","oldInput","toJSON","getName","isDefaultName","setName","newName","oldName","_PlayerEntity","fromJSON","players","requestingPromise","storePlayers","request","some","inputSourceListManager","storedPlayers","WebRTCServer","_","microphone","debounce","PlayersManager$1","unselectedRemoteMic","selectedRemoteMic","playerNumberIndex","phoneId","newPlayerNumber","currentPlayerNumber","toast","success","jsxs","Fragment","jsx","warning","sendPlayerStates","trackSongData","setup","scores","sameScores","every","score","index","posthog","mode","mobilePhoneMode","reduce","curr","getSongKey","fetchSongStats","storageKey","plays","storeSongStats","stats","currentState","date","PLAYER_NAMES_SESSION_STORAGE_KEY","PREVIOUS_PLAYER_NAMES_STORAGE_KEY","singSetup","currentNames","thisPlayNames","trim","newNamesSet","concat","Boolean","__","SimplifiedMic","noiseSuppression","autoGainControl","freq","volume","SimplifiedMic$1","MIC_ID_KEY","roundTo","num","precision","multiplier","pow","round","WebSocketClientTransport","isConnected","readyState","clientId","onError","onmessage","onclose","reason","info","onerror","PeerJSClientTransport","unavailableIdRetries","unavailableIdRetryTimeout","connectToRoom","open","disconnected","debug","destroy","TheClient","reconnecting","connected","sendFrequencies","throttle","onFrequencyUpdate","getClientId","setClientId","connectToServer","reconnect","pingStart","pinging","ping","p","help","getElementById","remove","reload","sendKeyStroke","searchSong","requestPlayerChange","confirmReadiness","getSongList","sendRequest","reject","timeout","clearTimeout","client","getSongBeatLength","memoize","bpm","bar","GAME_MODE","DUEL","PASS_THE_MIC","CO_OP","noDistanceNoteTypes","noPointsNoteTypes","MIDDLEA","SEMITONE","MAX_NAME_LENGTH","pitchToFrequency","pitchFromFrequency","getDistanceInCents","noteFreq","floor","getCentDistance","targetNote","cents","distance","sign","abs","calcDistanceBetweenPitches","noteDistance","calcDistance","frequency","GameState","getTolerance","preciseDistance","WINDOW_SIZE","detectVibrato","opChangePoints","change","lastChange","changePoints","intervals","slice","record","maxInterval","minInterval","min","averageIntervals","SINGING_BREAK_TOLERANCE_MS","appendFrequencyToPlayerNotes","playerNotes","beatLength","noteCandidate","pitch","breakToleranceBeat","noteEndBeat","isThisNoteDifferentThanLast","isDistanceDifferent","roundedStart","isPerfect","vibrato","frequencyRecords","lastPlayerNoteEndBeat","lastNoteEndBeat","roundedLength","getPlayerNoteDistance","MAX_POINTS","noteTypesMultipliers","freestyle","rap","star","normal","perfect","countsToBeats","counts","sumDetailedScore","beatsToPoints","pointsPerBeat","addDetailedScores","s1","s2","divideDetailedScores","divideBy","countSungBeats","calculateDetailedScoreData","trackNumber","beatsPerTrack","maxCounts","calculateScore","getCurrentBeat","gap","currentBeat","PlayerState","gameState","realFrequencyRecords","realPlayerNotes","storedSectionIndex","getNumber","update","getCurrentTime","currentTimestamp","lastRealRecord","lastTimestamp","timestampStep","updatePlayerNotes","dispatchSectionUpdate","currentSectionIndex","getCurrentSectionIndex","recordBeat","recordSection","getSectionByBeat","getPlayerNotes","getPlayerFrequencies","getSectionIndexByBeat","getTrack","findIndex","getCurrentSection","sectionIndex","getNextSection","getPreviousSection","getLastNotesSection","last","getScore","getSong","getTrackIndex","getDetailedScore","getMinPitch","getMaxPitch","getSingSetup","resetNotes","duration","playerStates","setCurrentTime","accountGap","setSong","setSingSetup","setDuration","getDuration","getPlayerCount","getPlayerScore","playerState","getPlayerDetailedScore","fs","pointsScores","summedPoints","pointsScore","tuple","startInputMonitoring","stopInputMonitoring","resetPlayerNotes","GameState$1","__exposeSingletons","__singletons","WebRTCClient","GameEvents","inputManager","InputSourceManager","inputSources","isDev","process","useEventListener","setValue","subscriber","useEventEffect","effect","eventList","useEventListenerSelector","selector","dependencies","initialValueRef","useMemo","blueFillBase","blueFill","blueStroke","redFillBase","redFill","redStroke","playerColors","text","fill","stroke","lineWidth","starPerfect","hit","miss","styles","colors","lines","active","activeBorder","default","inactive","focusable","props","css","focused","focusAnimation","keyframes","typography","REGULAR_ALPHA_CHARS","keyboard","lock","supportsEscAsBack","paramsToKeys","up","down","left","right","accept","back","random","keyToParam","keyCode","Object","entries","useKeyboard","params","enabled","deps","handledKeys","param","join","hkEvent","preventDefault","stopPropagation","useIsVisible","createPersistedState","KeyboardHelpView","isVisible","setIsVisible","useHotkeys","helps","Container","UseKeyboardIndicator","view","Component","defaultLabel","KeyhelpComponent","Section","SectionHelp","SectionKeys","Kbd","HelpIcon","HorizontalVerticalBase","vertical","horizontal","Horizontal","Vertical","HorizontalVertical","Accept","KeyboardReturn","Back","ShiftLetter","letter","toUpperCase","shiftR","_styled","target","collapsed","disabled","KeyboardHelpContext","createContext","setKeyboard","helpEntry","unsetKeyboard","KeyboardHelpProvider","children","keyboards","setKeyboards","kbs","omit","remote","rest","BackgroundContext","visible","setVisibility","useBackground","shouldBeVisible","background","useContext","LayoutWithBackgroundProvider","setVisible","useCallback","Background","BackgroundStatic","theme","graphicSetting","NormalizeFontSize","size","MicIcon","SvgIcon","MicIconRed","MicIconBlue","BottomBar","setActiveTab","ItemContainer","ItemIcon","ItemTitle","ListIcon","SettingsIcon","Button","buttonFocused","buttonFocusedAnimation","MenuButton","MenuContainer","nextIndex","values","current","direction","nextValueIndex","indexOf","nextValue","Switcher","onClick","restProps","ConfigurationPosition","ConfigValue","InfoText","expanded","Input","forwardRef","onChange","className","adornment","forwardedRef","inputRef","useRef","focus","Label","StyledInput","Adornment","usePersistedName","Connect","connectionStatus","connectionError","handleConnect","showConnectionTip","setShowConnectionTip","Form","ConnectButton","CircularProgress","Warning","QrCode2","Wifi","useDebounce","delay","debouncedValue","setDebouncedValue","handler","RemoteSongSearch","onSearchStateChange","setSearch","isOpen","setIsOpen","onOpen","debouncedSearch","useUnmount","Search","RemoteMicKeyboard","isHorizontal","isVertical","onPress","ActionsContainer","ArrowsContainer","ArrowButton","KeyboardArrowUp","KeyboardArrowLeft","Games","KeyboardArrowRight","KeyboardArrowDown","ActionButton","ArrowBack","ArrowForward","Break","Shuffle","flex","ButtonBase","_ref","Modal","Backdrop","PlayerChangeModal","onModalClose","header","selectPlayer","joined","Menu","color","PlayerNumberCircle","PlayerColorCircle","PlayerChange","memo","closeModal","PlayerChangeContainer","SwapHorizIcon","usePermissions","permissions","VolumeIndicator","isMicOn","maxVolume","setMaxVolume","backgroundColor","indicatorColor","IndicatorContainer","Debug","Indicator","transform","MicPreview","setVolume","updateVolumes","Ping","setLatency","useMicrophoneStatus","isOpera","userAgent","allowMic","enableMicOpera","enableMic","getProperEnableMicImage","UserMediaEnabled","fallback","showImages","WarningContainer","WarningIcon","AdditionalInfo","setMonitoringStarted","isKeepAwakeOn","setIsKeepAwakeOn","searchActive","setSearchActive","body","requestFullscreen","screen","orientation","unlock","micPreview","Panel","NoPermissionsMsg","KeepAwake","MicInputState","collapse","ConfirmReadiness","onConfirm","isAfterReload","setIsAfterReload","confirm","ReadyButton","ManagePlayers","Entry","setOpen","RemoteMicEntry","RemoteMicId","RemoteMicName","isSelf","RemoteSettings","reset","useSongIndex","songIndex","setSongIndex","emptyList","loadSongs","isLoading","generateLangMap","langNames","Intl","DisplayNames","langMap","j","code","fromCharCode","of","Akan","Hebrew","Indonesian","Javanese","Romanian","Yiddish","Tagalog","English","Korean","Swedish","Latin","langMap2","languageNameToIsoCode","RemoteSongList","originalSongList","overrides","setOverrides","songList","uniqBy","SongItemContainer","Language","ArtistTitle","Title","Artist","noSleep","NoSleep","activeTab","setKeepAwake","turnOn","isEnabled","enable","BottomBarFiller","dotparty","logo","pride","Logo","PrideLogo","StyledLogo","DotParty","isChromium","RecommendedBrowsers","RecommendChrome","GithubRibbon","Ribbon","position","top","border","transformOrigin","MenuWithLogo","supportedBrowsers","cameraSound","waitFinishedSound","classicBackgroundMusicSound","backgroundMusic$2","menuBackSound","menuEnterSound","menuNavigateSound","menuNavigate","Howl","src","menuEnter","menuBack","waitFinished","preload","backgroundMusic","backgroundMusicSound","loop","classicBackgroundMusic","useBackgroundMusic","backgroundMusicSelection","music","playing","useKeyboardHelp","setHelp","clearHelp","useKeyboardNav","onBackspace","backspaceHelp","additionalHelp","currentlySelected","setCurrentlySelected","elementList","newElementList","actions","currentlySelectedActionLabel","handleEnter","handleBackspace","handleNavigation","currentIndex","defaultSelection","register","onActive","isDefault","propName","keyboardNavigationChangeFocus","newElements","focusElement","startViewTransition","useSmoothNavigate","baseNavigate","useLocation","to","smooth","__enableSmooth","InputLag","inputLag","setInputLag","InputLagField","blur","Settings","navigate","goBack","graphicLevel","setGraphicLevel","fpsCount","setFpsCount","setMobilePhoneMode","setBackgroundMusic","inputLagRef","camera","setCamera","isRequestInProgress","setIsRequestInProgress","enableCamera","cameraValue","Pre","inputAction","action","InputProps","endAdornment","Tooltip","mr","typesMap","R","F","getPropertyValueFromTxt","txt","regex","RegExp","match","vals","split","LINE_BREAK_RELATIVE_REGEXP","getVideoId","url","searchParams","safeJsonParse","convertTxtToSong","videoLink","author","authorUrl","sourceUrl","trackNames","additionalData","year","edition","genre","videoGap","realBpm","previewStart","previewEnd","linkUrl","lastStart","line","startsWith","end","lyrics","AuthorAndVid","searchForVideo","encodeURIComponent","songArtist","songTitle","isSearchableForVideo","videoId","Box","display","flexWrap","TextField","mt","flexDirection","alignItems","YouTube","importSongFromSource","urlObj","importUsDbAnimuxSong","importUltrastarEsSong","doc","DOMParser","parseFromString","txtUrl","querySelector","getAttribute","href","authorPath","textContent","obj","useFixDiacritics","BasicData","onSourceUrlEdit","shouldAutoImport","onAutoImport","attemptFixDiacritics","setAttemptFixDiacritics","isTxtRequired","txtInput","fixDiacritics","inputProps","FormControlLabel","Switch","checked","replaceAll","formatMs","msec","minutes","seconds","miliseconds","padStart","ytPlayerAdapter","playVideo","pause","pauseVideo","seekTo","timeSec","setPlaybackSpeed","rate","setPlaybackRate","ms","py","mb","MIN_PREVIEW_LENGTH","PreviewAndVolumeAdjustment","reference","initialised","setInitialised","getInternalPlayer","currentVolume","getVolume","isPlayerPlaying","setIsPlayerPlaying","isReferencePlaying","setIsReferencePlaying","handleSliderChange","internalPlayer","Slider","currentTarget","SongMetadata","definedLanguages","definedGenres","l","searchGoogle","phrase","Grid","Autocomplete","AdjustPlayback","effectsEnabled","onEffectsToggle","seekBy","bySec","currentSpeed","setCurrentSpeed","Typography","ButtonGroup","px","Divider","speed","useCurrentSectionIndex","wholeBeat","EditSection","onRecordChange","onTrackNameChange","setTrack","selectedSection","setSelectedSection","changeRecords","setChangeRecords","onSectionClick","deleteSection","records","selected","shiftSection","newStart","lastRecord","newRecords","shift","SectionEdtiorContainer","Stack","ml","List","overflowY","ListItem","ListItemButton","ListItemText","fontWeight","SectionEditForm","step","SectionChangeList","maxHeight","SectionChangeDelete","SectionChangeShift","ChangeEntry","ListTracks","calculateProperBPM","desiredEndMs","notesSections","desiredLengthMs","bpmLength","toFixed","beatToMs","ManipulateBpm","lastNoteEndMs","desiredLastNoteEnd","setDesiredLastNoteEnd","ShiftGap","finalGap","ShiftVideoGap","HEADSTART_MS","shortenNoteSections","getSectionEnd","addPauseSections","padSizeBeats","lastEnd","sectionsWithPauses","normaliseSectionPaddings","desiredPadding","shiftSections","shiftBeats","addHeadstart","desiredHeadstart","actualHeadstart","normaliseGap","earliestTrack","currentNoteStart","thisNoteStart","firstSection","normaliseSpaces","normaliseLyricSpaces","usePlayerVolume","playerRef","useUnstuckOnStartSong","currentStatus","playerKey","setPlayerKey","UNSTARTED","useUnstuckOnBuffering","BUFFERING","onLine","useUnstuckYouTubePlayer","VideoState","ENDED","PLAYING","PAUSED","CUED","stateMap","YoutubeVideoPlayer","autoplay","startAt","controls","disablekb","onStateChange","ref","setCurrentStatus","setSize","useImperativeHandle","w","h","newVolume","loadVideoById","opts","playerVars","rel","modestbranding","DirectVideo","createCallback","onPlay","onPause","onEnded","playerApi","time","dummyVideo","OfflineVideoPlayer","VideoPlayer","VITE_REACT_APP_OFFLINE","Heading","SCompletedAnim","Lottie","completedAnimationSegment","CompletedAnim","completedAnimation","SelectPreference","onPreferenceSelected","previouslySelected","onBack","skipText","Option","OptionIconContainer","PhoneAndroid","PhoneIphone","OptionDescription","PhotoCamera","QrCode","Person","Laptop","Usb","moreInfoMixin","usePlayerMicData","intervalMs","onMeasure","playerVolume","playerFrequency","usePlayerMic","setData","VolumeIndicatorBase","percent","PlayerMicCheck","elem","setElem","style","linkObject","ConnectRemoteMic","useRoute","pathname","link","QRCode","QRCodeSVG","Description","QRCodeInstruction","CopyLinkInstruction","InputCopyContainer","InputCopy","CopyButton","clipboard","writeText","useMicrophoneList","load","usePlayerInput","sources","sourceList","selectedPlayerInput","playerInputData","playerInput","cycleSource","startingIndex","nextSource","cycleInput","newIndex","useRemoteMicAutoselect","nextPlayerToAutoSwitch","isWindows","PlayerSelector","SwitcherWithPlayerHeader","SwitcherWithMicCheck","MicCheck","Advanced","onSetupComplete","micInputs","isDifferentMics","onSave","closeButtonText","names","MicCheckContainer","BuiltIn","selectedMic","Mics","setMic","autoselect","defaultDevice","cycleMic","Header","changePreference","RemoteMics","onContinue","isComplete","SingStarMics","showAdvancedTip","setShowAdvancedTip","isSetup","isSameDeviceId","isMicInput","areAllPreferred","listChanged","setListChanged","initial","Skip","LAST_SELECTED_KEY","SelectInputView","onFinish","playerNames","preference","setPreference","setIsComplete","wasMonitoring","storedPreference","setStoredPreference","storePreference","pref","SelectInputModal","PauseMenu","onResume","onExit","onRestart","menuRef","isInputModalOpen","setIsInputModalOpen","getSongFirstNoteMs","firstNote","SKIP_INTRO_MS","getSkipIntroTime","SKIP_INTRO_THRESHOLD_MS","songHasLongIntro","SkipIntro","hasLongIntro","songFirstNoteMs","canSkip","skipIntro","SHOW_OUTRO_THRESHOLD_MS","SkipOutro","onSongEnd","singingEndBeat","singingEndTime","setCurrentBeat","skipping","setSkipping","useInterval","skipOutro","SkipOutro$1","React","DurationBar","firstNotes","uniq","v","lastNotes","durationMs","Bar","Marker","BarFill","BaseMarker","BaseBarFill","useDevicePing","PingContainer","PlayerStatus","tooltipPosition","StatusContainer","ThumbUpAlt","UnavailableIcon","UnstableIcon","StatusDescription","ErrorIcon","usePlayerMicStatus","LyricsVolumeIndicator","bottom","StyledPlayerStatus","StyledPing","Lyrics","playerChanges","playerColor","thisPlayerChanges","nextSection","subsequentSection","previousChange","nextChange","timeToNextChange","passTheMicProgress","shouldBlink","hasNotes","beatsBetweenSectionAndNote","LyricsContainer","PassTheMicProgress","LyricsLine","HeadstartContainer","Headstart","LyricContainer","LyricActiveContainer","LyricActive","endsWith","PassTheMicSymbol","BaseHeadstart","BaseLyricActive","clipPath","BasePassTheMicProgress","progress","shouldForwardProp","prop","shouldShake","nextLine","formatter","NumberFormat","maximumFractionDigits","ScoreText","format","getColor","ctx","isStar","isHit","getNoteColor","playerNote","triangle","x","y","angle","alpha","save","finalX","finalY","translate","rotate","PI","globalAlpha","fillStyle","beginPath","moveTo","lineTo","restore","spreadValue","spread","randomSign","baseTtlMs","ttlSpreadMs","velocityModifier","SungTriangle","finished","tick","delta","percentage","ttl","startingTtl","ticksLeft","heightModifier","velocityX","velocityY","initialAngle","randomFloat","from","randomInt","pitchPadding","NOTE_HEIGHT","BIG_NOTE_HEIGHT","calculateData","songBeatLength","minPitch","maxPitch","paddingVertical","currentSection","pixelsOverRatio","paddingHorizontal","sectionEndBeat","timeSectionGap","maxTime","canvasHeight","pitchStepHeight","simpleRoundRect","radius","actualWidth","actualRadius","quadraticCurveTo","closePath","roundRect","glass","clip","fillRect","applyColor","strokeStyle","drawRawNote","noteType","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","drawRawPlayerNote","SHADOW_PAD","smallNoteFragments","middle","bigNoteFragments","spriteMap","blueMiss","draw","padding","fragments","blueHit","bluePerfect","blueStarMiss","blueStarHit","blueStarPerfect","redMiss","redHit","redPerfect","redStarMiss","redStarHit","redStarPerfect","noteNormal","noteStar","noteFreestyle","noteRap","createCanvas","maxWidth","sprite","add","cachedCanvas","getContext","currentHeight","positions","pads","acc","entry","getSprite","fragment","drawSprite","destCtx","destX","destY","destW","destH","paddingWScale","paddingHScale","spriteData","finalWPadding","finalHPadding","imageSmoothingEnabled","drawImage","drawSpriteWithStartAndEnd","spriteName","startData","widthScale","endingsWidth","endingsSize","middleSize","getSpriteName","capitalize","drawNote","drawPlayerFrequencyTrace","lineJoin","drawPlayerNote","ParticleManager","particles","lastTick","getTimeDelta","timeShift","currentTick","particle","ParticleManager$1","baseTtl","ttlSpread","TriangleParticle","elapsedTicks","ExplodingNoteParticle","particleManager","lightColor","tinycolor","lighten","toRgbString","darkColor","darken","density","rand","finalColor","initialTtl","FadeoutNote","loadImage","image","Image","onload","particleImage","imageLoaded","img","velocity","WIDTH","WIDTH_SPREAD","easeOutQuart","RayParticle","seed","widthModifier","easing","mainRayWidth","mainRayHeight","INTERVAL_PX","VibratoParticle","deltaY","getPlayerNoteAtBeat","CanvasDrawing","verticalMargin","scaleFactor","pauseTime","pausedOn","onSectionEnd","drawFrame","resume","isPlaying","startTime","clearRect","drawPlayer","endTime","baseTimeout","finalTimeout","requestAnimationFrame","playerCount","drawingData","getDrawingData","displacements","calculateDisplacements","drawNotesToSing","drawSungNotes","drawFlare","getNoteCoords","currentPlayerNotes","displacement","getPreciseY","fadeoutNotes","explodeNotes","sungNotesStreak","sungNote","currLength","sungNoteLength","displacementRange","displacementX","displacementY","sectionShift","big","regionPaddingTop","sectionStart","dx","dy","pitchY","MAX_RENDER_RESOLUTION_W","GameOverlay","playerSetups","videoPlayerRef","isPauseMenuVisible","drawer","overlayWidth","overlayHeight","overlayScaleFactor","resolutionScaleFactor","offsetHeight","showMultipleLines","Screen","GameCanvas","Scores","usePlayerSetDuration","dur","Player","showControls","onTimeUpdate","onStatusChange","restartSong","onStateChangeCallback","Overlay","PlayerContainer","shiftGap","gapShift","shiftVideoGap","setBpm","applyChanges","changes","trackIndex","changeList","applyTrackNames","playerWidth","playerHeight","EditSong","setGapShift","videoGapShift","setVideoGapShift","overrideBpm","setOverrideBpm","setEffectsEnabled","setTrackNames","newSong","processed","cloneDeep","newShift","HelpText","newNames","SyncLyricsToVideo","steps","Convert","songs","currentStep","setCurrentStep","basicData","setBasicData","authorAndVid","setAuthorAndVid","metadataEntity","setMetadataEntity","editedSong","setEditedSong","conversionResult","possibleDuplicate","addedSong","property","isBasicInfoCompleted","isAuthorAndVidCompleted","isNextStepAvailable","finalSong","StyledEngineProvider","marginBottom","Link","Stepper","Step","StepButton","Alert","AlertTitle","justifyContent","align","fixVideoGap","processSong","useSong","loadedSong","Edit","txtTypesMap","invert","toTxtValue","notesToText","convertSongToTxt","parsedValues","first","SongList","initialSearch","columns","accessorKey","Cell","cell","MaterialReactTable","row","IconButton","original","EditIcon","anchor","download","appendChild","click","removeChild","Download","DataObject","VisibilityOff","Visibility","Delete","columnVisibility","globalFilter","showGlobalFilter","useLanguageList","langs","lang","langId","count","languages","MIN_SONGS_COUNT","ExcludeLanguagesView","closeText","excludedLanguages","setExcludedLanguages","availableLanguages","languageList","otherSongCount","songCount","toggleLanguage","languageNames","preferredLanguages","toExclude","areAllLanguagesExcluded","LanguageListContainer","excluded","LanguageEntry","Check","CheckBoxOutlineBlank","CheckBox","LanguageName","LanguageFlagBackground","Disclaimer","NextButtonContainer","CountUp","filteringFunctions","excludeLanguages","songLang","cleanSearch","duet","yearBefore","yearAfter","updatedAfter","after","dateAfter","applyFilters","appliedFilters","filters","useLanguageFilter","useSongListFilter","setFilters","deferredFilters","useDeferredValue","prefilteredList","filteredList","filtersData","available","allSongs","useSongList","groupedSongList","groups","newSongs","firstCharacter","isFinite","group","MAX_REMEMBERED_SONGS_COUNT","selectRandomSong","previouslySelectedSongs","maxRememberedCount","possibleOptions","usePrevious","useTwoDimensionalNavigation","itemsPerRow","cursorPosition","setCursorPosition","songIndexMatrix","chunk","songGroupMatrix","previousMatrix","isAtLastColumn","moveToSong","positionToValue","matrix","def","positionToSongIndex","positionToGroup","previousFocusedSong","currentFocusedSong","moveCursor","plane","newX","newY","maxXInRow","focusedSong","focusedGroup","useSongSelectionKeyboardNavigation","groupedSongs","onEnter","songsPerRow","showPlaylistsState","setShowPlaylistsState","previousPlaylistsState","arePlaylistsVisible","leavingKey","isAtFirstColumn","blockBack","setBlockBack","previousSearch","useLayoutEffect","navigateToGroup","currentGroup","nextGroupIndex","trailing","navigateVertically","repeat","currentlySelectedGroupIndex","navigateHorizontally","ignoreFilters","randomlySelectedSongs","randomSong","closePlaylist","previousShowFilters","enteringKey","useSongSelection","preselectedSong","keyboardControl","setKeyboardControl","showFilters","setShowFilters","preselected","setPreselected","preselectedSongIndex","firstNewSongIndex","songPreview","usePlaylists","songLanguages","addDays","playlist","Playlists","playlists","Playlist","QuickSearch","onSongFiltered","searchInput","isFocused","setIsFocused","onLeave","enableOnTags","focusSearch","searchLength","FilterItem","large","SHOW_TIP_TIMEOUT_MS","SelectRandomTip","useSongStats","setStats","setSongStats","useEditScore","singId","newScores","previousScore","newData","FinalSongCard","handleClick","onClickCallback","SongCardContainer","SongCardBackground","backgroundImage","SongInfo","SongCardStatsIndicator","MultiTrackIndicator","PeopleAltIcon","SongListEntryDetailsArtist","SongListEntryDetailsTitle","SongAuthor","SongListEntryStats","SongListEntryDetails","lastPlayed","playedToday","SongStatIndicator","gameModeNames","difficultyNames","useSetGameMode","useSetTolerance","GameSettings","onNextStep","onExitKeyboardControl","rememberedMode","setMode","handleNextButton","changeMode","changeTolerance","GSSwitcher","ModeDescription","PlayButton","NoiseDetection","isBuiltIn","measures","handleMeasure","noiseDetected","setNoiseDetected","noDetection","detection","avgNoDetectionVolume","avgDetectionVolume","isNoisy","NoiseWarningContainer","SinglePlayer","PlayerName","MicChecksContainer","placeholder","onBlur","autocompleteMenu","isInputFocused","setIsInputFocused","focusedOption","setFocusedOption","filteredOptions","option","handleKeyDown","scrollIntoView","behavior","block","handleBlur","AutocompleteMenu","AutocompleteMenuitem","getTrackName","multipleTracks","inputTouched","setInputTouched","nameRef","togglePlayerTrack","onNameChange","currentName","Track","PlayerSettings","playerSetup","setPlayerSetup","updatePlayer","newSetup","showModal","setShowModal","startSong","areInputsConfigured","PlayerSettingContainer","PlayerSettingTitle","SongSettings","setStep","onSongStepFinish","finalSetup","GameConfiguration","useViewportSize","windowSize","setWindowSize","handleResize","clientWidth","visualViewport","PREVIEW_LENGTH","SongPreviewComponent","focusEffect","showVideo","setShowVideo","windowWidth","windowHeight","undebounced","startSeconds","endSeconds","finalWidth","finalHeight","SongBPMIndicator","SongPreviewContainer","Video","Content","BaseSongPreviewContainer","animationDuration","show","ContentBase","BaseSongBPMIndicator","useTheme","mounts","useBlockScroll","classList","documentElement","focusMultiplier","MAX_SONGS_PER_ROW","SongSelection","onSongSelected","previewTop","previewLeft","previewWidth","previewHeight","setPositions","onRemoteSearch","previouslyFocusedGroup","previouslyFocusedSong","previousSong","offsetTop","inline","offsetLeft","offsetWidth","expandSong","LoaderContainer","SongListContainer","NoSongsFound","SongPreview","SongsGroupContainer","SongsGroupHeader","SongsGroup","SongListEntry","highlight","dim","SingASong","languageSelection","setLanguageSelection","useFullscreen","catch","TransitionWrapper","CSSTransition","sleep","AUTOSTART_TIMEOUT_S","WaitForReadiness","areAllPlayersReady","setAreAllPlayersReady","confirmedPlayers","setConfirmedPlayers","allInputsReady","inputsReady","minTimeElapsed","maxTimeElapsed","race","paused","playerStatuses","confirmed","WaitingForReady","PlayerList","PlayerEntry","ConfirmStatus","CheckCircleOutline","TimeoutMessage","MAX_SECTION_PAUSE_MS","getSingableBeats","segmentSections","noteSections","segments","lastSegment","lastSectionEnd","calculateAmplitude","sums","shiftSolution","takeFromLeft","pos","pop","takeFromRight","ceil","arrSum","arr","generatePlayerChanges","currentBuffer","idealSize","CHANGES_COUNT","segmentSingableBeatsCount","bufferSum","currentAmplitude","candidates","candidatesAmplitudes","minimalAmplitude","minimalAmplitudeIndex","GameTip","as","randomValue","CameraRoll","videoSrc","setVideoSrc","playbackRate","SongPage","FocusedSongContainer","BackgroundImage","ContentLayer","FocusedSongData","SongTitle","SongArtist","SongCreator","BaseBackgroundImage","ContentElement","MAX_POINTS_ANIM_LENGTH","MIN_POINTS_ANIM_LENGTH","PlayerScoreView","highestScore","highScores","useColors","revealHighScore","setAnimDone","playerScore","detailedScore","isHighScore","playerName","singSetupId","ScoreTextPlayer","ScoreTextScore","HighScoreBadge","win","highscore","ResultsView","isCoop","finalPlayers","finishedAnims","setFinishedAnims","isAnimDone","anim","playerScores","ScoresContainer","which","SongSelectionButton","StyledPhotoRoll","useRecentPlayerNames","HighScoreRename","setNewName","HighScoresView","editScore","ScoreContainer","ScorePosition","ScorePlayerName","ScoreScore","ScoreDate","isCurrentSing","PostGameView","onClickSongSelection","PostGameTip","useHighScores","singleScore","PostGame","Singing","songFile","returnToSongSelection","isEnded","setIsEnded","setPlayerState","isTransitionTimeout","setIsTransitionTimeout","BackgroundContainer","BaseOverlay","Game","setPreselectedSong","resetKey","setResetKey","handleSelect","Jukebox","currentlyPlaying","setCurrentlyPlaying","shuffledList","setShuffledList","shuffle","playNext","navigateUrl","SkipSongButton","PlayThisSongButton","SelectInput","ErrorFallback","resetError","origin","clear","GameScreens","GetSongsBPMs","bpms","VITE_APP_GET_SONG_BPM_API_TOKEN","getSongBPMData","ExcludeLanguages","ManageSongs","SuggestMobilePhone","setPhoneMode","QuickSetup","isMobile","matchMedia","matches","fullscreenElement","SuggestMobileMode","RemoteMicSettings","defaultPermission","setDefaultPermission","forceUpdate","useUpdate","EntryLabel","RemoteMicPing","DevicePing","FBEmbedCode","show_posts","small_header","adapt_container_width","hide_cover","show_facepile","appId","k","FacebookLink","setWidth","fbRef","node","getBoundingClientRect","__html","small","Welcome","BackgroundMusicCredit","FullscreenButton","isFullScreen","setIsFullScreen","exitFullscreen","FullscreenExit","Fullscreen","QRCodeModal","Toolbar","isModalOpen","setIsModalOpen","ToolbarContainer","App","setupPreference","createTheme","ThemeProvider","Global","ErrorBoundary","Router","Route","Redirect","filename","dsn","tracesSampleRate","environment","api_host","loaded","ph","storedUser","identify","container","root","createRoot","render","ToastContainer","POSITION","BOTTOM_LEFT"],"mappings":"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"}
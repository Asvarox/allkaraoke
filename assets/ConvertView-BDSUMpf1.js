import{r as d,p as Y,o as J,h as N,b as k,i as W,a as K,j as t,k as F,l as H,G as Te,al as Ge,B as Be,am as Ue,q as E,ak as U,a4 as Me,a8 as ze,an as we,ao as Re,c as Pe,ap as Z,aq as $e,ar as Fe,ab as me,as as Ve,at as De,w as ee,t as Oe,e as We,E as Ke,au as He,av as ue,aw as _e,ax as qe,ay as Ye,az as Je,aA as ge,aB as Ze,aC as Qe,aD as Xe,aE as et,a9 as tt,aF as at,aa as nt,ac as rt,S as ie,g as ot,aG as st,ai as it,ad as lt}from"./index-CkYc-P0x.js";import{B as T,q as M,k as P,N as ve,L as pe,T as z,O as ct,E as be,J as R,z as le,i as dt,I as ut,w as pt,o as ye,j as ht,Q as xt,R as mt,p as ft,U as X,V as gt,S as Se,e as vt,h as bt,W as yt,A as St,r as Ct}from"./ShareSongsModal-LTPh_hmN.js";function jt(e){return d.Children.toArray(e).filter(a=>d.isValidElement(a))}const kt=d.createContext({}),ae=kt,Lt=d.createContext({}),se=Lt;function It(e){return Y("MuiStep",e)}J("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const Tt=["active","children","className","component","completed","disabled","expanded","index","last"],Bt=e=>{const{classes:a,orientation:n,alternativeLabel:r,completed:o}=e;return H({root:["root",n,r&&"alternativeLabel",o&&"completed"]},It,a)},Mt=N("div",{name:"MuiStep",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:n}=e;return[a.root,a[n.orientation],n.alternativeLabel&&a.alternativeLabel,n.completed&&a.completed]}})(({ownerState:e})=>k({},e.orientation==="horizontal"&&{paddingLeft:8,paddingRight:8},e.alternativeLabel&&{flex:1,position:"relative"})),wt=d.forwardRef(function(a,n){const r=W({props:a,name:"MuiStep"}),{active:o,children:s,className:i,component:u="div",completed:c,disabled:p,expanded:x=!1,index:h,last:S}=r,l=K(r,Tt),{activeStep:v,connector:j,alternativeLabel:w,orientation:B,nonLinear:g}=d.useContext(ae);let[C=!1,L=!1,m=!1]=[o,c,p];v===h?C=o!==void 0?o:!0:!g&&v>h?L=c!==void 0?c:!0:!g&&v<h&&(m=p!==void 0?p:!0);const b=d.useMemo(()=>({index:h,last:S,expanded:x,icon:h+1,active:C,completed:L,disabled:m}),[h,S,x,C,L,m]),I=k({},r,{active:C,orientation:B,alternativeLabel:w,completed:L,disabled:m,expanded:x,component:u}),y=Bt(I),f=t.jsxs(Mt,k({as:u,className:F(y.root,i),ref:n,ownerState:I},l,{children:[j&&w&&h!==0?j:null,s]}));return t.jsx(se.Provider,{value:b,children:j&&!w&&h!==0?t.jsxs(d.Fragment,{children:[j,f]}):f})}),ne=wt,Rt=Te(t.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),Pt=Te(t.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function $t(e){return Y("MuiStepIcon",e)}const At=J("MuiStepIcon",["root","active","completed","error","text"]),ce=At;var Ce;const Et=["active","className","completed","error","icon"],Nt=e=>{const{classes:a,active:n,completed:r,error:o}=e;return H({root:["root",n&&"active",r&&"completed",o&&"error"],text:["text"]},$t,a)},de=N(Ge,{name:"MuiStepIcon",slot:"Root",overridesResolver:(e,a)=>a.root})(({theme:e})=>({display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),color:(e.vars||e).palette.text.disabled,[`&.${ce.completed}`]:{color:(e.vars||e).palette.primary.main},[`&.${ce.active}`]:{color:(e.vars||e).palette.primary.main},[`&.${ce.error}`]:{color:(e.vars||e).palette.error.main}})),Gt=N("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(e,a)=>a.text})(({theme:e})=>({fill:(e.vars||e).palette.primary.contrastText,fontSize:e.typography.caption.fontSize,fontFamily:e.typography.fontFamily})),Ut=d.forwardRef(function(a,n){const r=W({props:a,name:"MuiStepIcon"}),{active:o=!1,className:s,completed:i=!1,error:u=!1,icon:c}=r,p=K(r,Et),x=k({},r,{active:o,completed:i,error:u}),h=Nt(x);if(typeof c=="number"||typeof c=="string"){const S=F(s,h.root);return u?t.jsx(de,k({as:Pt,className:S,ref:n,ownerState:x},p)):i?t.jsx(de,k({as:Rt,className:S,ref:n,ownerState:x},p)):t.jsxs(de,k({className:S,ref:n,ownerState:x},p,{children:[Ce||(Ce=t.jsx("circle",{cx:"12",cy:"12",r:"12"})),t.jsx(Gt,{className:h.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:x,children:c})]}))}return c}),zt=Ut;function Ft(e){return Y("MuiStepLabel",e)}const Vt=J("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),_=Vt,Dt=["children","className","componentsProps","error","icon","optional","slotProps","StepIconComponent","StepIconProps"],Ot=e=>{const{classes:a,orientation:n,active:r,completed:o,error:s,disabled:i,alternativeLabel:u}=e;return H({root:["root",n,s&&"error",i&&"disabled",u&&"alternativeLabel"],label:["label",r&&"active",o&&"completed",s&&"error",i&&"disabled",u&&"alternativeLabel"],iconContainer:["iconContainer",r&&"active",o&&"completed",s&&"error",i&&"disabled",u&&"alternativeLabel"],labelContainer:["labelContainer",u&&"alternativeLabel"]},Ft,a)},Wt=N("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:n}=e;return[a.root,a[n.orientation]]}})(({ownerState:e})=>k({display:"flex",alignItems:"center",[`&.${_.alternativeLabel}`]:{flexDirection:"column"},[`&.${_.disabled}`]:{cursor:"default"}},e.orientation==="vertical"&&{textAlign:"left",padding:"8px 0"})),Kt=N("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(e,a)=>a.label})(({theme:e})=>k({},e.typography.body2,{display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),[`&.${_.active}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${_.completed}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${_.alternativeLabel}`]:{marginTop:16},[`&.${_.error}`]:{color:(e.vars||e).palette.error.main}})),Ht=N("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(e,a)=>a.iconContainer})(()=>({flexShrink:0,display:"flex",paddingRight:8,[`&.${_.alternativeLabel}`]:{paddingRight:0}})),_t=N("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(e,a)=>a.labelContainer})(({theme:e})=>({width:"100%",color:(e.vars||e).palette.text.secondary,[`&.${_.alternativeLabel}`]:{textAlign:"center"}})),Ae=d.forwardRef(function(a,n){var r;const o=W({props:a,name:"MuiStepLabel"}),{children:s,className:i,componentsProps:u={},error:c=!1,icon:p,optional:x,slotProps:h={},StepIconComponent:S,StepIconProps:l}=o,v=K(o,Dt),{alternativeLabel:j,orientation:w}=d.useContext(ae),{active:B,disabled:g,completed:C,icon:L}=d.useContext(se),m=p||L;let b=S;m&&!b&&(b=zt);const I=k({},o,{active:B,alternativeLabel:j,completed:C,disabled:g,error:c,orientation:w}),y=Ot(I),f=(r=h.label)!=null?r:u.label;return t.jsxs(Wt,k({className:F(y.root,i),ref:n,ownerState:I},v,{children:[m||b?t.jsx(Ht,{className:y.iconContainer,ownerState:I,children:t.jsx(b,k({completed:C,active:B,error:c,icon:m},l))}):null,t.jsxs(_t,{className:y.labelContainer,ownerState:I,children:[s?t.jsx(Kt,k({ownerState:I},f,{className:F(y.label,f==null?void 0:f.className),children:s})):null,x]})]}))});Ae.muiName="StepLabel";const qt=Ae;function Yt(e){return Y("MuiStepButton",e)}const Jt=J("MuiStepButton",["root","horizontal","vertical","touchRipple"]),je=Jt,Zt=["children","className","icon","optional"],Qt=e=>{const{classes:a,orientation:n}=e;return H({root:["root",n],touchRipple:["touchRipple"]},Yt,a)},Xt=N(Be,{name:"MuiStepButton",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:n}=e;return[{[`& .${je.touchRipple}`]:a.touchRipple},a.root,a[n.orientation]]}})(({ownerState:e})=>k({width:"100%",padding:"24px 16px",margin:"-24px -16px",boxSizing:"content-box"},e.orientation==="vertical"&&{justifyContent:"flex-start",padding:"8px",margin:"-8px"},{[`& .${je.touchRipple}`]:{color:"rgba(0, 0, 0, 0.3)"}})),ea=d.forwardRef(function(a,n){const r=W({props:a,name:"MuiStepButton"}),{children:o,className:s,icon:i,optional:u}=r,c=K(r,Zt),{disabled:p,active:x}=d.useContext(se),{orientation:h}=d.useContext(ae),S=k({},r,{orientation:h}),l=Qt(S),v={icon:i,optional:u},j=Ue(o,["StepLabel"])?d.cloneElement(o,v):t.jsx(qt,k({},v,{children:o}));return t.jsx(Xt,k({focusRipple:!0,disabled:p,TouchRippleProps:{className:l.touchRipple},className:F(l.root,s),ref:n,ownerState:S,"aria-current":x?"step":void 0},c,{children:j}))}),re=ea;function ta(e){return Y("MuiStepper",e)}J("MuiStepper",["root","horizontal","vertical","alternativeLabel"]);function aa(e){return Y("MuiStepConnector",e)}J("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const na=["className"],ra=e=>{const{classes:a,orientation:n,alternativeLabel:r,active:o,completed:s,disabled:i}=e,u={root:["root",n,r&&"alternativeLabel",o&&"active",s&&"completed",i&&"disabled"],line:["line",`line${E(n)}`]};return H(u,aa,a)},oa=N("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:n}=e;return[a.root,a[n.orientation],n.alternativeLabel&&a.alternativeLabel,n.completed&&a.completed]}})(({ownerState:e})=>k({flex:"1 1 auto"},e.orientation==="vertical"&&{marginLeft:12},e.alternativeLabel&&{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"})),sa=N("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(e,a)=>{const{ownerState:n}=e;return[a.line,a[`line${E(n.orientation)}`]]}})(({ownerState:e,theme:a})=>{const n=a.palette.mode==="light"?a.palette.grey[400]:a.palette.grey[600];return k({display:"block",borderColor:a.vars?a.vars.palette.StepConnector.border:n},e.orientation==="horizontal"&&{borderTopStyle:"solid",borderTopWidth:1},e.orientation==="vertical"&&{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24})}),ia=d.forwardRef(function(a,n){const r=W({props:a,name:"MuiStepConnector"}),{className:o}=r,s=K(r,na),{alternativeLabel:i,orientation:u="horizontal"}=d.useContext(ae),{active:c,disabled:p,completed:x}=d.useContext(se),h=k({},r,{alternativeLabel:i,orientation:u,active:c,completed:x,disabled:p}),S=ra(h);return t.jsx(oa,k({className:F(S.root,o),ref:n,ownerState:h},s,{children:t.jsx(sa,{className:S.line,ownerState:h})}))}),la=ia,ca=["activeStep","alternativeLabel","children","className","component","connector","nonLinear","orientation"],da=e=>{const{orientation:a,alternativeLabel:n,classes:r}=e;return H({root:["root",a,n&&"alternativeLabel"]},ta,r)},ua=N("div",{name:"MuiStepper",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:n}=e;return[a.root,a[n.orientation],n.alternativeLabel&&a.alternativeLabel]}})(({ownerState:e})=>k({display:"flex"},e.orientation==="horizontal"&&{flexDirection:"row",alignItems:"center"},e.orientation==="vertical"&&{flexDirection:"column"},e.alternativeLabel&&{alignItems:"flex-start"})),pa=t.jsx(la,{}),ha=d.forwardRef(function(a,n){const r=W({props:a,name:"MuiStepper"}),{activeStep:o=0,alternativeLabel:s=!1,children:i,className:u,component:c="div",connector:p=pa,nonLinear:x=!1,orientation:h="horizontal"}=r,S=K(r,ca),l=k({},r,{alternativeLabel:s,orientation:h,component:c}),v=da(l),j=d.Children.toArray(i).filter(Boolean),w=j.map((g,C)=>d.cloneElement(g,k({index:C,last:C+1===j.length},g.props))),B=d.useMemo(()=>({activeStep:o,alternativeLabel:s,connector:p,nonLinear:x,orientation:h}),[o,s,p,x,h]);return t.jsx(ae.Provider,{value:B,children:t.jsx(ua,k({as:c,ownerState:l,className:F(v.root,u),ref:n},S,{children:w}))})}),xa=ha;function ma(e){var n;const a=new URL((n=global.location)==null?void 0:n.href);Object.entries(e).forEach(([r,o])=>{o===null?a.searchParams.delete(r):a.searchParams.set(r,o)}),global.history.replaceState(null,"",a.toString())}const oe=U("span",{target:"eu1xhb40"})({name:"1n7r223",styles:"font-family:monospace"}),he=(e,a,n="Lookup")=>({InputProps:{endAdornment:t.jsx(Me,{title:a?"Open search results for the song":"Artist or title of the song is unknown",children:t.jsx("span",{children:t.jsx(T,{sx:{mr:-1},endIcon:t.jsx(ze,{}),color:"secondary",variant:"text",onClick:e,disabled:!a,children:n})})})}});function fa(e){const a=()=>{global.open(`https://www.youtube.com/results?search_query=${encodeURIComponent((e==null?void 0:e.songArtist)+" "+(e==null?void 0:e.songTitle))}`,"_blank")},n=!!e.songTitle&&!!e.songArtist,r=we(e.data.video);return t.jsxs(M,{sx:{display:"flex",flexWrap:"wrap"},"data-test":"author-and-vid",children:[t.jsx(P,{"data-test":"author-name",sx:{mt:2},value:e.data.author,onChange:o=>e.onChange({...e.data,author:o.target.value}),label:"Author name (optional)",fullWidth:!0,size:"small",helperText:"Nickname of the person that created the .txt file."}),t.jsx(P,{"data-test":"author-url",sx:{mt:2},value:e.data.authorUrl,onChange:o=>e.onChange({...e.data,authorUrl:o.target.value}),label:"Author URL (optional)",helperText:"Link to authors page/profile.",fullWidth:!0,size:"small"}),t.jsx(M,{sx:{display:"flex",flexDirection:"row",mt:2,alignItems:"center",width:"100%"},children:t.jsx(P,{"data-test":"video-url",required:!0,value:e.data.video,onChange:o=>e.onChange({...e.data,video:o.target.value}),label:"YouTube Video URL",placeholder:"https://www.youtube.com/watch?v=",fullWidth:!0,size:"small",helperText:"Link to YouTube video, eg https://www.youtube.com/watch?v=xxxxxxxxx. Click the 'Lookup' button to look for it on YouTube",name:"videoUrl",...he(a,n)})}),r&&t.jsx(M,{children:t.jsx(Re,{videoId:r})})]})}const ga={polish:{Ãˆ:"Ã©",Ã­:"'","Â¥":"'","Â¯":"Å»","Â¹":"Ä…",Ï€:"Ä…",Ãª:"Ä™",Ã:"Ä™",Å’:"Åš",Ã¥:"Åš",Å“:"Å›",Ãº:"Å›",Ã¦:"Ä‡",ÃŠ:"Ä‡","Â¿":"Å¼",Ã¸:"Å¼",Ã˜:"Å»",Ã±:"Å„",Ã’:"Å„","Â³":"Å‚","â‰¥":"Å‚","Â£":"Å",Ã›:"Ã³",Ã¼:"Åº",Å¸:"Åº"},spanish:{Ã¸:"Â¿",Ãˆ:"Ã©",ÃŒ:"Ã­",Ã’:"Ã±",Å„:"Ã±","Â·":"Ã¡",Ã›:"Ã³","Â°":"!","Ë™":"Ãº",Å›:"Ãº"}};function va(e,a){const n=ga[a];if(n===void 0)return e;let r=e;for(const[o,s]of Object.entries(n))r=r.replaceAll(o,s);return r}function ba(e){const a=e.split(`
`),n=["#TITLE","#ARTIST","#BPM"];for(const r of n)if(!a.some(o=>o.startsWith(r)))return!1;if(!a.some(r=>r.startsWith(":")))return!1;try{Pe(e)}catch(r){return console.log(r),!1}return!0}async function ya(e){try{const a=new URL(e);if(a.host==="usdb.animux.de")return Ca(e,a);if(a.host==="ultrastar-es.org")return Sa(e)}catch(a){console.warn(a)}}async function Sa(e){var c,p,x,h;const n=await(await fetch(`https://backend.allkaraoke.party/proxy?url=${encodeURIComponent(e)}`)).text(),r=new DOMParser().parseFromString(n,"text/html"),s=`https://ultrastar-es.org/pl/canciones/descargar/txt/${(c=r.querySelector("ul[data-id]"))==null?void 0:c.getAttribute("data-id")}`;global.location.href=s;const i=(p=r.querySelector("#listado > ul > li > dl > dd:nth-child(6) > a"))==null?void 0:p.getAttribute("href"),u=(x=r.querySelector("#listado > ul > li"))==null?void 0:x.getAttribute("data-id");return{authorUrl:i?"https://ultrastar-es.org"+i:"",author:((h=r.querySelector("#listado > ul > li > dl > dd:nth-child(6)"))==null?void 0:h.textContent)??"",video:u?"https://www.youtube.com/watch?v="+u:""}}async function Ca(e,a){var p,x,h,S,l;const r=await(await fetch(`https://backend.allkaraoke.party/proxy?url=${encodeURIComponent(e)}`)).text(),o=new DOMParser().parseFromString(r,"text/html"),s=(p=o.querySelector('a[href^="?link=profil&id="]'))==null?void 0:p.textContent,i=(h=(x=o.querySelector('a[href^="?link=profil&id="]'))==null?void 0:x.getAttribute)==null?void 0:h.call(x,"href"),u=(S=o.querySelector("#tablebg > tbody > tr:nth-child(3) > td > table:nth-child(2) > tbody > tr.list_head > td:nth-child(1)"))==null?void 0:S.textContent,c=(l=o.querySelector("#tablebg > tbody > tr:nth-child(3) > td > table:nth-child(2) > tbody > tr.list_head > td:nth-child(2)"))==null?void 0:l.textContent;return global.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(u+" "+c)}`,"_blank"),global.open(`http://usdb.animux.de/index.php?link=gettxt&id=${a.searchParams.get("id")}`,"_blank"),{authorUrl:i?"http://usdb.animux.de/index.php"+i:"",author:s??"",video:""}}function ja(e){var s,i;const a=async u=>{if(e.onChange({...e.data,sourceUrl:u.target.value}),e.shouldAutoImport){const c=await ya(u.target.value);c&&e.onAutoImport(c)}},n=u=>{e.onChange({...e.data,txtInput:va(e.data.txtInput,u)})},o=!d.useMemo(()=>ba(e.data.txtInput),[e.data.txtInput])&&e.data.txtInput.length>0;return t.jsxs(M,{sx:{display:"flex",flexWrap:"wrap"},"data-test":"basic-data",children:[e.isTxtRequired&&t.jsxs("div",{children:[t.jsx("h4",{children:"Where to find songs?"}),t.jsxs("p",{children:["Any UltraStar compatible .txt file will do. You can find many already made songs on"," ",t.jsx("a",{href:"https://usdb.animux.de/",target:"_blank",rel:"noreferrer",children:"usdb.animux.de"})," or ",t.jsx("a",{href:"https://ultrastar-es.org/en",target:"_blank",rel:"noreferrer",children:"ultrastar-es.org"}),".",t.jsx("br",{}),t.jsx("br",{})]}),t.jsx("p",{children:"You don't need audio/video files, you'll be able to search for appropriate YouTube video and synchronise the lyrics to it in subsequent steps."})]}),t.jsx(P,{sx:{mt:2},value:e.data.sourceUrl,onChange:a,label:"Source URL (optional)",fullWidth:!0,size:"small","data-test":"source-url",helperText:"The link to the page from which the .TXT file was downloaded."}),e.isTxtRequired?t.jsxs(t.Fragment,{children:[t.jsx(P,{error:o,helperText:o?"This doesn't look like a valid UltraStar .TXT format":"",required:!0,sx:{mt:2},fullWidth:!0,size:"small",multiline:!0,label:"Song's UltraStar .TXT file contents",onChange:u=>e.onChange({...e.data,txtInput:u.target.value}),value:e.data.txtInput,maxRows:15,minRows:15,InputProps:{inputProps:{"data-test":"input-txt",sx:{fontFamily:"monospace"}}}}),t.jsxs(M,{sx:{display:"flex",gap:1,mt:1},children:[t.jsx(T,{onClick:()=>n("polish"),children:"Fix ðŸ‡µðŸ‡± Polish accents"}),t.jsx(T,{onClick:()=>n("spanish"),children:"Fix ðŸ‡ªðŸ‡¸ Spanish accents"})]})]}):t.jsx(M,{sx:{display:"flex",width:"100%",height:500,overflow:"auto"},children:(i=(s=e.finalSong)==null?void 0:s.tracks)==null?void 0:i.map((u,c)=>t.jsxs(M,{sx:{flex:1},children:[t.jsx("h4",{children:u.name??`Track #${c+1}`}),u.sections.filter(Z).map(p=>t.jsx("p",{children:p.notes.map(x=>x.lyrics).join("")},p.start))]},c))})]})}const ka=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],La=e=>{const{classes:a,inset:n,primary:r,secondary:o,dense:s}=e;return H({root:["root",n&&"inset",s&&"dense",r&&o&&"multiline"],primary:["primary"],secondary:["secondary"]},ct,a)},Ia=N("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:n}=e;return[{[`& .${ve.primary}`]:a.primary},{[`& .${ve.secondary}`]:a.secondary},a.root,n.inset&&a.inset,n.primary&&n.secondary&&a.multiline,n.dense&&a.dense]}})(({ownerState:e})=>k({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},e.primary&&e.secondary&&{marginTop:6,marginBottom:6},e.inset&&{paddingLeft:56})),Ta=d.forwardRef(function(a,n){const r=W({props:a,name:"MuiListItemText"}),{children:o,className:s,disableTypography:i=!1,inset:u=!1,primary:c,primaryTypographyProps:p,secondary:x,secondaryTypographyProps:h}=r,S=K(r,ka),{dense:l}=d.useContext(pe);let v=c??o,j=x;const w=k({},r,{disableTypography:i,inset:u,primary:!!v,secondary:!!j,dense:l}),B=La(w);return v!=null&&v.type!==z&&!i&&(v=t.jsx(z,k({variant:l?"body2":"body1",className:B.primary,component:p!=null&&p.variant?void 0:"span",display:"block"},p,{children:v}))),j!=null&&j.type!==z&&!i&&(j=t.jsx(z,k({variant:"body2",className:B.secondary,color:"text.secondary",display:"block"},h,{children:j}))),t.jsxs(Ia,k({className:F(B.root,s),ownerState:w,ref:n},S,{children:[v,j]}))}),Ba=Ta,Ma={AF:"Afghanistan",AX:"Ã…land Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"South Korea",KR:"North Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia",MD:"Moldova",MC:"Monaco",MN:"Mongolia",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",SH:"Saint Helena",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",CS:"Serbia and Montenegro",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Vietnam",VI:"Virgin Islands",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},Ee=e=>{const a=Math.floor(e/1e3/60),n=Math.floor(e/1e3)-a*60,r=Math.floor(e%1e3);return t.jsxs(oe,{children:[String(a).padStart(2,"0"),":",String(n).padStart(2,"0"),".",String(r).padStart(3,"0")]})},wa=e=>"playVideo"in e?{play:()=>e.playVideo(),pause:()=>e.pauseVideo(),seekTo:a=>e.seekTo(a,!0),setPlaybackSpeed:a=>e.setPlaybackRate(a)}:e,te=(e,a)=>t.jsx(Me,{title:"Click to play the moment just before this time",placement:"top",arrow:!0,children:t.jsx(T,{sx:{py:.15,mb:.5},variant:"contained",size:"small",disabled:!a,onClick:a?()=>{$e.resetPlayerNotes(),wa(a).seekTo((e??0)/1e3-.7)}:void 0,children:Ee(e??0)})}),Ra=Ee,ke=10;function Pa({data:e,onChange:a,videoId:n,videoGap:r=0}){var g;const o=d.useRef(null),s=d.useRef(null),[i,u]=d.useState(!1);d.useEffect(()=>{(async()=>{var C,L,m,b;e.volume===0?(a({...e,volume:.5}),await((L=(C=o.current)==null?void 0:C.getInternalPlayer())==null?void 0:L.setVolume(50))):await((b=(m=o.current)==null?void 0:m.getInternalPlayer())==null?void 0:b.setVolume(e.volume*100)),u(!0)})()},[]),d.useEffect(()=>{if(!i)return;const C=setInterval(async()=>{var m,b;const L=await((b=(m=o.current)==null?void 0:m.getInternalPlayer())==null?void 0:b.getVolume());L!==void 0&&L!==e.volume*100&&a({...e,volume:L/100})},500);return()=>{clearInterval(C)}},[i,e,a]);const[c,p]=d.useState(!1),[x,h]=d.useState(!1),S=async(C,L)=>{var m,b;await((b=(m=o.current)==null?void 0:m.getInternalPlayer())==null?void 0:b.setVolume(+L*100)),a({...e,volume:+L})},l=e.previewStart??r+60,v=e.previewEnd??l+30,[j,w]=d.useState(null);d.useEffect(()=>{var C,L;s.current&&(s.current.currentTime=35),(L=(C=o.current)==null?void 0:C.getInternalPlayer())==null||L.getDuration().then(w)},[]);const B=(g=o.current)==null?void 0:g.getInternalPlayer();return t.jsxs(M,{sx:{display:"flex",flexDirection:"column",width:"100%"},children:[t.jsxs("h3",{children:["Set song preview (start: ",te(l*1e3,B),", end:"," ",te(v*1e3,B),")"]}),t.jsx(M,{sx:{display:"flex",gap:5},children:t.jsx(be,{"data-test":"song-preview",disabled:j===null,step:1,value:[l,v],max:(j??500)-ke,onChange:(C,L)=>{const[m,b]=L;b-m>ke&&a({...e,previewStart:m,previewEnd:b})}})}),t.jsx("h3",{children:"Adjust volume"}),t.jsxs(M,{sx:{display:"flex",gap:5},children:[t.jsxs(M,{children:[t.jsx("h4",{children:"Song"}),t.jsx(Re,{videoId:n,ref:o,onPlay:()=>{var C;p(!0),x&&((C=s.current)==null||C.pause(),setTimeout(()=>h(!0),200))},onPause:()=>{h(!1)}})]}),t.jsxs(M,{children:[t.jsx("h4",{children:"Reference sound"}),t.jsx("p",{children:"Use the slider below to make the video volume roughly the same as this music."}),t.jsx("br",{}),t.jsx("audio",{ref:s,controls:!0,src:Fe,loop:!0,onLoad:C=>C.currentTarget.currentTime=35,onPlay:C=>{var L,m;C.currentTarget.volume=.5,h(!0),c&&((m=(L=o.current)==null?void 0:L.getInternalPlayer())==null||m.pauseVideo(),setTimeout(()=>p(!0),200))},onPause:()=>{var C,L;h(!1),c&&((L=(C=o.current)==null?void 0:C.getInternalPlayer())==null||L.playVideo())}})]})]}),t.jsxs("h4",{children:["Final Song Volume (",e.volume*100,")"]}),t.jsx(M,{children:t.jsx(be,{"data-test":"volume",min:.1,max:1,step:.01,"aria-label":"Volume",value:e.volume,onChange:S})})]})}const $a=e=>{const a=me(!0);return d.useMemo(()=>{var r,o;const n=a.data.filter(s=>s.artist===e).map(s=>s.artistOrigin).filter(Boolean).reduce((s,i)=>(s[i]?s[i]++:s[i]=1,s),{});return(o=(r=Object.entries(n).sort((s,i)=>i[1]-s[1]))==null?void 0:r[0])==null?void 0:o[0]},[e,a.data])};function Aa(e){var S;const a=me(!0),n=$a(e.songArtist??"");d.useEffect(()=>{e.data.artistOrigin===void 0&&e.onChange({...e.data,artistOrigin:n})},[n,e.data]);const r=d.useMemo(()=>[...new Set(a.data.map(({language:l})=>Array.isArray(l)?l:[l]).flat().filter(Boolean))],[a.data]),o=Ma,s=d.useMemo(()=>[...new Set(a.data.map(l=>l.genre).filter(Boolean).map(l=>l.toLowerCase().replace(/\b\w/g,v=>v.toUpperCase().trim())))],[a.data]),i=d.useMemo(()=>[...new Set(a.data.map(l=>l.edition).filter(Boolean).map(l=>l.toLowerCase().replace(/\b\w/g,v=>v.toUpperCase().trim())))].sort(),[a.data]),u=l=>{global.open(`https://www.google.com/search?q=${encodeURIComponent(`${e.songArtist} ${e.songTitle} ${l}`)}`,"_blank")},c=!!e.songTitle&&!!e.songArtist,p=+(((S=e.data)==null?void 0:S.realBpm)??0)>200,[x,h]=d.useState(!1);return t.jsxs(R,{container:!0,spacing:2,"data-test":"song-metadata",sx:{mt:6},children:[t.jsx(R,{item:!0,xs:6,children:t.jsx(P,{value:e.data.artist,onChange:l=>e.onChange({...e.data,artist:l.target.value}),label:"Song artist",size:"small","data-test":"song-artist",required:!0,fullWidth:!0})}),t.jsx(R,{item:!0,xs:6,children:t.jsx(P,{value:e.data.title,onChange:l=>e.onChange({...e.data,title:l.target.value}),label:"Song title",fullWidth:!0,size:"small",required:!0,"data-test":"song-title"})}),t.jsx(R,{item:!0,xs:3,children:t.jsx(le,{onKeyDown:l=>{l.key==="Enter"&&l.preventDefault()},freeSolo:!0,disableClearable:!0,options:s,value:e.data.genre??"",onChange:(l,v)=>e.onChange({...e.data,genre:v}),renderInput:l=>t.jsx(P,{...l,onBlur:v=>e.onChange({...e.data,genre:v.target.value}),label:"Song genre (optional)",size:"small","data-test":"song-genre",fullWidth:!0})})}),t.jsx(R,{item:!0,xs:3,children:t.jsx(le,{onKeyDown:l=>{l.key==="Enter"&&l.preventDefault()},freeSolo:!0,disableClearable:!0,options:i,value:e.data.edition??"",onChange:(l,v)=>e.onChange({...e.data,edition:v}),renderInput:l=>t.jsx(P,{...l,onBlur:v=>e.onChange({...e.data,edition:v.target.value}),label:"Song edition (optional)",size:"small","data-test":"song-edition",helperText:"Songs with the same theme, e.g. 'Christmas'",fullWidth:!0})})}),t.jsx(R,{item:!0,xs:3,children:t.jsx(le,{onKeyDown:l=>{l.key==="Enter"&&l.preventDefault()},multiple:!0,freeSolo:!0,disableClearable:!0,options:r,value:typeof e.data.language=="string"?[e.data.language]:e.data.language,onChange:(l,v)=>{e.onChange({...e.data,language:v?v.filter(Boolean):e.data.language})},renderInput:l=>{var v;return t.jsx(P,{...l,label:"Song language",fullWidth:!0,size:"small",required:!((v=e.data.language)!=null&&v.length),"data-test":"song-language"})}})}),t.jsx(R,{item:!0,xs:3,children:t.jsxs(dt,{fullWidth:!0,children:[t.jsx(ut,{id:"song-origin-select-label",size:"small",children:"Song/artist origin (optional)"}),t.jsxs(pt,{"data-test":"artist-origin",size:"small",labelId:"song-origin-select-label",id:"song-origin-select",value:e.data.artistOrigin??"",label:"Song/artist origin (optional)",onChange:l=>e.onChange({...e.data,artistOrigin:l.target.value}),children:[t.jsx(ye,{value:"",children:"None"},"none"),Object.entries(o).map(([l,v])=>t.jsxs(ye,{value:l,children:[t.jsx(Ea,{isocode:l})," ",v]},l))]}),t.jsx(ht,{children:"Used to show the flag on the list"})]})}),t.jsx(R,{item:!0,xs:6,children:t.jsx(P,{"data-test":"release-year",value:e.data.year,onChange:l=>e.onChange({...e.data,year:l.target.value}),label:"Release year",helperText:"The year the song was released. Click the 'Lookup' button to look for it on Google",fullWidth:!0,size:"small",required:!0,...he(()=>u("release year"),c)})}),t.jsx(R,{item:!0,xs:6,children:t.jsx(P,{"data-test":"song-bpm",value:e.data.realBpm,onChange:l=>e.onChange({...e.data,realBpm:l.target.value}),label:"Song (real) BPM",focused:p?!0:void 0,helperText:p?t.jsxs(t.Fragment,{children:["Usually songs don't have higher BPM than ",t.jsx("b",{children:"200"}),". Make sure the value is correct (you can still save the song)"]}):`The actual tempo of the song. Click the 'Lookup' button to look for it on Google. ${x?"If you can't find it, you can still save the song":""}`,color:p?"warning":void 0,fullWidth:!0,type:"number",size:"small",required:!x,...he(()=>{h(!0),u("tempo")},c)})}),t.jsx(R,{item:!0,xs:12}),t.jsx(R,{item:!0,xs:12,children:t.jsx(Pa,{...e})})]})}const Ea=U(Ve,{target:"e70j9sv0"})({name:"1jigaf4",styles:"width:1em;margin-right:0.5em"});var Na=1,Ga=4;function Ua(e){return De(e,Na|Ga)}function za(e){return Y("MuiButtonGroup",e)}const A=J("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),Fa=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],Va=(e,a)=>{const{ownerState:n}=e;return[{[`& .${A.grouped}`]:a.grouped},{[`& .${A.grouped}`]:a[`grouped${E(n.orientation)}`]},{[`& .${A.grouped}`]:a[`grouped${E(n.variant)}`]},{[`& .${A.grouped}`]:a[`grouped${E(n.variant)}${E(n.orientation)}`]},{[`& .${A.grouped}`]:a[`grouped${E(n.variant)}${E(n.color)}`]},{[`& .${A.firstButton}`]:a.firstButton},{[`& .${A.lastButton}`]:a.lastButton},{[`& .${A.middleButton}`]:a.middleButton},a.root,a[n.variant],n.disableElevation===!0&&a.disableElevation,n.fullWidth&&a.fullWidth,n.orientation==="vertical"&&a.vertical]},Da=e=>{const{classes:a,color:n,disabled:r,disableElevation:o,fullWidth:s,orientation:i,variant:u}=e,c={root:["root",u,i==="vertical"&&"vertical",s&&"fullWidth",o&&"disableElevation"],grouped:["grouped",`grouped${E(i)}`,`grouped${E(u)}`,`grouped${E(u)}${E(i)}`,`grouped${E(u)}${E(n)}`,r&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return H(c,za,a)},Oa=N("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:Va})(({theme:e,ownerState:a})=>k({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius},a.variant==="contained"&&{boxShadow:(e.vars||e).shadows[2]},a.disableElevation&&{boxShadow:"none"},a.fullWidth&&{width:"100%"},a.orientation==="vertical"&&{flexDirection:"column"},{[`& .${A.grouped}`]:k({minWidth:40,"&:hover":k({},a.variant==="contained"&&{boxShadow:"none"})},a.variant==="contained"&&{boxShadow:"none"}),[`& .${A.firstButton},& .${A.middleButton}`]:k({},a.orientation==="horizontal"&&{borderTopRightRadius:0,borderBottomRightRadius:0},a.orientation==="vertical"&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},a.variant==="text"&&a.orientation==="horizontal"&&{borderRight:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${A.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}},a.variant==="text"&&a.orientation==="vertical"&&{borderBottom:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${A.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}},a.variant==="text"&&a.color!=="inherit"&&{borderColor:e.vars?`rgba(${e.vars.palette[a.color].mainChannel} / 0.5)`:ee(e.palette[a.color].main,.5)},a.variant==="outlined"&&a.orientation==="horizontal"&&{borderRightColor:"transparent"},a.variant==="outlined"&&a.orientation==="vertical"&&{borderBottomColor:"transparent"},a.variant==="contained"&&a.orientation==="horizontal"&&{borderRight:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${A.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}},a.variant==="contained"&&a.orientation==="vertical"&&{borderBottom:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${A.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}},a.variant==="contained"&&a.color!=="inherit"&&{borderColor:(e.vars||e).palette[a.color].dark},{"&:hover":k({},a.variant==="outlined"&&a.orientation==="horizontal"&&{borderRightColor:"currentColor"},a.variant==="outlined"&&a.orientation==="vertical"&&{borderBottomColor:"currentColor"})}),[`& .${A.lastButton},& .${A.middleButton}`]:k({},a.orientation==="horizontal"&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},a.orientation==="vertical"&&{borderTopRightRadius:0,borderTopLeftRadius:0},a.variant==="outlined"&&a.orientation==="horizontal"&&{marginLeft:-1},a.variant==="outlined"&&a.orientation==="vertical"&&{marginTop:-1})})),Wa=d.forwardRef(function(a,n){const r=W({props:a,name:"MuiButtonGroup"}),{children:o,className:s,color:i="primary",component:u="div",disabled:c=!1,disableElevation:p=!1,disableFocusRipple:x=!1,disableRipple:h=!1,fullWidth:S=!1,orientation:l="horizontal",size:v="medium",variant:j="outlined"}=r,w=K(r,Fa),B=k({},r,{color:i,component:u,disabled:c,disableElevation:p,disableFocusRipple:x,disableRipple:h,fullWidth:S,orientation:l,size:v,variant:j}),g=Da(B),C=d.useMemo(()=>({className:g.grouped,color:i,disabled:c,disableElevation:p,disableFocusRipple:x,disableRipple:h,fullWidth:S,size:v,variant:j}),[i,c,p,x,h,S,v,j,g.grouped]),L=jt(o),m=L.length,b=I=>{const y=I===0,f=I===m-1;return y&&f?"":y?g.firstButton:f?g.lastButton:g.middleButton};return t.jsx(Oa,k({as:u,role:"group",className:F(g.root,s),ref:n,ownerState:B},w,{children:t.jsx(xt.Provider,{value:C,children:L.map((I,y)=>t.jsx(mt.Provider,{value:b(y),children:I},y))})}))}),q=Wa;function Ka({player:e,currentTime:a,effectsEnabled:n,onEffectsToggle:r}){const o=u=>e.seekTo((a+u)/1e3),[s,i]=d.useState(1);return t.jsxs(t.Fragment,{children:[t.jsxs(M,{sx:{mb:2},children:[t.jsxs(z,{variant:"h6","data-test":"current-time",children:["Current time: ",Ra(a)," (",t.jsx(oe,{children:Math.round(a)})," ms)"]}),t.jsxs(M,{sx:{display:"flex",gap:1},children:[t.jsxs(q,{variant:"contained",sx:{display:"flex",mt:1,flex:1},children:[t.jsx(T,{sx:{flex:1,px:1},onClick:()=>o(-1e4),"data-test":"seek-10s",children:"-10"}),t.jsx(T,{sx:{flex:1,px:1},onClick:()=>o(-5e3),"data-test":"seek-5s",children:"-5"}),t.jsx(T,{sx:{flex:1,px:1},onClick:()=>o(-1e3),"data-test":"seek-1s",children:"-1"}),t.jsx(T,{sx:{flex:1,px:1},onClick:()=>o(-500),"data-test":"seek-0.5s",children:"-0.5"})]}),t.jsx(ft,{}),t.jsxs(q,{variant:"contained",sx:{display:"flex",mt:1,flex:1},children:[t.jsx(T,{sx:{flex:1,px:1},onClick:()=>o(500),"data-test":"seek+0.5s",children:"+0.5"}),t.jsx(T,{sx:{flex:1,px:1},onClick:()=>o(1e3),"data-test":"seek+1s",children:"+1"}),t.jsx(T,{sx:{flex:1,px:1},onClick:()=>o(5e3),"data-test":"seek+5s",children:"+5"}),t.jsx(T,{sx:{flex:1,px:1},onClick:()=>o(1e4),"data-test":"seek+10s",children:"+10"})]})]})]}),t.jsxs(M,{sx:{mb:2},children:[t.jsxs(z,{variant:"h6",children:["Playback speed: ",t.jsxs(oe,{"data-test":"current-speed",children:[s*100,"%"]})]}),t.jsx(q,{variant:"contained",sx:{display:"flex",mt:1},children:[.25,.5,.75,1,1.25,1.5,2].map(u=>t.jsxs(T,{"data-test":`speed-${u}`,sx:{flex:1},onClick:()=>{i(u),e.setPlaybackSpeed(u)},disabled:s===u,children:[u*100,"%"]},u))})]})]})}const Ha=["alignItems","autoFocus","component","children","dense","disableGutters","divider","focusVisibleClassName","selected","className"],_a=(e,a)=>{const{ownerState:n}=e;return[a.root,n.dense&&a.dense,n.alignItems==="flex-start"&&a.alignItemsFlexStart,n.divider&&a.divider,!n.disableGutters&&a.gutters]},qa=e=>{const{alignItems:a,classes:n,dense:r,disabled:o,disableGutters:s,divider:i,selected:u}=e,p=H({root:["root",r&&"dense",!s&&"gutters",i&&"divider",o&&"disabled",a==="flex-start"&&"alignItemsFlexStart",u&&"selected"]},gt,n);return k({},n,p)},Ya=N(Be,{shouldForwardProp:e=>Oe(e)||e==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:_a})(({theme:e,ownerState:a})=>k({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${X.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:ee(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${X.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:ee(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${X.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:ee(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:ee(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${X.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${X.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},a.divider&&{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"},a.alignItems==="flex-start"&&{alignItems:"flex-start"},!a.disableGutters&&{paddingLeft:16,paddingRight:16},a.dense&&{paddingTop:4,paddingBottom:4})),Ja=d.forwardRef(function(a,n){const r=W({props:a,name:"MuiListItemButton"}),{alignItems:o="center",autoFocus:s=!1,component:i="div",children:u,dense:c=!1,disableGutters:p=!1,divider:x=!1,focusVisibleClassName:h,selected:S=!1,className:l}=r,v=K(r,Ha),j=d.useContext(pe),w=d.useMemo(()=>({dense:c||j.dense||!1,alignItems:o,disableGutters:p}),[o,j.dense,c,p]),B=d.useRef(null);We(()=>{s&&B.current&&B.current.focus()},[s]);const g=k({},r,{alignItems:o,dense:w.dense,disableGutters:p,divider:x,selected:S}),C=qa(g),L=Ke(B,n);return t.jsx(pe.Provider,{value:w,children:t.jsx(Ya,k({ref:L,href:v.href||v.to,component:(v.href||v.to)&&i==="div"?"button":i,focusVisibleClassName:F(C.focusVisible,h),ownerState:g,className:F(C.root,l)},v,{classes:C,children:u}))})}),Za=Ja;function Qa(e,a){const n=Math.floor(a);return d.useMemo(()=>e.findIndex((r,o)=>n<0?!0:n<r.start?!1:o===e.length-1||e[o+1].start>n),[n,e])}function Xa({song:e,currentTime:a,beatLength:n,player:r,onRecordChange:o,onLyricChange:s,onTrackNameChange:i,lyricChanges:u}){var L;const[c,p]=d.useState(0),[x,h]=d.useState(-1),[S,l]=d.useState([]),v=He(a,n,e.gap),j=e.tracks[c].sections.filter(Z),w=Qa(j,v),B=m=>{h(m),$e.resetPlayerNotes(),r.seekTo((j[m].start*n+e.gap)/1e3)},g=()=>{l(m=>[...m,{type:"delete",section:x,track:c}]),x===j.length-1&&h(m=>m-1)},C=m=>{l(b=>{const I=b.at(-1);if(I&&I.type==="shift"&&I.track===c&&I.section===x){const y=[...b];return y.at(-1).shift=m,y}return[...b,{type:"shift",section:x,track:c,shift:m}]})};return d.useEffect(()=>{o(S)},[o,S]),t.jsxs(an,{children:[t.jsxs(Se,{direction:"row",children:[t.jsxs(z,{variant:"h6",mb:0,sx:{flex:1,display:"flex",alignItems:"center"},children:["Edit verses",e.tracks.length>1&&t.jsx(q,{variant:"contained",sx:{ml:2},size:"small",children:e.tracks.map((m,b)=>t.jsxs(T,{onClick:()=>p(b),disabled:c===b,"data-test":`track-${b+1}`,children:["Track ",b+1]},b))})]}),t.jsx(P,{label:"Track name",placeholder:"Set track name",sx:{flex:1},size:"small",value:((L=e.tracks[c])==null?void 0:L.name)??"",onChange:m=>i(c,m.target.value),"data-test":"track-name"})]}),t.jsxs(Se,{direction:"row",spacing:2,sx:{height:"400px",mt:3},children:[t.jsx(vt,{sx:{overflowY:"auto"},children:j.map((m,b)=>t.jsx(bt,{disablePadding:!0,"data-test":`section-${b}`,sx:{maxWidth:250,overflowX:"hidden",textWrap:"ellipsis",whiteSpace:"nowrap"},children:t.jsx(Za,{onClick:()=>B(b),selected:x===b,children:t.jsx(Ba,{primaryTypographyProps:{fontWeight:b===w?"bold":"normal"},primary:Z(m)?m.notes.map(I=>I.lyrics.replaceAll(" ","Â·")).join(""):"[pause]"})})},m.start))}),t.jsx(nn,{children:x>-1&&t.jsxs(t.Fragment,{children:[x===0&&t.jsx("h3",{"data-test":"use-gap-info",children:"Use gap shift to change when this section starts"}),x>0&&t.jsx(t.Fragment,{children:t.jsx(P,{"data-test":"change-start-beat",size:"small",type:"number",onChange:m=>C(+m.target.value),value:ue([j[x]]),label:"Change start beat",InputProps:{inputProps:{step:1}},fullWidth:!0,sx:{mb:2},helperText:t.jsxs(t.Fragment,{children:["Timestamp:"," ",te(ue([j[x]])*n+e.gap,r)]})})}),t.jsx(rn,{children:j[x].notes.map((m,b)=>{var y,f;const I=((f=(y=u[c])==null?void 0:y[x])==null?void 0:f[b])??m.lyrics;return t.jsx(on,{style:{width:`${I.length}ch`},value:I,"data-test":`lyric-input-${b}`,onChange:$=>{s({section:x,track:c,noteIndex:b,newLyric:$.target.value})},onKeyDown:$=>{var Q,fe;const V=$.target.selectionStart;if($.key==="ArrowLeft"&&V===0){const D=(Q=$.target)==null?void 0:Q.previousElementSibling;D&&(D.focus(),setTimeout(()=>D.setSelectionRange(D.value.length,D.value.length),10))}else if($.key==="ArrowRight"&&V===$.target.value.length){const D=(fe=$.target)==null?void 0:fe.nextElementSibling;D&&(D.focus(),setTimeout(()=>D.setSelectionRange(0,0),10))}}},b)})}),t.jsx(T,{variant:"contained",color:"error",onClick:g,fullWidth:!0,"data-test":"delete-section",children:"Delete section"})]})}),t.jsxs(en,{children:[t.jsx(M,{sx:{overflowY:"auto",maxHeight:"34rem"},"data-test":"change-list",children:S.map((m,b)=>{let I="",y=Le;return m.type==="delete"?(y=Le,I="Deleted"):m.type==="shift"&&(y=tn,I=`Start -> ${m.shift}`),t.jsx(y,{children:t.jsxs("strong",{children:["Track: ",m.track+1,", Section: ",m.section+1,", ",I]})},b)})}),S.length>0&&t.jsx(T,{"data-test":"undo-change",variant:"contained",color:"warning",onClick:()=>l(m=>m.filter((b,I)=>I!==m.length-1)),fullWidth:!0,children:"Undo last change"})]})]})]})}const en=U("div",{target:"e18sxv6t7"})({name:"82a6rk",styles:"flex:1"}),Ne=U("div",{target:"e18sxv6t6"})({name:"m1a2da",styles:"padding:0.5rem"}),Le=U(Ne,{target:"e18sxv6t5"})({name:"hwfcu5",styles:"color:red"}),tn=U(Ne,{target:"e18sxv6t4"})({name:"zzs6wi",styles:"color:#0059ff"}),an=U("div",{target:"e18sxv6t3"})(""),nn=U("div",{target:"e18sxv6t2"})({name:"82a6rk",styles:"flex:1"}),rn=U("div",{target:"e18sxv6t1"})({name:"1qhi3cl",styles:"display:flex;gap:0.25rem;column-gap:0;margin-bottom:1rem;align-items:center;flex-wrap:wrap"}),on=U("input",{target:"e18sxv6t0"})({name:"getj1y",styles:"font-family:monospace;background:#f6f6f6;width:3rem;padding:0.5rem 0.1rem;border:0;border-right:1px solid #e3e3e3;text-decoration:underline;&:focus{background:#b6b3b3;outline:none!important;}"});function sn({song:e,player:a,beatLength:n}){return t.jsx(t.Fragment,{})}function ln(e,a){var i;const r=(i=a.tracks[0].sections.filter(Z).at(-1))==null?void 0:i.notes.at(-1),o=e-a.gap,s=r.start+r.length;return Number((6e4/(o/s*a.bar)).toFixed(2))}function cn({current:e,onChange:a,player:n,song:r}){const o=Math.max(...r.tracks.map(c=>_e(c.sections))),s=qe(o,r)+r.gap,[i,u]=d.useState(Math.round(s));return t.jsxs(M,{sx:{display:"flex",gap:2,mb:2},children:[t.jsx(P,{"data-test":"desired-end",size:"small",type:"number",value:i,onChange:c=>u(+c.target.value),label:"Desired last note end time (in milliseconds)",sx:{flex:1},helperText:i?t.jsxs(t.Fragment,{children:["Estimated proper Tempo (BPM) of the lyrics:"," ",t.jsx(oe,{"data-test":"desired-bpm",children:ln(i,r)})]}):" "}),t.jsx(P,{"data-test":"change-bpm",size:"small",type:"number",value:e,onChange:c=>a(+c.target.value),label:"Tempo (BPM) of the lyrics",sx:{flex:.5},helperText:" ",InputProps:{inputProps:{step:"0.1"}}})]})}function dn({current:e,onChange:a,player:n,finalGap:r}){return t.jsxs(M,{sx:{flex:1},children:[t.jsxs(z,{variant:"h6",children:["Lyrics Gap shift (final: ",te(r,n),")"]}),t.jsxs(M,{sx:{display:"flex",gap:1,mt:1},children:[t.jsxs(q,{sx:{flex:1},children:[t.jsx(T,{sx:{flex:1,px:1},onClick:()=>a(e-1e3),"data-test":"shift-gap-1s",children:"-1000"}),t.jsx(T,{sx:{flex:1,px:1},onClick:()=>a(e-500),"data-test":"shift-gap-0.5s",children:"-500"}),t.jsx(T,{sx:{flex:1,px:1},onClick:()=>a(e-50),"data-test":"shift-gap-0.05s",children:"-50"})]}),t.jsx(P,{sx:{py:0,flex:1},size:"small",type:"text",value:e,onChange:o=>a(+o.target.value),label:"Miliseconds","data-test":"shift-gap"}),t.jsxs(q,{sx:{flex:1},children:[t.jsx(T,{sx:{flex:1,px:1},onClick:()=>a(e+50),"data-test":"shift-gap+0.05s",children:"+50"}),t.jsx(T,{sx:{flex:1,px:1},onClick:()=>a(e+500),"data-test":"shift-gap+0.5s",children:"+500"}),t.jsx(T,{sx:{flex:1,px:1},onClick:()=>a(e+1e3),"data-test":"shift-gap+1s",children:"+1000"})]})]})]})}function un({current:e,onChange:a,player:n,finalGap:r}){return t.jsxs(M,{sx:{flex:1},children:[t.jsxs(z,{variant:"h6",children:["Video Gap shift (final: ",te((r??0)*1e3,n),")"]}),t.jsxs(M,{sx:{display:"flex",gap:1,mt:1},children:[t.jsxs(q,{sx:{flex:1},children:[t.jsx(T,{sx:{flex:1,px:1.25},onClick:()=>a(e-10),"data-test":"shift-video-gap-10s",children:"-10"}),t.jsx(T,{sx:{flex:1,px:1.25},onClick:()=>a(e-5),"data-test":"shift-video-gap-5s",children:"-5"}),t.jsx(T,{sx:{flex:1,px:1.25},onClick:()=>a(e-1),"data-test":"shift-video-gap-1s",children:"-1"})]}),t.jsx(P,{"data-test":"shift-video-gap",sx:{py:0,flex:1},size:"small",type:"text",value:e,onChange:o=>a(+o.target.value),label:"Seconds"}),t.jsxs(q,{sx:{flex:1},children:[t.jsx(T,{sx:{flex:1,px:1.25},onClick:()=>a(e+1),"data-test":"shift-video-gap+1s",children:"+1"}),t.jsx(T,{sx:{flex:1,px:1.25},onClick:()=>a(e+5),"data-test":"shift-video-gap+5s",children:"+5"}),t.jsx(T,{sx:{flex:1,px:1.25},onClick:()=>a(e+10),"data-test":"shift-video-gap+10s",children:"+10"})]})]})]})}const pn=(e,a)=>({...e,gap:e.gap+a}),hn=(e,a)=>({...e,videoGap:(e.videoGap??0)+a}),xn=(e,a)=>({...e,bpm:a}),mn=(e,a)=>({...e,tracks:e.tracks.map((n,r)=>{const o=a.filter(i=>i.track===r);let s=[...n.sections].filter(Z);return o.forEach(i=>{if(i.type==="delete")s=s.filter((u,c)=>c!==i.section);else if(i.type==="shift"){const u=i.shift-ue([s[i.section]]);s=s.map((c,p)=>p<i.section?c:{...c,notes:c.notes.map(x=>({...x,start:x.start+u}))})}}),{...n,sections:s}})}),fn=(e,a)=>({...e,tracks:e.tracks.map((n,r)=>({...n,name:a[r]??n.name}))}),gn=(e,a)=>({...e,tracks:e.tracks.map((n,r)=>{const o=a[r]??{};return{...n,sections:n.sections.map((s,i)=>{const u=o[i]??{};return Z(s)?{...s,notes:s.notes.map((c,p)=>({...c,lyrics:u[p]??c.lyrics}))}:s})}})}),xe=800,Ie=xe/16*9;function vn({song:e,onUpdate:a,visible:n}){const r=d.useRef(null),[o,s]=d.useState(0),[i,u]=d.useState(0),[c,p]=d.useState(0),[x,h]=d.useState(e.bpm),[S,l]=d.useState(0),[v,j]=d.useState([]),[w,B]=d.useState(!1),[g,C]=d.useState(e.tracks.map(f=>f.name??void 0)),[L,m]=d.useState({}),b=d.useMemo(()=>{let f=Ua(e);return f=Ye(f),f=Je(f),f=ge(f),f=pn(f,i),f=hn(f,c),f=xn(f,x),f=mn(f,v),f=fn(f,g),f=gn(f,L),f=ge(f),f=Ze(f),f},[i,c,e,x,v,g,L]);d.useEffect(()=>{a==null||a(b)},[a,b]);const I=d.useMemo(()=>({id:"test",mode:Qe.DUEL,players:[{number:0,track:0},{number:1,track:e.tracks.length-1}],tolerance:6}),[e]);let y;return y=Xe(b),d.useEffect(()=>{var f;n||(f=r.current)==null||f.pause()},[n]),t.jsxs(R,{container:!0,spacing:2,sx:{display:n?void 0:"none"},children:[t.jsx(R,{item:!0,xs:8,"data-test":"player-container",children:t.jsx(M,{sx:{width:xe,height:Ie},children:t.jsx(et,{song:b,showControls:!0,autoplay:!1,width:xe,height:Ie,ref:r,onCurrentTimeUpdate:s,players:I.players,effectsEnabled:w,singSetup:I,onSongEnd:()=>{}},S)})}),t.jsxs(R,{item:!0,xs:4,children:[t.jsx(z,{variant:"h5",mb:2,children:"Playback controls"}),r.current&&t.jsx(Ka,{player:r.current,currentTime:o,effectsEnabled:w,onEffectsToggle:()=>B(f=>!f)}),!r.current&&t.jsx("h2",{children:"Start the song to see the manipulation form"})]}),r.current&&t.jsxs(t.Fragment,{children:[t.jsx(R,{item:!0,xs:8,children:t.jsxs(M,{sx:{display:"flex",gap:5,flex:1},children:[t.jsx(un,{player:r.current,onChange:f=>{const $=f-c;p(f),u(V=>V+$*1e3)},current:c,finalGap:b.videoGap}),t.jsx(dn,{player:r.current,onChange:u,current:i,finalGap:b.gap})]})}),t.jsxs(R,{item:!0,xs:4,children:[t.jsxs(O,{children:["Use ",t.jsx("strong",{children:"Video shift gap"})," to crop the beginning of the video if it starts with an intro."]}),t.jsxs(O,{children:["Use ",t.jsx("strong",{children:"Lyrics shift gap"})," to sync the start of the lyrics to the video. You can lower the"," ",t.jsx("strong",{children:"Playback speed"})," above to make sure you got it just right."]})]}),t.jsxs(R,{item:!0,xs:8,children:[t.jsx(z,{variant:"h5",mb:2,children:"Advanced"}),t.jsx(cn,{player:r.current,onChange:h,current:x,song:b},b.gap),t.jsx(sn,{player:r.current,song:b,beatLength:y})]}),t.jsxs(R,{item:!0,xs:4,children:[t.jsx(O,{children:"If the lyrics desynchronise over time, probably the tempo (BPM) of the lyrics is wrong."}),t.jsxs(O,{children:["You can either use ",t.jsx("strong",{children:"Last note end time"})," - enter the millisecond when the last note should end (seek through the video for the moment as ",t.jsx("strong",{children:"Current time"})," panel show the exact millisecond) and a suggested BPM value will appear below."]}),t.jsxs(O,{children:[t.jsx("strong",{children:"Tempo (BPM)"})," field allows to fine-tune the tempo."]})]}),t.jsx(R,{item:!0,xs:8,children:t.jsx(Xa,{song:b,currentTime:o,beatLength:y,player:r.current,onRecordChange:j,onTrackNameChange:(f,$)=>C(V=>{const Q=[...V];return Q[f]=$===""?void 0:$,Q}),lyricChanges:L,onLyricChange:f=>m($=>{var V;return{...$,[f.track]:{...$[f.track],[f.section]:{...(V=$[f.track])==null?void 0:V[f.section],[f.noteIndex]:f.newLyric}}}})})}),t.jsxs(R,{item:!0,xs:4,children:[t.jsxs(O,{children:["If the lyrics there are more lyrics than in the video or there are longer/shorter interludes between verses, you can ",t.jsx("strong",{children:"Edit verses"}),"."]}),t.jsx(O,{children:"Select a verse by clicking on it."}),t.jsxs(O,{children:["You can either ",t.jsx("strong",{children:"Change its start beat"}),' (which will "move in time" the verse and all subsequent ones) or ',t.jsx("strong",{children:"Delete it"})," (it won't affect the timing of other verses). You can also edit the lyrics of each note."]}),t.jsxs(O,{children:[t.jsx("strong",{children:"List of changes"})," on the right allows you to see and undo the actions one by one."]})]})]})]})}const O=U("p",{target:"e2gsf9o0"})({name:"1tcko1c",styles:"font-size:0.85rem;margin-bottom:1rem;line-height:1.25rem;strong{font-weight:bold;}"});function bn(e){var a,n,r;return t.jsx(M,{"data-test":"sync-lyrics",children:e.data&&e.data.video.length<15&&!!((r=(n=(a=e.data.tracks)==null?void 0:a[0])==null?void 0:n.sections)!=null&&r.length)&&t.jsx(vn,{song:e.data,onUpdate:e.onChange,visible:e.visible})})}function yn(e){return Array.isArray(e)?e.length===0:!e}const G=["basic-data","author-and-video","sync","metadata"];function kn({song:e}){const a=!!e,{data:n}=me(!0);tt(!1);const r=at();nt(!1);const o=rt("step"),[s,i]=d.useState(Math.max(0,G.indexOf(o))),[u,c]=d.useState(!1);d.useEffect(()=>{G[s]&&ma({step:G[s]})},[s]);const[p,x]=d.useState({sourceUrl:(e==null?void 0:e.sourceUrl)??"",txtInput:""}),[h,S]=d.useState({author:(e==null?void 0:e.author)??"",authorUrl:(e==null?void 0:e.authorUrl)??"",video:e!=null&&e.video?`https://www.youtube.com/watch?v=${e.video}`:""}),[l,v]=d.useState({artist:(e==null?void 0:e.artist)??"",title:(e==null?void 0:e.title)??"",realBpm:e!=null&&e.realBpm?String(e.realBpm):"",year:(e==null?void 0:e.year)??"",language:(e==null?void 0:e.language)??[],volume:(e==null?void 0:e.volume)??0,previewStart:(e==null?void 0:e.previewStart)??void 0,previewEnd:(e==null?void 0:e.previewEnd)??void 0,genre:e==null?void 0:e.genre,edition:e==null?void 0:e.edition,artistOrigin:e==null?void 0:e.artistOrigin}),[j,w]=d.useState(e),B=d.useRef(""),g=d.useMemo(()=>{try{return a?{...e,video:we(h.video)||e.video,author:h.author,authorUrl:h.authorUrl,sourceUrl:p.sourceUrl}:p.txtInput?Pe(p.txtInput,h.video,h.author,h.authorUrl,p.sourceUrl):void 0}catch(y){B.current=y.message,console.error(y)}},[p.txtInput,h.video,h.author,h.authorUrl,p.sourceUrl,e,a]),C=d.useMemo(()=>!a&&g&&(n==null?void 0:n.find(y=>ie.generateSongFile(y)===ie.generateSongFile(g))),[n,g,a]);d.useEffect(()=>{g&&(g.video&&!h.video&&S(y=>({...y,video:`https://www.youtube.com/watch?v=${g.video}`})),g.author&&!h.author&&S(y=>({...y,author:y.author||(g==null?void 0:g.author)||"",authorUrl:y.authorUrl||(g==null?void 0:g.authorUrl)||""})),g.sourceUrl&&!p.sourceUrl&&x(y=>({...y,sourceUrl:g.sourceUrl})),["year","language","realBpm","genre","artist","title","volume","previewStart","previewEnd","artistOrigin"].forEach(y=>{g[y]&&yn(l[y])&&v(f=>({...f,[y]:g[y]}))}))},[g,l.year,l.language,l.realBpm,l.genre,l.artist,l.volume,l.title,l.previewStart,l.previewEnd,p.sourceUrl,h.video]);const L=!!p.txtInput||a,m=!!h.video,b=G[s]==="author-and-video"?m:!0,I={...j,...l,author:h.author,authorUrl:h.authorUrl,realBpm:+l.realBpm,sourceUrl:p.sourceUrl,id:ot(l)};return t.jsxs(st,{injectFirst:!0,children:[t.jsx(it,{}),t.jsxs(Sn,{children:[!a&&t.jsx("div",{style:{marginBottom:"1rem"},children:t.jsx(lt,{to:"menu/",children:t.jsx("a",{children:"Return to the main menu"})})}),t.jsxs(xa,{activeStep:s,sx:{mb:2},nonLinear:a,children:[t.jsx(ne,{completed:L,children:t.jsx(re,{color:"inherit",onClick:()=>i(0),children:"Basic Info"})},0),t.jsx(ne,{completed:m,children:t.jsx(re,{color:"inherit",onClick:()=>i(1),children:"Author and video data"})},1),t.jsx(ne,{children:t.jsx(re,{color:"inherit",onClick:()=>i(2),children:"Sync lyrics to video"})},2),t.jsx(ne,{children:t.jsx(re,{color:"inherit",onClick:()=>i(3),children:"Fill song metadata"})},3)]}),t.jsxs("form",{onSubmit:async y=>{y.preventDefault(),s<G.length-1?i(f=>f+1):G.at(s)==="metadata"&&(c(!0),await ie.store(I),await yt(I.id),c(!1),r("edit/list/",{id:I.id,created:a?null:"true",song:null}))},children:[G.at(s)==="basic-data"&&t.jsx(ja,{shouldAutoImport:!m,isTxtRequired:!e,onAutoImport:S,onChange:x,data:p,finalSong:I}),G.at(s)==="author-and-video"&&t.jsx(fa,{songArtist:g==null?void 0:g.artist,songTitle:g==null?void 0:g.title,onChange:S,data:h}),g&&t.jsx(bn,{onChange:w,data:g,visible:G.at(s)==="sync"}),G.at(s)==="metadata"&&t.jsx(Aa,{videoGap:j==null?void 0:j.videoGap,onChange:v,data:l,songArtist:g==null?void 0:g.artist,songTitle:g==null?void 0:g.title,videoId:g.video}),C&&t.jsxs(St,{severity:"warning","data-test":"possible-duplicate",children:[t.jsx(Ct,{children:"Possible duplicate"}),"There is already a song with similar artist and/or name:"," ",t.jsxs("b",{children:[C.artist," - ",C.title]})]}),t.jsxs(M,{sx:{display:"flex",justifyContent:"flex-end"},children:[t.jsx(T,{"data-test":"previous-button",sx:{mt:2,align:"right"},onClick:()=>i(y=>y-1),disabled:s===0,children:"Previous"}),G.at(s)==="metadata"?t.jsx(T,{"data-test":"save-button",sx:{mt:2,align:"right"},type:"submit",variant:"contained",disabled:u,children:u?"Saving...":"Save"}):t.jsx(T,{"data-test":"next-button",sx:{mt:2,align:"right"},variant:"contained",type:"submit",disabled:!b||s===G.length-1,children:"Next"})]})]})]})]})}const Sn=U("div",{target:"ecp0zlc0"})({name:"1ec6m7r",styles:"background:white;margin:30px auto 0;width:1260px;height:100%"});export{kn as default};
//# sourceMappingURL=ConvertView-BDSUMpf1.js.map

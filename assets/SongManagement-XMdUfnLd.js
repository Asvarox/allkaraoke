try{let e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`7fa6829c-4d09-4d52-b1f4-a0439c495f28`,e._sentryDebugIdIdentifier=`sentry-dbid-7fa6829c-4d09-4d52-b1f4-a0439c495f28`)}catch{}{let e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:allkaraoke-party-sentry-key":!0})}import{A as e,C as t,D as n,E as r,O as i,S as a,T as o,_ as s,a as c,b as l,c as u,d,f,g as p,h as m,i as h,k as g,l as _,m as v,n as y,o as b,p as x,r as S,s as C,t as w,u as T,v as E,w as D,x as O,y as k}from"./SongsTable-CVcEKncf.js";import{A as ee,Bn as te,C as A,Cn as ne,D as re,Dn as ie,E as ae,En as j,F as oe,Fn as se,Ft as M,Gn as ce,Gt as N,H as le,Hn as ue,Ht as P,In as de,J as fe,K as pe,L as me,Ln as he,M as ge,Mn as _e,N as ve,Nn as ye,O as be,On as xe,P as Se,Pn as Ce,Rn as we,Sn as Te,T as Ee,Tn as De,U as Oe,Ut as F,V as ke,Vn as Ae,a as je,at as Me,b as Ne,c as Pe,ct as I,d as Fe,dn as Ie,dt as Le,fn as Re,gn as L,hn as ze,i as Be,j as Ve,jn as He,k as Ue,kn as We,ln as Ge,mn as R,nt as Ke,o as qe,ot as Je,pn as z,r as Ye,s as Xe,st as B,t as Ze,tt as Qe,u as V,un as $e,ut as H,w as et,xn as tt,yn as nt,yt as rt,z as it,zn as U}from"./index-C2MqRUVK.js";function at(e){return e==null||typeof e!=`object`&&typeof e!=`function`}function ot(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function st(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function ct(e){return e==null?e===void 0?`[object Undefined]`:`[object Null]`:Object.prototype.toString.call(e)}var lt=`[object RegExp]`,ut=`[object String]`,dt=`[object Number]`,ft=`[object Boolean]`,pt=`[object Arguments]`,mt=`[object Symbol]`,ht=`[object Date]`,gt=`[object Map]`,_t=`[object Set]`,vt=`[object Array]`,yt=`[object ArrayBuffer]`,bt=`[object Object]`,xt=`[object DataView]`,St=`[object Uint8Array]`,Ct=`[object Uint8ClampedArray]`,wt=`[object Uint16Array]`,Tt=`[object Uint32Array]`,Et=`[object Int8Array]`,Dt=`[object Int16Array]`,Ot=`[object Int32Array]`,kt=`[object Float32Array]`,At=`[object Float64Array]`;function W(e,t,n,r=new Map,i=void 0){let a=i?.(e,t,n,r);if(a!=null)return a;if(at(e))return e;if(r.has(e))return r.get(e);if(Array.isArray(e)){let t=Array(e.length);r.set(e,t);for(let a=0;a<e.length;a++)t[a]=W(e[a],a,n,r,i);return Object.hasOwn(e,`index`)&&(t.index=e.index),Object.hasOwn(e,`input`)&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){let t=new Map;r.set(e,t);for(let[a,o]of e)t.set(a,W(o,a,n,r,i));return t}if(e instanceof Set){let t=new Set;r.set(e,t);for(let a of e)t.add(W(a,void 0,n,r,i));return t}if(typeof Buffer<`u`&&Buffer.isBuffer(e))return e.subarray();if(ot(e)){let t=new(Object.getPrototypeOf(e)).constructor(e.length);r.set(e,t);for(let a=0;a<e.length;a++)t[a]=W(e[a],a,n,r,i);return t}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<`u`&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return r.set(e,t),G(t,e,n,r,i),t}if(typeof File<`u`&&e instanceof File){let t=new File([e],e.name,{type:e.type});return r.set(e,t),G(t,e,n,r,i),t}if(e instanceof Blob){let t=new Blob([e],{type:e.type});return r.set(e,t),G(t,e,n,r,i),t}if(e instanceof Error){let t=new e.constructor;return r.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,G(t,e,n,r,i),t}if(typeof e==`object`&&jt(e)){let t=Object.create(Object.getPrototypeOf(e));return r.set(e,t),G(t,e,n,r,i),t}return e}function G(e,t,n=e,r,i){let a=[...Object.keys(t),...st(t)];for(let o=0;o<a.length;o++){let s=a[o],c=Object.getOwnPropertyDescriptor(e,s);(c==null||c.writable)&&(e[s]=W(t[s],s,n,r,i))}}function jt(e){switch(ct(e)){case pt:case vt:case yt:case xt:case ft:case ht:case kt:case At:case Et:case Dt:case Ot:case gt:case dt:case bt:case lt:case _t:case ut:case mt:case St:case Ct:case wt:case Tt:return!0;default:return!1}}function Mt(e){return W(e,void 0,e,new Map,void 0)}var K=ce(Ae());function Nt(e){return K.Children.toArray(e).filter(e=>K.isValidElement(e))}var q=ce(De()),Pt=(e,t)=>{let n=tt(e);return n.sheet=new t({key:n.key,nonce:n.sheet.nonce,container:n.sheet.container,speedy:n.sheet.isSpeedy,prepend:n.sheet.prepend,insertionPoint:n.sheet.insertionPoint}),n},Ft;if(typeof document==`object`){let e=document.querySelector(`[name="emotion-insertion-point"]`);if(!e){e=document.createElement(`meta`),e.setAttribute(`name`,`emotion-insertion-point`),e.setAttribute(`content`,``);let t=document.querySelector(`head`);t&&t.prepend(e)}class t extends Te{insert(t,n){return this.key&&this.key.endsWith(`global`)&&(this.before=e),super.insert(t,n)}}Ft=Pt({key:`css`,insertionPoint:e},t)}function It(e){let{injectFirst:t,children:n}=e;return t&&Ft?(0,q.jsx)(nt,{value:Ft,children:n}):n}var Lt=e=>{let{classes:t,inset:n,primary:r,secondary:i,dense:a}=e;return N({root:[`root`,n&&`inset`,a&&`dense`,r&&i&&`multiline`],primary:[`primary`],secondary:[`secondary`]},O,t)},Rt=H(`div`,{name:`MuiListItemText`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${a.primary}`]:t.primary},{[`& .${a.secondary}`]:t.secondary},t.root,n.inset&&t.inset,n.primary&&n.secondary&&t.multiline,n.dense&&t.dense]}})({flex:`1 1 auto`,minWidth:0,marginTop:4,marginBottom:4,[`.${Fe.root}:where(& .${a.primary})`]:{display:`block`},[`.${Fe.root}:where(& .${a.secondary})`]:{display:`block`},variants:[{props:({ownerState:e})=>e.primary&&e.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:56}}]}),zt=K.forwardRef(function(e,t){let n=B({props:e,name:`MuiListItemText`}),{children:r,className:i,disableTypography:a=!1,inset:s=!1,primary:c,primaryTypographyProps:l,secondary:u,secondaryTypographyProps:d,slots:f={},slotProps:p={},...m}=n,{dense:h}=K.useContext(o),g=c??r,_=u,v={...n,disableTypography:a,inset:s,primary:!!g,secondary:!!_,dense:h},y=Lt(v),b={slots:f,slotProps:{primary:l,secondary:d,...p}},[x,S]=Ne(`primary`,{className:y.primary,elementType:V,externalForwardedProps:b,ownerState:v}),[C,w]=Ne(`secondary`,{className:y.secondary,elementType:V,externalForwardedProps:b,ownerState:v});return g!=null&&g.type!==V&&!a&&(g=(0,q.jsx)(x,{variant:h?`body2`:`body1`,component:S?.variant?void 0:`span`,...S,children:g})),_!=null&&_.type!==V&&!a&&(_=(0,q.jsx)(C,{variant:`body2`,color:`textSecondary`,...w,children:_})),(0,q.jsxs)(Rt,{className:z(y.root,i),ownerState:v,ref:t,...m,children:[g,_]})});const Bt=(e,t)=>{let{ownerState:n}=e;return[t.root,n.dense&&t.dense,n.alignItems===`flex-start`&&t.alignItemsFlexStart,n.divider&&t.divider,!n.disableGutters&&t.gutters]};var Vt=e=>{let{alignItems:t,classes:n,dense:r,disabled:i,disableGutters:a,divider:o,selected:s}=e,c=N({root:[`root`,r&&`dense`,!a&&`gutters`,o&&`divider`,i&&`disabled`,t===`flex-start`&&`alignItemsFlexStart`,s&&`selected`]},C,n);return{...n,...c}},Ht=H(fe,{shouldForwardProp:e=>Le(e)||e===`classes`,name:`MuiListItemButton`,slot:`Root`,overridesResolver:Bt})(I(({theme:e})=>({display:`flex`,flexGrow:1,justifyContent:`flex-start`,alignItems:`center`,position:`relative`,textDecoration:`none`,minWidth:0,boxSizing:`border-box`,textAlign:`left`,paddingTop:8,paddingBottom:8,transition:e.transitions.create(`background-color`,{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:`none`,backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:`transparent`}},[`&.${u.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:rt(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${u.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:rt(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${u.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:rt(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:rt(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${u.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${u.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},variants:[{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:`padding-box`}},{props:{alignItems:`flex-start`},style:{alignItems:`flex-start`}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.dense,style:{paddingTop:4,paddingBottom:4}}]}))),Ut=K.forwardRef(function(e,t){let n=B({props:e,name:`MuiListItemButton`}),{alignItems:r=`center`,autoFocus:i=!1,component:a=`div`,children:s,dense:c=!1,disableGutters:l=!1,divider:u=!1,focusVisibleClassName:d,selected:f=!1,className:p,...m}=n,h=K.useContext(o),_=K.useMemo(()=>({dense:c||h.dense||!1,alignItems:r,disableGutters:l}),[r,h.dense,c,l]),v=K.useRef(null);g(()=>{i&&v.current&&v.current.focus()},[i]);let y={...n,alignItems:r,dense:_.dense,disableGutters:l,divider:u,selected:f},b=Vt(y),x=Ke(v,t);return(0,q.jsx)(o.Provider,{value:_,children:(0,q.jsx)(Ht,{ref:x,href:m.href||m.to,component:(m.href||m.to)&&a===`div`?`button`:a,focusVisibleClassName:z(b.focusVisible,d),ownerState:y,className:z(b.root,p),...m,classes:b,children:s})})}),J=K.createContext({}),Wt=K.createContext({});function Gt(e){return F(`MuiStep`,e)}P(`MuiStep`,[`root`,`horizontal`,`vertical`,`alternativeLabel`,`completed`]);var Kt=e=>{let{classes:t,orientation:n,alternativeLabel:r,completed:i}=e;return N({root:[`root`,n,r&&`alternativeLabel`,i&&`completed`]},Gt,t)},qt=H(`div`,{name:`MuiStep`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.completed&&t.completed]}})({variants:[{props:{orientation:`horizontal`},style:{paddingLeft:8,paddingRight:8}},{props:{alternativeLabel:!0},style:{flex:1,position:`relative`}}]}),Jt=K.forwardRef(function(e,t){let n=B({props:e,name:`MuiStep`}),{active:r,children:i,className:a,component:o=`div`,completed:s,disabled:c,expanded:l=!1,index:u,last:d,...f}=n,{activeStep:p,connector:m,alternativeLabel:h,orientation:g,nonLinear:_}=K.useContext(J),[v=!1,y=!1,b=!1]=[r,s,c];p===u?v=r===void 0?!0:r:!_&&p>u?y=s===void 0?!0:s:!_&&p<u&&(b=c===void 0?!0:c);let x=K.useMemo(()=>({index:u,last:d,expanded:l,icon:u+1,active:v,completed:y,disabled:b}),[u,d,l,v,y,b]),S={...n,active:v,orientation:g,alternativeLabel:h,completed:y,disabled:b,expanded:l,component:o},C=(0,q.jsxs)(qt,{as:o,className:z(Kt(S).root,a),ref:t,ownerState:S,...f,children:[m&&h&&u!==0?m:null,i]});return(0,q.jsx)(Wt.Provider,{value:x,children:m&&!h&&u!==0?(0,q.jsxs)(K.Fragment,{children:[m,C]}):C})}),Yt=Me((0,q.jsx)(`path`,{d:`M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z`}),`CheckCircle`),Xt=Me((0,q.jsx)(`path`,{d:`M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z`}),`Warning`);function Zt(e){return F(`MuiStepIcon`,e)}var Qt=P(`MuiStepIcon`,[`root`,`active`,`completed`,`error`,`text`]),$t,en=e=>{let{classes:t,active:n,completed:r,error:i}=e;return N({root:[`root`,n&&`active`,r&&`completed`,i&&`error`],text:[`text`]},Zt,t)},tn=H(Je,{name:`MuiStepIcon`,slot:`Root`,overridesResolver:(e,t)=>t.root})(I(({theme:e})=>({display:`block`,transition:e.transitions.create(`color`,{duration:e.transitions.duration.shortest}),color:(e.vars||e).palette.text.disabled,[`&.${Qt.completed}`]:{color:(e.vars||e).palette.primary.main},[`&.${Qt.active}`]:{color:(e.vars||e).palette.primary.main},[`&.${Qt.error}`]:{color:(e.vars||e).palette.error.main}}))),nn=H(`text`,{name:`MuiStepIcon`,slot:`Text`,overridesResolver:(e,t)=>t.text})(I(({theme:e})=>({fill:(e.vars||e).palette.primary.contrastText,fontSize:e.typography.caption.fontSize,fontFamily:e.typography.fontFamily}))),rn=K.forwardRef(function(e,t){let n=B({props:e,name:`MuiStepIcon`}),{active:r=!1,className:i,completed:a=!1,error:o=!1,icon:s,...c}=n,l={...n,active:r,completed:a,error:o},u=en(l);if(typeof s==`number`||typeof s==`string`){let e=z(i,u.root);return o?(0,q.jsx)(tn,{as:Xt,className:e,ref:t,ownerState:l,...c}):a?(0,q.jsx)(tn,{as:Yt,className:e,ref:t,ownerState:l,...c}):(0,q.jsxs)(tn,{className:e,ref:t,ownerState:l,...c,children:[$t||=(0,q.jsx)(`circle`,{cx:`12`,cy:`12`,r:`12`}),(0,q.jsx)(nn,{className:u.text,x:`12`,y:`12`,textAnchor:`middle`,dominantBaseline:`central`,ownerState:l,children:s})]})}return s});function an(e){return F(`MuiStepLabel`,e)}var Y=P(`MuiStepLabel`,[`root`,`horizontal`,`vertical`,`label`,`active`,`completed`,`error`,`disabled`,`iconContainer`,`alternativeLabel`,`labelContainer`]),on=e=>{let{classes:t,orientation:n,active:r,completed:i,error:a,disabled:o,alternativeLabel:s}=e;return N({root:[`root`,n,a&&`error`,o&&`disabled`,s&&`alternativeLabel`],label:[`label`,r&&`active`,i&&`completed`,a&&`error`,o&&`disabled`,s&&`alternativeLabel`],iconContainer:[`iconContainer`,r&&`active`,i&&`completed`,a&&`error`,o&&`disabled`,s&&`alternativeLabel`],labelContainer:[`labelContainer`,s&&`alternativeLabel`]},an,t)},sn=H(`span`,{name:`MuiStepLabel`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[n.orientation]]}})({display:`flex`,alignItems:`center`,[`&.${Y.alternativeLabel}`]:{flexDirection:`column`},[`&.${Y.disabled}`]:{cursor:`default`},variants:[{props:{orientation:`vertical`},style:{textAlign:`left`,padding:`8px 0`}}]}),cn=H(`span`,{name:`MuiStepLabel`,slot:`Label`,overridesResolver:(e,t)=>t.label})(I(({theme:e})=>({...e.typography.body2,display:`block`,transition:e.transitions.create(`color`,{duration:e.transitions.duration.shortest}),[`&.${Y.active}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${Y.completed}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${Y.alternativeLabel}`]:{marginTop:16},[`&.${Y.error}`]:{color:(e.vars||e).palette.error.main}}))),ln=H(`span`,{name:`MuiStepLabel`,slot:`IconContainer`,overridesResolver:(e,t)=>t.iconContainer})({flexShrink:0,display:`flex`,paddingRight:8,[`&.${Y.alternativeLabel}`]:{paddingRight:0}}),un=H(`span`,{name:`MuiStepLabel`,slot:`LabelContainer`,overridesResolver:(e,t)=>t.labelContainer})(I(({theme:e})=>({width:`100%`,color:(e.vars||e).palette.text.secondary,[`&.${Y.alternativeLabel}`]:{textAlign:`center`}}))),dn=K.forwardRef(function(e,t){let n=B({props:e,name:`MuiStepLabel`}),{children:r,className:i,componentsProps:a={},error:o=!1,icon:s,optional:c,slots:l={},slotProps:u={},StepIconComponent:d,StepIconProps:f,...p}=n,{alternativeLabel:m,orientation:h}=K.useContext(J),{active:g,disabled:_,completed:v,icon:y}=K.useContext(Wt),b=s||y,x=d;b&&!x&&(x=rn);let S={...n,active:g,alternativeLabel:m,completed:v,disabled:_,error:o,orientation:h},C=on(S),w={slots:l,slotProps:{stepIcon:f,...a,...u}},[T,E]=Ne(`label`,{elementType:cn,externalForwardedProps:w,ownerState:S}),[D,O]=Ne(`stepIcon`,{elementType:x,externalForwardedProps:w,ownerState:S});return(0,q.jsxs)(sn,{className:z(C.root,i),ref:t,ownerState:S,...p,children:[b||D?(0,q.jsx)(ln,{className:C.iconContainer,ownerState:S,children:(0,q.jsx)(D,{completed:v,active:g,error:o,icon:b,...O})}):null,(0,q.jsxs)(un,{className:C.labelContainer,ownerState:S,children:[r?(0,q.jsx)(T,{...E,className:z(C.label,E?.className),children:r}):null,c]})]})});dn.muiName=`StepLabel`;var fn=dn;function pn(e){return F(`MuiStepButton`,e)}var mn=P(`MuiStepButton`,[`root`,`horizontal`,`vertical`,`touchRipple`]),hn=e=>{let{classes:t,orientation:n}=e;return N({root:[`root`,n],touchRipple:[`touchRipple`]},pn,t)},gn=H(fe,{name:`MuiStepButton`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${mn.touchRipple}`]:t.touchRipple},t.root,t[n.orientation]]}})({width:`100%`,padding:`24px 16px`,margin:`-24px -16px`,boxSizing:`content-box`,[`& .${mn.touchRipple}`]:{color:`rgba(0, 0, 0, 0.3)`},variants:[{props:{orientation:`vertical`},style:{justifyContent:`flex-start`,padding:`8px`,margin:`-8px`}}]}),_n=K.forwardRef(function(t,n){let r=B({props:t,name:`MuiStepButton`}),{children:i,className:a,icon:o,optional:s,...c}=r,{disabled:l,active:u}=K.useContext(Wt),{orientation:d}=K.useContext(J),f={...r,orientation:d},p=hn(f),m={icon:o,optional:s},h=e(i,[`StepLabel`])?K.cloneElement(i,m):(0,q.jsx)(fn,{...m,children:i});return(0,q.jsx)(gn,{focusRipple:!0,disabled:l,TouchRippleProps:{className:p.touchRipple},className:z(p.root,a),ref:n,ownerState:f,"aria-current":u?`step`:void 0,...c,children:h})});function vn(e){return F(`MuiStepper`,e)}P(`MuiStepper`,[`root`,`horizontal`,`vertical`,`nonLinear`,`alternativeLabel`]);function yn(e){return F(`MuiStepConnector`,e)}P(`MuiStepConnector`,[`root`,`horizontal`,`vertical`,`alternativeLabel`,`active`,`completed`,`disabled`,`line`,`lineHorizontal`,`lineVertical`]);var bn=e=>{let{classes:t,orientation:n,alternativeLabel:r,active:i,completed:a,disabled:o}=e;return N({root:[`root`,n,r&&`alternativeLabel`,i&&`active`,a&&`completed`,o&&`disabled`],line:[`line`,`line${M(n)}`]},yn,t)},xn=H(`div`,{name:`MuiStepConnector`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.completed&&t.completed]}})({flex:`1 1 auto`,variants:[{props:{orientation:`vertical`},style:{marginLeft:12}},{props:{alternativeLabel:!0},style:{position:`absolute`,top:12,left:`calc(-50% + 20px)`,right:`calc(50% + 20px)`}}]}),Sn=H(`span`,{name:`MuiStepConnector`,slot:`Line`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.line,t[`line${M(n.orientation)}`]]}})(I(({theme:e})=>{let t=e.palette.mode===`light`?e.palette.grey[400]:e.palette.grey[600];return{display:`block`,borderColor:e.vars?e.vars.palette.StepConnector.border:t,variants:[{props:{orientation:`horizontal`},style:{borderTopStyle:`solid`,borderTopWidth:1}},{props:{orientation:`vertical`},style:{borderLeftStyle:`solid`,borderLeftWidth:1,minHeight:24}}]}})),Cn=K.forwardRef(function(e,t){let n=B({props:e,name:`MuiStepConnector`}),{className:r,...i}=n,{alternativeLabel:a,orientation:o=`horizontal`}=K.useContext(J),{active:s,disabled:c,completed:l}=K.useContext(Wt),u={...n,alternativeLabel:a,orientation:o,active:s,completed:l,disabled:c},d=bn(u);return(0,q.jsx)(xn,{className:z(d.root,r),ref:t,ownerState:u,...i,children:(0,q.jsx)(Sn,{className:d.line,ownerState:u})})}),wn=e=>{let{orientation:t,nonLinear:n,alternativeLabel:r,classes:i}=e;return N({root:[`root`,t,n&&`nonLinear`,r&&`alternativeLabel`]},vn,i)},Tn=H(`div`,{name:`MuiStepper`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.nonLinear&&t.nonLinear]}})({display:`flex`,variants:[{props:{orientation:`horizontal`},style:{flexDirection:`row`,alignItems:`center`}},{props:{orientation:`vertical`},style:{flexDirection:`column`}},{props:{alternativeLabel:!0},style:{alignItems:`flex-start`}}]}),En=(0,q.jsx)(Cn,{}),Dn=K.forwardRef(function(e,t){let n=B({props:e,name:`MuiStepper`}),{activeStep:r=0,alternativeLabel:i=!1,children:a,className:o,component:s=`div`,connector:c=En,nonLinear:l=!1,orientation:u=`horizontal`,...d}=n,f={...n,nonLinear:l,alternativeLabel:i,orientation:u,component:s},p=wn(f),m=K.Children.toArray(a).filter(Boolean),h=m.map((e,t)=>K.cloneElement(e,{index:t,last:t+1===m.length,...e.props})),g=K.useMemo(()=>({activeStep:r,alternativeLabel:i,connector:c,nonLinear:l,orientation:u}),[r,i,c,l,u]);return(0,q.jsx)(J.Provider,{value:g,children:(0,q.jsx)(Tn,{as:s,ownerState:f,className:z(p.root,o),ref:t,...d,children:h})})});function On(e){let t=new URL(global.location?.href);Object.entries(e).forEach(([e,n])=>{n===null?t.searchParams.delete(e):t.searchParams.set(e,n)}),global.history.replaceState(null,``,t.toString())}const kn=Re.span`font-mono`,An=(e,t,r=`Lookup`)=>({InputProps:{endAdornment:(0,q.jsx)(n,{title:t?`Open search results for the song`:`Artist or title of the song is unknown`,children:(0,q.jsx)(`span`,{children:(0,q.jsx)(A,{sx:{mr:-1},endIcon:(0,q.jsx)(it,{}),color:`secondary`,variant:`text`,onClick:e,disabled:!t,children:r})})})}});function jn(e){let t=()=>{global.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(e?.songArtist+` `+e?.songTitle)}`,`_blank`)},n=!!e.songTitle&&!!e.songArtist,i=xe(e.data.video);return(0,q.jsxs)(r,{sx:{display:`flex`,flexWrap:`wrap`},"data-test":`author-and-vid`,children:[(0,q.jsx)(f,{"data-test":`author-name`,sx:{mt:2},value:e.data.author,onChange:t=>e.onChange({...e.data,author:t.target.value}),label:`Author name (optional)`,fullWidth:!0,size:`small`,helperText:`Nickname of the person that created the .txt file.`}),(0,q.jsx)(f,{"data-test":`author-url`,sx:{mt:2},value:e.data.authorUrl,onChange:t=>e.onChange({...e.data,authorUrl:t.target.value}),label:`Author URL (optional)`,helperText:`Link to authors page/profile.`,fullWidth:!0,size:`small`}),(0,q.jsx)(r,{sx:{display:`flex`,flexDirection:`row`,mt:2,alignItems:`center`,width:`100%`},children:(0,q.jsx)(f,{"data-test":`video-url`,required:!0,value:e.data.video,onChange:t=>e.onChange({...e.data,video:t.target.value}),label:`YouTube Video URL`,placeholder:`https://www.youtube.com/watch?v=`,fullWidth:!0,size:`small`,helperText:`Link to YouTube video, eg https://www.youtube.com/watch?v=xxxxxxxxx. Click the 'Lookup' button to look for it on YouTube`,name:`videoUrl`,...An(t,n)})}),i&&(0,q.jsx)(r,{children:(0,q.jsx)(Ye,{videoId:i})})]})}async function Mn(e){try{let t=new URL(e);if(t.host===`usdb.animux.de`)return Pn(e,t);if(t.host===`ultrastar-es.org`)return Nn(e)}catch(e){console.warn(e)}}async function Nn(e){let t=await(await fetch(`/proxy?url=${encodeURIComponent(e)}`)).text(),n=new DOMParser().parseFromString(t,`text/html`),r=`https://ultrastar-es.org/pl/canciones/descargar/txt/${n.querySelector(`ul[data-id]`)?.getAttribute(`data-id`)}`;global.location.href=r;let i=n.querySelector(`#listado > ul > li > dl > dd:nth-child(6) > a`)?.getAttribute(`href`),a=n.querySelector(`#listado > ul > li`)?.getAttribute(`data-id`);return{authorUrl:i?`https://ultrastar-es.org`+i:``,author:n.querySelector(`#listado > ul > li > dl > dd:nth-child(6)`)?.textContent??``,video:a?`https://www.youtube.com/watch?v=`+a:``}}async function Pn(e,t){let n=await(await fetch(`/proxy?url=${encodeURIComponent(e)}`)).text(),r=new DOMParser().parseFromString(n,`text/html`),i=r.querySelector(`a[href^="?link=profil&id="]`)?.textContent,a=r.querySelector(`a[href^="?link=profil&id="]`)?.getAttribute?.(`href`),o=r.querySelector(`#tablebg > tbody > tr:nth-child(3) > td > table:nth-child(2) > tbody > tr.list_head > td:nth-child(1)`)?.textContent,s=r.querySelector(`#tablebg > tbody > tr:nth-child(3) > td > table:nth-child(2) > tbody > tr.list_head > td:nth-child(2)`)?.textContent;return global.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(o+` `+s)}`,`_blank`),global.open(`http://usdb.animux.de/index.php?link=gettxt&id=${t.searchParams.get(`id`)}`,`_blank`),{authorUrl:a?`http://usdb.animux.de/index.php`+a:``,author:i??``,video:``}}var Fn=e=>{let t=Math.floor(e/1e3/60),n=Math.floor(e/1e3)-t*60,r=Math.floor(e%1e3);return`${String(t).padStart(2,`0`)}:${String(n).padStart(2,`0`)}.${String(r).padStart(3,`0`)}`},In=e=>`playVideo`in e?{play:()=>e.playVideo(),pause:()=>e.pauseVideo(),seekTo:t=>e.seekTo(t,!0),setPlaybackSpeed:t=>e.setPlaybackRate(t),getCurrentTime:()=>e.getCurrentTime()}:e;const Ln=(e,t)=>(0,q.jsx)(n,{title:`Click to play the moment just before this time`,placement:`top`,arrow:!0,children:(0,q.jsx)(A,{sx:{py:.15,mb:.5},variant:`contained`,size:`small`,disabled:!t,onClick:t?()=>{He.resetPlayerNotes(),In(t).seekTo((e??0)/1e3-.7)}:void 0,children:(0,q.jsx)(kn,{children:Fn(e??0)})})});var Rn=Fn,zn={polish:{Ãˆ:`Ã©`,Ã­:`'`,"Â¥":`'`,"Â¯":`Å»`,"Â¹":`Ä…`,Ï€:`Ä…`,Ãª:`Ä™`,Ã:`Ä™`,Å’:`Åš`,Ã¥:`Åš`,Å“:`Å›`,Ãº:`Å›`,Ã¦:`Ä‡`,ÃŠ:`Ä‡`,"Â¿":`Å¼`,Ã¸:`Å¼`,Ã˜:`Å»`,Ã±:`Å„`,Ã’:`Å„`,"Â³":`Å‚`,"â‰¥":`Å‚`,"Â£":`Å`,Ã›:`Ã³`,Ã¼:`Åº`,Å¸:`Åº`},spanish:{Ã¸:`Â¿`,Ãˆ:`Ã©`,ÃŒ:`Ã­`,Ã’:`Ã±`,Å„:`Ã±`,"Â·":`Ã¡`,Ã›:`Ã³`,"Â°":`!`,"Ë™":`Ãº`,Å›:`Ãº`}};function Bn(e,t){let n=zn[t];if(n===void 0)return e;let r=e;for(let[e,t]of Object.entries(n))r=r.replaceAll(e,t);return r}function Vn(e){let t=e.split(`
`);for(let e of[`#TITLE`,`#ARTIST`,`#BPM`])if(!t.some(t=>t.startsWith(e)))return!1;if(!t.some(e=>e.startsWith(`:`)))return!1;try{ie(e)}catch(e){return console.log(e),!1}return!0}function Hn(e){let t=async t=>{if(e.onChange({...e.data,sourceUrl:t.target.value}),e.shouldAutoImport){let n=await Mn(t.target.value);n&&e.onAutoImport(n)}},n=t=>{e.onChange({...e.data,txtInput:Bn(e.data.txtInput,t)})},i=!(0,K.useMemo)(()=>Vn(e.data.txtInput),[e.data.txtInput])&&e.data.txtInput.length>0;return(0,q.jsxs)(r,{sx:{display:`flex`,flexWrap:`wrap`},"data-test":`basic-data`,children:[e.isTxtRequired&&(0,q.jsxs)(`div`,{children:[(0,q.jsx)(`h4`,{children:`Where to find songs?`}),(0,q.jsxs)(`p`,{children:[`Any UltraStar compatible .txt file will do. You can find many already made songs on`,` `,(0,q.jsx)(`a`,{href:`https://usdb.animux.de/`,target:`_blank`,rel:`noreferrer`,children:`usdb.animux.de`}),` or `,(0,q.jsx)(`a`,{href:`https://ultrastar-es.org/en`,target:`_blank`,rel:`noreferrer`,children:`ultrastar-es.org`}),`.`,(0,q.jsx)(`br`,{}),(0,q.jsx)(`br`,{})]}),(0,q.jsx)(`p`,{children:`You don't need audio/video files, you'll be able to search for appropriate YouTube video and synchronise the lyrics to it in subsequent steps.`})]}),(0,q.jsx)(f,{sx:{mt:2},value:e.data.sourceUrl,onChange:t,label:`Source URL (optional)`,fullWidth:!0,size:`small`,"data-test":`source-url`,helperText:`The link to the page from which the .TXT file was downloaded.`}),e.isTxtRequired?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(f,{error:i,helperText:i?`This doesn't look like a valid UltraStar .TXT format`:``,required:!0,sx:{mt:2},fullWidth:!0,size:`small`,multiline:!0,label:`Song's UltraStar .TXT file contents`,onChange:t=>e.onChange({...e.data,txtInput:t.target.value}),value:e.data.txtInput,maxRows:15,minRows:15,InputProps:{inputProps:{"data-test":`input-txt`,sx:{fontFamily:`monospace`}}}}),(0,q.jsxs)(r,{sx:{display:`flex`,gap:1,mt:1},children:[(0,q.jsx)(A,{onClick:()=>n(`polish`),children:`Fix ðŸ‡µðŸ‡± Polish accents`}),(0,q.jsx)(A,{onClick:()=>n(`spanish`),children:`Fix ðŸ‡ªðŸ‡¸ Spanish accents`})]})]}):(0,q.jsx)(`div`,{className:`flex h-150 w-full gap-1 overflow-auto`,children:e.finalSong?.tracks?.map((t,n)=>(0,q.jsxs)(`div`,{className:`flex flex-1 flex-col gap-1`,children:[(0,q.jsx)(`h4`,{className:`py-3`,children:t.name??`Track #${n+1}`}),t.sections.filter(U).map(t=>(0,q.jsxs)(`p`,{children:[(0,q.jsxs)(`span`,{className:`text-[0.75rem]`,children:[`[`,(0,q.jsx)(kn,{children:Rn(de(t,e.finalSong))}),`]`]}),` `,t.notes.map(e=>e.lyrics).join(``)]},t.start))]},n))})]})}const Un={AF:`Afghanistan`,AX:`Ã…land Islands`,AL:`Albania`,DZ:`Algeria`,AS:`American Samoa`,AD:`Andorra`,AO:`Angola`,AI:`Anguilla`,AQ:`Antarctica`,AG:`Antigua and Barbuda`,AR:`Argentina`,AM:`Armenia`,AW:`Aruba`,AU:`Australia`,AT:`Austria`,AZ:`Azerbaijan`,BS:`Bahamas`,BH:`Bahrain`,BD:`Bangladesh`,BE:`Belgium`,BZ:`Belize`,BJ:`Benin`,BM:`Bermuda`,BT:`Bhutan`,BO:`Bolivia`,BA:`Bosnia and Herzegovina`,BW:`Botswana`,BV:`Bouvet Island`,BR:`Brazil`,IO:`British Indian Ocean Territory`,BN:`Brunei Darussalam`,BG:`Bulgaria`,BF:`Burkina Faso`,BI:`Burundi`,KH:`Cambodia`,CM:`Cameroon`,CA:`Canada`,CV:`Cape Verde`,KY:`Cayman Islands`,CF:`Central African Republic`,TD:`Chad`,CL:`Chile`,CN:`China`,CX:`Christmas Island`,CC:`Cocos (Keeling) Islands`,CO:`Colombia`,KM:`Comoros`,CG:`Congo`,CD:`Congo`,CK:`Cook Islands`,CR:`Costa Rica`,CI:`Cote D Ivoire`,HR:`Croatia`,CU:`Cuba`,CY:`Cyprus`,CZ:`Czech Republic`,DK:`Denmark`,DJ:`Djibouti`,DM:`Dominica`,DO:`Dominican Republic`,EC:`Ecuador`,EG:`Egypt`,SV:`El Salvador`,GQ:`Equatorial Guinea`,ER:`Eritrea`,EE:`Estonia`,ET:`Ethiopia`,FK:`Falkland Islands (Malvinas)`,FO:`Faroe Islands`,FJ:`Fiji`,FI:`Finland`,FR:`France`,GF:`French Guiana`,PF:`French Polynesia`,TF:`French Southern Territories`,GA:`Gabon`,GM:`Gambia`,GE:`Georgia`,DE:`Germany`,GH:`Ghana`,GI:`Gibraltar`,GR:`Greece`,GL:`Greenland`,GD:`Grenada`,GP:`Guadeloupe`,GU:`Guam`,GT:`Guatemala`,GG:`Guernsey`,GN:`Guinea`,GW:`Guinea-Bissau`,GY:`Guyana`,HT:`Haiti`,HM:`Heard Island and Mcdonald Islands`,VA:`Holy See (Vatican City State)`,HN:`Honduras`,HK:`Hong Kong`,HU:`Hungary`,IS:`Iceland`,IN:`India`,ID:`Indonesia`,IR:`Iran`,IQ:`Iraq`,IE:`Ireland`,IM:`Isle of Man`,IL:`Israel`,IT:`Italy`,JM:`Jamaica`,JP:`Japan`,JE:`Jersey`,JO:`Jordan`,KZ:`Kazakhstan`,KE:`Kenya`,KI:`Kiribati`,KP:`South Korea`,KR:`North Korea`,KW:`Kuwait`,KG:`Kyrgyzstan`,LA:`Lao People Democratic Republic`,LV:`Latvia`,LB:`Lebanon`,LS:`Lesotho`,LR:`Liberia`,LY:`Libyan Arab Jamahiriya`,LI:`Liechtenstein`,LT:`Lithuania`,LU:`Luxembourg`,MO:`Macao`,MK:`Macedonia`,MG:`Madagascar`,MW:`Malawi`,MY:`Malaysia`,MV:`Maldives`,ML:`Mali`,MT:`Malta`,MH:`Marshall Islands`,MQ:`Martinique`,MR:`Mauritania`,MU:`Mauritius`,YT:`Mayotte`,MX:`Mexico`,FM:`Micronesia`,MD:`Moldova`,MC:`Monaco`,MN:`Mongolia`,MS:`Montserrat`,MA:`Morocco`,MZ:`Mozambique`,MM:`Myanmar`,NA:`Namibia`,NR:`Nauru`,NP:`Nepal`,NL:`Netherlands`,AN:`Netherlands Antilles`,NC:`New Caledonia`,NZ:`New Zealand`,NI:`Nicaragua`,NE:`Niger`,NG:`Nigeria`,NU:`Niue`,NF:`Norfolk Island`,MP:`Northern Mariana Islands`,NO:`Norway`,OM:`Oman`,PK:`Pakistan`,PW:`Palau`,PS:`Palestinian Territory`,PA:`Panama`,PG:`Papua New Guinea`,PY:`Paraguay`,PE:`Peru`,PH:`Philippines`,PN:`Pitcairn`,PL:`Poland`,PT:`Portugal`,PR:`Puerto Rico`,QA:`Qatar`,RE:`Reunion`,RO:`Romania`,RU:`Russian Federation`,RW:`Rwanda`,SH:`Saint Helena`,KN:`Saint Kitts and Nevis`,LC:`Saint Lucia`,PM:`Saint Pierre and Miquelon`,VC:`Saint Vincent and the Grenadines`,WS:`Samoa`,SM:`San Marino`,ST:`Sao Tome and Principe`,SA:`Saudi Arabia`,SN:`Senegal`,CS:`Serbia and Montenegro`,SC:`Seychelles`,SL:`Sierra Leone`,SG:`Singapore`,SK:`Slovakia`,SI:`Slovenia`,SB:`Solomon Islands`,SO:`Somalia`,ZA:`South Africa`,GS:`South Georgia and the South Sandwich Islands`,ES:`Spain`,LK:`Sri Lanka`,SD:`Sudan`,SR:`Suriname`,SJ:`Svalbard and Jan Mayen`,SZ:`Swaziland`,SE:`Sweden`,CH:`Switzerland`,SY:`Syrian Arab Republic`,TW:`Taiwan`,TJ:`Tajikistan`,TZ:`Tanzania`,TH:`Thailand`,TL:`Timor-Leste`,TG:`Togo`,TK:`Tokelau`,TO:`Tonga`,TT:`Trinidad and Tobago`,TN:`Tunisia`,TR:`Turkey`,TM:`Turkmenistan`,TC:`Turks and Caicos Islands`,TV:`Tuvalu`,UG:`Uganda`,UA:`Ukraine`,AE:`United Arab Emirates`,GB:`United Kingdom`,US:`United States`,UY:`Uruguay`,UZ:`Uzbekistan`,VU:`Vanuatu`,VE:`Venezuela`,VN:`Vietnam`,VI:`Virgin Islands`,WF:`Wallis and Futuna`,EH:`Western Sahara`,YE:`Yemen`,ZM:`Zambia`,ZW:`Zimbabwe`};var Wn=10;function Gn({data:e,onChange:t,videoId:n,videoGap:i=0}){let a=(0,K.useRef)(null),o=(0,K.useRef)(null),[s,l]=(0,K.useState)(!1);(0,K.useEffect)(()=>{let n=setInterval(async()=>{if(!s)e.volume===0?(t({...e,volume:.7}),await a.current?.getInternalPlayer()?.setVolume(70)):await a.current?.getInternalPlayer()?.setVolume(e.volume*100),l(!0);else{let n=await a.current?.getInternalPlayer()?.getVolume();n!==void 0&&n!==e.volume*100&&t({...e,volume:n/100})}},500);return()=>{clearInterval(n)}},[s,e,t]);let[u,d]=(0,K.useState)(!1),[f,p]=(0,K.useState)(!1),m=async(n,r)=>{await a.current?.getInternalPlayer()?.setVolume(r*100),t({...e,volume:+r})},h=e.previewStart??i+60,g=e.previewEnd??h+30,[_,v]=(0,K.useState)(null);(0,K.useEffect)(()=>{o.current&&(o.current.currentTime=35),a.current?.getInternalPlayer()?.getDuration().then(v)},[]),(0,K.useEffect)(()=>{if(_!==null&&_<g){let n=Math.max(_-i-Wn,0)/2,r=Math.max(i+n,0),a=Math.max(r+Wn,_);t({...e,previewStart:r,previewEnd:a})}},[_,e,g,t,i]);let y=a.current?.getInternalPlayer();return(0,q.jsxs)(r,{sx:{display:`flex`,flexDirection:`column`,width:`100%`},gap:1,children:[(0,q.jsxs)(`h4`,{children:[`Set song preview (start: `,Ln(h*1e3,y),`, end:`,` `,Ln(g*1e3,y),`)`]}),(0,q.jsx)(r,{sx:{display:`flex`,gap:5},children:(0,q.jsx)(c,{"data-test":`song-preview`,disabled:_===null,step:1,value:[h,g],max:(_??500)-Wn,onChange:(n,r)=>{let[i,a]=r;a-i>Wn&&t({...e,previewStart:i,previewEnd:a})}})}),(0,q.jsx)(`h4`,{children:`Adjust volume`}),(0,q.jsxs)(r,{sx:{display:`flex`,gap:5},children:[(0,q.jsxs)(r,{sx:{display:`flex`,flexDirection:`column`,gap:1},children:[(0,q.jsx)(`h5`,{children:`Song`}),(0,q.jsx)(Ye,{videoId:n,ref:a,onPlay:()=>{d(!0),f&&(o.current?.pause(),setTimeout(()=>p(!0),200))},onPause:()=>{p(!1)}})]}),(0,q.jsxs)(r,{sx:{display:`flex`,flexDirection:`column`,gap:1},children:[(0,q.jsx)(`h5`,{children:`Reference sound`}),(0,q.jsx)(`p`,{children:`Use the slider below to make the video volume roughly the same as this music.`}),(0,q.jsx)(`br`,{}),(0,q.jsx)(`audio`,{ref:o,controls:!0,src:ne,loop:!0,onLoad:e=>e.currentTarget.currentTime=35,onPlay:e=>{e.currentTarget.volume=.5,p(!0),u&&(a.current?.getInternalPlayer()?.pauseVideo(),setTimeout(()=>d(!0),200))},onPause:()=>{p(!1),u&&a.current?.getInternalPlayer()?.playVideo()}})]})]}),(0,q.jsxs)(`h5`,{children:[`Final Song Volume (`,e.volume*100,`)`]}),(0,q.jsx)(r,{children:(0,q.jsx)(c,{"data-test":`volume`,min:.1,max:1,step:.01,"aria-label":`Volume`,value:e.volume,onChange:m})})]})}var Kn=e=>{let t=oe(!0);return(0,K.useMemo)(()=>{let n=t.data.filter(t=>t.artist===e).map(e=>e.artistOrigin).filter(Boolean).reduce((e,t)=>(e[t]?e[t]++:e[t]=1,e),{});return Object.entries(n).sort((e,t)=>t[1]-e[1])?.[0]?.[0]??``},[e,t.data])};function qn(e){let t=oe(!0),n=Kn(e.songArtist??``);(0,K.useEffect)(()=>{e.data.artistOrigin===void 0&&(console.log(`props.data.artistOrigin`,n),e.onChange({...e.data,artistOrigin:n}))},[n,e.data]);let r=(0,K.useMemo)(()=>[...new Set(t.data.map(({language:e})=>Array.isArray(e)?e:[e]).flat().filter(Boolean))],[t.data]),a=Un,o=(0,K.useMemo)(()=>[...new Set(t.data.map(e=>e.genre).filter(Boolean).map(e=>e.toLowerCase().replace(/\b\w/g,e=>e.toUpperCase().trim())))],[t.data]),s=(0,K.useMemo)(()=>[...new Set(t.data.map(e=>e.edition).filter(Boolean).map(e=>e.toLowerCase().replace(/\b\w/g,e=>e.toUpperCase().trim())))].sort(),[t.data]),c=t=>{global.open(`https://www.google.com/search?q=${encodeURIComponent(`${e.data.artist} ${e.data.title} ${t}`)}`,`_blank`)},u=!!e.data.title&&!!e.data.artist,d=+(e.data?.realBpm??0)>200,[h,g]=(0,K.useState)(!1);return(0,q.jsxs)(i,{container:!0,spacing:2,"data-test":`song-metadata`,children:[(0,q.jsx)(i,{item:!0,xs:6,children:(0,q.jsx)(f,{value:e.data.artist,onChange:t=>e.onChange({...e.data,artist:t.target.value}),label:`Song artist`,size:`small`,"data-test":`song-artist`,required:!0,fullWidth:!0})}),(0,q.jsx)(i,{item:!0,xs:6,children:(0,q.jsx)(f,{value:e.data.title,onChange:t=>e.onChange({...e.data,title:t.target.value}),label:`Song title`,fullWidth:!0,size:`small`,required:!0,"data-test":`song-title`})}),(0,q.jsx)(i,{item:!0,xs:3,children:(0,q.jsx)(T,{onKeyDown:e=>{e.key===`Enter`&&e.preventDefault()},freeSolo:!0,disableClearable:!0,options:o,value:e.data.genre??``,onChange:(t,n)=>e.onChange({...e.data,genre:n}),renderInput:t=>(0,q.jsx)(f,{...t,onBlur:t=>e.onChange({...e.data,genre:t.target.value}),label:`Song genre (optional)`,size:`small`,"data-test":`song-genre`,fullWidth:!0})})}),(0,q.jsx)(i,{item:!0,xs:3,children:(0,q.jsx)(T,{onKeyDown:e=>{e.key===`Enter`&&e.preventDefault()},freeSolo:!0,disableClearable:!0,options:s,value:e.data.edition??``,onChange:(t,n)=>e.onChange({...e.data,edition:n}),renderInput:t=>(0,q.jsx)(f,{...t,onBlur:t=>e.onChange({...e.data,edition:t.target.value}),label:`Song edition (optional)`,size:`small`,"data-test":`song-edition`,helperText:`Songs with the same theme, e.g. 'Christmas'`,fullWidth:!0})})}),(0,q.jsx)(i,{item:!0,xs:3,children:(0,q.jsx)(T,{onKeyDown:e=>{e.key===`Enter`&&e.preventDefault()},multiple:!0,freeSolo:!0,disableClearable:!0,options:r,value:typeof e.data.language==`string`?[e.data.language]:e.data.language,onChange:(t,n)=>{e.onChange({...e.data,language:n?n.filter(Boolean):e.data.language})},renderInput:t=>(0,q.jsx)(f,{...t,label:`Song language`,fullWidth:!0,size:`small`,required:!e.data.language?.length,"data-test":`song-language`})})}),(0,q.jsx)(i,{item:!0,xs:3,children:(0,q.jsxs)(m,{fullWidth:!0,children:[(0,q.jsx)(p,{id:`song-origin-select-label`,size:`small`,children:`Song/artist origin (optional)`}),(0,q.jsxs)(x,{"data-test":`artist-origin`,size:`small`,labelId:`song-origin-select-label`,id:`song-origin-select`,value:e.data.artistOrigin??``,label:`Song/artist origin (optional)`,onChange:t=>e.onChange({...e.data,artistOrigin:t.target.value}),children:[(0,q.jsx)(l,{value:``,children:`None`},`none`),Object.entries(a).map(([e,t])=>(0,q.jsxs)(l,{value:e,children:[(0,q.jsx)(Jn,{isocode:e}),` `,t]},e))]}),(0,q.jsx)(v,{children:`Used to show the flag on the list`})]})}),(0,q.jsx)(i,{item:!0,xs:6,children:(0,q.jsx)(f,{"data-test":`release-year`,value:e.data.year,onChange:t=>e.onChange({...e.data,year:t.target.value}),label:`Release year`,helperText:`The year the song was released. Click the 'Lookup' button to look for it on Google`,fullWidth:!0,size:`small`,required:!0,...An(()=>c(`release year`),u)})}),(0,q.jsx)(i,{item:!0,xs:6,children:(0,q.jsx)(f,{"data-test":`song-bpm`,value:e.data.realBpm,onChange:t=>e.onChange({...e.data,realBpm:t.target.value}),label:`Song (real) BPM`,focused:d?!0:void 0,helperText:d?(0,q.jsxs)(q.Fragment,{children:[`Usually songs don't have higher BPM than `,(0,q.jsx)(`b`,{children:`200`}),`. Make sure the value is correct (you can still save the song)`]}):`The actual tempo of the song. Click the 'Lookup' button to look for it on Google. ${h?`If you can't find it, you can still save the song`:``}`,color:d?`warning`:void 0,fullWidth:!0,type:`number`,size:`small`,required:!h,...An(()=>{g(!0),c(`tempo`)},u)})}),(0,q.jsx)(i,{item:!0,xs:12}),(0,q.jsx)(i,{item:!0,xs:12,children:(0,q.jsx)(Gn,{...e})})]})}var Jn=L(me,{target:`e70j9sv0`})({name:`3kqygp`,styles:`width:1em;margin-right:0.5em;display:inline-block`});function Yn(e){return F(`MuiButtonGroup`,e)}var X=P(`MuiButtonGroup`,`root.contained.outlined.text.disableElevation.disabled.firstButton.fullWidth.horizontal.vertical.colorPrimary.colorSecondary.grouped.groupedHorizontal.groupedVertical.groupedText.groupedTextHorizontal.groupedTextVertical.groupedTextPrimary.groupedTextSecondary.groupedOutlined.groupedOutlinedHorizontal.groupedOutlinedVertical.groupedOutlinedPrimary.groupedOutlinedSecondary.groupedContained.groupedContainedHorizontal.groupedContainedVertical.groupedContainedPrimary.groupedContainedSecondary.lastButton.middleButton`.split(`.`)),Xn=(e,t)=>{let{ownerState:n}=e;return[{[`& .${X.grouped}`]:t.grouped},{[`& .${X.grouped}`]:t[`grouped${M(n.orientation)}`]},{[`& .${X.grouped}`]:t[`grouped${M(n.variant)}`]},{[`& .${X.grouped}`]:t[`grouped${M(n.variant)}${M(n.orientation)}`]},{[`& .${X.grouped}`]:t[`grouped${M(n.variant)}${M(n.color)}`]},{[`& .${X.firstButton}`]:t.firstButton},{[`& .${X.lastButton}`]:t.lastButton},{[`& .${X.middleButton}`]:t.middleButton},t.root,t[n.variant],n.disableElevation===!0&&t.disableElevation,n.fullWidth&&t.fullWidth,n.orientation===`vertical`&&t.vertical]},Zn=e=>{let{classes:t,color:n,disabled:r,disableElevation:i,fullWidth:a,orientation:o,variant:s}=e;return N({root:[`root`,s,o,a&&`fullWidth`,i&&`disableElevation`,`color${M(n)}`],grouped:[`grouped`,`grouped${M(o)}`,`grouped${M(s)}`,`grouped${M(s)}${M(o)}`,`grouped${M(s)}${M(n)}`,r&&`disabled`],firstButton:[`firstButton`],lastButton:[`lastButton`],middleButton:[`middleButton`]},Yn,t)},Qn=H(`div`,{name:`MuiButtonGroup`,slot:`Root`,overridesResolver:Xn})(I(({theme:e})=>({display:`inline-flex`,borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{variant:`contained`},style:{boxShadow:(e.vars||e).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:`none`}},{props:{fullWidth:!0},style:{width:`100%`}},{props:{orientation:`vertical`},style:{flexDirection:`column`,[`& .${X.lastButton},& .${X.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${X.firstButton},& .${X.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:`horizontal`},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${X.lastButton},& .${X.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:`text`,orientation:`horizontal`},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderRight:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode===`light`?`rgba(0, 0, 0, 0.23)`:`rgba(255, 255, 255, 0.23)`}`,[`&.${X.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},{props:{variant:`text`,orientation:`vertical`},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderBottom:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode===`light`?`rgba(0, 0, 0, 0.23)`:`rgba(255, 255, 255, 0.23)`}`,[`&.${X.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},...Object.entries(e.palette).filter(Qe()).flatMap(([t])=>[{props:{variant:`text`,color:t},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderColor:e.vars?`rgba(${e.vars.palette[t].mainChannel} / 0.5)`:rt(e.palette[t].main,.5)}}}]),{props:{variant:`outlined`,orientation:`horizontal`},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderRightColor:`transparent`,"&:hover":{borderRightColor:`currentColor`}},[`& .${X.lastButton},& .${X.middleButton}`]:{marginLeft:-1}}},{props:{variant:`outlined`,orientation:`vertical`},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderBottomColor:`transparent`,"&:hover":{borderBottomColor:`currentColor`}},[`& .${X.lastButton},& .${X.middleButton}`]:{marginTop:-1}}},{props:{variant:`contained`,orientation:`horizontal`},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderRight:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${X.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},{props:{variant:`contained`,orientation:`vertical`},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderBottom:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${X.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},...Object.entries(e.palette).filter(Qe([`dark`])).map(([t])=>({props:{variant:`contained`,color:t},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderColor:(e.vars||e).palette[t].dark}}}))],[`& .${X.grouped}`]:{minWidth:40,boxShadow:`none`,props:{variant:`contained`},style:{"&:hover":{boxShadow:`none`}}}}))),Z=K.forwardRef(function(e,t){let n=B({props:e,name:`MuiButtonGroup`}),{children:r,className:i,color:a=`primary`,component:o=`div`,disabled:s=!1,disableElevation:c=!1,disableFocusRipple:l=!1,disableRipple:u=!1,fullWidth:d=!1,orientation:f=`horizontal`,size:p=`medium`,variant:m=`outlined`,...h}=n,g={...n,color:a,component:o,disabled:s,disableElevation:c,disableFocusRipple:l,disableRipple:u,fullWidth:d,orientation:f,size:p,variant:m},_=Zn(g),v=K.useMemo(()=>({className:_.grouped,color:a,disabled:s,disableElevation:c,disableFocusRipple:l,disableRipple:u,fullWidth:d,size:p,variant:m}),[a,s,c,l,u,d,p,m,_.grouped]),y=Nt(r),b=y.length,x=e=>{let t=e===0,n=e===b-1;return t&&n?``:t?_.firstButton:n?_.lastButton:_.middleButton};return(0,q.jsx)(Qn,{as:o,role:`group`,className:z(_.root,i),ref:t,ownerState:g,...h,children:(0,q.jsx)(Ee.Provider,{value:v,children:y.map((e,t)=>(0,q.jsx)(et.Provider,{value:x(t),children:e},t))})})});function Q({shortcutKey:e,children:t}){return _(e=>e.breakpoints.down(`sm`))?t:(0,q.jsx)(n,{disableInteractive:!0,title:`${e}`,placement:`bottom-end`,open:!0,slotProps:{popper:{modifiers:[{name:`offset`,options:{offset:[5,-20]}}]}},children:t})}function $n({player:e,playbackSpeed:n,setPlaybackSpeed:i}){let a=async t=>{let n=await e.getCurrentTime();e.seekTo(((n??0)+t)/1e3)},o=(0,K.useRef)(null);return(0,K.useEffect)(()=>{let t=setInterval(async()=>{if(o.current){let t=await e.getCurrentTime();o.current.textContent=`${Rn(t)} (${Math.round(t)} ms)`}},50);return()=>clearInterval(t)},[e]),(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(r,{children:[(0,q.jsxs)(V,{"data-test":`current-time`,children:[`Current time: `,(0,q.jsx)(kn,{ref:o})]}),(0,q.jsxs)(r,{sx:{display:`flex`,gap:1},children:[(0,q.jsxs)(Z,{variant:`contained`,sx:{display:`flex`,mt:1,flex:1},children:[(0,q.jsx)(A,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(-1e4),"data-test":`seek-10s`,children:`-10`}),(0,q.jsx)(A,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(-5e3),"data-test":`seek-5s`,children:`-5`}),(0,q.jsx)(A,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(-1e3),"data-test":`seek-1s`,children:`-1`}),(0,q.jsx)(A,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(-500),"data-test":`seek-0.5s`,children:`-0.5`})]}),(0,q.jsx)(t,{}),(0,q.jsxs)(Z,{variant:`contained`,sx:{display:`flex`,mt:1,flex:1},children:[(0,q.jsx)(A,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(500),"data-test":`seek+0.5s`,children:`+0.5`}),(0,q.jsx)(A,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(1e3),"data-test":`seek+1s`,children:`+1`}),(0,q.jsx)(A,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(5e3),"data-test":`seek+5s`,children:`+5`}),(0,q.jsx)(A,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(1e4),"data-test":`seek+10s`,children:`+10`})]})]})]}),(0,q.jsxs)(r,{children:[(0,q.jsxs)(V,{children:[`Playback speed: `,(0,q.jsxs)(kn,{"data-test":`current-speed`,children:[n*100,`%`]})]}),(0,q.jsx)(Q,{shortcutKey:`1/2/3/4`,children:(0,q.jsx)(Z,{variant:`contained`,sx:{display:`flex`,mt:1},children:[.25,.5,.75,1,1.25,1.5,2].map(e=>(0,q.jsxs)(A,{size:`small`,"data-test":`speed-${e}`,sx:{flex:1},onClick:()=>{i(e)},disabled:n===e,children:[e*100,`%`]},e))})})]})]})}function er(e,t,n,r){let[i,a]=(0,K.useState)(-1);return(0,K.useEffect)(()=>{let i=setInterval(async()=>{let i=(await t.getCurrentTime()-r)/n,o=Math.floor(i);a(e.findIndex((t,n)=>o<0?!0:o<t.start?!1:n===e.length-1||e[n+1].start>o))},50);return()=>clearInterval(i)},[e,t,n,r]),i}function tr({song:e,beatLength:t,player:n,onRecordChange:i,onLyricChange:a,playbackSpeed:o,onTrackNameChange:s,lyricChanges:c}){let[l,u]=(0,K.useState)(0),[d,p]=(0,K.useState)(-1),[m,h]=(0,K.useState)([]),g=e.tracks[l].sections.filter(U),_=er(g,n,t,e.gap),v=t=>{p(t),He.resetPlayerNotes();let r=de(g[t],e);n.seekTo(r/1e3-.8*o)},y=()=>{h(e=>[...e,{type:`delete`,section:d,track:l}]),d===g.length-1&&p(e=>e-1)},x=e=>{h(t=>{let n=t.at(-1);if(n&&n.type===`shift`&&n.track===l&&n.section===d){let n=[...t];return n.at(-1).shift=e,n}return[...t,{type:`shift`,section:d,track:l,shift:e}]})};return(0,K.useEffect)(()=>{i(m)},[i,m]),(0,q.jsxs)(or,{children:[(0,q.jsxs)(k,{direction:`row`,children:[(0,q.jsxs)(V,{variant:`h6`,mb:0,sx:{flex:1,display:`flex`,alignItems:`center`},children:[`Edit verses`,e.tracks.length>1&&(0,q.jsx)(Z,{variant:`contained`,sx:{ml:2},size:`small`,children:e.tracks.map((e,t)=>(0,q.jsxs)(A,{onClick:()=>u(t),disabled:l===t,"data-test":`track-${t+1}`,children:[`Track `,t+1]},t))})]}),(0,q.jsx)(f,{label:`Track name`,placeholder:`Set track name`,sx:{flex:1},size:`small`,value:e.tracks[l]?.name??``,onChange:e=>s(l,e.target.value),"data-test":`track-name`})]}),(0,q.jsxs)(k,{direction:`row`,spacing:2,sx:{height:`400px`,mt:3},children:[(0,q.jsx)(D,{sx:{overflowY:`auto`},children:g.map((e,t)=>(0,q.jsx)(b,{disablePadding:!0,"data-test":`section-${t}`,sx:{maxWidth:250,overflowX:`hidden`,textWrap:`ellipsis`,whiteSpace:`nowrap`},children:(0,q.jsx)(Ut,{onClick:()=>v(t),selected:d===t,children:(0,q.jsx)(zt,{primaryTypographyProps:{fontWeight:t===_?`bold`:`normal`},primary:U(e)?e.notes.map(e=>e.lyrics.replaceAll(` `,`Â·`)).join(``):`[pause]`})})},e.start))}),(0,q.jsx)(sr,{children:d>-1&&(0,q.jsxs)(q.Fragment,{children:[d===0&&(0,q.jsx)(`h3`,{"data-test":`use-gap-info`,children:`Use gap shift to change when this section starts`}),d>0&&(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(f,{"data-test":`change-start-beat`,size:`small`,type:`number`,onChange:e=>x(+e.target.value),value:ye([g[d]]),label:`Change start beat`,InputProps:{inputProps:{step:1}},fullWidth:!0,sx:{mb:2},helperText:(0,q.jsxs)(q.Fragment,{children:[`Timestamp:`,` `,Ln(ye([g[d]])*t+e.gap,n)]})})}),(0,q.jsx)(cr,{children:g[d].notes.map((e,t)=>{let n=c[l]?.[d]?.[t]??e.lyrics;return(0,q.jsx)(lr,{style:{width:`${n.length}ch`},value:n,"data-test":`lyric-input-${t}`,onChange:e=>{a({section:d,track:l,noteIndex:t,newLyric:e.target.value})},onKeyDown:e=>{let t=e.target.selectionStart;if(e.key===`ArrowLeft`&&t===0){let t=e.target?.previousElementSibling;t&&(t.focus(),setTimeout(()=>t.setSelectionRange(t.value.length,t.value.length),10))}else if(e.key===`ArrowRight`&&t===e.target.value.length){let t=e.target?.nextElementSibling;t&&(t.focus(),setTimeout(()=>t.setSelectionRange(0,0),10))}}},t)})}),(0,q.jsx)(A,{variant:`contained`,color:`error`,onClick:y,fullWidth:!0,"data-test":`delete-section`,children:`Delete section`})]})}),(0,q.jsxs)(nr,{children:[(0,q.jsx)(r,{sx:{overflowY:`auto`,maxHeight:`34rem`},"data-test":`change-list`,children:m.map((e,t)=>{let n=``,r=ir;return e.type===`delete`?(r=ir,n=`Deleted`):e.type===`shift`&&(r=ar,n=`Start -> ${e.shift}`),(0,q.jsx)(r,{children:(0,q.jsxs)(`strong`,{children:[`Track: `,e.track+1,`, Section: `,e.section+1,`, `,n]})},t)})}),m.length>0&&(0,q.jsx)(A,{"data-test":`undo-change`,variant:`contained`,color:`warning`,onClick:()=>h(e=>e.filter((t,n)=>n!==e.length-1)),fullWidth:!0,children:`Undo last change`})]})]})]})}var nr=L(`div`,{target:`e18sxv6t7`})({name:`82a6rk`,styles:`flex:1`}),rr=L(`div`,{target:`e18sxv6t6`})({name:`m1a2da`,styles:`padding:0.5rem`}),ir=L(rr,{target:`e18sxv6t5`})({name:`hwfcu5`,styles:`color:red`}),ar=L(rr,{target:`e18sxv6t4`})({name:`zzs6wi`,styles:`color:#0059ff`}),or=L(`div`,{target:`e18sxv6t3`})(``),sr=L(`div`,{target:`e18sxv6t2`})({name:`82a6rk`,styles:`flex:1`}),cr=L(`div`,{target:`e18sxv6t1`})({name:`1qhi3cl`,styles:`display:flex;gap:0.25rem;column-gap:0;margin-bottom:1rem;align-items:center;flex-wrap:wrap`}),lr=L(`input`,{target:`e18sxv6t0`})({name:`1bv0k4z`,styles:`font-family:monospace;background:#f6f6f6;width:3rem;padding:0.5rem 0.1rem;border:0;border-right:1px solid #ececec;text-decoration:underline;box-sizing:content-box;&:focus{background:#ececec;outline:none!important;}`});function ur(e,t){let n=t.tracks[0].sections.filter(U).at(-1)?.notes.at(-1),r=e-t.gap,i=n.start+n.length;return Number((6e4/(r/i*t.bar)).toFixed(2))}function dr({current:e,onChange:t,song:n}){let r=be(Math.max(...n.tracks.map(e=>Ce(e.sections))),n)+n.gap,[i,a]=(0,K.useState)(Math.round(r));return(0,q.jsxs)(`div`,{className:`mb-2 flex items-start gap-2`,children:[(0,q.jsx)(f,{"data-test":`desired-end`,size:`small`,type:`number`,value:i,onChange:e=>a(+e.target.value),label:`Target last note end time (ms)`,sx:{flex:1},helperText:i?(0,q.jsxs)(q.Fragment,{children:[`Estimated proper Tempo (BPM) of the lyrics:`,` `,(0,q.jsx)(kn,{"data-test":`desired-bpm`,children:ur(i,n)})]}):` `}),(0,q.jsxs)(`div`,{className:`flex flex-1`,children:[(0,q.jsx)(Q,{shortcutKey:`z`,children:(0,q.jsx)(A,{sx:{minWidth:`40px`,width:`40px`},variant:`contained`,size:`small`,onClick:()=>t(e-.1),children:`-`})}),(0,q.jsx)(f,{"data-test":`change-bpm`,size:`small`,type:`number`,value:e,onChange:e=>!isNaN(+e.target.value)&&t(+e.target.value),label:`Tempo (BPM) of the lyrics`,sx:{flex:1},InputProps:{inputProps:{step:`0.1`}}}),(0,q.jsx)(Q,{shortcutKey:`w`,children:(0,q.jsx)(A,{variant:`contained`,size:`small`,sx:{minWidth:`40px`,width:`40px`},onClick:()=>t(e+.1),children:`+`})})]})]})}function fr({current:e,onChange:t,player:n,finalGap:i}){let a=n=>{t(String(Number(e)+n))};return(0,q.jsxs)(r,{flex:`1`,children:[(0,q.jsxs)(V,{children:[`Lyrics Gap shift (final: `,Ln(i,n),`)`]}),(0,q.jsxs)(`div`,{className:`mt-1 flex gap-1`,children:[(0,q.jsxs)(Z,{sx:{flex:1},children:[(0,q.jsx)(A,{sx:{flex:1,px:1},onClick:()=>a(-1e3),"data-test":`shift-gap-1s`,children:`-1000`}),(0,q.jsx)(A,{sx:{flex:1,px:1},onClick:()=>a(-500),"data-test":`shift-gap-0.5s`,children:`-500`}),(0,q.jsx)(Q,{shortcutKey:`a`,children:(0,q.jsx)(A,{sx:{flex:1,px:1},onClick:()=>a(-50),"data-test":`shift-gap-0.05s`,children:`-50`})})]}),(0,q.jsx)(f,{sx:{py:0,flex:1},size:`small`,type:`text`,value:e,onChange:e=>t(e.target.value),label:`Miliseconds`,"data-test":`shift-gap`}),(0,q.jsxs)(Z,{sx:{flex:1},children:[(0,q.jsx)(Q,{shortcutKey:`s`,children:(0,q.jsx)(A,{sx:{flex:1,px:1},onClick:()=>a(50),"data-test":`shift-gap+0.05s`,children:`+50`})}),(0,q.jsx)(A,{sx:{flex:1,px:1},onClick:()=>a(500),"data-test":`shift-gap+0.5s`,children:`+500`}),(0,q.jsx)(A,{sx:{flex:1,px:1},onClick:()=>a(1e3),"data-test":`shift-gap+1s`,children:`+1000`})]})]})]})}function pr({current:e,onChange:t,player:n,finalGap:i}){return(0,q.jsxs)(r,{flex:`1`,children:[(0,q.jsxs)(V,{children:[`Video Gap shift (final: `,Ln((i??0)*1e3,n),`)`]}),(0,q.jsxs)(r,{sx:{display:`flex`,gap:1,mt:1},children:[(0,q.jsxs)(Z,{sx:{flex:1},children:[(0,q.jsx)(A,{sx:{flex:1,px:1.25},onClick:()=>t(e-10),"data-test":`shift-video-gap-10s`,children:`-10`}),(0,q.jsx)(A,{sx:{flex:1,px:1.25},onClick:()=>t(e-5),"data-test":`shift-video-gap-5s`,children:`-5`}),(0,q.jsx)(A,{sx:{flex:1,px:1.25},onClick:()=>t(e-1),"data-test":`shift-video-gap-1s`,children:`-1`})]}),(0,q.jsx)(f,{"data-test":`shift-video-gap`,sx:{py:0,flex:1},size:`small`,type:`text`,value:e,onChange:e=>t(+e.target.value),label:`Seconds`}),(0,q.jsxs)(Z,{sx:{flex:1},children:[(0,q.jsx)(A,{sx:{flex:1,px:1.25},onClick:()=>t(e+1),"data-test":`shift-video-gap+1s`,children:`+1`}),(0,q.jsx)(A,{sx:{flex:1,px:1.25},onClick:()=>t(e+5),"data-test":`shift-video-gap+5s`,children:`+5`}),(0,q.jsx)(A,{sx:{flex:1,px:1.25},onClick:()=>t(e+10),"data-test":`shift-video-gap+10s`,children:`+10`})]})]})]})}var mr=(e,t)=>({...e,gap:e.gap+t}),hr=(e,t)=>({...e,videoGap:(e.videoGap??0)+t}),gr=(e,t)=>({...e,bpm:t}),_r=(e,t)=>({...e,tracks:e.tracks.map((e,n)=>{let r=t.filter(e=>e.track===n),i=[...e.sections].filter(U);return r.forEach(e=>{if(e.type===`delete`)i=i.filter((t,n)=>n!==e.section);else if(e.type===`shift`){let t=e.shift-ye([i[e.section]]);i=i.map((n,r)=>r<e.section?n:{...n,notes:n.notes.map(e=>({...e,start:e.start+t}))})}}),{...e,sections:i}})}),vr=(e,t)=>({...e,tracks:e.tracks.map((e,n)=>({...e,name:t[n]??e.name}))}),yr=(e,t)=>({...e,tracks:e.tracks.map((e,n)=>{let r=t[n]??{};return{...e,sections:e.sections.map((e,t)=>{let n=r[t]??{};return U(e)?{...e,notes:e.notes.map((e,t)=>({...e,lyrics:n[t]??e.lyrics}))}:e})}})});function br({song:e,onUpdate:t,visible:n}){let a=(0,K.useRef)(null),[o,s]=(0,K.useState)(1),{width:c}=ze(),l=Math.min(c-16,824),u=l/16*9,[d,f]=(0,K.useState)(`0`),[p,m]=(0,K.useState)(0),[h,g]=(0,K.useState)(e.bpm),[_,v]=(0,K.useState)([]),[y,b]=(0,K.useState)(e.tracks.map(e=>e.name??void 0)),[x,S]=(0,K.useState)({}),C=(0,K.useMemo)(()=>{let t=Mt(e);return t=re(t),t=Ue(t),t=ee(t),isNaN(Number(d))||(t=mr(t,Number(d))),t=hr(t,p),t=gr(t,h),t=_r(t,_),t=vr(t,y),t=yr(t,x),t=ee(t),t=ae(t),t},[d,p,e,h,_,y,x]);(0,K.useEffect)(()=>{t?.(C)},[t,C]);let w=(0,K.useMemo)(()=>({id:`test`,mode:te.DUEL,players:[{number:0,track:0},{number:1,track:e.tracks.length-1}],tolerance:6}),[e]),T=he(C);(0,K.useEffect)(()=>{n||a.current?.pause()},[n]),(0,K.useEffect)(()=>{a.current?.setPlaybackSpeed(o)},[o]);let E=(e,t=.5*o)=>{e&&a.current&&(a.current.seekTo((e.start*T+C.gap)/1e3-t),a.current.play())},D=e=>{E(_e(C.tracks[0].sections),e)},O=async(e,t)=>{if(!a.current)return;let n=we(await a.current.getCurrentTime(),T,C.gap),r=C.tracks[0].sections.filter(U),i=r.filter(e=>e.start<=n).length-1+e;E(r[Math.max(Math.min(i,r.length-1),0)].notes[0],t)},k=e=>{O(1,e)},ne=e=>{O(-1,e)},ie=e=>{let t=se(C.tracks[0].sections)?.notes[0];E(t,e)};return R(`1`,()=>{s(.25)},[C,s]),R(`2`,()=>{s(.5)},[C,s]),R(`3`,()=>{s(1)},[C,s]),R(`4`,()=>{s(2)},[C,s]),R(`q`,()=>{D()},[C,D]),R(`w`,()=>{ne()},[C,ne]),R(`e`,()=>{k()},[C,k]),R(`r`,()=>{ie()},[C]),R(`a`,()=>{f(e=>String(Number(e)-50))}),R(`s`,()=>{f(e=>String(Number(e)+50))}),R(`z`,()=>{g(e=>e-.1)}),R(`x`,()=>{g(e=>e+.1)}),(0,q.jsxs)(i,{container:!0,spacing:2,sx:{display:n?void 0:`none`},children:[(0,q.jsx)(i,{item:!0,xs:12,sm:8,"data-test":`player-container`,children:(0,q.jsx)(r,{sx:{width:l,height:u},children:(0,q.jsx)(Ze,{song:C,showControls:!0,autoplay:!1,width:l,height:u,ref:a,effectsEnabled:!1,singSetup:w,onSongEnd:()=>void 0},0)})}),(0,q.jsxs)(i,{item:!0,xs:12,sm:4,sx:{display:`flex`,flexDirection:`column`,gap:2},children:[a.current&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)($n,{player:a.current,playbackSpeed:o,setPlaybackSpeed:s}),(0,q.jsxs)(`div`,{className:`flex justify-between`,children:[(0,q.jsx)(Q,{shortcutKey:`q`,children:(0,q.jsx)(A,{variant:`outlined`,size:`small`,onClick:()=>D(),children:`First section`})}),(0,q.jsx)(Q,{shortcutKey:`w`,children:(0,q.jsx)(A,{variant:`outlined`,size:`small`,onClick:()=>ne(),children:`Prev`})}),(0,q.jsx)(Q,{shortcutKey:`e`,children:(0,q.jsx)(A,{variant:`outlined`,size:`small`,onClick:()=>k(),children:`Next`})}),(0,q.jsx)(Q,{shortcutKey:`r`,children:(0,q.jsx)(A,{variant:`outlined`,size:`small`,onClick:()=>ie(),children:`Last section`})})]})]}),!a.current&&(0,q.jsx)(`h2`,{children:`Start the song to see the manipulation form`})]}),a.current&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(i,{item:!0,xs:12,sm:8,children:(0,q.jsxs)(`div`,{className:`flex flex-1 flex-col gap-5 sm:flex-row`,children:[(0,q.jsx)(pr,{player:a.current,onChange:e=>{let t=e-p;m(e),f(e=>isNaN(Number(e))?e:String(Number(e)+t*1e3))},current:p,finalGap:C.videoGap}),(0,q.jsx)(fr,{player:a.current,onChange:f,current:d,finalGap:C.gap})]})}),(0,q.jsxs)(i,{item:!0,xs:0,sm:4,className:`hidden sm:block`,children:[(0,q.jsxs)(`div`,{className:`mb-2 text-xs`,children:[`Use `,(0,q.jsx)(`strong`,{children:`Video shift gap`}),` to crop the beginning of the video if it starts with an intro.`]}),(0,q.jsxs)(`div`,{className:`mb-2 text-xs`,children:[`Use `,(0,q.jsx)(`strong`,{children:`Lyrics shift gap`}),` to sync the start of the lyrics to the video. You can lower the`,` `,(0,q.jsx)(`strong`,{children:`Playback speed`}),` above to make sure you got it just right.`,` `]})]}),(0,q.jsxs)(i,{item:!0,xs:12,sm:8,children:[(0,q.jsx)(V,{variant:`h5`,mb:2,children:`Advanced`}),(0,q.jsx)(dr,{onChange:g,current:h,song:C},C.gap)]}),(0,q.jsxs)(i,{item:!0,xs:0,sm:4,className:`hidden sm:block`,children:[(0,q.jsx)(`div`,{className:`mb-2 text-xs`,children:`If the lyrics desynchronise over time, probably the tempo (BPM) of the lyrics is wrong.`}),(0,q.jsxs)(`div`,{className:`mb-2 text-xs`,children:[`You can either use `,(0,q.jsx)(`strong`,{children:`Last note end time`}),` - enter the millisecond when the last note should end (seek through the video for the moment as `,(0,q.jsx)(`strong`,{children:`Current time`}),` panel show the exact millisecond) and a suggested BPM value will appear below.`]}),(0,q.jsxs)(`div`,{className:`mb-2 text-xs`,children:[(0,q.jsx)(`strong`,{children:`Tempo (BPM)`}),` field allows to fine-tune the tempo.`]})]}),(0,q.jsx)(i,{item:!0,xs:12,sm:8,children:(0,q.jsx)(tr,{playbackSpeed:o,song:C,beatLength:T,player:a.current,onRecordChange:v,onTrackNameChange:(e,t)=>b(n=>{let r=[...n];return r[e]=t===``?void 0:t,r}),lyricChanges:x,onLyricChange:e=>S(t=>({...t,[e.track]:{...t[e.track],[e.section]:{...t[e.track]?.[e.section],[e.noteIndex]:e.newLyric}}}))})}),(0,q.jsxs)(i,{item:!0,xs:0,sm:4,className:`hidden sm:block`,children:[(0,q.jsxs)(`div`,{className:`mb-2 text-xs`,children:[`If the lyrics there are more lyrics than in the video or there are longer/shorter interludes between verses, you can `,(0,q.jsx)(`strong`,{children:`Edit verses`}),`.`]}),(0,q.jsx)(`div`,{className:`mb-2 text-xs`,children:`Select a verse by clicking on it.`}),(0,q.jsxs)(`div`,{className:`mb-2 text-xs`,children:[`You can either `,(0,q.jsx)(`strong`,{children:`Change its start beat`}),` (which will "move in time" the verse and all subsequent ones) or `,(0,q.jsx)(`strong`,{children:`Delete it`}),` (it won't affect the timing of other verses). You can also edit the lyrics of each note.`]}),(0,q.jsxs)(`div`,{className:`mb-2 text-xs`,children:[(0,q.jsx)(`strong`,{children:`List of changes`}),` on the right allows you to see and undo the actions one by one.`]})]})]})]})}function xr(e){return(0,q.jsx)(r,{"data-test":`sync-lyrics`,children:e.data&&e.data.video.length<15&&!!e.data.tracks?.[0]?.sections?.length&&(0,q.jsx)(br,{song:e.data,onUpdate:e.onChange,visible:e.visible})})}function Sr(e){return Array.isArray(e)?e.length===0:!e}var $=[`basic-data`,`author-and-video`,`sync`,`metadata`];function Cr({song:e}){let t=!!e,{data:n}=oe(!0);Ie(!1);let r=le();Se(!1);let a=Ge(`step`),[o,s]=(0,K.useState)(Math.max(0,$.indexOf(a))),[c,l]=(0,K.useState)(!1),u=Ge(`redirect`);(0,K.useEffect)(()=>{$[o]&&On({step:$[o]})},[o]);let[d,f]=(0,K.useState)({sourceUrl:e?.sourceUrl??``,txtInput:``}),[p,m]=(0,K.useState)({author:e?.author??``,authorUrl:e?.authorUrl??``,video:e?.video?`https://www.youtube.com/watch?v=${e.video}`:``}),[g,_]=(0,K.useState)({artist:e?.artist??``,title:e?.title??``,realBpm:e?.realBpm?String(e.realBpm):``,year:e?.year??``,language:e?.language??[],volume:e?.volume??70,previewStart:e?.previewStart??void 0,previewEnd:e?.previewEnd??void 0,genre:e?.genre,edition:e?.edition,artistOrigin:e?.artistOrigin}),[v,y]=(0,K.useState)(e),b=(0,K.useMemo)(()=>{try{return t?{...e,video:xe(p.video)||e.video,author:p.author,authorUrl:p.authorUrl,sourceUrl:d.sourceUrl}:d.txtInput?ie(d.txtInput,p.video,p.author,p.authorUrl,d.sourceUrl):void 0}catch(e){console.error(e)}},[d.txtInput,p.video,p.author,p.authorUrl,d.sourceUrl,e,t]),x=(0,K.useMemo)(()=>!t&&b&&n?.find(e=>j.generateSongFile(e)===j.generateSongFile(b)),[n,b,t]);(0,K.useEffect)(()=>{b&&(b.video&&!p.video&&m(e=>({...e,video:`https://www.youtube.com/watch?v=${b.video}`})),b.author&&!p.author&&m(e=>({...e,author:e.author||b?.author||``,authorUrl:e.authorUrl||b?.authorUrl||``})),b.sourceUrl&&!d.sourceUrl&&f(e=>({...e,sourceUrl:b.sourceUrl})),[`year`,`language`,`realBpm`,`genre`,`artist`,`title`,`volume`,`previewStart`,`previewEnd`,`artistOrigin`].forEach(e=>{b[e]&&Sr(g[e])&&_(t=>({...t,[e]:b[e]}))}))},[b,g.year,g.language,g.realBpm,g.genre,g.artist,g.volume,g.title,g.previewStart,g.previewEnd,d.sourceUrl,p.video]);let C=!!d.txtInput||t,w=!!p.video,T=$[o]===`author-and-video`?w:!0,E={...v,...g,author:p.author,authorUrl:p.authorUrl,realBpm:+g.realBpm,sourceUrl:d.sourceUrl,id:We(g)},D=async()=>{l(!0),await j.store(E),u?(qe(E.id),r(u)):(await qe(E.id),r(`edit/list/`,{id:E.id,created:t?null:`true`,song:null})),l(!1)},O=()=>{o<$.length-1?s(e=>e+1):$[o]===`metadata`&&D()};R(`shift+enter`,()=>{O()},[O]);let k=$.at(o)===`metadata`;return(0,q.jsxs)(It,{injectFirst:!0,children:[(0,q.jsx)($e,{}),(0,q.jsxs)(i,{container:!0,gap:2,p:1,pb:10,children:[(0,q.jsx)(i,{item:!0,xs:12,children:!t&&(0,q.jsx)(`div`,{style:{marginBottom:`1rem`},children:(0,q.jsx)(Oe,{to:`menu/`,children:(0,q.jsx)(`a`,{children:`Return to the main menu`})})})}),(0,q.jsx)(i,{item:!0,xs:12,children:(0,q.jsxs)(Dn,{activeStep:o,sx:{mb:2},nonLinear:t,children:[(0,q.jsx)(Jt,{completed:C,children:(0,q.jsx)(_n,{color:`inherit`,onClick:()=>s(0),children:`Basic Info`})},0),(0,q.jsx)(Jt,{completed:w,children:(0,q.jsx)(_n,{color:`inherit`,onClick:()=>s(1),children:`Author and video data`})},1),(0,q.jsx)(Jt,{children:(0,q.jsx)(_n,{color:`inherit`,onClick:()=>s(2),children:`Sync lyrics to video`})},2),(0,q.jsx)(Jt,{children:(0,q.jsx)(_n,{color:`inherit`,onClick:()=>s(3),children:`Fill song metadata`})},3)]})}),(0,q.jsx)(i,{item:!0,xs:12,children:(0,q.jsxs)(`form`,{onSubmit:async e=>{e.preventDefault(),O()},children:[$.at(o)===`basic-data`&&(0,q.jsx)(Hn,{shouldAutoImport:!w,isTxtRequired:!e,onAutoImport:m,onChange:f,data:d,finalSong:E}),$.at(o)===`author-and-video`&&(0,q.jsx)(jn,{songArtist:b?.artist,songTitle:b?.title,onChange:m,data:p}),b&&(0,q.jsx)(xr,{onChange:y,data:b,visible:$.at(o)===`sync`}),$.at(o)===`metadata`&&(0,q.jsx)(qn,{videoGap:v?.videoGap,onChange:_,data:g,songArtist:b?.artist,videoId:b?.video??``}),x&&(0,q.jsxs)(h,{severity:`warning`,"data-test":`possible-duplicate`,children:[(0,q.jsx)(S,{children:`Possible duplicate`}),`There is already a song with similar artist and/or name:`,` `,(0,q.jsxs)(`b`,{children:[x.artist,` - `,x.title]})]}),(0,q.jsxs)(ge,{sx:{position:`fixed`,bottom:0,left:`50%`,maxWidth:`1260px`,width:`100%`,padding:1,transform:`translateX(-50%)`,display:`flex`,gap:2,justifyContent:`space-between`},elevation:3,children:[u&&(0,q.jsx)(A,{disabled:c,sx:{align:`right`},onClick:async()=>{l(!0),await j.store(E),l(!1),r(u)},children:`Skip`}),(0,q.jsxs)(`div`,{className:`flex items-end`,children:[(0,q.jsx)(A,{"data-test":`previous-button`,sx:{align:`right`},onClick:()=>s(e=>e-1),disabled:o===0,children:`Previous`}),k?(0,q.jsx)(A,{"data-test":`save-button`,sx:{align:`right`},type:`submit`,variant:`contained`,disabled:c,children:c?`Saving...`:`Save`}):(0,q.jsx)(A,{"data-test":`next-button`,sx:{align:`right`},variant:`contained`,type:`submit`,disabled:c||!T||o===$.length-1,children:`Next`})]})]})]})})]})]})}var wr=Me((0,q.jsx)(`path`,{d:`M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z`}),`Download`),Tr=Me((0,q.jsx)(`path`,{d:`M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3`}),`Visibility`);function Er(){Ie(!1),Se(!1);let{data:e,reload:t}=oe(!0),[n,r]=Xe(null),a=Ge(`created`),o=Ge(`id`);return e?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(ve,{children:(0,q.jsx)(`title`,{children:`Song List | AllKaraoke.Party - Free Online Karaoke Party Game`})}),(0,q.jsx)(Be,{children:(0,q.jsxs)(Dr,{children:[a&&(0,q.jsx)(je,{id:o}),(0,q.jsx)($e,{}),(0,q.jsxs)(i,{container:!0,rowGap:2,children:[(0,q.jsx)(i,{item:!0,xs:3,display:`flex`,alignItems:`center`,justifyContent:`flex-start`,children:(0,q.jsx)(Oe,{to:`menu/`,children:(0,q.jsx)(A,{"data-test":`main-menu-link`,children:`Return to main menu`})})}),(0,q.jsx)(i,{item:!0,xs:6,display:`flex`,alignItems:`center`,justifyContent:`center`,children:(0,q.jsxs)(`h4`,{children:[(0,q.jsx)(`span`,{onClick:()=>{window.__exposeSingletons(),window.__singletons.importSongs()},children:e.length}),` `,(0,q.jsx)(Oe,{to:`edit/redirect-to-first-local-song`,children:(0,q.jsx)(`span`,{children:`songs`})})]})}),(0,q.jsx)(i,{item:!0,xs:3,display:`flex`,alignItems:`center`,justifyContent:`flex-end`,children:(0,q.jsx)(Oe,{to:`convert/`,children:(0,q.jsx)(A,{"data-test":`convert-song`,variant:`contained`,children:`Import UltraStar .TXT`})})}),(0,q.jsx)(i,{item:!0,xs:12,children:(0,q.jsx)(w,{globalFilter:o,data:e,renderRowActions:({row:r})=>(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Oe,{to:ke(`edit/song/`,{song:r.original.id,id:null}),children:(0,q.jsx)(pe,{title:`Edit the song`,"data-test":`edit-song`,"data-song":r.original.id,children:(0,q.jsx)(E,{})})}),(0,q.jsx)(pe,{title:`Download .txt file`,onClick:async()=>{let e=await j.get(r.original.id),t=Pe(e),n=document.createElement(`a`);n.href=`data:plain/text;charset=utf-8,${encodeURIComponent(t)}`,n.download=`${j.generateSongFile(e)}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n)},"data-test":`download-song`,"data-song":r.original.id,children:(0,q.jsx)(wr,{})}),!r.original.isDeleted&&(0,q.jsx)(pe,{title:`Hide the song`,onClick:async()=>{await j.softDeleteSong(r.original.id),t()},"data-test":`hide-song`,"data-song":r.original.id,children:(0,q.jsx)(Tr,{})}),r.original.isDeleted&&(0,q.jsx)(pe,{title:`Restore the song`,onClick:async()=>{await j.restoreSong(r.original.id),t()},"data-test":`restore-song`,"data-song":r.original.id,children:(0,q.jsx)(s,{})}),(0,q.jsx)(pe,{className:r.original.local?``:`cursor-default! opacity-50`,title:`Delete the song`,onClick:async()=>{global.confirm(`Are you sure you want to delete this song?`)&&(await j.deleteSong(r.original.id),n&&e.some(e=>e.id===r.original.id)&&ue.capture(`unshare-song`,{songId:r.original.id}),t())},"data-test":`delete-song`,"data-song":r.original.id,children:(0,q.jsx)(Ve,{})})]})})}),n!==null&&(0,q.jsx)(i,{item:!0,xs:12,children:(0,q.jsx)(d,{control:(0,q.jsx)(y,{defaultChecked:!0,checked:n,onChange:e=>r(e.target.checked),"data-test":`share-songs-switch`}),label:`Share added songs (so they can be played by others)`})})]})]})})]}):(0,q.jsx)(q.Fragment,{children:`Loading`})}var Dr=L(`div`,{target:`e4idn2b0`})({name:`19rvb6v`,styles:`margin:0 auto;height:100%;width:1260px;background:white;padding:60px 20px 0 20px`});export{Cr as Convert,Er as SongList};
//# sourceMappingURL=SongManagement-XMdUfnLd.js.map
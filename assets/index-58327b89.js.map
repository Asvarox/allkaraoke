{"version":3,"file":"index-58327b89.js","sources":["../../src/GameEvents/GameEvents.ts","../../src/Scenes/Game/Singing/Input/MicStrategies/Aubio.ts","../../src/utils/Listener.ts","../../src/UserMedia/userMediaService.ts","../../src/Scenes/Game/Singing/Input/SimplifiedMic.tsx","../../src/utils/isE2E.ts","../../src/utils/peerJSOptions.ts","../../src/RemoteMic/Network/sendEvent.ts","../../src/RemoteMic/Network/WebRTCClient.ts","../../src/RemoteMic/RemoteMicInput.ts","../../src/RemoteMic/RemoteMicManager.ts","../../src/RemoteMic/Network/WebRTCServer.ts","../../src/Songs/utils/isNotesSection.ts","../../src/Songs/utils/notesSelectors.ts","../../src/Scenes/Game/Singing/Input/DrawingTestInput.tsx","../../src/Scenes/Game/Singing/Input/DummyInput.tsx","../../src/Scenes/Game/Singing/Input/MicInput.tsx","../../src/Scenes/Game/Singing/Input/RemoteMicInput.tsx","../../src/Scenes/SelectInput/InputSources/DrawingTest.ts","../../src/Scenes/SelectInput/InputSources/Microphone.ts","../../src/Scenes/SelectInput/InputSources/Remote.ts","../../src/utils/storage.ts","../../src/Scenes/SelectInput/InputSources/Dummy.ts","../../src/Scenes/SelectInput/InputSources/index.ts","../../src/Scenes/Game/Singing/Input/InputManager.ts","../../src/consts.ts","../../src/utils/pitchToFrequency.ts","../../src/Scenes/Game/Singing/GameState/Helpers/calcDistance.tsx","../../src/Scenes/Game/Singing/GameState/Helpers/detectVibrato.ts","../../src/Scenes/Game/Singing/GameState/Helpers/appendFrequencyToPlayerNotes.ts","../../src/Scenes/Game/Singing/Helpers/getPlayerNoteDistance.ts","../../src/Scenes/Game/Singing/GameState/Helpers/calculateScore.ts","../../src/Scenes/Game/Singing/GameState/Helpers/getCurrentBeat.ts","../../src/Songs/utils/getSongBeatLength.ts","../../src/Scenes/Game/Singing/GameState/GameState.ts","../../src/utils/exposeSingletons.ts","../../src/hooks/players/consts.ts","../../src/Stats/players.ts","../../src/Stats/lastVisit.ts","../../src/Songs/stats/common.ts","../../src/Songs/stats/index.ts","../../src/RemoteMic/eventListeners.tsx","../../src/Scenes/Game/eventListeners.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/styles.ts","../../src/Elements/cssMixins.ts","../../src/Scenes/KeyboardHelp/HelpView.tsx","../../src/GameEvents/hooks.ts","../../src/Scenes/KeyboardHelp/Context.tsx","../../src/Elements/Button.tsx","../../src/Elements/Menu.tsx","../../src/Songs/stats/hooks.ts","../../src/Scenes/SingASong/SongSelection/SongCard.tsx","../../src/Elements/Switcher.tsx","../../src/hooks/useKeyboard.ts","../../src/assets/menu_back.wav","../../src/assets/menu_enter.wav","../../src/assets/menu_navigate.wav","../../src/assets/376817__original_sound__impact-cinematic.wav","../../src/assets/Funk Cool Groove (No Copyright Music) By Anwar Amr.mp3","../../src/SoundManager.ts","../../src/hooks/useKeyboardHelp.ts","../../src/hooks/useKeyboardNav.ts","../../src/Scenes/Settings/SettingsState.ts","../../src/utils/startViewTransition.ts","../../src/hooks/useSmoothNavigate.ts","../../src/Scenes/Welcome/GithubRibbon.tsx","../../src/Elements/logo.gif","../../src/Elements/pride.png","../../src/Elements/dotparty.gif","../../src/Elements/Logo.tsx","../../src/Elements/RecommendedBrowsers.tsx","../../src/Elements/LayoutWithBackground.tsx","../../src/Elements/MenuWithLogo.tsx","../../src/Scenes/Settings/Settings.tsx","../../src/Songs/utils/convertTxtToSong.ts","../../src/Scenes/Convert/Steps/AuthorAndVid.tsx","../../src/Scenes/Convert/importUltrastarEsSong.ts","../../src/Scenes/Convert/Steps/BasicData.tsx","../../src/Scenes/Convert/Steps/VolumeAdjustment.tsx","../../src/Scenes/Convert/Steps/SongMetadata.tsx","../../src/interfaces.ts","../../src/Scenes/Convert/Elements.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/formatMs.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Components/AdjustPlayback.tsx","../../src/Scenes/Game/Singing/Hooks/useCurrentSectionIndex.ts","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Components/EditSection.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Components/ListTracks.tsx","../../src/Scenes/Convert/calculateProperBpm.ts","../../src/Scenes/Game/Singing/GameState/Helpers/beatToMs.ts","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Components/ManipulateBpm.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Components/ShiftGap.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Components/ShiftVideoGap.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseSectionPaddings.ts","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/addHeadstart.ts","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseGap.ts","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseLyricSpaces.ts","../../src/hooks/usePlayerVolume.ts","../../src/hooks/useUnstuckYouTubePlayer.ts","../../src/Elements/VideoPlayer/Youtube.tsx","../../src/Elements/VideoPlayer/DirectVideo.tsx","../../src/Elements/VideoPlayer/dummy.mp4","../../src/Elements/VideoPlayer/Offline.tsx","../../src/Elements/VideoPlayer/index.tsx","../../src/Scenes/Game/Singing/GameOverlay/Components/PauseMenu.tsx","../../src/Songs/utils/getSongFirstNoteMs.ts","../../src/Songs/utils/getSkipIntroTime.ts","../../src/utils/songHasLongIntro.ts","../../src/Scenes/Game/Singing/GameOverlay/Components/SkipIntro.tsx","../../src/hooks/useDebounce.ts","../../src/Scenes/Game/Singing/GameOverlay/Components/SkipOutro.tsx","../../src/Scenes/Game/Singing/GameOverlay/Components/DurationBar.tsx","../../src/Scenes/Game/Singing/GameOverlay/Components/Lyrics.tsx","../../src/Scenes/Game/Singing/GameOverlay/Components/ScoreText.tsx","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/utils/getNoteColor.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/triangle.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/utils.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/SungTriangle.ts","../../src/utils/randomValue.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/calculateData.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/applyColor.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/roundRect.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/Elements/note.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/Elements/playerNote.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/spriteMap.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/utils/createCanvas.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/cachedSprites.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/spriteWithStartAndEnd.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/note.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/playerFrequencyTrace.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/playerNote.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/ParticleManager.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/Triangle.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/ExplodingNote.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/FadeoutNote.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Elements/utils/loadImage.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/ray-particle.png","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/Ray.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/Particles/Vibrato.ts","../../src/Scenes/Game/Singing/GameOverlay/Drawing/CanvasDrawing.ts","../../src/Scenes/Game/Singing/GameOverlay/GameOverlay.tsx","../../src/Scenes/Game/Singing/Player.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo/EditSong.tsx","../../src/Scenes/Convert/Steps/SyncLyricsToVideo.tsx","../../src/utils/clearString.ts","../../scripts/utils.ts","../../src/Songs/SongDao.ts","../../src/Elements/NormalizeFontSize.tsx","../../src/hooks/useBackgroundMusic.ts","../../src/Scenes/Convert/Convert.tsx","../../src/Songs/hooks/useSong.ts","../../src/Scenes/Edit/Edit.tsx","../../src/Songs/hooks/useSongIndex.ts","../../src/Songs/utils/convertSongToTxt.ts","../../src/Scenes/Edit/SongList.tsx","../../src/hooks/useFullscreen.ts","../../src/Elements/TransitionWrapper.tsx","../../src/hooks/useViewportSize.ts","../../src/Scenes/Game/Singing/Helpers/generatePlayerChanges.ts","../../src/Scenes/Game/SongPage.tsx","../../src/Scenes/Game/Singing/PostGame/Views/Results.tsx","../../src/Elements/Input.tsx","../../src/Elements/Autocomplete.tsx","../../src/hooks/players/useRecentPlayerNames.ts","../../src/Scenes/Game/Singing/PostGame/Views/HighScoreRename.tsx","../../src/Scenes/Game/Singing/PostGame/Views/HighScores.tsx","../../src/Elements/GameTip.tsx","../../src/Scenes/Game/Singing/PostGame/PostGameView.tsx","../../src/Scenes/Game/Singing/PostGame/PostGame.tsx","../../src/assets/459342__papaninkasettratat__cinematic-music-short.mp3","../../src/utils/sleep.ts","../../src/Scenes/Game/Singing/WaitForReadiness.tsx","../../src/hooks/useBlockScroll.ts","../../src/Scenes/Game/Singing/Singing.tsx","../../src/utils/languageNameToIsoCode.ts","../../src/Scenes/ExcludeLanguages/ExcludeLanguagesView.tsx","../../src/Scenes/SingASong/SongSelection/Playlists.tsx","../../src/Scenes/SingASong/SongSelection/QuickSearch.tsx","../../src/Scenes/SingASong/SongSelection/SelectRandomTip.tsx","../../src/hooks/usePrevious.ts","../../src/Scenes/SingASong/SongSelection/Hooks/useSongList.ts","../../src/Scenes/SingASong/SongSelection/Hooks/useSongSelectionKeyboardNavigation.ts","../../src/Scenes/SingASong/SongSelection/Hooks/useSongSelection.ts","../../src/Scenes/SingASong/SongSelection/SongSettings/GameSettings.tsx","../../src/Scenes/Game/VolumeIndicator.tsx","../../src/Scenes/SingASong/SongSelection/SongSettings/MicCheck.tsx","../../src/Scenes/SelectInput/SelectPreference/SelectPreference.tsx","../../src/Scenes/ConnectRemoteMic/ConnectRemoteMic.tsx","../../src/Scenes/SelectInput/hooks/useRemoteMicAutoselect.ts","../../src/Scenes/SelectInput/MicCheck.tsx","../../src/Scenes/SelectInput/Variants/RemoteMics.tsx","../../src/Scenes/SelectInput/hooks/useMicrophoneList.ts","../../src/UserMedia/enable-mic.png","../../src/UserMedia/allow-mic.png","../../src/UserMedia/hooks.ts","../../src/UserMedia/UserMediaEnabled.tsx","../../src/utils/isWindows.ts","../../src/Scenes/SelectInput/Variants/SingStarMics.tsx","../../src/Scenes/SelectInput/Variants/Skip.tsx","../../src/Scenes/SelectInput/hooks/usePlayerInput.ts","../../src/Scenes/SelectInput/Variants/Advanced.tsx","../../src/Scenes/SelectInput/Variants/BuiltIn.tsx","../../src/Scenes/SelectInput/SelectInputView.tsx","../../src/Elements/Modal.tsx","../../src/Scenes/SingASong/SongSelection/SongSettings/PlayerSettings/SelectInputModal.tsx","../../src/Scenes/SingASong/SongSelection/SongSettings/PlayerSettings/SinglePlayer.tsx","../../src/Scenes/SingASong/SongSelection/SongSettings/PlayerSettings.tsx","../../src/Scenes/SingASong/SongSelection/SongSettings/SongSettings.tsx","../../src/Scenes/SingASong/SongSelection/SongPreview.tsx","../../src/Scenes/SingASong/SongSelection/SongSelection.tsx","../../src/Scenes/SingASong/SingASong.tsx","../../src/Scenes/Game/Game.tsx","../../src/Scenes/Jukebox/Jukebox.tsx","../../src/Scenes/RemoteMic/Panels/Keyboard.tsx","../../src/Scenes/RemoteMic/Panels/PlayerChange.tsx","../../src/Scenes/RemoteMic/Panels/VolumeIndicator.tsx","../../src/Scenes/RemoteMic/Panels/MicPreview.tsx","../../src/Scenes/RemoteMic/Panels/Connect.tsx","../../src/Scenes/RemoteMic/Panels/ConfirmReadiness.tsx","../../src/Scenes/RemoteMic/RemoteMic.tsx","../../src/Scenes/SelectInput/SelectInput.tsx","../../src/Scenes/Edit/GetSongsBPMs.tsx","../../src/Scenes/QuickSetup/QuickSetup.tsx","../../src/Scenes/Welcome/logo_bpm.png","../../src/Scenes/Welcome/Welcome.tsx","../../src/styles.ts","../../src/Elements/ErrorFallback.tsx","../../src/Toolbar/QRCodeModal.tsx","../../src/Toolbar/Toolbar.tsx","../../src/Scenes/ExcludeLanguages/ExcludeLanguages.tsx","../../src/Scenes/ManageSongs/ManageSongs.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["import { SingSetup, Song, SongPreview } from 'interfaces';\nimport posthog from 'posthog-js';\nimport { SelectedPlayerInput } from 'Scenes/Game/Singing/Input/InputManager';\nimport { SongStats } from 'Songs/stats/common';\nimport { keyStrokes } from 'RemoteMic/Network/events';\nimport { HelpEntry } from 'Scenes/KeyboardHelp/Context';\n\nexport class GameEvent<T extends (...args: any[]) => void> {\n    protected subscribers: Array<T> = [];\n\n    public subscribe = (callback: T) => {\n        this.unsubscribe(callback);\n        this.subscribers.push(callback);\n    };\n\n    public unsubscribe = (callback: T) => {\n        this.subscribers = this.subscribers.filter((cb) => cb !== callback);\n    };\n\n    public dispatch = (...args: Parameters<T>) => {\n        console.log('dispatch', this.name, ...args);\n        this.subscribers.forEach((callback) => callback(...args));\n\n        if (this.track) {\n            posthog.capture(this.name, this.track instanceof Function ? this.track(...args) : args);\n        }\n    };\n\n    public constructor(private name: string, private track: boolean | ((...args: Parameters<T>) => any) = false) {}\n}\n\nexport const events = {\n    sectionChange: new GameEvent<(player: number, previousSectionIndex: number) => void>('sectionChange'),\n    // newPlayerNote: new GameEvent<(player: number, playerNote: PlayerNote) => void>('//', true),\n    // playerNoteUpdate: new GameEvent<(player: number, playerNote: PlayerNote) => void>('//', true),\n\n    songStarted: new GameEvent<(song: Song | SongPreview, singSetup: SingSetup) => void>('songStarted', false),\n    songEnded: new GameEvent<\n        (song: Song | SongPreview, singSetup: SingSetup, scores: Array<{ name: string; score: number }>) => void\n    >('songEnded', false),\n\n    remoteMicConnected: new GameEvent<(remoteMic: { id: string; name: string; silent: boolean }) => void>(\n        'remoteMicConnected',\n    ),\n    remoteMicDisconnected: new GameEvent<(remoteMic: { id: string; name: string }, silent: boolean) => void>(\n        'remoteMicDisconnected',\n    ),\n    playerInputChanged: new GameEvent<\n        (playerNumber: number, oldInput: SelectedPlayerInput | undefined, newInput: SelectedPlayerInput) => void\n    >('playerInputChanged', (player, oldI, newI) => ({ player, old: oldI?.inputSource, new: newI.inputSource })),\n    inputListChanged: new GameEvent<() => void>('inputListChanged'),\n\n    karaokeConnectionStatusChange: new GameEvent<\n        (status: 'connecting' | 'connected' | 'disconnected' | 'reconnecting' | 'error') => void\n    >('karaokeConnectionStatusChange'),\n    remoteMicPlayerNumberSet: new GameEvent<(playerNumber: number | null) => void>('remoteMicPlayerNumberSet'),\n    remoteMicMonitoringStarted: new GameEvent('remoteMicMonitoringStarted'),\n    remoteMicMonitoringStopped: new GameEvent('remoteMicMonitoringStopped'),\n\n    micMonitoringStarted: new GameEvent('micMonitoringStarted'),\n    micMonitoringStopped: new GameEvent('micMonitoringStopped'),\n    playerChangeRequested: new GameEvent<(remoteMicId: string, newPlayerNumber: number | null) => void>(\n        'playerChangeRequested',\n        true,\n    ),\n\n    songStatStored: new GameEvent<(key: string, stats: SongStats) => void>('songStatStored'),\n    songScoreUpdated: new GameEvent<(key: string, stats: SongStats, newName: string) => void>(\n        'songScoreUpdated',\n        () => undefined,\n    ),\n\n    remoteKeyboardPressed: new GameEvent<(key: keyStrokes) => void>('remoteKeyboardPressed', true),\n    remoteKeyboardLayout: new GameEvent<(help: HelpEntry | undefined) => void>('remoteKeyboardLayout'),\n    remoteReadinessRequested: new GameEvent('remoteReadinessRequested'),\n    readinessConfirmed: new GameEvent<(deviceId: string) => void>('remoteReadinessConfirmed'),\n};\n\nexport default events;\n","import aubio from 'aubiojs';\nimport { FrequencyDetectionStrategy } from './interfaces';\n\nexport default class AubioStrategy implements FrequencyDetectionStrategy {\n    private detector: any;\n\n    public init = async (context: AudioContext, buffer: number): Promise<void> => {\n        const { Pitch } = await aubio();\n\n        this.detector = new Pitch('default', buffer, buffer / 8, context.sampleRate);\n        this.detector.setTolerance(0.5);\n    };\n\n    public getSampleSize(): number {\n        return 1 << 11;\n    }\n\n    public getFrequency = async (data: Float32Array) => {\n        return this.detector.do(data);\n    };\n}\n","type Callback<ARG extends Array<any>> = (...args: ARG) => void;\nexport default class Listener<ARG extends Array<any> = []> {\n    private listeners: Callback<ARG>[] = [];\n    protected onUpdate = (...args: ARG) => {\n        this.listeners.forEach((callback) => callback(...args));\n    };\n\n    public addListener = (listener: Callback<ARG>) => {\n        this.listeners.push(listener);\n\n        return () => {\n            this.removeListener(listener);\n        };\n    };\n\n    public removeListener = (listener: Callback<ARG>) => this.listeners.filter((callback) => callback !== listener);\n}\n","import Listener from 'utils/Listener';\n\ntype accessStatus = 'uninitialised' | 'requested' | 'accepted' | 'declined';\nclass UserMediaService extends Listener<[accessStatus]> {\n    private status: accessStatus = 'uninitialised';\n\n    public getUserMedia: typeof navigator.mediaDevices.getUserMedia = async (...args) =>\n        this.requestAndTrack(() => navigator.mediaDevices.getUserMedia(...args));\n\n    public enumerateDevices: typeof navigator.mediaDevices.enumerateDevices = async (...args) =>\n        this.requestAndTrack(() => navigator.mediaDevices.enumerateDevices(...args));\n\n    private requestAndTrack = async <T extends CallableFunction>(fnc: T) => {\n        try {\n            if (this.status !== 'accepted') this.setStatus('requested');\n            const result = await fnc();\n            this.setStatus('accepted');\n\n            return result;\n        } catch (e) {\n            this.setStatus('declined');\n            throw e;\n        }\n    };\n\n    private setStatus = (newStatus: accessStatus) => {\n        this.status = newStatus;\n\n        this.onUpdate(newStatus);\n    };\n\n    public getStatus = () => this.status;\n}\n\nexport default new UserMediaService();\n","import events from 'GameEvents/GameEvents';\nimport AubioStrategy from 'Scenes/Game/Singing/Input/MicStrategies/Aubio';\nimport InputInterface from './Interface';\nimport userMediaService from 'UserMedia/userMediaService';\nimport Listener from 'utils/Listener';\n\nclass SimplifiedMic extends Listener<[number, number]> implements InputInterface {\n    private stream: MediaStream | null = null;\n    private context: AudioContext | null = null;\n\n    private interval: ReturnType<typeof setInterval> | null = null;\n\n    private frequencies: [number, number] = [0, 0];\n    private volumes: [number, number] = [0, 0];\n\n    private startedMonitoring = false;\n\n    public startMonitoring = async (deviceId?: string, echoCancellation = false) => {\n        if (this.startedMonitoring) return;\n        this.startedMonitoring = true;\n\n        this.stream = await userMediaService.getUserMedia({\n            audio: {\n                echoCancellation: true,\n                noiseSuppression: true,\n                autoGainControl: false,\n            },\n            video: false,\n        });\n\n        this.context = new AudioContext();\n\n        const source = this.context.createMediaStreamSource(this.stream);\n\n        const analyserCh0 = this.context.createAnalyser();\n        analyserCh0.fftSize = 2048;\n        analyserCh0.minDecibels = -100;\n        source.connect(analyserCh0);\n\n        const strategy = new AubioStrategy();\n        await strategy.init(this.context, analyserCh0.fftSize);\n\n        this.interval = setInterval(async () => {\n            const dataCh0 = new Float32Array(analyserCh0.fftSize);\n\n            analyserCh0.getFloatTimeDomainData(dataCh0);\n            const freq = await strategy.getFrequency(dataCh0);\n            const volume = this.calculateVolume(dataCh0);\n\n            this.frequencies = [freq, freq];\n\n            this.volumes = [volume, volume];\n\n            this.onUpdate(freq, volume);\n        }, this.context.sampleRate / analyserCh0.fftSize);\n\n        events.micMonitoringStarted.dispatch();\n    };\n\n    public getFrequencies = () => {\n        return this.frequencies;\n    };\n    public getVolumes = () => this.volumes;\n\n    public stopMonitoring = async () => {\n        if (!this.startedMonitoring) return;\n        this.startedMonitoring = false;\n        this.interval && clearInterval(this.interval);\n        this.stream?.getTracks().forEach(function (track) {\n            track.stop();\n        });\n        try {\n            await this.context?.close();\n        } catch (e) {\n            console.log('MicInput.stoMonitoring error', e);\n        }\n\n        events.micMonitoringStopped.dispatch();\n    };\n\n    public getInputLag = () => 180;\n    public getChannelsCount = () => 2;\n\n    private calculateVolume(input: Float32Array) {\n        let i;\n        let sum = 0.0;\n        for (i = 0; i < input.length; ++i) {\n            sum += input[i] * input[i];\n        }\n        return Math.sqrt(sum / input.length);\n    }\n    public requestReadiness = () => Promise.resolve(true);\n}\n\nexport default new SimplifiedMic();\n","export default function isE2E() {\n    return window.isE2ETests || window.location.search.includes('e2e-test');\n}\n","import { PeerJSOption } from 'peerjs';\nimport isE2E from 'utils/isE2E';\n\nconst e2eOverrides: PeerJSOption = isE2E()\n    ? {\n          host: 'localhost',\n          port: 9000,\n          path: '/',\n      }\n    : {};\n\nconst options: PeerJSOption = {\n    ...e2eOverrides,\n    // debug: 3,\n};\n\nexport default options;\n","import { DataConnection } from 'peerjs';\nimport { WebRTCEvents } from 'RemoteMic/Network/events';\n\nfunction sendEvent<T extends WebRTCEvents>(\n    connection: DataConnection | null | undefined,\n    type: T['t'],\n    payload?: Omit<T, 't'>,\n) {\n    connection?.send({ t: type, ...payload });\n}\n\nexport default sendEvent;\n","import { DataConnection, Peer } from 'peerjs';\nimport events from 'GameEvents/GameEvents';\nimport { v4 } from 'uuid';\nimport SimplifiedMic from 'Scenes/Game/Singing/Input/SimplifiedMic';\nimport peerJSOptions from 'utils/peerJSOptions';\nimport { keyStrokes, WebRTCEvents } from 'RemoteMic/Network/events';\nimport sendEvent from './sendEvent';\nimport { throttle } from 'lodash-es';\n\nconst MIC_ID_KEY = 'MIC_CLIENT_ID';\n\nconst roundTo = (num: number, precision: number) => {\n    if (num === 0) return 0;\n\n    const multiplier = Math.pow(10, precision);\n\n    return Math.round(num * multiplier) / multiplier;\n};\n\nclass WebRTCClient {\n    private clientId = window.sessionStorage.getItem(MIC_ID_KEY);\n    private peer: Peer | null = null;\n    private connection: DataConnection | null = null;\n    private reconnecting = false;\n\n    private frequencies: number[] = [];\n\n    private sendFrequencies = throttle((volume: number) => {\n        const freqs = this.frequencies.map((freq) => roundTo(freq, 2));\n        this.frequencies.length = 0;\n        this.sendEvent('freq', [freqs, roundTo(volume, 4)]);\n    }, 75);\n\n    // Chunk frequencies and send them in packages\n    // One package throttled with 75ms contains ~10 frequencies\n    private onFrequencyUpdate = (freq: number, volume: number) => {\n        this.frequencies.push(freq);\n\n        this.sendFrequencies(volume);\n    };\n\n    private setClientId = (id: string) => {\n        this.clientId = id;\n        window.sessionStorage.setItem(MIC_ID_KEY, id);\n    };\n\n    public connect = (roomId: string, name: string, silent: boolean) => {\n        if (this.clientId === null) this.setClientId(v4());\n\n        this.peer = new Peer(this.clientId!, { ...peerJSOptions, debug: 3 });\n\n        this.peer.on('open', () => this.connectToServer(roomId, name, silent));\n        this.peer.on('close', () => {\n            SimplifiedMic.removeListener(this.onFrequencyUpdate);\n            SimplifiedMic.stopMonitoring();\n        });\n    };\n\n    public connectToServer = (roomId: string, name: string, silent: boolean) => {\n        events.karaokeConnectionStatusChange.dispatch('connecting');\n        this.connection = this.peer!.connect(roomId);\n\n        this.connection.on('open', () => {\n            this.reconnecting = false;\n\n            window.addEventListener('beforeunload', this.disconnect);\n\n            this.sendEvent('register', { name, id: this.clientId!, silent });\n\n            events.karaokeConnectionStatusChange.dispatch('connected');\n\n            this.connection?.on('data', (data: WebRTCEvents) => {\n                const type = data.t;\n                console.log('data', data);\n                if (type === 'start-monitor') {\n                    SimplifiedMic.addListener(this.onFrequencyUpdate);\n                    // echoCancellation is turned on because without it there is silence from the mic\n                    // every other second (possibly some kind of Chrome Mobile bug)\n                    SimplifiedMic.startMonitoring(undefined, true);\n                } else if (type === 'stop-monitor') {\n                    SimplifiedMic.removeListener(this.onFrequencyUpdate);\n                    SimplifiedMic.stopMonitoring();\n                } else if (type === 'set-player-number') {\n                    events.remoteMicPlayerNumberSet.dispatch(data.playerNumber);\n                } else if (type === 'keyboard-layout') {\n                    events.remoteKeyboardLayout.dispatch(data.help);\n                } else if (type === 'reload-mic') {\n                    window.removeEventListener('beforeunload', this.disconnect);\n                    this.sendEvent('unregister');\n                    window.sessionStorage.setItem('reload-mic-request', '1');\n                    document.getElementById('phone-ui-container')?.remove();\n                    window.location.reload();\n                } else if (type === 'request-readiness') {\n                    events.remoteReadinessRequested.dispatch();\n                }\n            });\n        });\n\n        this.connection.on('error', console.warn);\n\n        this.connection.on('close', () => {\n            window.removeEventListener('beforeunload', this.disconnect);\n\n            events.karaokeConnectionStatusChange.dispatch('disconnected');\n            events.remoteMicPlayerNumberSet.dispatch(null);\n            SimplifiedMic.removeListener(this.onFrequencyUpdate);\n            SimplifiedMic.stopMonitoring();\n\n            console.log('closed connection :o');\n\n            this.reconnecting = true;\n            setTimeout(() => this.reconnect(roomId, name), 500);\n        });\n    };\n\n    private reconnect = (roomId: string, name: string) => {\n        if (this.reconnecting) {\n            events.karaokeConnectionStatusChange.dispatch('reconnecting');\n            this.connectToServer(roomId, name, false);\n            setTimeout(() => this.reconnect(roomId, name), 1000);\n        }\n    };\n\n    public getRoomId = () => this.clientId;\n\n    public sendKeyStroke = (key: keyStrokes) => {\n        this.sendEvent('keystroke', { key });\n    };\n\n    public requestPlayerChange = (playerNumber: number | null) => {\n        this.sendEvent('request-mic-select', { playerNumber });\n    };\n\n    public confirmReadiness = () => {\n        this.sendEvent('confirm-readiness');\n    };\n\n    private sendEvent = <T extends WebRTCEvents>(type: T['t'], payload?: Parameters<typeof sendEvent<T>>[2]) => {\n        sendEvent(this.connection, type, payload);\n    };\n\n    private disconnect = () => {\n        this.connection?.close();\n    };\n}\n\nexport default new WebRTCClient();\n","import Peer from 'peerjs';\nimport InputInterface from 'Scenes/Game/Singing/Input/Interface';\nimport { WebRTCEvents } from 'RemoteMic/Network/events';\nimport sendEvent from './Network/sendEvent';\n\nclass RemoteMicInput implements InputInterface {\n    private frequencies: number[] | number[][] = [0];\n    private volumes = [0];\n\n    private requestReadinessPromise: null | Promise<boolean> = null;\n\n    public constructor(private connection: Peer.DataConnection) {}\n\n    getChannelsCount = () => 1;\n\n    getFrequencies = () => {\n        const freqs = this.frequencies;\n\n        if (Array.isArray(freqs[0])) {\n            this.frequencies = [freqs[0].at(-1)!];\n        }\n        return freqs;\n    };\n    getVolumes = () => this.volumes;\n\n    getInputLag = () => 200;\n\n    requestReadiness = () => {\n        if (!this.requestReadinessPromise) {\n            this.requestReadinessPromise = new Promise<boolean>((resolve) => {\n                const listener = (data: WebRTCEvents) => {\n                    if (data.t === 'confirm-readiness') {\n                        resolve(true);\n                        this.connection.off('data', listener);\n                        this.requestReadinessPromise = null;\n                    }\n                };\n\n                this.connection.on('data', listener);\n\n                sendEvent(this.connection, 'request-readiness');\n            });\n        }\n        return this.requestReadinessPromise!;\n    };\n    startMonitoring = async () => {\n        sendEvent(this.connection, 'start-monitor');\n\n        this.connection?.on('data', this.handleRTCData);\n    };\n\n    stopMonitoring = async () => {\n        sendEvent(this.connection, 'stop-monitor');\n\n        this.connection?.off('data', this.handleRTCData);\n    };\n\n    private handleRTCData = (data: WebRTCEvents) => {\n        if (data.t === 'freq') {\n            this.frequencies = [data[0], data[0]];\n            this.volumes = [data[1], data[1]];\n        }\n    };\n}\n\nexport class RemoteMic {\n    private input: RemoteMicInput;\n    constructor(public id: string, public name: string, public connection: Peer.DataConnection) {\n        this.input = new RemoteMicInput(connection);\n    }\n\n    public getInput = () => this.input;\n\n    public setPlayerNumber = (playerNumber: number | null) => {\n        this.connection?.send({ t: 'set-player-number', playerNumber } as WebRTCEvents);\n    };\n}\n","import Peer from 'peerjs';\nimport { WebRTCEvents } from 'RemoteMic/Network/events';\nimport { RemoteMic } from 'RemoteMic/RemoteMicInput';\nimport events from 'GameEvents/GameEvents';\n\nclass RemoteMicManager {\n    private remoteMics: RemoteMic[] = [];\n    private readinessRequestPromise: Promise<boolean> | null = null;\n\n    public addRemoteMic = (id: string, name: string, connection: Peer.DataConnection, silent: boolean) => {\n        this.remoteMics.push(new RemoteMic(id, name, connection));\n        events.remoteMicConnected.dispatch({ id, name, silent });\n    };\n\n    public removeRemoteMic = (id: string, silent = false) => {\n        const remoteMic = this.remoteMics.find((remoteMic) => remoteMic.id === id);\n        this.remoteMics = this.remoteMics.filter((remoteMic) => remoteMic.id !== id);\n        if (remoteMic) events.remoteMicDisconnected.dispatch(remoteMic, silent);\n    };\n\n    public getRemoteMics = () => this.remoteMics;\n\n    public getRemoteMicById = (id: string) => this.remoteMics.find((remoteMic) => remoteMic.id === id);\n\n    public broadcast = (event: WebRTCEvents) => {\n        this.getRemoteMics().forEach((remoteMic) => remoteMic.connection.send(event));\n    };\n}\n\nexport default new RemoteMicManager();\n","import { Peer } from 'peerjs';\nimport { v4 } from 'uuid';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport peerJSOptions from 'utils/peerJSOptions';\nimport { WebRTCEvents } from 'RemoteMic/Network/events';\nimport events from 'GameEvents/GameEvents';\n\nconst ROOM_ID_KEY = 'room_id_key';\n\nclass WebRTCServer {\n    private roomId = window.sessionStorage.getItem(ROOM_ID_KEY)!;\n    private peer: Peer | null = null;\n    private started = false;\n\n    public constructor() {\n        if (!this.roomId) {\n            this.roomId = v4();\n        } else {\n            this.start();\n        }\n\n        window.addEventListener('beforeunload', () => {\n            RemoteMicManager.getRemoteMics().forEach((remoteMic) => remoteMic.connection.close());\n            this.peer?.disconnect();\n        });\n    }\n\n    public start = () => {\n        if (this.started) return;\n        this.started = true;\n        window.sessionStorage.setItem(ROOM_ID_KEY, this.roomId);\n\n        this.peer = new Peer(this.roomId, peerJSOptions);\n\n        this.peer.on('open', function (id) {\n            console.log('My peer ID is: ' + id);\n        });\n\n        this.peer.on('connection', (conn) => {\n            conn.on('data', (data: WebRTCEvents) => {\n                const type = data.t;\n                if (type === 'register') {\n                    RemoteMicManager.addRemoteMic(data.id, data.name, conn, data.silent);\n                } else if (type === 'keystroke') {\n                    events.remoteKeyboardPressed.dispatch(data.key);\n                } else if (type === 'unregister') {\n                    RemoteMicManager.removeRemoteMic(conn.peer, true);\n                } else if (type === 'request-mic-select') {\n                    events.playerChangeRequested.dispatch(conn.peer, data.playerNumber);\n                }\n            });\n\n            conn.on('open', () => {\n                console.log('connected');\n            });\n\n            conn.on('error', (data) => console.warn('error', data));\n\n            // iceStateChanged works - close/disconnected/error doesn't for some reason\n            // @ts-expect-error `iceStateChanged` is not included in TS definitions\n            conn.on('iceStateChanged', (state) => {\n                if (state === 'disconnected' || state === 'closed') {\n                    RemoteMicManager.removeRemoteMic(conn.peer);\n                }\n            });\n\n            conn.on('close', () => {\n                RemoteMicManager.removeRemoteMic(conn.peer);\n            });\n        });\n        this.peer.on('close', () => {\n            this.started = false;\n        });\n    };\n\n    public getRoomId = () => this.roomId;\n}\n\nexport default new WebRTCServer();\n","import { NotesSection, Section } from 'interfaces';\n\nexport default function isNotesSection(section: Section | undefined | null): section is NotesSection {\n    return section?.type === 'notes' && !!section.notes.length;\n}\n","import { NotesSection, Section } from 'interfaces';\nimport isNotesSection from './isNotesSection';\n\nexport const getFirstNoteStartFromSections = (sections: Section[]) => {\n    const firstNoteSection = sections.find(isNotesSection);\n\n    return firstNoteSection ? firstNoteSection.notes[0].start : Infinity;\n};\nexport const getLastNoteEndFromSections = (sections: Section[]) => {\n    const notesSections = sections.filter(isNotesSection);\n    const lastSection = notesSections.at(-1);\n\n    return lastSection ? getLastNoteEnd(lastSection) : 0;\n};\n\nexport const getLastNoteEnd = (section: NotesSection) => {\n    const lastNote = section.notes.at(-1)!;\n\n    return lastNote.start + lastNote.length;\n};\n\nexport const getNoteAtBeat = (section: NotesSection, beat: number, tolerance = 0) => {\n    return section.notes.find((note) => note.start - tolerance <= beat && note.start + note.length + tolerance >= beat);\n};\n","import InputInterface from './Interface';\n\nclass DrawingTestInput implements InputInterface {\n    private frequencies: [number, number] = [440, 410];\n    private volumes: [number, number] = [1, 1];\n\n    public startMonitoring = async () => {};\n\n    public getFrequencies = (deviceId?: string) => this.frequencies;\n    public getVolumes = (deviceId?: string) => this.volumes;\n\n    public stopMonitoring = async (deviceId?: string) => {};\n\n    public getInputLag = () => 0;\n    public getChannelsCount = () => 2;\n\n    public setFrequency = (channel: 0 | 1, value: number) => (this.frequencies[channel] = value);\n\n    public requestReadiness = () => Promise.resolve(true);\n}\n\nexport default new DrawingTestInput();\n","import InputInterface from './Interface';\n\nclass DummyInput implements InputInterface {\n    private frequencies: [number, number] = [410, 210];\n    private volumes: [number, number] = [1, 1];\n    private timestamp = 0;\n    private interval: number | null = null;\n\n    private isMonitoring = false;\n\n    public startMonitoring = async () => {\n        if (this.isMonitoring) return;\n        this.isMonitoring = true;\n        this.interval = window.setInterval(() => {\n            this.timestamp = this.timestamp + 32;\n\n            const secPart = 0; // this.timestamp % 1000;\n            if (secPart > 232 && secPart < 708) {\n                this.frequencies[0] = 0;\n                this.frequencies[1] = 0;\n            } else {\n                this.frequencies[0] = Math.sin(this.timestamp / 1000) * 50 + 100;\n                this.frequencies[1] = Math.cos(this.timestamp / 1000) * 50 + 200;\n            }\n        }, 32);\n    };\n\n    public getFrequencies = () => this.frequencies;\n    public getVolumes = () => this.volumes;\n\n    public stopMonitoring = async () => {\n        if (!this.isMonitoring) return;\n        this.isMonitoring = false;\n        if (this.interval) {\n            window.clearInterval(this.interval);\n        }\n    };\n\n    public getInputLag = () => 150;\n    public getChannelsCount = () => 2;\n    public requestReadiness = () => Promise.resolve(true);\n}\n\nexport default new DummyInput();\n","import events from 'GameEvents/GameEvents';\nimport AubioStrategy from 'Scenes/Game/Singing/Input/MicStrategies/Aubio';\nimport userMediaService from 'UserMedia/userMediaService';\nimport Listener from 'utils/Listener';\nimport InputInterface from './Interface';\n\nclass MicInput extends Listener<[[number, number], [number, number]]> implements InputInterface {\n    private stream: MediaStream | null = null;\n    private context: AudioContext | null = null;\n\n    private interval: ReturnType<typeof setInterval> | null = null;\n\n    private frequencies: [number, number] = [0, 0];\n    private volumes: [number, number] = [0, 0];\n\n    private startedMonitoring = false;\n\n    public startMonitoring = async (deviceId?: string, echoCancellation = false) => {\n        if (this.startedMonitoring) return;\n        this.startedMonitoring = true;\n\n        this.stream = await userMediaService.getUserMedia({\n            audio: {\n                ...(deviceId ? { deviceId, exact: true } : {}),\n                echoCancellation: echoCancellation,\n            },\n            video: false,\n        });\n\n        this.context = new AudioContext();\n\n        const source = this.context.createMediaStreamSource(this.stream);\n        const splitter = this.context.createChannelSplitter(2);\n        source.connect(splitter);\n\n        const analyserCh0 = this.context.createAnalyser();\n        analyserCh0.fftSize = 2048;\n        analyserCh0.minDecibels = -100;\n        const analyserCh1 = this.context.createAnalyser();\n        analyserCh1.fftSize = 2048;\n        analyserCh1.minDecibels = -100;\n        splitter.connect(analyserCh0, 0);\n        splitter.connect(analyserCh1, 1);\n\n        const strategy = new AubioStrategy();\n        await strategy.init(this.context, analyserCh0.fftSize);\n\n        this.interval = setInterval(async () => {\n            const dataCh0 = new Float32Array(analyserCh0.fftSize);\n            const dataCh1 = new Float32Array(analyserCh1.fftSize);\n\n            analyserCh0.getFloatTimeDomainData(dataCh0);\n            analyserCh1.getFloatTimeDomainData(dataCh1);\n\n            this.frequencies = await Promise.all([strategy.getFrequency(dataCh0), strategy.getFrequency(dataCh1)]);\n\n            this.volumes = [this.calculateVolume(dataCh0), this.calculateVolume(dataCh1)];\n\n            this.onUpdate(this.frequencies, this.volumes);\n        }, this.context.sampleRate / analyserCh0.fftSize);\n\n        events.micMonitoringStarted.dispatch();\n    };\n\n    public getFrequencies = () => {\n        return this.frequencies;\n    };\n    public getVolumes = () => this.volumes;\n\n    public stopMonitoring = async () => {\n        if (!this.startedMonitoring) return;\n        this.startedMonitoring = false;\n        this.interval && clearInterval(this.interval);\n        this.stream?.getTracks().forEach(function (track) {\n            track.stop();\n        });\n        try {\n            await this.context?.close();\n        } catch (e) {\n            console.log('MicInput.stoMonitoring error', e);\n        }\n\n        events.micMonitoringStopped.dispatch();\n    };\n\n    public getInputLag = () => 180;\n    public getChannelsCount = () => 2;\n\n    private calculateVolume(input: Float32Array) {\n        let i;\n        let sum = 0.0;\n        for (i = 0; i < input.length; ++i) {\n            sum += input[i] * input[i];\n        }\n        return Math.sqrt(sum / input.length);\n    }\n    public requestReadiness = () => Promise.resolve(true);\n}\n\nexport default new MicInput();\n","import RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport InputInterface from './Interface';\n\nclass RemoteMicInput implements InputInterface {\n    private frequencies: [number] = [0];\n    private volumes: [number] = [1];\n\n    public startMonitoring = async (remoteMicId?: string) => {\n        return RemoteMicManager.getRemoteMicById(remoteMicId ?? '')\n            ?.getInput()\n            .startMonitoring();\n    };\n\n    public getFrequencies = (deviceId?: string) => {\n        const val = RemoteMicManager.getRemoteMicById(deviceId ?? '')\n            ?.getInput()\n            .getFrequencies();\n\n        return val ?? this.frequencies;\n    };\n    public getVolumes = (deviceId?: string) => {\n        const val = RemoteMicManager.getRemoteMicById(deviceId ?? '')\n            ?.getInput()\n            .getVolumes();\n\n        return val ?? this.volumes;\n    };\n\n    public stopMonitoring = async (deviceId?: string) =>\n        RemoteMicManager.getRemoteMicById(deviceId ?? '')\n            ?.getInput()\n            .stopMonitoring();\n\n    public requestReadiness = (deviceId?: string) =>\n        RemoteMicManager.getRemoteMicById(deviceId ?? '')\n            ?.getInput()\n            .requestReadiness() ?? Promise.resolve(true);\n\n    public getInputLag = (deviceId?: string) =>\n        RemoteMicManager.getRemoteMicById(deviceId ?? '')\n            ?.getInput()\n            .getInputLag() ?? 0;\n\n    public getChannelsCount = () => 1;\n}\n\nexport default new RemoteMicInput();\n","import { InputSource } from './interfaces';\n\nconst inputs = [\n    {\n        channels: 2,\n        channel: 1,\n        label: 'Drawing Test Input',\n        id: 'default;1',\n        deviceId: 'default',\n    },\n];\n\nexport class DrawingTestInputSource {\n    public static readonly inputName = 'DrawingTest';\n\n    public static getDefault = () => inputs[0];\n\n    public static getInputs = async (): Promise<InputSource[]> => inputs;\n\n    public static subscribeToListChange = (callback: () => void) => undefined;\n    public static unsubscribeToListChange = (callback: () => void) => undefined;\n}\n","import { range } from 'lodash-es';\nimport { InputSource } from './interfaces';\nimport userMediaService from 'UserMedia/userMediaService';\n\ninterface NameMapper {\n    test: (label: string, channel: number, channels: number) => boolean;\n    map: (label: string, channel: number) => string;\n}\n\nconst singstarWirelessMicMapper: NameMapper = {\n    test: (label) =>\n        label.toLowerCase().includes('wireless mic #') || label.toLowerCase().includes('sony wireless singstar'),\n    map: (label, channel) => `SingStar Wireless - ${channel === 0 ? 'Blue' : 'Red'}`,\n};\nconst singstarWiredMicMapper: NameMapper = {\n    test: (label) => label.toLowerCase().includes('usbmic serial#') || label.toLowerCase().includes('singstar'),\n    map: (label, channel) => `SingStar Wired - ${channel === 0 ? 'Blue' : 'Red'}`,\n};\nconst singstarGenericMapper: NameMapper = {\n    test: (label, channel, channels) => channels === 2 && label.toLowerCase().includes('singstar'),\n    map: (label, channel) => `SingStar Mic - ${channel === 0 ? 'Blue' : 'Red'}`,\n};\n\nconst getPreferred = (...[label, ch, channels]: Parameters<NameMapper['test']>) =>\n    singstarWiredMicMapper.test(label, ch, channels) ||\n    singstarWirelessMicMapper.test(label, ch, channels) ||\n    singstarGenericMapper.test(label, ch, channels)\n        ? ch\n        : undefined;\n\nconst mapInputName = (label: string, channel: number, channels: number) => {\n    if (singstarWirelessMicMapper.test(label, channel, channels)) return singstarWirelessMicMapper.map(label, channel);\n    if (singstarWiredMicMapper.test(label, channel, channels)) return singstarWiredMicMapper.map(label, channel);\n    if (singstarGenericMapper.test(label, channel, channels)) return singstarGenericMapper.map(label, channel);\n\n    return channels > 1 ? `${label} (ch ${channel + 1})` : label;\n};\n\nexport class MicrophoneInputSource {\n    private static inputList: InputSource[] = [];\n    public static readonly inputName = 'Microphone';\n\n    public static getDefault = () =>\n        MicrophoneInputSource.inputList.find((input) => input.id === 'default;0') ??\n        MicrophoneInputSource.inputList[0] ??\n        null;\n\n    public static getInputs = async (): Promise<InputSource[]> => {\n        await userMediaService.getUserMedia({ audio: true });\n        const devices = await userMediaService.enumerateDevices();\n\n        MicrophoneInputSource.inputList = (devices as any as Array<MediaStreamTrack & MediaDeviceInfo>)\n            .filter((device) => device.kind === 'audioinput')\n            .map((device) => {\n                const channels = device.getCapabilities?.()?.channelCount?.max ?? 1;\n\n                return range(0, channels).map((channel) => ({\n                    label: mapInputName(device.label, channel, channels),\n                    channel,\n                    channels,\n                    deviceId: device.deviceId,\n                    id: `${device.deviceId};${channel}`,\n                    preferred: getPreferred(device.label, channel, channels),\n                }));\n            })\n            .flat();\n\n        return MicrophoneInputSource.inputList;\n    };\n\n    public static subscribeToListChange = (callback: () => void) =>\n        navigator.mediaDevices.addEventListener('devicechange', callback);\n    public static unsubscribeToListChange = (callback: () => void) =>\n        navigator.mediaDevices.removeEventListener('devicechange', callback);\n}\n","import { RemoteMic } from 'RemoteMic/RemoteMicInput';\nimport { InputSource } from './interfaces';\nimport events from 'GameEvents/GameEvents';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\n\nconst mapRemoteMicToInput = (remoteMic: RemoteMic): InputSource => ({\n    label: `ðŸ“±${remoteMic.name}`,\n    id: `${remoteMic.id};0`,\n    deviceId: remoteMic.id,\n    channels: 1,\n    channel: 0,\n});\n\nexport class RemoteMicrophoneInputSource {\n    public static readonly inputName = 'Remote Microphone';\n\n    public static getDefault = () => RemoteMicManager.getRemoteMics().map(mapRemoteMicToInput)[0] ?? null;\n\n    public static getInputs = async (): Promise<InputSource[]> =>\n        RemoteMicManager.getRemoteMics().map(mapRemoteMicToInput);\n\n    public static subscribeToListChange = (callback: () => void) => {\n        events.remoteMicConnected.subscribe(callback);\n        events.remoteMicDisconnected.subscribe(callback);\n    };\n    public static unsubscribeToListChange = (callback: () => void) => {\n        events.remoteMicConnected.unsubscribe(callback);\n        events.remoteMicDisconnected.unsubscribe(callback);\n    };\n}\n","export default {\n    storeValue: <T>(key: string, value: T) => {\n        sessionStorage.setItem(key, JSON.stringify(value));\n    },\n    getValue: <T = any>(key: string): T | null => {\n        const val = sessionStorage.getItem(key);\n\n        if (val === null) {\n            return null;\n        }\n\n        return JSON.parse(val);\n    },\n};\n","import { InputSource } from './interfaces';\n\nconst inputList = [\n    {\n        channels: 2,\n        channel: 0,\n        label: 'Dummy Input 1',\n        id: 'default;0',\n        deviceId: 'default',\n    },\n    {\n        channels: 2,\n        channel: 1,\n        label: 'Dummy Input 2',\n        id: 'default;1',\n        deviceId: 'default',\n    },\n];\n\nexport class DummyInputSource {\n    public static readonly inputName = 'Dummy';\n\n    public static getDefault = () => inputList[0];\n\n    public static getInputs = async (): Promise<InputSource[]> => inputList;\n\n    public static subscribeToListChange = (callback: () => void) => undefined;\n    public static unsubscribeToListChange = (callback: () => void) => undefined;\n}\n","import events from 'GameEvents/GameEvents';\nimport { SelectedPlayerInput } from 'Scenes/Game/Singing/Input/InputManager';\nimport { DrawingTestInputSource } from 'Scenes/SelectInput/InputSources/DrawingTest';\nimport {\n    InputSourceList,\n    InputSourceManagerInterface,\n    InputSourceNames,\n} from 'Scenes/SelectInput/InputSources/interfaces';\nimport { DummyInputSource } from './Dummy';\nimport { MicrophoneInputSource } from './Microphone';\nimport { RemoteMicrophoneInputSource } from './Remote';\n\nconst selectedPlayerInputToId = (input: SelectedPlayerInput) => `${input.deviceId};${input.channel}`;\n\nclass InputSourceListManager {\n    private inputList: Record<InputSourceNames, InputSourceList>;\n\n    constructor() {\n        this.inputList = {\n            [MicrophoneInputSource.inputName]: this.initialiseInputSource(MicrophoneInputSource, true),\n            [DummyInputSource.inputName]: this.initialiseInputSource(DummyInputSource),\n            [RemoteMicrophoneInputSource.inputName]: this.initialiseInputSource(RemoteMicrophoneInputSource),\n            [DrawingTestInputSource.inputName]: this.initialiseInputSource(DrawingTestInputSource),\n        };\n    }\n\n    private initialiseInputSource = <T extends InputSourceManagerInterface>(source: T, lazily = false) => {\n        if (!lazily) {\n            source.getInputs().then((list) => {\n                this.inputList[source.inputName].list = list;\n                events.inputListChanged.dispatch();\n\n                source.subscribeToListChange(async () => {\n                    this.inputList[source.inputName].list = await source.getInputs();\n                    events.inputListChanged.dispatch();\n                });\n            });\n        }\n\n        return {\n            list: [],\n            getDefault: source.getDefault,\n        };\n    };\n\n    public loadMics = () => {\n        if (!this.inputList.Microphone.list.length) {\n            this.inputList.Microphone = this.initialiseInputSource(MicrophoneInputSource);\n        }\n    };\n\n    public getInputList = () => this.inputList;\n\n    public getInputForPlayerSelected = (input: SelectedPlayerInput, returnDefault = true) => {\n        const source = this.inputList[input.inputSource];\n        return (\n            source.list.find((item) => item.id === selectedPlayerInputToId(input)) ??\n            (returnDefault ? source.getDefault() : null)\n        );\n    };\n}\nexport default new InputSourceListManager();\n","import events from 'GameEvents/GameEvents';\nimport DrawingTestInput from 'Scenes/Game/Singing/Input/DrawingTestInput';\nimport dummyInput from 'Scenes/Game/Singing/Input/DummyInput';\nimport MicInput from 'Scenes/Game/Singing/Input/MicInput';\nimport RemoteMicInput from 'Scenes/Game/Singing/Input/RemoteMicInput';\nimport { DrawingTestInputSource } from 'Scenes/SelectInput/InputSources/DrawingTest';\nimport { InputSourceNames } from 'Scenes/SelectInput/InputSources/interfaces';\nimport { MicrophoneInputSource } from 'Scenes/SelectInput/InputSources/Microphone';\nimport { RemoteMicrophoneInputSource } from 'Scenes/SelectInput/InputSources/Remote';\nimport storage from 'utils/storage';\nimport inputSourceListManager from 'Scenes/SelectInput/InputSources';\n\nexport interface SelectedPlayerInput {\n    inputSource: InputSourceNames;\n    deviceId?: string;\n    channel: number;\n}\n\nconst PLAYER_INPUTS_LOCAL_STORAGE_KEY = 'playerselectedinputs';\n\nclass InputManager {\n    private isMonitoring = false;\n    private requestingPromise: Promise<any> | null = null;\n    private playerInputs: SelectedPlayerInput[] = storage.getValue(PLAYER_INPUTS_LOCAL_STORAGE_KEY) ?? [];\n\n    constructor() {\n        if (this.playerInputs.length === 0) {\n            this.setPlayerInput(0, 'Dummy', 0, 'default');\n            this.setPlayerInput(1, 'Dummy', 1, 'default');\n        } else if (this.playerInputs.some((input) => input.inputSource === 'Microphone')) {\n            // If any microphones are selected, load the list\n            inputSourceListManager.loadMics();\n        }\n\n        events.inputListChanged.subscribe(async () => {\n            if (this.isMonitoring) {\n                await this.stopMonitoring();\n                this.startMonitoring();\n            }\n        });\n    }\n\n    /**\n     * Returns raw current selection with no guarantee that the device (eg mic, remote mic) is actually connected\n     */\n    public getRawInputs = () => this.playerInputs;\n\n    public getPlayerFrequency = (playerNumber: number) => {\n        const frequencies = this.sourceNameToInput(this.playerInputs[playerNumber].inputSource).getFrequencies(\n            this.playerInputs[playerNumber].deviceId,\n        );\n\n        return frequencies[this.playerInputs[playerNumber].channel];\n    };\n\n    public getPlayerVolume = (playerNumber: number) => {\n        const frequencies = this.sourceNameToInput(this.playerInputs[playerNumber].inputSource).getVolumes(\n            this.playerInputs[playerNumber].deviceId,\n        );\n\n        return frequencies[this.playerInputs[playerNumber].channel];\n    };\n\n    public getPlayerInputLag = (playerNumber: number) =>\n        this.sourceNameToInput(this.playerInputs[playerNumber].inputSource).getInputLag();\n\n    public setPlayerInput = (playerNumber: number, source: InputSourceNames, channel = 0, deviceId?: string) => {\n        // In case input change while monitoring stop monitoring everything and start monitoring after the change happen\n        let restartMonitoringPromise: null | Promise<void> = null;\n        if (this.isMonitoring) {\n            restartMonitoringPromise = this.stopMonitoring();\n        }\n\n        const newInput = { inputSource: source, deviceId, channel };\n        const oldInput = this.playerInputs[playerNumber];\n        this.playerInputs[playerNumber] = newInput;\n\n        storage.storeValue(PLAYER_INPUTS_LOCAL_STORAGE_KEY, this.playerInputs);\n        events.playerInputChanged.dispatch(playerNumber, oldInput, newInput);\n\n        if (restartMonitoringPromise) {\n            restartMonitoringPromise.then(this.startMonitoring);\n        }\n    };\n\n    public getPlayerInput = (playerNumber: number): SelectedPlayerInput | null =>\n        this.playerInputs[playerNumber] ?? null;\n\n    public startMonitoring = async () => {\n        await Promise.all(\n            this.playerInputs.map((playerInput) =>\n                this.sourceNameToInput(playerInput.inputSource).startMonitoring(playerInput.deviceId),\n            ),\n        );\n        this.isMonitoring = true;\n    };\n\n    public stopMonitoring = async () => {\n        await Promise.all(\n            this.playerInputs.map((playerInput) =>\n                this.sourceNameToInput(playerInput.inputSource).stopMonitoring(playerInput.deviceId),\n            ),\n        );\n        this.isMonitoring = false;\n    };\n\n    public getInputs = (): SelectedPlayerInput[] => {\n        return this.playerInputs.map((input) =>\n            inputSourceListManager.getInputForPlayerSelected(input, false)\n                ? input\n                : { inputSource: 'Dummy', deviceId: 'default', channel: 0 },\n        );\n    };\n\n    public monitoringStarted = () => this.isMonitoring;\n\n    public requestReadiness = async () => {\n        if (!this.requestingPromise) {\n            this.requestingPromise = new Promise((resolve) => {\n                const request = async () => {\n                    const allInputsConnected = !this.playerInputs.some(\n                        (input) => inputSourceListManager.getInputForPlayerSelected(input, false) === null,\n                    );\n\n                    if (allInputsConnected) {\n                        await Promise.all(\n                            this.playerInputs.map((playerInput) =>\n                                this.sourceNameToInput(playerInput.inputSource)\n                                    .requestReadiness(playerInput.deviceId)\n                                    .then(() => {\n                                        events.readinessConfirmed.dispatch(playerInput.deviceId!);\n                                    }),\n                            ),\n                        );\n                        events.inputListChanged.unsubscribe(request);\n                        this.requestingPromise = null;\n                        resolve(true);\n                    }\n                };\n\n                events.inputListChanged.subscribe(request);\n                request();\n            });\n        }\n\n        return this.requestingPromise;\n    };\n\n    // todo: Create eg. \"InputSourceManager\" and have the logic there?\n    private sourceNameToInput = (sourceName: InputSourceNames) => {\n        if (sourceName === MicrophoneInputSource.inputName) return MicInput;\n        if (sourceName === DrawingTestInputSource.inputName) return DrawingTestInput;\n        if (sourceName === RemoteMicrophoneInputSource.inputName) return RemoteMicInput;\n        return dummyInput;\n    };\n}\n\nexport default new InputManager();\n","export const noDistanceNoteTypes = ['freestyle', 'rap'];\nexport const noPointsNoteTypes: string[] = [];\n\nexport const MIDDLEA = 440;\nexport const SEMITONE = 69;\n","import { MIDDLEA, SEMITONE } from 'consts';\n\nexport default function pitchToFrequency(note: number) {\n    return MIDDLEA * Math.pow(2, (note - SEMITONE) / 12);\n}\n","import { MIDDLEA, SEMITONE } from 'consts';\nimport pitchToFrequency from 'utils/pitchToFrequency';\nimport GameState from '../GameState';\n\nexport const pitchFromFrequency = (freq: number) =>\n    Math.round(12 * (Math.log(freq / MIDDLEA) / Math.log(2))) + SEMITONE;\n\nconst getDistanceInCents = (noteFreq: number, freq: number) =>\n    Math.floor((1200 * Math.log(freq / noteFreq)) / Math.log(2));\n\nconst getCentDistance = (targetNote: number, freq: number, tolerance: number) => {\n    const noteFreq = pitchToFrequency(targetNote);\n    const cents = getDistanceInCents(noteFreq, freq);\n    // To handle cases for cents like -1150 (=50) or 1150 (=-50)\n    const distance = Math.sign(cents) * ((((Math.abs(cents) % 1200) + 600) % 1200) - 600);\n\n    return distance / (tolerance * 100 + 50);\n};\n\nexport const calcDistanceBetweenPitches = (note: number, targetNote: number, tolerance: number) => {\n    // +6 / - 6 are here to avoid distances like -8 in favor of +4\n    // (so smallest between \"too high\" or \"too low\" pitch to hit the note in whatever octave)\n    const noteDistance = (((note % 12) - (targetNote % 12) + 18) % 12) - 6;\n\n    return Math.abs(noteDistance) <= tolerance ? 0 : noteDistance;\n};\n\nexport const calcDistance = (frequency: number, targetNote: number) => {\n    const tolerance = GameState.getTolerance();\n    const note = pitchFromFrequency(frequency);\n    let preciseDistance: number = -1;\n    const distance = calcDistanceBetweenPitches(note, targetNote, tolerance);\n\n    if (distance === 0) {\n        preciseDistance = getCentDistance(targetNote, frequency, tolerance);\n    }\n\n    return { distance, preciseDistance };\n};\n","import { FrequencyRecord } from 'interfaces';\n\nconst WINDOW_SIZE = 6;\n\nexport default function detectVibrato(data: FrequencyRecord[]): boolean {\n    const opChangePoints: Array<FrequencyRecord & { change: '>' | '<'; interval: number }> = [];\n\n    for (let i = 1; i < data.length; i++) {\n        if (Math.round(data[i].frequency / 2) === Math.round(data[i - 1].frequency / 2)) continue;\n\n        const change = data[i].frequency > data[i - 1].frequency ? '>' : '<';\n        if (opChangePoints.length === 0) {\n            opChangePoints.push({\n                ...data[i],\n                interval: data[i].timestamp - data[i - 1].timestamp,\n                change,\n            });\n        } else {\n            const lastChange = opChangePoints.at(-1)!;\n            if (lastChange.change !== change) {\n                opChangePoints.push({\n                    ...data[i],\n                    interval: data[i].timestamp - lastChange.timestamp,\n                    change,\n                });\n            }\n        }\n    }\n\n    const changePoints = opChangePoints;\n\n    for (let i = 0; i < changePoints.length - WINDOW_SIZE; i++) {\n        const window = changePoints.slice(i, i + WINDOW_SIZE - 1);\n\n        const intervals = window.map((record) => record.interval);\n        // const pitches = window.map((record) => record.pitch);\n        const maxInterval = Math.max(...intervals);\n        const minInterval = Math.min(...intervals);\n\n        const averageIntervals = intervals.reduce((sum, i) => sum + i, 0) / intervals.length;\n\n        if (maxInterval < averageIntervals * 1.75 && minInterval > averageIntervals / 1.75) return true;\n    }\n\n    return false;\n}\n","import { noDistanceNoteTypes } from 'consts';\nimport { FrequencyRecord, Note, PlayerNote } from 'interfaces';\nimport { calcDistance } from './calcDistance';\nimport detectVibrato from './detectVibrato';\n\nconst SINGING_BREAK_TOLERANCE_MS = 100;\n\nexport function appendFrequencyToPlayerNotes(\n    playerNotes: PlayerNote[],\n    record: FrequencyRecord,\n    note: Note,\n    beatLength: number,\n) {\n    if (record.frequency === 0) return;\n    const noteCandidate = {\n        ...record,\n        beat: Math.max(0, record.timestamp) / beatLength,\n        ...calcDistance(record.frequency, note.pitch),\n    };\n    const lastNote = playerNotes.at(-1);\n\n    const breakToleranceBeat = SINGING_BREAK_TOLERANCE_MS / beatLength;\n\n    const noteEndBeat = note.start + note.length;\n    const isThisNoteDifferentThanLast = !lastNote || lastNote.note.start !== note.start;\n    const isDistanceDifferent =\n        !lastNote || (lastNote.distance !== noteCandidate.distance && !noDistanceNoteTypes.includes(note.type));\n\n    if (\n        isThisNoteDifferentThanLast ||\n        isDistanceDifferent ||\n        noteCandidate.beat - (lastNote.start + lastNote.length) > breakToleranceBeat\n    ) {\n        const roundedStart = noteCandidate.beat - breakToleranceBeat < note.start ? note.start : noteCandidate.beat;\n        playerNotes.push({\n            // If this is the first player note for the note, round player note start to note's start\n            start: Math.min(isThisNoteDifferentThanLast ? roundedStart : noteCandidate.beat, noteEndBeat),\n            length: 0,\n            distance: noteCandidate.distance,\n            note,\n            isPerfect: false,\n            vibrato: false,\n            frequencyRecords: [\n                {\n                    frequency: noteCandidate.frequency,\n                    preciseDistance: noteCandidate.preciseDistance,\n                    timestamp: noteCandidate.timestamp,\n                },\n            ],\n        });\n\n        // Round the last player note length to the end of the note, so it looks a bit smoother\n        if (lastNote && note.start !== lastNote.note.start) {\n            const lastPlayerNoteEndBeat = lastNote.start + lastNote.length;\n            const lastNoteEndBeat = lastNote.note.start + lastNote.note.length;\n            const roundedLength =\n                lastPlayerNoteEndBeat + breakToleranceBeat > lastNoteEndBeat ? lastNoteEndBeat : lastPlayerNoteEndBeat;\n            lastNote.length = Math.max(0, roundedLength - lastNote.start);\n        }\n    } else {\n        lastNote.length = Math.max(0, Math.min(noteCandidate.beat, note.start + note.length) - lastNote.start);\n        lastNote.frequencyRecords.push({\n            frequency: noteCandidate.frequency,\n            timestamp: noteCandidate.timestamp,\n            preciseDistance: noteCandidate.preciseDistance,\n        });\n\n        lastNote.isPerfect = lastNote.distance === 0 && Math.abs(lastNote.length - lastNote.note.length) < 0.5;\n\n        lastNote.vibrato = lastNote.distance === 0 && detectVibrato(lastNote.frequencyRecords);\n    }\n}\n","import { noDistanceNoteTypes } from 'consts';\nimport { PlayerNote } from 'interfaces';\n\nexport default function getPlayerNoteDistance(note: PlayerNote) {\n    return noDistanceNoteTypes.includes(note.note.type) ? 0 : note.distance;\n}\n","import { noPointsNoteTypes } from 'consts';\nimport { DetailedScore, PlayerNote, Song } from 'interfaces';\nimport { memoize } from 'lodash-es';\nimport tuple from '../../../../../utils/tuple';\nimport getPlayerNoteDistance from '../../Helpers/getPlayerNoteDistance';\nimport isNotesSection from 'Songs/utils/isNotesSection';\n\nexport const MAX_POINTS = 3_500_000;\n\nconst noteTypesMultipliers: DetailedScore = {\n    freestyle: 0.25,\n    rap: 0.25,\n    star: 2,\n    normal: 1,\n    perfect: 0.5,\n    vibrato: 0.25,\n};\n\nconst countsToBeats = (counts: DetailedScore): DetailedScore => ({\n    freestyle: counts.freestyle * noteTypesMultipliers.freestyle,\n    rap: counts.rap * noteTypesMultipliers.rap,\n    star: counts.star * noteTypesMultipliers.star,\n    normal: counts.normal * noteTypesMultipliers.normal,\n    perfect: counts.perfect * noteTypesMultipliers.perfect,\n    vibrato: counts.vibrato * noteTypesMultipliers.vibrato,\n});\n\nexport const sumDetailedScore = (counts: DetailedScore) =>\n    counts.freestyle + counts.rap + counts.star + counts.normal + counts.perfect + counts.vibrato;\n\nconst countSungBeats = memoize((song: Song): DetailedScore[] => {\n    return song.tracks.map(({ sections }) => {\n        const counts: DetailedScore = {\n            freestyle: 0,\n            rap: 0,\n            star: 0,\n            normal: 0,\n            perfect: 0,\n            vibrato: 0,\n        };\n        sections.filter(isNotesSection).forEach((section) => {\n            const notes = section.notes.filter((note) => !noPointsNoteTypes.includes(note.type));\n\n            notes.forEach((note) => {\n                counts[note.type] = counts[note.type] + note.length;\n                counts.perfect = counts.perfect + note.length;\n                counts.vibrato = counts.vibrato + note.length;\n            });\n        });\n\n        return counts;\n    });\n});\n\nexport function calculateDetailedScoreData(playerNotes: PlayerNote[], song: Song, trackNumber: number) {\n    const beatsPerTrack = countSungBeats(song);\n\n    const counts: DetailedScore = {\n        freestyle: 0,\n        rap: 0,\n        star: 0,\n        normal: 0,\n        perfect: 0,\n        vibrato: 0,\n    };\n\n    if (!beatsPerTrack[trackNumber]) {\n        console.error(`No beat count for track ${trackNumber} in song`, song);\n        return tuple([0, counts, counts]);\n    }\n\n    const maxCounts = countsToBeats(countSungBeats(song)[trackNumber]);\n\n    const pointsPerBeat = MAX_POINTS / sumDetailedScore(maxCounts);\n\n    for (let i = 0; i < playerNotes.length; i++) {\n        const note = playerNotes[i];\n        if (noPointsNoteTypes.includes(note.note.type)) continue;\n        if (getPlayerNoteDistance(note) !== 0) continue;\n\n        counts[note.note.type] = counts[note.note.type] + note.length;\n\n        if (note.isPerfect) counts.perfect = counts.perfect + note.length;\n        if (note.vibrato) counts.vibrato = counts.vibrato + note.length;\n    }\n\n    return tuple([pointsPerBeat, countsToBeats(counts), maxCounts]);\n}\n\nexport default function calculateScore(playerNotes: PlayerNote[], song: Song, trackNumber: number): number {\n    const [pointsPerBeat, counts] = calculateDetailedScoreData(playerNotes, song, trackNumber);\n\n    return sumDetailedScore(counts) * pointsPerBeat;\n}\n","export default function getCurrentBeat(currentTime: number, beatLength: number, gap: number, round = true): number {\n    const currentBeat = (currentTime - gap) / beatLength;\n    return round ? Math.floor(currentBeat) : currentBeat;\n}\n","import { Song, SongPreview } from 'interfaces';\nimport { memoize } from 'lodash-es';\n\nexport default memoize(function getSongBeatLength(song: Song | SongPreview): number {\n    return (60 / song.bpm / song.bar) * 1000;\n});\n","import { FrequencyRecord, NotesSection, PlayerNote, SingSetup, Song } from 'interfaces';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { getNoteAtBeat } from 'Songs/utils/notesSelectors';\nimport InputManager from '../Input/InputManager';\nimport { appendFrequencyToPlayerNotes } from './Helpers/appendFrequencyToPlayerNotes';\nimport calculateScore from './Helpers/calculateScore';\nimport getCurrentBeat from './Helpers/getCurrentBeat';\nimport getSongBeatLength from 'Songs/utils/getSongBeatLength';\nimport events from 'GameEvents/GameEvents';\n\nclass PlayerState {\n    private frequencyRecords: FrequencyRecord[] = [];\n    private playerNotes: PlayerNote[] = [];\n    private realFrequencyRecords: FrequencyRecord[] = [];\n    private realPlayerNotes: PlayerNote[] = [];\n    private min = Infinity;\n    private max = -Infinity;\n\n    private storedSectionIndex = 0;\n\n    public constructor(private index: number, private name: string, private gameState: GameState) {\n        this.getTrack()\n            .sections.filter(isNotesSection)\n            .forEach((section) =>\n                section.notes.forEach((note) => {\n                    this.min = Math.min(this.min, note.pitch);\n                    this.max = Math.max(this.max, note.pitch);\n                }),\n            );\n    }\n\n    public getName = () => this.name;\n    public setName = (name: string) => (this.name = name);\n\n    public update = () => {\n        const currentTime = this.gameState.getCurrentTime();\n\n        const frequency = InputManager.getPlayerFrequency(this.index);\n        const currentTimestamp = currentTime - InputManager.getPlayerInputLag(this.index);\n\n        // If it's a pack of frequencies (from remote mic), restore last \"real\" frequencies,\n        // add and recalculate for the received pack, and store newly computed\n        // frequencies for the moment when new package arrive.\n        // If it's a single frequency, just add it to the notes\n        if (Array.isArray(frequency)) {\n            const lastRealRecord = this.realFrequencyRecords.at(-1) || this.frequencyRecords.at(0);\n            const lastTimestamp = lastRealRecord?.timestamp ?? 0;\n            const timestampStep = (currentTimestamp - lastTimestamp) / frequency.length;\n\n            this.frequencyRecords = this.realFrequencyRecords;\n            this.playerNotes = this.realPlayerNotes;\n\n            for (let i = 0; i < frequency.length; i++) {\n                const timestamp = lastTimestamp + timestampStep * (i + 1);\n                this.updatePlayerNotes(timestamp, frequency[i]);\n            }\n\n            this.realFrequencyRecords = [...this.frequencyRecords];\n            this.realPlayerNotes = JSON.parse(JSON.stringify(this.playerNotes));\n        } else {\n            this.updatePlayerNotes(currentTimestamp, frequency);\n        }\n\n        this.dispatchSectionUpdate();\n    };\n\n    private dispatchSectionUpdate = () => {\n        const currentSectionIndex = this.getCurrentSectionIndex();\n        if (this.storedSectionIndex !== currentSectionIndex) {\n            events.sectionChange.dispatch(this.index, this.storedSectionIndex);\n            this.storedSectionIndex = currentSectionIndex;\n        }\n    };\n\n    public updatePlayerNotes = (timestamp: number, frequency: number) => {\n        const record = { timestamp, frequency };\n        this.frequencyRecords.push(record);\n\n        const recordBeat = record.timestamp / this.gameState.getSongBeatLength();\n        const recordSection = this.getSectionByBeat(recordBeat);\n\n        if (isNotesSection(recordSection)) {\n            const note = getNoteAtBeat(recordSection, recordBeat, 0) ?? getNoteAtBeat(recordSection, recordBeat, 0.5);\n\n            if (note) appendFrequencyToPlayerNotes(this.playerNotes, record, note, this.gameState.getSongBeatLength());\n        }\n    };\n\n    public getPlayerNotes = () => this.playerNotes;\n    public getPlayerFrequencies = () => this.frequencyRecords;\n\n    public getSectionIndexByBeat = (beat: number) => {\n        return this.getTrack().sections.findIndex((section, index, sections) => {\n            if (beat < 0) return true;\n            if (beat < section.start) return false;\n            if (index === sections.length - 1) return true;\n            return sections[index + 1].start > beat;\n        });\n    };\n\n    public getCurrentSectionIndex = () => this.getSectionIndexByBeat(this.gameState.getCurrentBeat());\n\n    public getSectionByBeat = (beat: number) => this.getTrack().sections[this.getSectionIndexByBeat(beat)] ?? null;\n\n    public getCurrentSection = () => {\n        const sectionIndex = this.getCurrentSectionIndex();\n\n        return this.getTrack().sections[sectionIndex] ?? null;\n    };\n\n    public getNextSection = (index = 1) => {\n        const sectionIndex = this.getCurrentSectionIndex();\n\n        return sectionIndex > -1 ? this.getTrack().sections[sectionIndex + index] ?? null : null;\n    };\n\n    public getPreviousSection = (index = 1) => {\n        const sectionIndex = this.getCurrentSectionIndex();\n\n        return sectionIndex > -1 ? this.getTrack().sections[sectionIndex - index] ?? null : null;\n    };\n\n    public getLastNotesSection = () => {\n        const last = this.getTrack().sections.at(-1);\n        return isNotesSection(last) ? last : (this.getTrack().sections.at(-2) as NotesSection);\n    };\n\n    public getScore = () => calculateScore(this.playerNotes, this.gameState.getSong()!, this.getTrackIndex());\n\n    public getMinPitch = () => this.min;\n    public getMaxPitch = () => this.max;\n\n    public getTrackIndex = () => this.gameState.getSingSetup()!.players[this.index].track;\n    public getTrack = () => this.gameState.getSong()!.tracks[this.getTrackIndex()];\n\n    public resetNotes = () => {\n        this.playerNotes = [];\n    };\n}\n\nclass GameState {\n    private song: Song | null = null;\n    private currentTime: number = 0;\n    private duration: number = 0;\n    private singSetup: SingSetup | null = null;\n    private playerStates: PlayerState[] = [];\n\n    public setCurrentTime = (currentTime: number) => (this.currentTime = currentTime);\n    public getCurrentTime = (accountGap = true) => {\n        return this.currentTime - (accountGap && this.song ? this.song.gap : 0);\n    };\n\n    public getSongBeatLength = () => getSongBeatLength(this.song!);\n    public getCurrentBeat = () => {\n        return getCurrentBeat(this.getCurrentTime(), this.getSongBeatLength(), 0, false);\n    };\n\n    public setSong = (song: Song) => (this.song = song);\n    public getSong = () => this.song;\n\n    public setSingSetup = (singSetup: SingSetup) => {\n        this.singSetup = singSetup;\n\n        this.playerStates = singSetup.players.map(({ name }, index) => new PlayerState(index, name, this));\n    };\n    public getSingSetup = () => this.singSetup;\n    public getTolerance = () => this.getSingSetup()?.tolerance ?? 2;\n\n    public setDuration = (duration: number) => (this.duration = duration);\n    public getDuration = () => this.duration;\n\n    public getPlayer = (player: number) => this.playerStates[player];\n\n    public getPlayers = () => this.playerStates;\n\n    public getPlayerCount = () => this.playerStates.length;\n\n    public startInputMonitoring = async () => {\n        return InputManager.startMonitoring();\n    };\n\n    public stopInputMonitoring = () => {\n        return InputManager.stopMonitoring();\n    };\n\n    public update = () => {\n        this.playerStates.forEach((player) => player.update());\n    };\n    public resetPlayerNotes = () => {\n        this.playerStates.forEach((player) => player.resetNotes());\n    };\n}\n\nexport default new GameState();\n","import WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport WebRTCServer from 'RemoteMic/Network/WebRTCServer';\nimport GameState from 'Scenes/Game/Singing/GameState/GameState';\nimport GameEvents from 'GameEvents/GameEvents'; // @ts-ignore\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\n\n// @ts-ignore\nwindow.__exposeSingletons = () => {\n    // @ts-ignore\n    window.__singletons = {\n        WebRTCClient,\n        WebRTCServer,\n        GameState,\n        GameEvents,\n        RemoteMicManager,\n    };\n};\n\nconsole.log(`Run window.__exposeSingletons() and inspect window.__singletons for debugging`);\n","export const PLAYER_NAMES_SESSION_STORAGE_KEY = 'session-player-names';\nexport const PREVIOUS_PLAYER_NAMES_STORAGE_KEY = 'previous-player-names';\n","import { PLAYER_NAMES_SESSION_STORAGE_KEY, PREVIOUS_PLAYER_NAMES_STORAGE_KEY } from 'hooks/players/consts';\n\nimport events from 'GameEvents/GameEvents';\n\nevents.songStarted.subscribe((_, singSetup) => {\n    let currentNames = JSON.parse(window.sessionStorage.getItem(PLAYER_NAMES_SESSION_STORAGE_KEY)!) || [];\n    const thisPlayNames = singSetup.players.map(({ name }) => name.trim());\n\n    const newNamesSet = [...currentNames].concat(...thisPlayNames);\n    currentNames = [...new Set(newNamesSet)].filter(Boolean);\n\n    window.sessionStorage.setItem(PLAYER_NAMES_SESSION_STORAGE_KEY, JSON.stringify(currentNames));\n    window.sessionStorage.setItem(PREVIOUS_PLAYER_NAMES_STORAGE_KEY, JSON.stringify(thisPlayNames));\n});\n\nevents.songScoreUpdated.subscribe((_, __, newName) => {\n    debugger;\n    let currentNames = JSON.parse(window.sessionStorage.getItem(PLAYER_NAMES_SESSION_STORAGE_KEY)!) || [];\n\n    const newNamesSet = [...currentNames].concat(newName);\n    currentNames = [...new Set(newNamesSet)].filter(Boolean);\n\n    window.sessionStorage.setItem(PLAYER_NAMES_SESSION_STORAGE_KEY, JSON.stringify(currentNames));\n});\n","const CURRENT_VISIT_KEY = 'CURRENT_VISIT_KEY';\nconst LAST_VISIT_KEY = 'LAST_VISIT_KEY';\n\nconst VISIT_TIMEOUT_MS = 3 * 60 * 60 * 1_000;\n\nconst currentTime = Date.now();\nconst currentVisit = Number(localStorage.getItem(CURRENT_VISIT_KEY) ?? currentTime);\n\n// One of the few ways to determine if user already visited the site before\nconst isFirstVisit = localStorage.getItem('posthog-user-id') === null;\n\n// If it's the first visit, don't show new songs\n// If the user visited the site before, show new songs added since the functionality was implemented\nconst defaultLastVisit = isFirstVisit ? currentTime : 1673642382501; // implementation time\nlet lastVisit = Number(localStorage.getItem(LAST_VISIT_KEY) ?? defaultLastVisit);\n\nif (currentTime - currentVisit > VISIT_TIMEOUT_MS) {\n    localStorage.setItem(LAST_VISIT_KEY, String(currentVisit));\n    lastVisit = currentVisit;\n}\nlocalStorage.setItem(CURRENT_VISIT_KEY, String(currentTime));\n\nexport { lastVisit };\n","import { SingSetup, SongPreview } from 'interfaces';\nimport localForage from 'localforage';\n\nexport interface SongStats {\n    plays: number;\n    scores: Array<{\n        setup: SingSetup;\n        scores: Array<{ name: string; score: number }>;\n        date: string;\n    }>;\n}\n\nexport const getSongKey = (song: Pick<SongPreview, 'artist' | 'title'>) => `${song.artist}-${song.title}`.toLowerCase();\n\nexport const fetchSongStats = async (song: Pick<SongPreview, 'artist' | 'title'>) => {\n    const storageKey = getSongKey(song);\n    return (await localForage.getItem<SongStats>(storageKey)) || { plays: 0, scores: [] };\n};\n\nexport const storeSongStats = async (song: Pick<SongPreview, 'artist' | 'title'>, stats: SongStats) => {\n    await localForage.setItem<SongStats>(getSongKey(song), stats);\n};\n","import localForage from 'localforage';\nimport events from 'GameEvents/GameEvents';\nimport { getSongKey, SongStats, storeSongStats } from 'Songs/stats/common';\n\nevents.songEnded.subscribe(async (song, setup, scores) => {\n    let currentState = await localForage.getItem<SongStats>(getSongKey(song));\n\n    const score = { setup, scores, date: new Date().toISOString() };\n    if (currentState) {\n        // there might be cases where only { plays: number } is stored\n        currentState.scores = [...(currentState?.scores ?? []), score];\n        currentState.plays = currentState.scores.length;\n    } else {\n        currentState = {\n            plays: 1,\n            scores: [score],\n        };\n    }\n\n    await storeSongStats(song, currentState);\n    events.songStatStored.dispatch(getSongKey(song), currentState);\n});\n","import { RemoteMicrophoneInputSource } from 'Scenes/SelectInput/InputSources/Remote';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport events from 'GameEvents/GameEvents';\nimport { toast } from 'react-toastify';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\n\nevents.playerInputChanged.subscribe((playerNumber, oldInput, newInput) => {\n    if (oldInput?.inputSource === RemoteMicrophoneInputSource.inputName) {\n        const playerNumber = InputManager.getInputs().findIndex(\n            (input) => input.inputSource === 'Remote Microphone' && input.deviceId === oldInput.deviceId,\n        );\n        const unselectedRemoteMic = RemoteMicManager.getRemoteMicById(oldInput.deviceId!);\n\n        unselectedRemoteMic?.setPlayerNumber(playerNumber >= 0 ? playerNumber : null);\n    }\n    if (newInput?.inputSource === 'Remote Microphone') {\n        const selectedRemoteMic = RemoteMicManager.getRemoteMicById(newInput.deviceId!);\n\n        selectedRemoteMic?.setPlayerNumber(playerNumber);\n    }\n});\nevents.remoteMicConnected.subscribe(({ id }) => {\n    const playerNumberIndex = InputManager.getRawInputs().findIndex(\n        (input) => input.inputSource === 'Remote Microphone' && input.deviceId === id,\n    );\n\n    if (playerNumberIndex > -1) {\n        const remoteMic = RemoteMicManager.getRemoteMicById(id);\n\n        remoteMic?.setPlayerNumber(playerNumberIndex);\n\n        if (InputManager.monitoringStarted()) {\n            remoteMic?.getInput()?.startMonitoring();\n        }\n    }\n});\n\nevents.playerChangeRequested.subscribe((phoneId, newPlayerNumber) => {\n    const currentPlayerNumber = InputManager.getRawInputs().findIndex((input) => input.deviceId === phoneId);\n\n    if (currentPlayerNumber > -1) {\n        InputManager.setPlayerInput(currentPlayerNumber, 'Dummy', 0);\n    }\n    if (newPlayerNumber !== null) {\n        InputManager.setPlayerInput(newPlayerNumber, 'Remote Microphone', 0, phoneId);\n    }\n});\n\nevents.remoteMicConnected.subscribe(({ name, silent }) => {\n    if (!silent) {\n        toast.success(\n            <>\n                Remote microphone <b>{name}</b> connected!\n            </>,\n        );\n    }\n});\nevents.remoteMicDisconnected.subscribe(({ name }, silent) => {\n    if (!silent) {\n        toast.warning(\n            <>\n                Remote microphone <b>{name}</b> disconnected!\n            </>,\n        );\n    }\n});\n","import InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport events from 'GameEvents/GameEvents';\nimport { SingSetup, Song, SongPreview } from 'interfaces';\nimport posthog from 'posthog-js';\n\nconst trackSongData =\n    (event: string) =>\n    ({ artist, title }: Song | SongPreview, setup: SingSetup, scores: Array<{ name: string; score: number }> = []) => {\n        const inputs = {\n            input0: InputManager.getInputs()[0].inputSource,\n            input1: InputManager.getInputs()[1].inputSource,\n        };\n        posthog.capture(event, {\n            name: `${artist} - ${title}`,\n            artist,\n            title,\n            mode: setup.mode,\n            tolerance: setup.tolerance,\n            players: setup.players.length,\n            ...inputs,\n            ...scores.reduce((curr, score, index) => ({ ...curr, [`score${index}`]: score.score }), {}),\n        });\n    };\n\nevents.songStarted.subscribe(trackSongData('songStarted'));\nevents.songEnded.subscribe(trackSongData('songEnded'));\n","export const blueFillBase = '0, 153, 255';\nexport const blueFill = (a = 1) => `rgba(${blueFillBase}, ${a})`;\nexport const blueStroke = (a = 1) => `rgba(0, 77, 128, ${a})`;\nexport const redFillBase = '255, 54, 54';\nexport const redFill = (a = 1) => `rgba(${redFillBase}, ${a})`;\nexport const redStroke = (a = 1) => `rgba(117, 25, 25, ${a})`;\n\nconst playerColors = [\n    {\n        text: blueFillBase,\n        star: {\n            fill: 'rgba(255, 183, 0, .5)',\n            stroke: 'rgba(255, 183, 0, 0)',\n            lineWidth: 1,\n        },\n        perfect: {\n            fill: blueFill(1),\n            stroke: 'white',\n            lineWidth: 1,\n        },\n        starPerfect: {\n            fill: 'rgba(255, 213, 0, 1)',\n            stroke: 'rgba(255, 183, 0, 1)',\n            lineWidth: 2,\n        },\n        hit: {\n            fill: blueFill(0.9),\n            stroke: blueStroke(0),\n            lineWidth: 1,\n        },\n        miss: {\n            fill: blueFill(0.25),\n            stroke: blueStroke(1),\n            lineWidth: 1,\n        },\n    },\n    {\n        text: redFillBase,\n        star: {\n            fill: 'rgba(255, 183, 0, .5)',\n            stroke: 'rgba(255, 183, 0, 0)',\n            lineWidth: 1,\n        },\n        perfect: {\n            fill: redFill(1),\n            stroke: 'white',\n            lineWidth: 1,\n        },\n        starPerfect: {\n            fill: 'rgba(255, 213, 0, 1)',\n            stroke: 'rgba(255, 183, 0, 1)',\n            lineWidth: 2,\n        },\n        hit: {\n            fill: redFill(0.9),\n            stroke: redStroke(0),\n            lineWidth: 1,\n        },\n        miss: {\n            fill: redFill(0.25),\n            stroke: redStroke(1),\n            lineWidth: 1,\n        },\n    },\n];\n\nconst styles = {\n    colors: {\n        players: playerColors,\n        lines: {\n            normal: {\n                fill: 'rgba(127, 127, 127, .7)',\n                stroke: 'black',\n                lineWidth: 1,\n            },\n            star: {\n                fill: 'rgba(158, 144, 106, 1)',\n                stroke: 'rgba(255, 183, 0, 1)',\n                lineWidth: 1,\n            },\n            freestyle: {\n                fill: 'rgba(255, 255, 255, 0.1)',\n                stroke: 'black',\n                lineWidth: 2,\n            },\n        },\n        text: {\n            active: 'orange',\n            activeBorder: 'rgb(101,75,22)',\n            default: 'white',\n            inactive: 'grey',\n        },\n    },\n};\n\nexport default styles;\n","import { css, keyframes } from '@emotion/react';\nimport styles from '../Scenes/Game/Singing/GameOverlay/Drawing/styles';\n\nexport const focusable = (props: { focused?: boolean }) => css`\n    ${!!props.focused && focused};\n\n    :hover {\n        ${focused};\n    }\n`;\n\nconst focusAnimation = keyframes`\n  100% {\n    box-shadow: inset 0px 0px 0px 2px ${styles.colors.text.active};\n  }\n  50% {\n    box-shadow: inset 0px 0px 0px 4px ${styles.colors.text.active};\n  }\n  0% {\n    box-shadow: inset 0px 0px 0px 2px ${styles.colors.text.active};\n  }\n`;\n\nexport const focused = css`\n    animation: ${focusAnimation} 1000ms ease-in-out infinite both;\n`;\n\nexport const typography = css`\n    font-weight: bold;\n    -webkit-text-stroke: thin black;\n    color: white;\n`;\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport { ComponentType } from 'react';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport createPersistedState from 'use-persisted-state';\nimport { HelpEntry } from './Context';\n\ninterface Props {\n    help: HelpEntry | undefined;\n}\n\nconst useIsVisible = createPersistedState('keyboard-help-visibility');\n\nexport default function KeyboardHelpView({ help }: Props) {\n    const [isVisible, setIsVisible] = useIsVisible(true);\n\n    useHotkeys('h', () => setIsVisible(!isVisible), undefined, [isVisible]);\n\n    const helps = Object.entries(help ?? {}).filter(([, value]) => value !== undefined);\n    return (\n        <>\n            {isVisible && !!helps.length && (\n                <Container data-test=\"help-container\">\n                    {helps.map(([type, label]) => {\n                        const { view: Component, defaultLabel } = KeyhelpComponent[type as keyof HelpEntry];\n                        return (\n                            <Section key={type}>\n                                <SectionHelp>{label ?? defaultLabel}</SectionHelp>\n                                <SectionKeys>\n                                    <Component />\n                                </SectionKeys>\n                            </Section>\n                        );\n                    })}\n                    <Section>\n                        <SectionHelp>Show/hide this help</SectionHelp>\n                        <SectionKeys>\n                            <Kbd>H</Kbd>\n                        </SectionKeys>\n                    </Section>\n                </Container>\n            )}\n        </>\n    );\n}\n\nconst HorizontalVerticalBase = ({ vertical = false, horizontal = false }) => (\n    <>\n        <Kbd disabled={!vertical}>â†‘</Kbd>\n        <br />\n        <Kbd disabled={!horizontal}>â†</Kbd>\n        <Kbd disabled={!vertical}>â†“</Kbd>\n        <Kbd disabled={!horizontal}>â†’</Kbd>\n    </>\n);\n\nconst Horizontal = () => <HorizontalVerticalBase horizontal />;\nconst Vertical = () => <HorizontalVerticalBase vertical />;\nconst HorizontalVertical = () => <HorizontalVerticalBase vertical horizontal />;\nconst Accept = () => <Kbd>Enter âŽ</Kbd>;\nconst Back = () => <Kbd>Backspace âŒ«</Kbd>;\nconst ShiftLetter = (letter: string) => () =>\n    (\n        <>\n            <Kbd>Shift</Kbd> + <Kbd>{letter.toUpperCase()}</Kbd>\n        </>\n    );\n\nconst KeyhelpComponent: Record<keyof HelpEntry, { view: ComponentType; defaultLabel: string }> = {\n    'horizontal-vertical': { view: HorizontalVertical, defaultLabel: 'Navigate' },\n    horizontal: { view: Horizontal, defaultLabel: 'Navigate' },\n    vertical: { view: Vertical, defaultLabel: 'Navigate' },\n    accept: { view: Accept, defaultLabel: 'Select' },\n    back: { view: Back, defaultLabel: 'Go back' },\n    shiftR: { view: ShiftLetter('r'), defaultLabel: 'Pick random' },\n};\n\nconst Section = styled.div`\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 1rem;\n`;\n\nconst SectionKeys = styled.div`\n    flex-wrap: nowrap;\n    text-align: center;\n    flex: 2;\n    color: white;\n    font-weight: bold;\n`;\nconst SectionHelp = styled.span`\n    flex: 3;\n    ${typography};\n    font-size: 2rem;\n    text-align: right;\n`;\n\nconst Container = styled.div`\n    position: fixed;\n    top: 10rem;\n    right: 5.5rem;\n    padding: 0.5rem;\n    background: rgba(0, 0, 0, 0.5);\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    width: 34rem;\n\n    z-index: 10000;\n\n    @media (max-width: 560px) {\n        display: none;\n    }\n`;\n\nconst Kbd = styled.kbd<{ disabled?: boolean }>`\n    margin: 0.2rem;\n    padding: 0.12rem 0.9rem;\n    border-radius: 0.3rem;\n    border: 0.1rem solid rgb(204, 204, 204);\n    color: rgb(51, 51, 51);\n    line-height: 1.4;\n    font-size: 1.6rem;\n    display: inline-block;\n    box-shadow: 0 0.1rem 0 rgba(0, 0, 0, 0.2), inset 0 0 0 0.2rem #ffffff;\n    background-color: rgb(247, 247, 247);\n    text-shadow: 0 0.1rem 0 #fff;\n    font-weight: normal;\n\n    opacity: ${(props) => (props.disabled ? 0.25 : 1)};\n`;\n","import { useEffect, useMemo, useState } from 'react';\nimport { GameEvent } from 'GameEvents/GameEvents';\n\nexport function useEventListener<T extends (...args: any[]) => void>(event: GameEvent<T>) {\n    const [value, setValue] = useState<Parameters<T> | null>(null);\n\n    useEffect(() => {\n        const subscriber = ((...args: Parameters<T>) => {\n            setValue(args);\n        }) as T;\n        event.subscribe(subscriber);\n        return () => event.unsubscribe(subscriber);\n    }, [event]);\n\n    return value;\n}\n\nexport function useEventEffect<T extends (...args: any[]) => void>(event: GameEvent<T> | GameEvent<T>[], effect: T) {\n    const eventList = Array.isArray(event) ? event : [event];\n\n    useEffect(() => {\n        eventList.forEach((e) => e.subscribe(effect));\n\n        return () => eventList.forEach((e) => e.unsubscribe(effect));\n    }, [...eventList, effect]);\n}\n\nexport function useEventListenerSelector<S extends any>(event: GameEvent<any> | GameEvent<any>[], selector: () => S) {\n    const initialValueRef = useMemo(selector, []);\n    const [value, setValue] = useState<S>(initialValueRef);\n\n    const eventList = Array.isArray(event) ? event : [event];\n\n    useEffect(() => {\n        const subscriber = () => setValue(selector());\n        eventList.forEach((e) => e.subscribe(subscriber));\n\n        return () => eventList.forEach((e) => e.unsubscribe(subscriber));\n    }, eventList);\n\n    return value;\n}\n","import { omit } from 'lodash-es';\nimport { createContext, FunctionComponent, PropsWithChildren, useEffect, useState } from 'react';\nimport KeyboardHelpView from './HelpView';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport { useEventEffect } from 'GameEvents/hooks';\nimport events from 'GameEvents/GameEvents';\n\ntype keys = 'horizontal' | 'vertical' | 'horizontal-vertical' | 'accept' | 'back' | 'shiftR';\n\nexport type HelpEntry = Partial<Record<keys, string | null>>;\n\nexport const KeyboardHelpContext = createContext({\n    setKeyboard: (name: string, helpEntry: HelpEntry): void => {},\n    unsetKeyboard: (name: string): void => {},\n});\n\ntype KeyboardsList = Record<string, HelpEntry>;\n\nexport const KeyboardHelpProvider: FunctionComponent<PropsWithChildren> = ({ children }) => {\n    const [keyboards, setKeyboards] = useState<KeyboardsList>({});\n\n    const setKeyboard = (name: string, helpEntry: HelpEntry) => {\n        setKeyboards((kbs) => ({\n            ...kbs,\n            [name]: helpEntry,\n        }));\n    };\n\n    const unsetKeyboard = (name: string) => setKeyboards((kbs) => omit(kbs, [name]));\n\n    const [name, help] = Object.entries(keyboards).at(-1) ?? [];\n\n    useEventEffect(events.remoteMicConnected, ({ id }) => {\n        RemoteMicManager.getRemoteMicById(id)?.connection.send({\n            t: 'keyboard-layout',\n            help,\n        });\n    });\n\n    useEffect(() => {\n        RemoteMicManager.broadcast({\n            t: 'keyboard-layout',\n            help,\n        });\n    }, [name]);\n\n    return (\n        <KeyboardHelpContext.Provider value={{ setKeyboard, unsetKeyboard }}>\n            {children}\n            <KeyboardHelpView help={help} />\n        </KeyboardHelpContext.Provider>\n    );\n};\n","import { css } from '@emotion/react';\nimport styled from '@emotion/styled';\nimport { focused, typography } from 'Elements/cssMixins';\nimport styles from '../Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport isE2E from 'utils/isE2E';\n\nexport const Button = styled.button<{ focused?: boolean }>`\n    padding: 0.1rem 0.3rem;\n    font-size: 2.6rem;\n    display: block;\n    text-align: center;\n    cursor: pointer;\n    border: 0;\n\n    background-color: rgba(0, 0, 0, 0.75);\n    text-transform: uppercase;\n    letter-spacing: 0.2rem;\n\n    ${typography};\n\n    pointer-events: auto;\n    ${(props) => props.focused && buttonFocused};\n    box-sizing: border-box;\n\n    transition: 300ms;\n\n    :hover {\n        ${focused};\n    }\n`;\n// Disable for E2E as they wait for animation to finish (and since it's infinite they timeout)\nconst buttonFocusedAnimation = isE2E()\n    ? css``\n    : css`\n          @keyframes button-focus-loop {\n              0%,\n              100% {\n                  transform: scale(1.045);\n              }\n              50% {\n                  transform: scale(1.055);\n              }\n          }\n          animation: button-focus-loop 600ms ease-in-out infinite both;\n      `;\n\nexport const buttonFocused = css`\n    transform: scale(1.05);\n    background: ${styles.colors.text.active};\n\n    ${buttonFocusedAnimation};\n`;\n","import styled from '@emotion/styled';\nimport { Button } from './Button';\n\nexport const MenuButton = styled(Button)<{ focused?: boolean }>`\n    margin: 0.5rem 0;\n    height: 10rem;\n    border: 0 solid black;\n\n    :disabled {\n        cursor: default;\n        color: #989898;\n        background-color: #212121;\n        border-width: 0.3rem;\n    }\n`;\n\nexport const MenuContainer = styled.div`\n    background: rgba(0, 0, 0, 0.5);\n    padding: 1.5rem;\n    width: 100vw;\n    box-sizing: border-box;\n    max-width: 75rem;\n    margin: 2rem auto 0 auto;\n    font-size: 2.6rem;\n    display: flex;\n    flex-direction: column;\n    gap: 2rem;\n\n    view-transition-name: menu-container;\n`;\n","import { SongPreview } from 'interfaces';\nimport { useEffect, useState } from 'react';\nimport { useEventEffect } from 'GameEvents/hooks';\nimport { fetchSongStats, getSongKey, SongStats, storeSongStats } from 'Songs/stats/common';\nimport events from 'GameEvents/GameEvents';\n\nexport const useSongStats = (song: Pick<SongPreview, 'artist' | 'title'>) => {\n    const [stats, setStats] = useState<SongStats | null>(null);\n\n    const storageKey = getSongKey(song);\n\n    const setSongStats = async () => {\n        setStats(await fetchSongStats(song));\n    };\n\n    useEffect(() => {\n        setSongStats();\n    }, [storageKey]);\n\n    useEventEffect(events.songStatStored, setSongStats);\n\n    return stats;\n};\n\nexport const useEditScore = (song: Pick<SongPreview, 'artist' | 'title'>) => {\n    return async (singId: string, score: number, oldName: string, newName: string) => {\n        const storageKey = getSongKey(song);\n        const data = await fetchSongStats(song);\n\n        const newScores = data.scores.map((record) => {\n            if (record.setup.id !== singId) return record;\n\n            const newScores = record.scores.map((previousScore) => {\n                if (previousScore.name !== oldName || previousScore.score !== score) return previousScore;\n\n                return { name: newName.trim(), score };\n            });\n\n            return { ...record, scores: newScores };\n        });\n\n        const newData = { ...data, scores: newScores };\n\n        await storeSongStats(song, newData);\n        events.songScoreUpdated.dispatch(storageKey, newData, newName.trim());\n    };\n};\n","import styled from '@emotion/styled';\nimport { addDays, isAfter } from 'date-fns';\nimport { typography } from 'Elements/cssMixins';\nimport { SongPreview } from 'interfaces';\nimport { useSongStats } from 'Songs/stats/hooks';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\n\nexport const SongCardContainer = styled.div`\n    font-size: 4.5rem;\n\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    flex-direction: column;\n    box-sizing: border-box;\n`;\n\nexport const SongCardBackground = styled.div<{ video: string; focused: boolean }>`\n    position: absolute;\n    z-index: -1;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-position: center center;\n    // background-size: ${(props) => (props.focused ? 150.5 : 180)}%;\n    background-size: ${(props) => (props.focused ? 100 : 110)}%;\n    ${(props) => (props.focused ? '' : 'filter: grayscale(90%);')}\n\n    opacity: ${(props) => (props.focused ? 1 : 0.8)};\n\n    border-radius: 0.5rem;\n    transition: 300ms;\n`;\n\nexport const SongCard = styled(SongCardContainer)`\n    cursor: pointer;\n`;\n\nexport const SongListEntryDetails = styled.span<{ active?: boolean }>`\n    background: rgba(0, 0, 0, 0.7);\n\n    width: auto;\n    display: inline-block;\n    padding: 0.5rem;\n    ${typography};\n\n    text-align: right;\n    font-size: ${({ active }) => (active ? '6rem' : '2.7rem')};\n`;\n\nexport const SongListEntryDetailsArtist = styled(SongListEntryDetails)`\n    color: ${styles.colors.text.active};\n`;\n\nexport const SongListEntryDetailsTitle = styled(SongListEntryDetails)`\n    margin-top: ${(props) => (props.active ? '1.5rem' : '0.5rem')};\n    color: white;\n`;\n\nexport const SongCardStatsIndicator = ({ song }: { song: SongPreview }) => {\n    const stats = useSongStats(song);\n    const lastPlayed = stats?.scores?.at(-1)?.date ?? false;\n\n    const playedToday = lastPlayed && isAfter(new Date(lastPlayed), addDays(new Date(), -1));\n\n    return stats?.plays ? (\n        <SongStatIndicator data-test=\"song-stat-indicator\">\n            {playedToday ? 'Played today' : stats.plays}\n        </SongStatIndicator>\n    ) : null;\n};\n\nconst SongStatIndicator = styled.div`\n    position: absolute;\n    top: 0.5rem;\n    right: 0.5rem;\n    //min-width: 1rem;\n    padding: 0 1rem;\n    height: 2rem;\n    border-radius: 5rem;\n    color: white;\n    background: rgba(0, 0, 0, 0.75);\n    font-size: 1.4rem;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    text-transform: uppercase;\n`;\n","import styled from '@emotion/styled';\nimport { focusable } from 'Elements/cssMixins';\nimport { ReactNode } from 'react';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { SongListEntryDetails } from 'Scenes/SingASong/SongSelection/SongCard';\nimport { ValuesType } from 'utility-types';\n\ninterface Props {\n    focused: boolean;\n    label: ReactNode;\n    value: ReactNode;\n    onClick?: () => void;\n}\n\nexport function nextIndex<T extends readonly any[]>(values: T, current: number, direction: 1 | -1 = 1): number {\n    return direction === 1 ? (current + 1) % values.length : (current + values.length - 1) % values.length;\n}\nexport function nextValueIndex<T extends readonly any[]>(\n    values: T,\n    current: ValuesType<T>,\n    direction: 1 | -1 = 1,\n): number {\n    return nextIndex(values, values.indexOf(current), direction);\n}\nexport function nextValue<T extends readonly any[]>(\n    values: T,\n    current: ValuesType<T>,\n    direction: 1 | -1 = 1,\n): ValuesType<T> {\n    return values[nextValueIndex(values, current, direction)];\n}\n\nexport const Switcher = ({ focused, label, value, onClick, ...restProps }: Props) => (\n    <ConfigurationPosition focused={focused} onClick={onClick} {...restProps}>\n        <span>{label}:</span> <ConfigValue>{value}</ConfigValue>\n    </ConfigurationPosition>\n);\n\nconst ConfigurationPosition = styled(SongListEntryDetails)<{ focused: boolean }>`\n    cursor: pointer;\n    padding: 0.65rem;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n\n    ${focusable}\n`;\n\nconst ConfigValue = styled.span`\n    color: ${styles.colors.text.active};\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n    padding-left: 1rem;\n`;\n","import { invert } from 'lodash-es';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport { useEventEffect } from 'GameEvents/hooks';\nimport events from 'GameEvents/GameEvents';\nimport { keyStrokes } from 'RemoteMic/Network/events';\n\ntype Callback = (e?: KeyboardEvent) => void;\n\n// All besides F and H characters\nexport const REGULAR_ALPHA_CHARS = 'a,b,c,d,e,f,g,i,j,k,l,m,n,o,p,r,s,t,u,w,x,y,z';\n\ninterface Params {\n    onUpArrow?: Callback;\n    onDownArrow?: Callback;\n    onLeftArrow?: Callback;\n    onRightArrow?: Callback;\n    onEnter?: Callback;\n    onBackspace?: Callback;\n    onR?: Callback;\n    // onAlphaNumeric?: () => void,\n}\n\nconst paramsToKeys: { [param in keyof Params]: keyStrokes } = {\n    onUpArrow: 'up',\n    onDownArrow: 'down',\n    onLeftArrow: 'left',\n    onRightArrow: 'right',\n    onEnter: 'Enter',\n    onBackspace: 'Backspace',\n    onR: 'Shift+R',\n};\n\nconst keysToParams: { [key: string]: keyof Params } = invert(paramsToKeys) as any;\n\nexport default function useKeyboard(params: Params, enabled = true, deps?: any[]) {\n    let handledKeys: string = Object.keys(params)\n        .map((param) => paramsToKeys[param as keyof Params])\n        .join(',');\n\n    useEventEffect(events.remoteKeyboardPressed, (key) => {\n        if (enabled) {\n            const param = keysToParams[key];\n\n            if (!param) return;\n\n            if (param in params) {\n                params[param]?.();\n            }\n        }\n    });\n\n    useHotkeys(\n        handledKeys,\n        (event, hkEvent) => {\n            const param = keysToParams[hkEvent.key];\n\n            if (!param) return;\n\n            if (param in params) {\n                event.preventDefault();\n                event.stopPropagation();\n                params[param]?.(event);\n            }\n        },\n        { enabled },\n        deps,\n    );\n}\n","export default \"__VITE_ASSET__1483804b__\"","export default \"__VITE_ASSET__c276addd__\"","export default \"__VITE_ASSET__c41709e6__\"","export default \"__VITE_ASSET__ba17dbac__\"","export default \"__VITE_ASSET__4b5d4e94__\"","import { Howl } from 'howler';\n\nimport menuBackSound from 'assets/menu_back.wav';\nimport menuEnterSound from 'assets/menu_enter.wav';\nimport menuNavigateSound from 'assets/menu_navigate.wav';\nimport waitFinishedSound from 'assets/376817__original_sound__impact-cinematic.wav';\nimport backgroundMusicSound from 'assets/Funk Cool Groove (No Copyright Music) By Anwar Amr.mp3';\n\nconst menuNavigate = new Howl({\n    src: menuNavigateSound,\n});\n\nconst menuEnter = new Howl({\n    src: menuEnterSound,\n});\n\nconst menuBack = new Howl({\n    src: menuBackSound,\n});\n\nconst waitFinished = new Howl({\n    src: waitFinishedSound,\n    preload: true,\n});\n\nconst backgroundMusic = new Howl({\n    src: backgroundMusicSound,\n    volume: 0.3,\n    loop: true,\n});\n\nexport { menuNavigate, menuEnter, menuBack, waitFinished, backgroundMusic };\n","import { useContext, useEffect, useRef } from 'react';\nimport { HelpEntry, KeyboardHelpContext } from 'Scenes/KeyboardHelp/Context';\n\nlet id = 0;\n\nexport default function useKeyboardHelp(help: HelpEntry, enabled: boolean) {\n    const name = useRef(`${String(Math.random())}-${id++}`);\n    const { setKeyboard, unsetKeyboard } = useContext(KeyboardHelpContext);\n\n    const setHelp = (help: HelpEntry) => {\n        setKeyboard(name.current, help);\n    };\n\n    const clearHelp = () => unsetKeyboard(name.current);\n\n    useEffect(() => {\n        if (enabled) {\n            setHelp(help);\n        }\n\n        return clearHelp;\n    }, [help, enabled]);\n\n    return { setHelp, clearHelp };\n}\n","import useKeyboard from 'hooks/useKeyboard';\nimport { useEffect, useMemo, useRef, useState } from 'react';\nimport { HelpEntry } from 'Scenes/KeyboardHelp/Context';\nimport { menuBack, menuEnter, menuNavigate } from 'SoundManager';\nimport useKeyboardHelp from './useKeyboardHelp';\n\n/**\n * todo: Bug: for some reason elementList is duplicated eg.\n * ['a', 'b', 'c', 'a', 'b', 'c']\n *\n * But still works even with dynamic elements :shrugs:\n */\ninterface Options {\n    enabled?: boolean;\n    onBackspace?: () => void;\n    backspaceHelp?: string | null;\n    direction?: 'horizontal' | 'vertical';\n    additionalHelp?: HelpEntry;\n}\n\ninterface KeyboardAction {\n    callback: () => void;\n    label?: string;\n    propName: string;\n}\n\nexport default function useKeyboardNav(options: Options = {}, debug = false) {\n    const { enabled = true, onBackspace, backspaceHelp = null, direction = 'vertical', additionalHelp = {} } = options;\n\n    const [currentlySelected, setCurrentlySelected] = useState<string | null>(null);\n    const elementList = useRef<string[]>([]);\n    const newElementList = useRef<string[]>([]);\n    const actions = useRef<Record<string, KeyboardAction>>({});\n\n    const currentlySelectedActionLabel = actions.current[currentlySelected!]?.label;\n    const help = useMemo(\n        () => ({\n            [direction]: null,\n            accept: currentlySelectedActionLabel ?? null,\n            back: onBackspace ? backspaceHelp : undefined,\n            ...additionalHelp,\n        }),\n        [currentlySelectedActionLabel, actions, backspaceHelp, direction],\n    );\n    useKeyboardHelp(help, enabled);\n\n    const handleEnter = () => {\n        actions.current[currentlySelected!]?.callback();\n        menuEnter.play();\n    };\n\n    const handleBackspace = () => {\n        if (onBackspace) {\n            menuBack.play();\n            onBackspace();\n        }\n    };\n\n    const handleNavigation = (direction: -1 | 1) => {\n        const currentIndex = currentlySelected ? elementList.current.indexOf(currentlySelected) : 0;\n        menuNavigate.play();\n\n        setCurrentlySelected(elementList.current.at((currentIndex + direction) % elementList.current.length) ?? null);\n    };\n\n    useKeyboard(\n        {\n            [direction === 'vertical' ? 'onUpArrow' : 'onLeftArrow']: () => handleNavigation(-1),\n            [direction === 'vertical' ? 'onDownArrow' : 'onRightArrow']: () => handleNavigation(1),\n            onEnter: handleEnter,\n            onBackspace: handleBackspace,\n        },\n        enabled,\n        [currentlySelected, elementList.current],\n    );\n\n    let defaultSelection = '';\n\n    const register = (\n        name: string,\n        onActive: () => void,\n        help?: string,\n        isDefault = false,\n        { propName = 'onClick' } = {},\n    ) => {\n        newElementList.current.push(name);\n        if (onActive) actions.current[name] = { callback: onActive, label: help, propName };\n\n        if (isDefault) {\n            defaultSelection = name;\n        }\n\n        const focused = enabled && currentlySelected === name;\n\n        return {\n            focused,\n            [propName]: onActive,\n            keyboardNavigationChangeFocus: handleNavigation,\n            ...(enabled ? { 'data-focused': focused } : {}),\n        };\n    };\n\n    useEffect(() => {\n        let newElements = newElementList.current.filter((e) => !elementList.current.includes(e));\n        debug && newElements.length && console.log('new elements', newElements);\n        elementList.current = [...newElementList.current];\n        newElementList.current.length = 0;\n\n        if (!elementList.current.length) return;\n        if (\n            currentlySelected === null ||\n            elementList.current.indexOf(currentlySelected) === -1 ||\n            newElements.includes(defaultSelection)\n        ) {\n            setCurrentlySelected(defaultSelection || elementList.current[0]);\n        }\n    });\n\n    const focusElement = (name: string) => {\n        if (elementList.current.includes(name)) setCurrentlySelected(name);\n    };\n\n    return {\n        focusElement,\n        focused: currentlySelected,\n        register,\n    };\n}\n","import { useEffect, useState } from 'react';\nimport { ValuesType } from 'utility-types';\n\nclass Setting<T> {\n    private value: T | undefined = undefined;\n\n    private listeners: Array<(newValue: T) => void> = [];\n    public constructor(\n        private name: string,\n        private defaultValue: T,\n        private driver: 'localStorage' | 'sessionStorage' = 'localStorage',\n    ) {}\n\n    public get = (): T => {\n        if (this.value === undefined) {\n            this.value = JSON.parse(window[this.driver].getItem(`settings-${this.name}`)!) ?? this.defaultValue;\n        }\n        return this.value as T;\n    };\n\n    public set = (newValue: T) => {\n        this.value = newValue;\n\n        window[this.driver].setItem(`settings-${this.name}`, JSON.stringify(newValue));\n        this.listeners.forEach((listener) => listener(newValue));\n    };\n\n    public addListener = (newListener: (newValue: T) => void) => {\n        this.listeners.push(newListener);\n\n        return () => {\n            this.listeners = this.listeners.filter((listener) => listener !== newListener);\n        };\n    };\n}\n\nexport const GraphicsLevel = ['high', 'low'] as const;\nconst GRAPHICS_LEVEL_KEY = 'graphics-level';\nexport const GraphicSetting = new Setting<ValuesType<typeof GraphicsLevel>>(GRAPHICS_LEVEL_KEY, GraphicsLevel[0]);\n\nexport const MicSetupPreference = [null, 'skip', 'remoteMics', 'mics', 'advanced', 'built-in'] as const;\nconst MIC_SETUP_PREFERENCE_KEY = 'mic-setup-preference';\nexport const MicSetupPreferenceSetting = new Setting<ValuesType<typeof MicSetupPreference>>(\n    MIC_SETUP_PREFERENCE_KEY,\n    MicSetupPreference[0],\n    'sessionStorage',\n);\n\nexport const FpsCount = [60, 30] as const;\nconst FPS_COUNT_KEY = 'fps-count';\nexport const FPSCountSetting = new Setting<ValuesType<typeof FpsCount>>(FPS_COUNT_KEY, FpsCount[0]);\n\nconst EXCLUDED_LANGUAGES_KEY = 'EXCLUDED_LANGUAGES_KEY';\nexport const ExcludedLanguagesSetting = new Setting<string[] | null>(EXCLUDED_LANGUAGES_KEY, null);\n\nexport function useSettingValue<T>(value: Setting<T>) {\n    const [currentValue, setCurrentValue] = useState(value.get());\n\n    useEffect(() => {\n        return value.addListener(setCurrentValue);\n    }, [value]);\n\n    return [currentValue, value.set] as const;\n}\n","export default function startViewTransition(callback: () => void) {\n    // @ts-expect-error\n    if (!document.startViewTransition) {\n        callback();\n    } else {\n        // @ts-expect-error\n        document.startViewTransition(callback);\n    }\n}\n","import { useLocation } from 'wouter';\nimport startViewTransition from 'utils/startViewTransition';\n\ninterface Options {\n    replace?: boolean;\n    smooth?: boolean;\n}\n\nexport default function useSmoothNavigate() {\n    const [, baseNavigate] = useLocation();\n\n    return (to: string, { smooth = true, ...options }: Options = {}) => {\n        if (!smooth) {\n            baseNavigate(to, options);\n        } else {\n            startViewTransition(() => baseNavigate(to, options));\n        }\n    };\n}\n","// https://tholman.com/github-corners/\nimport styled from '@emotion/styled';\n\nexport default function GithubRibbon() {\n    return (\n        <>\n            <Ribbon\n                href=\"https://github.com/Asvarox/allkaraoke\"\n                aria-label=\"View source on GitHub\"\n                target=\"_blank\"\n                rel=\"noreferrer\">\n                <svg\n                    width=\"80\"\n                    height=\"80\"\n                    viewBox=\"0 0 250 250\"\n                    style={{\n                        fill: '#151513',\n                        color: '#fff',\n                        position: 'absolute',\n                        top: 0,\n                        border: 0,\n                        left: 0,\n                        transform: 'scale(-1, 1)',\n                    }}\n                    aria-hidden=\"true\">\n                    <path d=\"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z\"></path>\n                    <path\n                        d=\"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2\"\n                        fill=\"currentColor\"\n                        style={{ transformOrigin: '13rem 10.6rem' }}\n                        className=\"octo-arm\"></path>\n                    <path\n                        d=\"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z\"\n                        fill=\"currentColor\"\n                        className=\"octo-body\"></path>\n                </svg>\n            </Ribbon>\n        </>\n    );\n}\n\nconst Ribbon = styled.a`\n    &:hover .octo-arm {\n        animation: octocat-wave 560ms ease-in-out;\n    }\n    @keyframes octocat-wave {\n        0 %,\n        100% {\n            transform: rotate(0);\n        }\n        20%,\n        60% {\n            transform: rotate(-25deg);\n        }\n        40%,\n        80% {\n            transform: rotate(10deg);\n        }\n    }\n    @media (max-width: 500px) {\n        &:hover .octo-arm {\n            animation: none;\n        }\n        .octo-arm {\n            animation: octocat-wave 560ms ease-in-out;\n        }\n    }\n`;\n","export default \"__VITE_ASSET__a63f4704__\"","export default \"__VITE_ASSET__898ca0f7__\"","export default \"data:image/gif;base64,R0lGODlhiQAzAOflAAABAAYAAAACAAcAAAkBAAoDAQsEAxAFABEHABIIABMKABgJAhQLAhsLABwNACANAR0OACEOAyMPACMQACcPACgQASgRAioSACsTACwTACwUAC8WAC4WAzAWADQVADUXATYYAjgYADkZADoaADobAD8aAzscAUEbAD4dAEMdAEUeAkAgAEYfAEUfA0ghAE4hAksjAU8iAFEjAFIkAFMlAFQmAVsmAFcoAFwnAF0oAF8qAmEqAGIrAGMsAGksAWUuAGotAmAwDWwuAGsuA20vAF0zDm4wAG8xAHEyAHIzAXgyAHM0AnU1AHo0AHY2AHw1AH43AIA5AoE6AIM7AIQ8AIk7AIU9AIs8AIc+AIw9AI0+AY4+ApFAAJJBAJNCAJRDAJpCAZVEAJtDAp1EAJxEA55FAKBHAKFIAKJJAKhIAaRKAKVLAKtKAKxLAI5RI5BRJK9NALBOALFPALJQALNRALlQBLtRALxSAL1TAL9UAMFWAMJXAMRYArlbCsZZAMVZA8xYAMhaAM9aANFcAdNdAtVfAMpiDddgAN1fANhhAN9hANljAOFiAeNkAOJkA91mAONlBN5nAdhoDeVmAOdoAO5mAOJqB+9nAOlpAPBpAfFqA654SvNrAOduDvRsAPZtAN5yGONxGvduANh0IPFwB/hvAOtxE+B0Gt90I/lwAOxyFPNxCu5zBud0EvRyANt2Is54Ndp2Krt8S+B1JM95L9V4Ked0HeF2G/txAO1zFvRyDOh1E9x3I895NtV4ML19Rsp7NcN8Qbx9TMl7O8J8R9Z5Kq6AW8h7QrZ/ULh/S7V/VsV9O75+R8t8NsR9QqmCYKeCZpqFcLGBVq+BXJGHe4+HgbeAUaOEZqGEbLaAV6CEcauDXKqDYZuGcZmGd42Ih5KIfJCIgpSId4iKh4uKgv///////////////////////////////////////////////////////////////////////////////////////////////////////////yH5BAEIAP8ALAAAAACJADMAAAj+AP8JHEiwoMGDCBMqXMiwocOHECMSHEexosWLGDNq3Mixo8ePIDtKHPhtGK6TKFOqXInrGcuXMGPKnEmzpspU40YKHBdryICfQIMKFVpHFq6hSJOWSMq0qdOnUH8S8PRN579v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\"","import logo from 'Elements/logo.gif';\nimport pride from 'Elements/pride.png';\nimport dotparty from 'Elements/dotparty.gif';\nimport styled from '@emotion/styled';\n\nexport default function Logo(props: any) {\n    return (\n        <Container>\n            {window.location.search.includes('pride') && <PrideLogo src={pride} alt=\"AllKaraoke Pride logo part 1\" />}\n            <StyledLogo src={logo} alt=\"AllKaraoke logo\" {...props} />\n            <DotParty src={dotparty} alt=\"AllKaraoke Pride logo part 2\" />\n        </Container>\n    );\n}\nconst StyledLogo = styled.img`\n    width: 66rem;\n    height: 16.4rem;\n`;\n\nconst Container = styled.div`\n    position: relative;\n    height: 16.4rem;\n    view-transition-name: logo;\n`;\n\nconst PrideLogo = styled(StyledLogo)`\n    position: absolute;\n`;\n\nconst DotParty = styled.img`\n    position: absolute;\n    width: 13.7rem;\n    height: 5.1rem;\n    bottom: -0.5rem;\n    right: -1rem;\n`;\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\n\nfunction RecommendedBrowsers() {\n    return (\n        <>\n            {!window.chrome && (\n                <RecommendChrome>\n                    <h2>\n                        This game is tested in <strong>Google Chrome</strong> and <strong>MS Edge</strong>.\n                    </h2>\n                    It's not guaranteed to work on other browsers (like the one you use now).\n                </RecommendChrome>\n            )}\n        </>\n    );\n}\n\nconst RecommendChrome = styled.div`\n    width: 100%;\n    ${typography};\n    text-align: center;\n    background: darkred;\n    padding: 3rem 0;\n    margin-top: 1rem;\n    h2 {\n        margin-top: 0;\n    }\n\n    strong {\n        color: ${styles.colors.text.active};\n    }\n`;\n\nexport default RecommendedBrowsers;\n","import styled from '@emotion/styled';\nimport React, { createContext, useCallback, useContext, useEffect, useState } from 'react';\nimport { blueFill, blueStroke, redStroke } from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\n\nexport const BackgroundContext = createContext({\n    visible: true,\n    setVisibility: (visible: boolean): void => undefined,\n});\n\nexport const useBackground = (shouldBeVisible: boolean) => {\n    const background = useContext(BackgroundContext);\n    useEffect(() => {\n        if (shouldBeVisible !== background.visible) {\n            console.log(shouldBeVisible, background.visible);\n            background.setVisibility(shouldBeVisible);\n        }\n    }, [shouldBeVisible, background.visible, background.setVisibility]);\n};\n\nexport default function LayoutWithBackgroundProvider({ children }: React.PropsWithChildren) {\n    const [visible, setVisible] = useState(true);\n\n    const setVisibility = useCallback(\n        (newValue: boolean) => {\n            setVisible(newValue);\n        },\n        [setVisible],\n    );\n\n    return (\n        <BackgroundContext.Provider value={{ visible, setVisibility }}>\n            {visible && <Background />}\n            {children}\n        </BackgroundContext.Provider>\n    );\n}\n\nconst Background = styled.div`\n    z-index: -1;\n    top: 0;\n    position: fixed;\n    background: white;\n\n    background: linear-gradient(-45deg, ${redStroke()}, ${blueFill()}, ${blueStroke()}, ${redStroke()});\n    background-size: 400% 400%;\n    animation: gradient 15s ease infinite;\n\n    @keyframes gradient {\n        0% {\n            background-position: 0% 50%;\n        }\n        50% {\n            background-position: 100% 50%;\n        }\n        100% {\n            background-position: 0% 50%;\n        }\n    }\n\n    width: 100%;\n    height: 100%;\n`;\n","import styled from '@emotion/styled';\nimport { MenuContainer } from 'Elements/Menu';\nimport GithubRibbon from 'Scenes/Welcome/GithubRibbon';\nimport Logo from 'Elements/Logo';\nimport RecommendedBrowsers from 'Elements/RecommendedBrowsers';\nimport { useBackground } from 'Elements/LayoutWithBackground';\nimport { PropsWithChildren } from 'react';\n\ntype Props = PropsWithChildren<{\n    supportedBrowsers?: boolean;\n}>;\nfunction MenuWithLogo({ children, supportedBrowsers }: Props) {\n    useBackground(true);\n\n    return (\n        <>\n            <GithubRibbon />\n            <Container>\n                <Logo />\n                {supportedBrowsers && <RecommendedBrowsers />}\n                <MenuContainer>{children}</MenuContainer>\n            </Container>\n        </>\n    );\n}\n\nconst Container = styled.div`\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n`;\n\nexport default MenuWithLogo;\n","import { MenuButton } from 'Elements/Menu';\nimport { nextValue, Switcher } from 'Elements/Switcher';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport {\n    FpsCount,\n    FPSCountSetting,\n    GraphicSetting,\n    GraphicsLevel,\n    useSettingValue,\n} from 'Scenes/Settings/SettingsState';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport MenuWithLogo from 'Elements/MenuWithLogo';\n\ninterface Props {}\n\nfunction Settings(props: Props) {\n    const navigate = useSmoothNavigate();\n    const goBack = () => navigate('/');\n\n    const { register } = useKeyboardNav({ onBackspace: goBack });\n\n    const [graphicLevel, setGraphicLevel] = useSettingValue(GraphicSetting);\n    const [fpsCount, setFpsCount] = useSettingValue(FPSCountSetting);\n\n    return (\n        <MenuWithLogo>\n            <h1>Settings</h1>\n            <h2>Graphics</h2>\n            <Switcher\n                {...register('graphics', () => setGraphicLevel(nextValue(GraphicsLevel, graphicLevel)))}\n                label=\"Graphics\"\n                value={graphicLevel.toUpperCase()}\n                data-test=\"graphics-level\"\n            />\n            <Switcher\n                {...register('fpsCount', () => setFpsCount(nextValue(FpsCount, fpsCount)))}\n                label=\"FPS Count\"\n                value={fpsCount}\n                data-test=\"fps-count-level\"\n            />\n            <MenuButton {...register('go back', goBack)} data-test=\"back-button\">\n                Return To Main Menu\n            </MenuButton>\n        </MenuWithLogo>\n    );\n}\n\nexport default Settings;\n","import { ExtractOptional, NotesSection, Section, Song } from 'interfaces';\n\nexport const typesMap = {\n    R: 'rap',\n    F: 'freestyle',\n    '*': 'star',\n    ':': 'normal',\n} as const;\n\nexport type SongTXTKeys =\n    | 'TRACKNAMES'\n    | 'YEAR'\n    | 'LASTUPDATE'\n    | 'EDITION'\n    | 'GENRE'\n    | 'LANGUAGE'\n    | 'VIDEOGAP'\n    | 'REALBPM'\n    | 'PREVIEWSTART'\n    | 'PREVIEWEND'\n    | 'VOLUME'\n    | 'CREATOR'\n    | 'CREATORURL'\n    | 'SOURCEURL'\n    | 'TITLE'\n    | 'ARTIST'\n    | 'BPM'\n    | 'GAP'\n    | 'VIDEOID';\n\nfunction getPropertyValueFromTxt(txt: string, key: SongTXTKeys, number?: false): string | undefined;\nfunction getPropertyValueFromTxt(txt: string, key: SongTXTKeys, number?: true): number | undefined;\nfunction getPropertyValueFromTxt(txt: string, key: SongTXTKeys, number = false) {\n    const regex = new RegExp(`#${key}\\\\:(.*)`);\n\n    const value = txt.match(regex)?.[1];\n    if (value === undefined) return undefined;\n    return number ? Number(value.replace(',', '.')) ?? 0 : value;\n}\n\nconst LINE_BREAK_RELATIVE_REGEXP = /- -?\\d+ -?\\d+/;\n\nexport function getVideoId(url: string) {\n    try {\n        const linkUrl = new URL(url);\n        return linkUrl.searchParams.get('v') || false;\n    } catch (e: any) {\n        return false;\n    }\n}\nfunction safeJsonParse<T extends any, DV extends any = T>(str: any, defaultValue: DV): T | DV {\n    try {\n        return JSON.parse(str);\n    } catch (e) {\n        return defaultValue;\n    }\n}\n\nexport default function convertTxtToSong(\n    text: string,\n    videoLink?: string,\n    author?: string,\n    authorUrl?: string,\n    sourceUrl?: string,\n): Song {\n    const trackNames: string[] = safeJsonParse<string[]>(getPropertyValueFromTxt(text, 'TRACKNAMES'), []);\n\n    const additionalData = {\n        year: getPropertyValueFromTxt(text, 'YEAR'),\n        lastUpdate: getPropertyValueFromTxt(text, 'LASTUPDATE'),\n        edition: getPropertyValueFromTxt(text, 'EDITION'),\n        genre: getPropertyValueFromTxt(text, 'GENRE'),\n        language: getPropertyValueFromTxt(text, 'LANGUAGE'),\n        videoGap: getPropertyValueFromTxt(text, 'VIDEOGAP', true),\n        realBpm: getPropertyValueFromTxt(text, 'REALBPM', true),\n        previewStart: getPropertyValueFromTxt(text, 'PREVIEWSTART', true),\n        previewEnd: getPropertyValueFromTxt(text, 'PREVIEWEND', true),\n        volume: getPropertyValueFromTxt(text, 'VOLUME', true),\n        author: getPropertyValueFromTxt(text, 'CREATOR') ?? author,\n        authorUrl: getPropertyValueFromTxt(text, 'CREATORURL') ?? authorUrl,\n        sourceUrl: getPropertyValueFromTxt(text, 'SOURCEURL') ?? sourceUrl,\n        // todo upgrade eslint and use `satisfies` instead of `as`\n    } as ExtractOptional<Song>;\n\n    if (additionalData.videoGap) additionalData.videoGap = Math.floor(additionalData.videoGap);\n\n    const song: Song = {\n        title: getPropertyValueFromTxt(text, 'TITLE') ?? '',\n        artist: getPropertyValueFromTxt(text, 'ARTIST') ?? '',\n        bpm: Number(getPropertyValueFromTxt(text, 'BPM')?.replace(',', '.') ?? 0),\n        bar: 4,\n        gap: Number(getPropertyValueFromTxt(text, 'GAP')?.replace(',', '.') ?? 0),\n        video: getPropertyValueFromTxt(text, 'VIDEOID') ?? '',\n        ...additionalData,\n        tracks: [],\n    };\n\n    if (song.video === '' && videoLink) {\n        try {\n            const linkUrl = new URL(videoLink);\n            song.video = linkUrl.searchParams.get('v') || 'Invalid link';\n        } catch (e: any) {\n            song.video = `Invalid link: ${e.message}`;\n        }\n    }\n\n    let sections: Section[] = [];\n    let lastStart = 0;\n\n    text.split('\\n').forEach((line) => {\n        if (line.startsWith('#')) return;\n        const split = line.split(' ');\n\n        // Sometimes the txts are wrongly formatted and include breaks/notes that just overlap\n        // The assumption here is that tracks should start and end roughly similarly, so if a next\n        // track starts just as the previous ends, it's considered a wrong formatting issue rather\n        // than a new track\n        if (Number(split[1]) < lastStart * 0.75 && sections.length) {\n            // new track (song is a duet)\n            if (trackNames[song.tracks.length]) song.tracks.push({ sections, name: trackNames[song.tracks.length] });\n            else song.tracks.push({ sections });\n            sections = [];\n        }\n\n        if (LINE_BREAK_RELATIVE_REGEXP.test(line)) {\n            // \"Pause\" or relative line break\n            const [, start, end] = split;\n            sections.push({ start: Number(start), end: Number(end), type: 'pause' });\n            sections.push({ start: Number(end), type: 'notes', notes: [] });\n\n            lastStart = Number(end);\n        } else if (line.startsWith('-')) {\n            // new section\n            sections.push({ start: Number(line.split('-')[1].trim()), notes: [], type: 'notes' });\n        } else if (Object.keys(typesMap).includes(line[0])) {\n            if (sections.length === 0) {\n                sections = [{ start: 0, notes: [], type: 'notes' }];\n            }\n            // Note\n            const lastSection = sections[sections.length - 1];\n\n            const [type, start, length, pitch, ...lyrics] = split;\n\n            (lastSection as NotesSection).notes.push({\n                type: typesMap[type as 'R' | '*' | ':'] ?? 'normal',\n                start: Number(start),\n                length: Number(length),\n                pitch: Number(pitch),\n                lyrics: lyrics.join(' '),\n            });\n            lastStart = Number(split[1]);\n        }\n    });\n\n    if (trackNames[song.tracks.length]) song.tracks.push({ sections, name: trackNames[song.tracks.length] });\n    else song.tracks.push({ sections });\n\n    song.tracks = song.tracks.map((track) => ({\n        ...track,\n        // get rid of sections with no notes\n        sections: track.sections.filter((section) => section.type === 'pause' || section.notes.length),\n    }));\n\n    return song;\n}\n","import { Box, Button, TextField, Tooltip } from '@mui/material';\nimport YouTube from 'react-youtube';\nimport { getVideoId } from 'Songs/utils/convertTxtToSong';\n\nexport interface AuthorAndVidEntity {\n    author: string;\n    authorUrl: string;\n    video: string;\n}\n\ninterface Props {\n    onChange: (data: AuthorAndVidEntity) => void;\n    data: AuthorAndVidEntity;\n    songTitle?: string;\n    songArtist?: string;\n}\n\nexport default function AuthorAndVid(props: Props) {\n    const searchForVideo = () => {\n        window.open(\n            `https://www.youtube.com/results?search_query=${encodeURIComponent(\n                props?.songArtist + ' ' + props?.songTitle,\n            )}`,\n            '_blank',\n        );\n    };\n    const isSearchableForVideo = !!props.songTitle && !!props.songArtist;\n\n    const videoId = getVideoId(props.data.video);\n\n    return (\n        <Box sx={{ display: 'flex', flexWrap: 'wrap' }} data-test=\"author-and-vid\">\n            <TextField\n                data-test=\"author-name\"\n                sx={{ mt: 2 }}\n                value={props.data.author}\n                onChange={(e) => props.onChange({ ...props.data, author: e.target.value })}\n                label=\"Author name\"\n                fullWidth\n                size=\"small\"\n            />\n            <TextField\n                data-test=\"author-url\"\n                sx={{ mt: 2 }}\n                value={props.data.authorUrl}\n                onChange={(e) => props.onChange({ ...props.data, authorUrl: e.target.value })}\n                label=\"Author URL\"\n                fullWidth\n                size=\"small\"\n            />\n            <Box sx={{ display: 'flex', flexDirection: 'row', mt: 2, alignItems: 'center', width: '100%' }}>\n                <TextField\n                    data-test=\"video-url\"\n                    required\n                    value={props.data.video}\n                    onChange={(e) => props.onChange({ ...props.data, video: e.target.value })}\n                    label=\"Video URL\"\n                    fullWidth\n                    size=\"small\"\n                    helperText=\"Link to YouTube video, eg https://www.youtube.com/watch?v=xxxxxxxxx\"\n                    name=\"videoUrl\"\n                    InputProps={{\n                        endAdornment: (\n                            <Tooltip\n                                title={\n                                    isSearchableForVideo\n                                        ? 'Open YouTube search results for the song'\n                                        : 'Artist or title of the song is unknown'\n                                }>\n                                <span>\n                                    <Button\n                                        data-test=\"search-video\"\n                                        color={'secondary'}\n                                        variant={'contained'}\n                                        onClick={searchForVideo}\n                                        disabled={!isSearchableForVideo}>\n                                        Search&nbsp;for&nbsp;video\n                                    </Button>\n                                </span>\n                            </Tooltip>\n                        ),\n                    }}\n                />\n            </Box>\n            {videoId && (\n                <Box>\n                    <YouTube videoId={videoId} />\n                </Box>\n            )}\n        </Box>\n    );\n}\n","import { AuthorAndVidEntity } from 'Scenes/Convert/Steps/AuthorAndVid';\n\nexport default async function importSongFromSource(url: string) {\n    const urlObj = new URL(url);\n\n    if (urlObj.host === 'usdb.animux.de') {\n        return importUsDbAnimuxSong(url, urlObj);\n    } else if (urlObj.host === 'ultrastar-es.org') {\n        return importUltrastarEsSong(url);\n    }\n}\n\nasync function importUltrastarEsSong(url: string): Promise<AuthorAndVidEntity> {\n    const response = await fetch(`https://at-cors-anywhere.fly.dev/raw?url=${encodeURIComponent(url)}`);\n    const text = await response.text();\n\n    const doc = new DOMParser().parseFromString(text, 'text/html');\n\n    const id = doc.querySelector('ul[data-id]')?.getAttribute('data-id');\n    const txtUrl = `https://ultrastar-es.org/pl/canciones/descargar/txt/${id}`;\n    window.location.href = txtUrl;\n\n    const authorPath = doc.querySelector('#listado > ul > li > dl > dd:nth-child(6) > a')?.getAttribute('href');\n    const videoId = doc.querySelector('#listado > ul > li')?.getAttribute('data-id');\n\n    return {\n        authorUrl: authorPath ? 'https://ultrastar-es.org' + authorPath : '',\n        author: doc.querySelector('#listado > ul > li > dl > dd:nth-child(6)')?.textContent ?? '',\n        video: videoId ? 'https://www.youtube.com/watch?v=' + videoId : '',\n    };\n}\n\nasync function importUsDbAnimuxSong(url: string, obj: URL): Promise<AuthorAndVidEntity> {\n    const response = await fetch(`https://at-cors-anywhere.fly.dev/raw?url=${encodeURIComponent(url)}`);\n    const text = await response.text();\n\n    const doc = new DOMParser().parseFromString(text, 'text/html');\n\n    const author = doc.querySelector('a[href^=\"?link=profil&id=\"]')?.textContent;\n    const authorPath = doc.querySelector('a[href^=\"?link=profil&id=\"]')?.getAttribute?.('href');\n\n    const artist = doc.querySelector(\n        '#tablebg > tbody > tr:nth-child(3) > td > table:nth-child(2) > tbody > tr.list_head > td:nth-child(1)',\n    )?.textContent;\n    const title = doc.querySelector(\n        '#tablebg > tbody > tr:nth-child(3) > td > table:nth-child(2) > tbody > tr.list_head > td:nth-child(2)',\n    )?.textContent;\n\n    window.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(artist + ' ' + title)}`, '_blank');\n    window.open(`http://usdb.animux.de/index.php?link=gettxt&id=${obj.searchParams.get('id')}`, '_blank');\n\n    return {\n        authorUrl: authorPath ? 'http://usdb.animux.de/index.php' + authorPath : '',\n        author: author ?? '',\n        video: '',\n    };\n}\n","import { Box, TextField } from '@mui/material';\nimport { ChangeEventHandler } from 'react';\nimport importUltrastarEsSong from 'Scenes/Convert/importUltrastarEsSong';\nimport { AuthorAndVidEntity } from 'Scenes/Convert/Steps/AuthorAndVid';\n\nexport interface BasicDataEntity {\n    sourceUrl: string;\n    txtInput: string;\n}\n\ninterface Props {\n    shouldAutoImport: boolean;\n    onAutoImport: (data: AuthorAndVidEntity) => void;\n    onChange: (data: BasicDataEntity) => void;\n    data: BasicDataEntity;\n    isTxtRequired: boolean;\n}\n\nexport default function BasicData(props: Props) {\n    const onSourceUrlEdit: ChangeEventHandler<HTMLInputElement> = async (e) => {\n        props.onChange({ ...props.data, sourceUrl: e.target.value });\n        if (props.shouldAutoImport) {\n            const data = await importUltrastarEsSong(e.target.value);\n\n            if (data) props.onAutoImport(data);\n        }\n    };\n\n    return (\n        <Box sx={{ display: 'flex', flexWrap: 'wrap' }} data-test=\"basic-data\">\n            <TextField\n                sx={{ mt: 2 }}\n                value={props.data.sourceUrl}\n                onChange={onSourceUrlEdit}\n                label=\"Source URL\"\n                fullWidth\n                size=\"small\"\n                data-test=\"source-url\"\n            />\n            {props.isTxtRequired && (\n                <TextField\n                    required\n                    sx={{ mt: 2 }}\n                    fullWidth\n                    size=\"small\"\n                    multiline\n                    label=\"Song's .TXT file contents\"\n                    onChange={(e) => props.onChange({ ...props.data, txtInput: fixDiacritics(e.target.value) })}\n                    value={props.data.txtInput}\n                    maxRows={15}\n                    minRows={15}\n                    InputProps={{\n                        inputProps: {\n                            'data-test': 'input-txt',\n                        },\n                    }}\n                />\n            )}\n        </Box>\n    );\n}\n\nfunction fixDiacritics(txt: string): string {\n    return txt\n        .replaceAll('Ãˆ', 'Ã©')\n        .replaceAll('Ã­', \"'\")\n        .replaceAll('Â¥', \"'\")\n\n        .replaceAll('Â¯', 'Å»')\n        .replaceAll('Â¹', 'Ä…')\n        .replaceAll('Ï€', 'Ä…')\n        .replaceAll('Ãª', 'Ä™')\n        .replaceAll('Ã', 'Ä™')\n        .replaceAll('Å’', 'Åš')\n        .replaceAll('Ã¥', 'Åš')\n        .replaceAll('Å“', 'Å›')\n        .replaceAll('Ãº', 'Å›')\n        .replaceAll('Ã¦', 'Ä‡')\n        .replaceAll('ÃŠ', 'Ä‡')\n        .replaceAll('Â¿', 'Å¼')\n        .replaceAll('Ã¸', 'Å¼')\n        .replaceAll('Ã˜', 'Å»')\n        .replaceAll('Ã±', 'Å„')\n        .replaceAll('Ã’', 'Å„')\n        .replaceAll('Â³', 'Å‚')\n        .replaceAll('â‰¥', 'Å‚')\n        .replaceAll('â‰¥', 'Å‚')\n        .replaceAll('Â£', 'Å')\n        .replaceAll('Ã›', 'Ã³')\n        .replaceAll('Ã¼', 'Åº')\n        .replaceAll('Å¸', 'Åº');\n}\n","import { Box, Slider } from '@mui/material';\nimport YouTube from 'react-youtube';\nimport backgroundMusic from 'assets/Funk Cool Groove (No Copyright Music) By Anwar Amr.mp3';\nimport { SongMetadataEntity } from 'Scenes/Convert/Steps/SongMetadata';\nimport { useEffect, useRef } from 'react';\n\ninterface Props {\n    onChange: (data: SongMetadataEntity) => void;\n    data: SongMetadataEntity;\n    videoId: string;\n}\n\nexport default function VolumeAdjustment(props: Props) {\n    const player = useRef<YouTube | null>(null);\n\n    useEffect(() => {\n        player.current?.getInternalPlayer().setVolume(props.data.volume * 100);\n    }, [props.data.volume, player.current]);\n\n    useEffect(() => {\n        const interval = setInterval(async () => {\n            const currentVolume = await player.current?.getInternalPlayer().getVolume();\n\n            if (currentVolume !== props.data.volume * 100) {\n                props.onChange({ ...props.data, volume: currentVolume / 100 });\n            }\n        }, 500);\n\n        return () => {\n            clearInterval(interval);\n        };\n    }, [props.data, props.onChange, player.current]);\n\n    return (\n        <Box sx={{ display: 'flex', flexDirection: 'column', width: '100%' }}>\n            <h3>Adjust volume</h3>\n            <Box sx={{ display: 'flex', gap: 5 }}>\n                <Box>\n                    <h4>Song</h4>\n                    <YouTube videoId={props.videoId} ref={player} />\n                </Box>\n                <Box>\n                    <h4>Reference sound</h4>\n                    <p>Use the slider below to make the video volume roughly the same as this music.</p>\n                    <br />\n                    <audio\n                        controls\n                        src={backgroundMusic}\n                        loop\n                        onPlay={(e) => {\n                            e.currentTarget.volume = 0.5;\n                        }}\n                    />\n                </Box>\n            </Box>\n            <h4>Final Song Volume ({props.data.volume * 100})</h4>\n            <Box>\n                <Slider\n                    data-test=\"volume\"\n                    min={0}\n                    max={1}\n                    step={0.01}\n                    aria-label=\"Volume\"\n                    value={props.data.volume}\n                    onChange={(e, value) => props.onChange({ ...props.data, volume: +value })}\n                />\n            </Box>\n        </Box>\n    );\n}\n","import { Box, Button, TextField } from '@mui/material';\nimport VolumeAdjustment from 'Scenes/Convert/Steps/VolumeAdjustment';\n\nexport interface SongMetadataEntity {\n    year: string;\n    realBpm: string;\n    language: string;\n    volume: number;\n}\n\ninterface Props {\n    onChange: (data: SongMetadataEntity) => void;\n    data: SongMetadataEntity;\n    songTitle?: string;\n    songArtist?: string;\n    videoId: string;\n}\n\nexport default function SongMetadata(props: Props) {\n    const searchGoogle = (phrase: string) => {\n        window.open(\n            `https://www.google.com/search?q=${encodeURIComponent(`${props.songArtist} ${props.songTitle} ${phrase}`)}`,\n            '_blank',\n        );\n    };\n    const isSearchableForVideo = !!props.songTitle && !!props.songArtist;\n\n    return (\n        <Box sx={{ display: 'flex', flexWrap: 'wrap' }} data-test=\"song-metadata\">\n            <TextField\n                sx={{ mt: 2 }}\n                value={props.data.language}\n                onChange={(e) => props.onChange({ ...props.data, language: e.target.value })}\n                label=\"Song language\"\n                fullWidth\n                size=\"small\"\n                required\n                data-test=\"song-language\"\n            />\n            <TextField\n                data-test=\"release-year\"\n                sx={{ mt: 2 }}\n                value={props.data.year}\n                onChange={(e) => props.onChange({ ...props.data, year: e.target.value })}\n                label=\"Release year\"\n                fullWidth\n                size=\"small\"\n                required\n                InputProps={{\n                    endAdornment: (\n                        <Button\n                            color=\"secondary\"\n                            variant={'contained'}\n                            onClick={() => searchGoogle('release year')}\n                            disabled={!isSearchableForVideo}>\n                            Search&nbsp;for&nbsp;year\n                        </Button>\n                    ),\n                }}\n            />\n            <TextField\n                data-test=\"song-bpm\"\n                sx={{ mt: 2 }}\n                value={props.data.realBpm}\n                onChange={(e) => props.onChange({ ...props.data, realBpm: e.target.value })}\n                label=\"Song (real) BPM\"\n                fullWidth\n                type=\"number\"\n                size=\"small\"\n                required\n                InputProps={{\n                    endAdornment: (\n                        <Button\n                            color={'secondary'}\n                            variant={'contained'}\n                            onClick={() => searchGoogle('tempo')}\n                            disabled={!isSearchableForVideo}>\n                            Search&nbsp;for&nbsp;tempo\n                        </Button>\n                    ),\n                }}\n            />\n            <VolumeAdjustment {...props} />\n        </Box>\n    );\n}\n","import { ValuesType } from \"utility-types\";\n\nexport type NoteType = 'normal' | 'star' | 'freestyle' | 'rap';\nexport interface Note {\n    start: number;\n    length: number;\n    pitch: number;\n    type: NoteType;\n    lyrics: string;\n}\n\nexport type Section = NotesSection | PauseSection;\n\nexport const GAME_MODE = {\n    DUEL: 'DUEL',\n    PASS_THE_MIC: 'PASS_THE_MIC',\n} as const;\n\nexport interface PlayerSetup {\n    name: string;\n    track: number;\n}\n\nexport interface SingSetup {\n    id: string;\n    players: [PlayerSetup, PlayerSetup];\n    mode: ValuesType<typeof GAME_MODE>;\n    tolerance: number;\n}\n\nexport interface NotesSection {\n    // end: never;\n    start: number;\n    notes: Note[];\n    type: 'notes';\n}\n\nexport interface PauseSection {\n    start: number;\n    end: number;\n    // notes: never;\n    type: 'pause';\n}\n\nexport interface Song {\n    lastUpdate: string | undefined;\n    author: string | undefined;\n    authorUrl: string | undefined;\n    genre: string | undefined;\n    year: string | undefined;\n    edition: string | undefined;\n    language: string | undefined;\n    sourceUrl: string | undefined;\n    videoGap: number | undefined;\n    artist: string;\n    title: string;\n    video: string;\n    previewStart: number | undefined;\n    previewEnd: number | undefined;\n    gap: number;\n    bpm: number;\n    realBpm: number | undefined;\n    bar: number;\n    tracks: SongTrack[];\n    volume: number | undefined;\n}\n\nexport interface SongTrack {\n    name?: string;\n    sections: Section[];\n}\n\nexport interface SongPreview extends Omit<Song, 'tracks'> {\n    file: string;\n    tracksCount: number;\n    tracks: Array<Pick<SongTrack, 'name'> & { start: number }>;\n    search: string;\n    isNew?: boolean;\n    isDeleted?: boolean;\n    local?: boolean;\n}\n\nexport interface FrequencyRecord {\n    timestamp: number;\n    frequency: number;\n}\n\nexport interface NoteFrequencyRecord extends FrequencyRecord {\n    preciseDistance: number;\n}\n\nexport interface PlayerNote {\n    start: number;\n    length: number;\n    distance: number;\n    note: Note;\n    isPerfect: boolean;\n    vibrato: boolean;\n    frequencyRecords: NoteFrequencyRecord[];\n}\n\ntype UndefinedKeys<T> = {\n    [K in keyof T]: undefined extends T[K] ? K : never;\n}[keyof T];\n\nexport type ExtractOptional<T> = Pick<T, Exclude<UndefinedKeys<T>, undefined>>;\n\nexport type DetailedScore = Record<Note['type'] | 'perfect' | 'vibrato', number>;\n\nexport interface HighScoreEntity {\n    singSetupId: string;\n    name: string;\n    score: number;\n    date: string;\n}\n\nexport type seconds = number;\nexport type milliseconds = number;\n","import styled from '@emotion/styled';\n\nexport const Pre = styled.span`\n    font-family: monospace;\n`;\n","import { Button, Tooltip } from '@mui/material';\nimport { Pre } from 'Scenes/Convert/Elements';\nimport GameState from 'Scenes/Game/Singing/GameState/GameState';\nimport { PlayerRef } from 'Scenes/Game/Singing/Player';\n\nconst formatMs = (msec: number) => {\n    const minutes = Math.floor(msec / 1000 / 60);\n    const seconds = Math.floor(msec / 1000) - minutes * 60;\n    const miliseconds = Math.floor(msec % 1000);\n\n    return (\n        <Pre>\n            {String(minutes).padStart(2, '0')}:{String(seconds).padStart(2, '0')}.{String(miliseconds).padStart(3, '0')}\n        </Pre>\n    );\n};\n\nexport const msec = (ms: number | undefined, player: PlayerRef) => (\n    <Tooltip title=\"Click to play the moment just before this time\" placement={'top'} arrow>\n        <Button\n            sx={{ py: 0.15, mb: 0.5 }}\n            variant={'contained'}\n            size=\"small\"\n            onClick={() => {\n                GameState.resetPlayerNotes();\n                player.seekTo((ms ?? 0) / 1000 - 0.7);\n            }}>\n            {formatMs(ms ?? 0)}\n        </Button>\n    </Tooltip>\n);\n\nexport default formatMs;\n","import { Box, Button, ButtonGroup, Divider, Typography } from '@mui/material';\nimport { useState } from 'react';\nimport { Pre } from 'Scenes/Convert/Elements';\nimport formatMs from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/formatMs';\nimport { PlayerRef } from 'Scenes/Game/Singing/Player';\n\ninterface Props {\n    player: PlayerRef;\n    currentTime: number;\n    effectsEnabled: boolean;\n    onEffectsToggle: () => void;\n}\n\nexport default function AdjustPlayback({ player, currentTime, effectsEnabled, onEffectsToggle }: Props) {\n    const seekBy = (bySec: number) => player.seekTo((currentTime + bySec) / 1000);\n    const [currentSpeed, setCurrentSpeed] = useState(1);\n\n    return (\n        <>\n            <Box sx={{ mb: 2 }}>\n                <Typography variant={'h6'} data-test=\"current-time\">\n                    Current time: {formatMs(currentTime)} (<Pre>{Math.round(currentTime)}</Pre> ms)\n                </Typography>\n                <Box sx={{ display: 'flex', gap: 1 }}>\n                    <ButtonGroup variant=\"contained\" sx={{ display: 'flex', mt: 1, flex: 1 }}>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(-10_000)} data-test=\"seek-10s\">\n                            -10\n                        </Button>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(-5_000)} data-test=\"seek-5s\">\n                            -5\n                        </Button>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(-1_000)} data-test=\"seek-1s\">\n                            -1\n                        </Button>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(-500)} data-test=\"seek-0.5s\">\n                            -0.5\n                        </Button>\n                    </ButtonGroup>\n                    <Divider />\n                    <ButtonGroup variant=\"contained\" sx={{ display: 'flex', mt: 1, flex: 1 }}>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(+500)} data-test=\"seek+0.5s\">\n                            +0.5\n                        </Button>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(+1_000)} data-test=\"seek+1s\">\n                            +1\n                        </Button>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(+5_000)} data-test=\"seek+5s\">\n                            +5\n                        </Button>\n                        <Button sx={{ flex: 1, px: 1 }} onClick={() => seekBy(+10_000)} data-test=\"seek+10s\">\n                            +10\n                        </Button>\n                    </ButtonGroup>\n                </Box>\n            </Box>\n            <Box sx={{ mb: 2 }}>\n                <Typography variant={'h6'}>\n                    Playback speed: <Pre data-test=\"current-speed\">{currentSpeed * 100}%</Pre>\n                </Typography>\n                <ButtonGroup variant=\"contained\" sx={{ display: 'flex', mt: 1 }}>\n                    {[0.25, 0.5, 0.75, 1, 1.25, 1.5, 2].map((speed) => (\n                        <Button\n                            data-test={`speed-${speed}`}\n                            key={speed}\n                            sx={{ flex: 1 }}\n                            onClick={() => {\n                                setCurrentSpeed(speed);\n                                player.setPlaybackSpeed(speed);\n                            }}\n                            disabled={currentSpeed === speed}>\n                            {speed * 100}%\n                        </Button>\n                    ))}\n                </ButtonGroup>\n            </Box>\n        </>\n    );\n}\n","import { Section } from 'interfaces';\nimport { useMemo } from 'react';\n\nexport default function useCurrentSectionIndex(sections: Section[], currentBeat: number) {\n    const wholeBeat = Math.floor(currentBeat);\n    return useMemo(\n        () =>\n            sections.findIndex((section, index) => {\n                if (wholeBeat < 0) return true;\n                if (wholeBeat < section.start) return false;\n                if (index === sections.length - 1) return true;\n                if (sections[index + 1].start > wholeBeat) {\n                    return true;\n                }\n                return false;\n            }),\n        [wholeBeat, sections],\n    );\n}\n","import styled from '@emotion/styled';\nimport {\n    Box,\n    Button,\n    ButtonGroup,\n    List,\n    ListItem,\n    ListItemButton,\n    ListItemText,\n    Stack,\n    TextField,\n    Typography,\n} from '@mui/material';\nimport { Song } from 'interfaces';\nimport { useEffect, useState } from 'react';\nimport { msec } from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/formatMs';\nimport GameState from 'Scenes/Game/Singing/GameState/GameState';\nimport getCurrentBeat from 'Scenes/Game/Singing/GameState/Helpers/getCurrentBeat';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { getFirstNoteStartFromSections } from 'Songs/utils/notesSelectors';\nimport useCurrentSectionIndex from 'Scenes/Game/Singing/Hooks/useCurrentSectionIndex';\nimport { PlayerRef } from 'Scenes/Game/Singing/Player';\n\ninterface Props {\n    song: Song;\n    currentTime: number;\n    beatLength: number;\n    player: PlayerRef;\n    onRecordChange: (changeRecords: ChangeRecord[]) => void;\n    onTrackNameChange: (track: number, newName: string) => void;\n}\n\ninterface ChangeRecordBase {\n    track: number;\n    section: number;\n}\n\ninterface ChangeRecordShift extends ChangeRecordBase {\n    track: number;\n    section: number;\n    type: 'shift';\n    shift: number;\n}\n\ninterface ChangeRecordDelete extends ChangeRecordBase {\n    track: number;\n    section: number;\n    type: 'delete';\n}\n\nexport type ChangeRecord = ChangeRecordDelete | ChangeRecordShift;\n\nexport default function EditSection({\n    song,\n    currentTime,\n    beatLength,\n    player,\n    onRecordChange,\n    onTrackNameChange,\n}: Props) {\n    const [track, setTrack] = useState(0);\n    const [selectedSection, setSelectedSection] = useState(-1);\n    const [changeRecords, setChangeRecords] = useState<ChangeRecord[]>([]);\n    const currentBeat = getCurrentBeat(currentTime, beatLength, song.gap);\n\n    const sections = song.tracks[track].sections.filter(isNotesSection);\n\n    const currentSectionIndex = useCurrentSectionIndex(sections, currentBeat);\n\n    const onSectionClick = (index: number) => {\n        setSelectedSection(index);\n        GameState.resetPlayerNotes();\n        player.seekTo((sections[index].start * beatLength + song.gap) / 1000);\n    };\n\n    const deleteSection = () => {\n        setChangeRecords((records) => [...records, { type: 'delete', section: selectedSection, track }]);\n        if (selectedSection === sections.length - 1) {\n            setSelectedSection((selected) => selected - 1);\n        }\n    };\n\n    const shiftSection = (newStart: number) => {\n        setChangeRecords((records) => {\n            const lastRecord = records.at(-1);\n\n            if (\n                lastRecord &&\n                lastRecord.type === 'shift' &&\n                lastRecord.track === track &&\n                lastRecord.section === selectedSection\n            ) {\n                const newRecords = [...records];\n                (newRecords.at(-1)! as ChangeRecordShift).shift = newStart;\n\n                return newRecords;\n            }\n\n            return [...records, { type: 'shift', section: selectedSection, track, shift: newStart }];\n        });\n    };\n\n    useEffect(() => {\n        onRecordChange(changeRecords);\n    }, [onRecordChange, changeRecords]);\n\n    return (\n        <SectionEdtiorContainer>\n            <Stack direction=\"row\">\n                <Typography variant={'h6'} mb={0} sx={{ flex: 1 }}>\n                    Edit verses\n                    {song.tracks.length > 1 && (\n                        <ButtonGroup variant={'contained'} sx={{ ml: 2 }} size={'small'}>\n                            {song.tracks.map((_, index) => (\n                                <Button\n                                    key={index}\n                                    onClick={() => setTrack(index)}\n                                    disabled={track === index}\n                                    data-test={`track-${index + 1}`}>\n                                    Track {index + 1}\n                                </Button>\n                            ))}\n                        </ButtonGroup>\n                    )}\n                </Typography>\n                <TextField\n                    placeholder=\"Set track name\"\n                    sx={{ flex: 1 }}\n                    size=\"small\"\n                    value={song.tracks[track]?.name ?? ''}\n                    onChange={(e) => onTrackNameChange(track, e.target.value)}\n                    data-test=\"track-name\"\n                />\n            </Stack>\n            <Stack direction=\"row\" spacing={2} sx={{ height: '400px' }}>\n                <List sx={{ overflowY: 'auto' }}>\n                    {sections.map((section, index) => (\n                        <ListItem key={section.start} disablePadding data-test={`section-${index}`}>\n                            <ListItemButton onClick={() => onSectionClick(index)} selected={selectedSection === index}>\n                                <ListItemText\n                                    primaryTypographyProps={{\n                                        fontWeight: index === currentSectionIndex ? 'bold' : 'normal',\n                                    }}\n                                    primary={\n                                        isNotesSection(section)\n                                            ? section.notes.map((note) => note.lyrics).join('')\n                                            : '[pause]'\n                                    }\n                                />\n                            </ListItemButton>\n                        </ListItem>\n                    ))}\n                </List>\n                <SectionEditForm>\n                    {selectedSection > -1 && (\n                        <>\n                            {selectedSection === 0 && (\n                                <h3 data-test={`use-gap-info`}>Use gap shift to change when this section starts</h3>\n                            )}\n                            {selectedSection > 0 && (\n                                <>\n                                    <TextField\n                                        data-test=\"change-start-beat\"\n                                        size={'small'}\n                                        type=\"number\"\n                                        onChange={(e) => shiftSection(+e.target.value)}\n                                        value={getFirstNoteStartFromSections([sections[selectedSection]])}\n                                        label=\"Change start beat\"\n                                        InputProps={{\n                                            inputProps: {\n                                                step: 1,\n                                            },\n                                        }}\n                                        fullWidth\n                                        sx={{ mb: 2 }}\n                                        helperText={\n                                            <>\n                                                Timestamp:{' '}\n                                                {msec(\n                                                    getFirstNoteStartFromSections([sections[selectedSection]]) *\n                                                        beatLength +\n                                                        song.gap,\n                                                    player,\n                                                )}\n                                            </>\n                                        }\n                                    />\n                                </>\n                            )}\n                            <Button\n                                variant=\"contained\"\n                                color={'error'}\n                                onClick={deleteSection}\n                                fullWidth\n                                data-test=\"delete-section\">\n                                Delete section\n                            </Button>\n                        </>\n                    )}\n                </SectionEditForm>\n                <SectionChangeList>\n                    <Box sx={{ overflowY: 'auto', maxHeight: '34rem' }} data-test=\"change-list\">\n                        {changeRecords.map((change, index) => {\n                            let message = '';\n                            let Component = SectionChangeDelete;\n                            if (change.type === 'delete') {\n                                Component = SectionChangeDelete;\n                                message = `Deleted`;\n                            } else if (change.type === 'shift') {\n                                Component = SectionChangeShift;\n                                message = `Start -> ${change.shift}`;\n                            }\n\n                            return (\n                                <Component key={index}>\n                                    <strong>\n                                        Track: {change.track + 1}, Section: {change.section + 1}, {message}\n                                    </strong>\n                                </Component>\n                            );\n                        })}\n                    </Box>\n                    {changeRecords.length > 0 && (\n                        <Button\n                            data-test=\"undo-change\"\n                            variant=\"contained\"\n                            color={'warning'}\n                            onClick={() =>\n                                setChangeRecords((records) =>\n                                    records.filter((_, index) => index !== records.length - 1),\n                                )\n                            }\n                            fullWidth>\n                            Undo last change\n                        </Button>\n                    )}\n                </SectionChangeList>\n            </Stack>\n        </SectionEdtiorContainer>\n    );\n}\n\nconst SectionChangeList = styled.div`\n    flex: 1;\n`;\n\nconst ChangeEntry = styled.div`\n    padding: 0.5rem;\n`;\n\nconst SectionChangeDelete = styled(ChangeEntry)`\n    color: red;\n`;\n\nconst SectionChangeShift = styled(ChangeEntry)`\n    color: #0059ff;\n`;\n\nconst Editor = styled.div`\n    display: flex;\n    flex-direction: row;\n`;\n\nconst SectionEdtiorContainer = styled.div``;\n\nconst SectionEditForm = styled.div`\n    flex: 1;\n`;\n\nconst SectionList = styled.div`\n    flex: 1;\n    overflow-y: auto;\n`;\nconst SectionListEntry = styled.div<{ active: boolean; selected: boolean }>`\n    font-weight: ${(props) => (props.active ? 'bold' : 'normal')};\n\n    border: 0.1rem solid;\n    border-color: ${(props) => (props.selected ? 'black' : 'white')};\n\n    padding: 1rem;\n`;\n","import { Song } from 'interfaces';\nimport { PlayerRef } from 'Scenes/Game/Singing/Player';\n\ninterface Props {\n    player: PlayerRef;\n    song: Song;\n    beatLength: number;\n}\n\nexport default function ListTracks({ song, player, beatLength }: Props) {\n    return (\n        <>\n            {/*{song.tracks.map(({ sections }, index) => {*/}\n            {/*    const notesSections = sections.filter(isNotesSection);*/}\n            {/*    const firstNote = notesSections[0].notes[0];*/}\n\n            {/*    const lastNote = notesSections.at(-1)?.notes.at(-1);*/}\n\n            {/*    if (!firstNote || !lastNote || !beatLength) return null;*/}\n\n            {/*    return (*/}\n            {/*        <EditorRow key={index}>*/}\n            {/*            <strong>Track #{index + 1} - </strong>*/}\n            {/*            Start: {msec(firstNote.start * beatLength + song.gap, player)}, end:{' '}*/}\n            {/*            {msec(lastNote.start * beatLength + song.gap, player)}*/}\n            {/*        </EditorRow>*/}\n            {/*    );*/}\n            {/*})}*/}\n        </>\n    );\n}\n","import { Song } from 'interfaces';\nimport isNotesSection from 'Songs/utils/isNotesSection';\n\nexport default function calculateProperBPM(desiredEndMs: number, song: Song) {\n    const notesSections = song.tracks[0].sections.filter(isNotesSection);\n\n    const lastNote = notesSections.at(-1)?.notes.at(-1)!;\n\n    const desiredLengthMs = desiredEndMs - song.gap;\n    const bpmLength = lastNote.start + lastNote.length;\n\n    return Number((60_000 / ((desiredLengthMs / bpmLength) * song.bar)).toFixed(2));\n}\n","import { Song, SongPreview } from 'interfaces';\nimport getSongBeatLength from 'Songs/utils/getSongBeatLength';\n\nexport default function beatToMs(beat: number, song: Song | SongPreview): number {\n    return getSongBeatLength(song) * beat;\n}\n","import { Box, TextField } from '@mui/material';\nimport { Song } from 'interfaces';\nimport { useState } from 'react';\nimport calculateProperBPM from 'Scenes/Convert/calculateProperBpm';\nimport { Pre } from 'Scenes/Convert/Elements';\nimport beatToMs from 'Scenes/Game/Singing/GameState/Helpers/beatToMs';\nimport { getLastNoteEndFromSections } from 'Songs/utils/notesSelectors';\nimport { PlayerRef } from 'Scenes/Game/Singing/Player';\n\ninterface Props {\n    onChange: (bpm: number) => void;\n    current: number;\n    player: PlayerRef;\n    song: Song;\n}\n\nexport default function ManipulateBpm({ current, onChange, player, song }: Props) {\n    const lastNoteEndBeat = Math.max(...song.tracks.map((track) => getLastNoteEndFromSections(track.sections)));\n    const lastNoteEndMs = beatToMs(lastNoteEndBeat, song) + song.gap;\n    const [desiredLastNoteEnd, setDesiredLastNoteEnd] = useState<number>(Math.round(lastNoteEndMs));\n\n    return (\n        <Box sx={{ display: 'flex', gap: 2, mb: 2 }}>\n            <TextField\n                data-test=\"desired-end\"\n                size={'small'}\n                type=\"number\"\n                value={desiredLastNoteEnd}\n                onChange={(e) => setDesiredLastNoteEnd(+e.target.value)}\n                label=\"Desired last note end time (in milliseconds)\"\n                sx={{ flex: 1 }}\n                helperText={\n                    !!desiredLastNoteEnd ? (\n                        <>\n                            Est. proper Tempo (BPM):{' '}\n                            <Pre data-test=\"desired-bpm\">{calculateProperBPM(desiredLastNoteEnd, song)}</Pre>\n                        </>\n                    ) : (\n                        ' '\n                    )\n                }\n            />\n            <TextField\n                data-test=\"change-bpm\"\n                size={'small'}\n                type=\"number\"\n                value={current}\n                onChange={(e) => onChange(+e.target.value)}\n                label=\"Tempo (BPM) of the lyrics\"\n                sx={{ flex: 0.5 }}\n                helperText={' '}\n                InputProps={{\n                    inputProps: {\n                        step: '0.1',\n                    },\n                }}\n            />\n        </Box>\n    );\n}\n","import { Box, Button, ButtonGroup, TextField, Typography } from '@mui/material';\nimport { msec } from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/formatMs';\nimport { PlayerRef } from 'Scenes/Game/Singing/Player';\n\ninterface Props {\n    onChange: (shift: number) => void;\n    current: number;\n    player: PlayerRef;\n    finalGap: number;\n}\n\nexport default function ShiftGap({ current, onChange, player, finalGap }: Props) {\n    return (\n        <Box sx={{ flex: 1 }}>\n            <Typography variant={'h6'}>Gap shift (final: {msec(finalGap, player)})</Typography>\n            <Box sx={{ display: 'flex', gap: 1, mt: 1 }}>\n                <ButtonGroup sx={{ flex: 1 }}>\n                    <Button sx={{ flex: 1, px: 1 }} onClick={() => onChange(current - 1000)} data-test=\"shift-gap-1s\">\n                        -1000\n                    </Button>\n                    <Button sx={{ flex: 1, px: 1 }} onClick={() => onChange(current - 500)} data-test=\"shift-gap-0.5s\">\n                        -500\n                    </Button>\n                    <Button sx={{ flex: 1, px: 1 }} onClick={() => onChange(current - 50)} data-test=\"shift-gap-0.05s\">\n                        -50\n                    </Button>\n                </ButtonGroup>\n                <TextField\n                    sx={{ py: 0, flex: 1 }}\n                    size={'small'}\n                    type=\"text\"\n                    value={current}\n                    onChange={(e) => onChange(+e.target.value)}\n                    label=\"Miliseconds\"\n                    data-test=\"shift-gap\"\n                />\n                <ButtonGroup sx={{ flex: 1 }}>\n                    <Button sx={{ flex: 1, px: 1 }} onClick={() => onChange(current + 50)} data-test=\"shift-gap+0.05s\">\n                        +50\n                    </Button>\n                    <Button sx={{ flex: 1, px: 1 }} onClick={() => onChange(current + 500)} data-test=\"shift-gap+0.5s\">\n                        +500\n                    </Button>\n                    <Button sx={{ flex: 1, px: 1 }} onClick={() => onChange(current + 1000)} data-test=\"shift-gap+1s\">\n                        +1000\n                    </Button>\n                </ButtonGroup>\n            </Box>\n        </Box>\n    );\n}\n","import { Box, Button, ButtonGroup, TextField, Typography } from '@mui/material';\nimport { msec } from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/formatMs';\nimport { PlayerRef } from 'Scenes/Game/Singing/Player';\n\ninterface Props {\n    onChange: (shift: number) => void;\n    current: number;\n    player: PlayerRef;\n    finalGap: number | undefined;\n}\n\nexport default function ShiftVideoGap({ current, onChange, player, finalGap }: Props) {\n    return (\n        <Box sx={{ flex: 1 }}>\n            <Typography variant={'h6'}>Video Gap shift (final: {msec((finalGap ?? 0) * 1000, player)})</Typography>\n            <Box sx={{ display: 'flex', gap: 1, mt: 1 }}>\n                <ButtonGroup sx={{ flex: 1 }}>\n                    <Button\n                        sx={{ flex: 1, px: 1.25 }}\n                        onClick={() => onChange(current - 10)}\n                        data-test=\"shift-video-gap-10s\">\n                        -10\n                    </Button>\n                    <Button\n                        sx={{ flex: 1, px: 1.25 }}\n                        onClick={() => onChange(current - 5)}\n                        data-test=\"shift-video-gap-5s\">\n                        -5\n                    </Button>\n                    <Button\n                        sx={{ flex: 1, px: 1.25 }}\n                        onClick={() => onChange(current - 1)}\n                        data-test=\"shift-video-gap-1s\">\n                        -1\n                    </Button>\n                </ButtonGroup>\n                <TextField\n                    data-test=\"shift-video-gap\"\n                    sx={{ py: 0, flex: 1 }}\n                    size={'small'}\n                    type=\"text\"\n                    value={current}\n                    onChange={(e) => onChange(+e.target.value)}\n                    label=\"Seconds\"\n                    // helperText={}\n                />\n                <ButtonGroup sx={{ flex: 1 }}>\n                    <Button\n                        sx={{ flex: 1, px: 1.25 }}\n                        onClick={() => onChange(current + 1)}\n                        data-test=\"shift-video-gap+1s\">\n                        +1\n                    </Button>\n                    <Button\n                        sx={{ flex: 1, px: 1.25 }}\n                        onClick={() => onChange(current + 5)}\n                        data-test=\"shift-video-gap+5s\">\n                        +5\n                    </Button>\n                    <Button\n                        sx={{ flex: 1, px: 1.25 }}\n                        onClick={() => onChange(current + 10)}\n                        data-test=\"shift-video-gap+10s\">\n                        +10\n                    </Button>\n                </ButtonGroup>\n            </Box>\n        </Box>\n    );\n}\n","import { NotesSection, Section, Song } from 'interfaces';\nimport getSongBeatLength from 'Songs/utils/getSongBeatLength';\nimport isNotesSection from 'Songs/utils/isNotesSection';\n\nexport const HEADSTART_MS = 1000;\n\nconst shortenNoteSections = (sections: NotesSection[]): NotesSection[] =>\n    sections.map((section) => {\n        if (section.notes.length === 0) {\n            debugger;\n        }\n        return {\n            ...section,\n            start: section.notes[0].start,\n        };\n    });\n\nconst getSectionEnd = (section: NotesSection) => {\n    const lastNote = section.notes.at(-1)!;\n    return lastNote.start + lastNote.length;\n};\n\nconst addPauseSections = (sections: NotesSection[], padSizeBeats = 10): Section[] => {\n    let lastEnd = 0;\n    let sectionsWithPauses: Section[] = [];\n\n    sections.forEach((section) => {\n        const spaceBetweenSections = section.start - lastEnd;\n\n        if (spaceBetweenSections > padSizeBeats) {\n            sectionsWithPauses.push({ type: 'pause', start: lastEnd, end: section.start - padSizeBeats });\n            lastEnd = section.start - padSizeBeats;\n        }\n        sectionsWithPauses.push({ ...section, start: lastEnd });\n        lastEnd = getSectionEnd(section);\n    });\n\n    return sectionsWithPauses;\n};\n\n// Triest its best to add enough headstart to sections so the player can see the lyrics and notes\n// in advance. If possible, will also make the section a bit longer so it doesn't end abruptly\nexport default function normaliseSectionPaddings(song: Song): Song {\n    const beatLength = getSongBeatLength(song);\n    const desiredPadding = Math.round(HEADSTART_MS / beatLength);\n    // const minPadding = Math.round(MIN_HEADSTART_MS / beatLength);\n\n    return {\n        ...song,\n        tracks: song.tracks.map((track) => ({\n            ...track,\n            sections: addPauseSections(shortenNoteSections(track.sections.filter(isNotesSection)), desiredPadding),\n        })),\n    };\n}\n","import { Section, Song } from 'interfaces';\nimport { HEADSTART_MS } from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseSectionPaddings';\nimport getSongBeatLength from 'Songs/utils/getSongBeatLength';\nimport isNotesSection from 'Songs/utils/isNotesSection';\n\nconst shiftSections = (sections: Section[], shiftBeats: number): Section[] =>\n    sections.map((section, index) => {\n        if (isNotesSection(section)) {\n            return {\n                ...section,\n                start: index === 0 ? 0 : Math.max(0, section.start + shiftBeats), // first section might be 0\n                notes: section.notes.map((note) => ({ ...note, start: note.start + shiftBeats })),\n            };\n        } else {\n            return {\n                ...section,\n                start: Math.max(0, section.start + shiftBeats), // first section might be 0\n                end: Math.max(0, section.end + shiftBeats), // first section might be 0\n            };\n        }\n    });\n\nexport default function addHeadstart(song: Song): Song {\n    const beatLength = getSongBeatLength(song);\n    const desiredHeadstart = Math.round(HEADSTART_MS / beatLength);\n    const actualHeadstart = Math.floor(\n        (song.gap - desiredHeadstart * beatLength < 0 ? song.gap : desiredHeadstart * beatLength) / beatLength,\n    );\n\n    const gap = song.gap - actualHeadstart * beatLength;\n\n    return {\n        ...song,\n        gap,\n        tracks: song.tracks.map((track) => ({ ...track, sections: shiftSections(track.sections, actualHeadstart) })),\n    };\n}\n","import { Section, Song } from 'interfaces';\nimport getSongBeatLength from 'Songs/utils/getSongBeatLength';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { getFirstNoteStartFromSections } from 'Songs/utils/notesSelectors';\n\nconst shiftSections = (sections: Section[], shiftBeats: number): Section[] =>\n    sections\n        .map((section, index) => {\n            if (isNotesSection(section)) {\n                return {\n                    ...section,\n                    start: index === 0 ? 0 : Math.max(0, section.start - shiftBeats), // first section might be 0\n                    notes: section.notes.map((note) => ({ ...note, start: note.start - shiftBeats })),\n                };\n            } else {\n                return {\n                    ...section,\n                    start: Math.max(0, section.start - shiftBeats), // first section might be 0\n                    end: Math.max(0, section.end - shiftBeats), // first section might be 0\n                };\n            }\n        })\n        .filter((section) => isNotesSection(section) || section.start - section.end > 0); // clear empty pause sections\n\nexport default function normaliseGap(song: Song): Song {\n    const beatLength = getSongBeatLength(song);\n\n    const earliestTrack = song.tracks.reduce((current, track, index) => {\n        const currentNoteStart = getFirstNoteStartFromSections(song.tracks[current].sections);\n        const thisNoteStart = getFirstNoteStartFromSections(track.sections);\n        return currentNoteStart > thisNoteStart ? index : current;\n    }, 0);\n\n    const firstSection = song.tracks[earliestTrack].sections.find(isNotesSection);\n\n    if (!firstSection) {\n        console.error('There are no notes sections in the song, wat', song.tracks);\n        return song;\n    }\n\n    const shiftBeats = firstSection.start + (firstSection.notes[0].start - firstSection.start);\n\n    const gap = Math.floor(song.gap + shiftBeats * beatLength);\n\n    return {\n        ...song,\n        gap,\n        tracks: song.tracks.map((track) => ({ ...track, sections: shiftSections(track.sections, shiftBeats) })),\n    };\n}\n","import { Note, Song } from 'interfaces';\nimport isNotesSection from 'Songs/utils/isNotesSection';\n\nconst normaliseSpaces = (notes: Note[]): Note[] => {\n    notes.forEach((note, index) => {\n        if (note.lyrics.startsWith(' ')) {\n            note.lyrics = note.lyrics.trim();\n\n            if (index > 0) {\n                notes[index - 1].lyrics = notes[index - 1].lyrics + ' ';\n            }\n        }\n    });\n\n    return notes;\n};\n\nexport default function normaliseLyricSpaces(song: Song) {\n    return {\n        ...song,\n        tracks: song.tracks.map((track) => ({\n            ...track,\n            sections: track.sections.map((section) =>\n                isNotesSection(section)\n                    ? {\n                          ...section,\n                          notes: normaliseSpaces(section.notes),\n                      }\n                    : section,\n            ),\n        })),\n    };\n}\n","import { MutableRefObject, useEffect } from 'react';\nimport YouTube from 'react-youtube';\n\nexport default function usePlayerVolume(playerRef: MutableRefObject<YouTube | null>, volume: number | undefined) {\n    useEffect(() => {\n        playerRef.current?.getInternalPlayer().setVolume(Math.round((volume ?? 0.5) * 100));\n    }, [playerRef, volume]);\n}\n","import { MutableRefObject, useEffect, useState } from 'react';\nimport YouTube from 'react-youtube';\n\n/**\n * For some reason YouTube player would start the song but not change the player state, making the game not\n * start.\n *\n * This hooks \"detects\" that and return the key prop value for <YouTube /> component - if it's UNSTARTED\n * for more than a timeout, a new key will be generated to reload the entire player (and try again).\n */\nfunction useUnstuckOnStartSong(currentStatus: number) {\n    const [playerKey, setPlayerKey] = useState(1);\n    useEffect(() => {\n        if (currentStatus === YouTube.PlayerState.UNSTARTED) {\n            const timeout = setTimeout(() => {\n                setPlayerKey((current) => current + 1);\n            }, 5000 + playerKey * 2500);\n\n            return () => {\n                clearTimeout(timeout);\n            };\n        }\n    });\n\n    return playerKey;\n}\n\n/**\n * For some reason once YouTube player enters BUFFERING state, it gets stuck even when internet is\n * back available. Seeking to some timestamp unstucks it.\n *\n * \"Fix\": If player enters BUFFERING status, wait until internet is available, then go back a couple\n * of seconds of the song to force the player to start playing\n */\nfunction useUnstuckOnBuffering(playerRef: MutableRefObject<YouTube | null>, currentStatus: number) {\n    useEffect(() => {\n        if (currentStatus === YouTube.PlayerState.BUFFERING) {\n            const interval = setInterval(async () => {\n                if (navigator.onLine) {\n                    clearInterval(interval);\n\n                    const seconds = await playerRef.current?.getInternalPlayer().getCurrentTime();\n                    playerRef.current?.getInternalPlayer().seekTo(Math.max(seconds - 2, 0));\n                }\n            }, 500);\n\n            return () => {\n                clearInterval(interval);\n            };\n        }\n    });\n}\n\nexport default function useUnstuckYouTubePlayer(playerRef: MutableRefObject<YouTube | null>, currentStatus: number) {\n    useUnstuckOnBuffering(playerRef, currentStatus);\n\n    return useUnstuckOnStartSong(currentStatus);\n}\n","import usePlayerVolume from 'hooks/usePlayerVolume';\nimport useUnstuckYouTubePlayer from 'hooks/useUnstuckYouTubePlayer';\nimport { seconds } from 'interfaces';\nimport { ForwardedRef, forwardRef, useEffect, useImperativeHandle, useRef, useState } from 'react';\nimport YouTube from 'react-youtube';\n\nexport enum VideoState {\n    UNSTARTED = 'UNSTARTED',\n    ENDED = 'ENDED',\n    PLAYING = 'PLAYING',\n    PAUSED = 'PAUSED',\n    BUFFERING = 'BUFFERING',\n    CUED = 'CUED',\n}\n\nconst stateMap = {\n    [YouTube.PlayerState.UNSTARTED]: VideoState.UNSTARTED,\n    [YouTube.PlayerState.ENDED]: VideoState.ENDED,\n    [YouTube.PlayerState.PLAYING]: VideoState.PLAYING,\n    [YouTube.PlayerState.PAUSED]: VideoState.PAUSED,\n    [YouTube.PlayerState.BUFFERING]: VideoState.BUFFERING,\n    [YouTube.PlayerState.CUED]: VideoState.CUED,\n} as const;\n\ninterface Props {\n    video: string;\n    autoplay?: boolean;\n    controls?: boolean;\n    disablekb?: boolean;\n    volume?: number;\n    startAt?: number;\n    onStateChange: (state: VideoState) => void;\n    width: number;\n    height: number;\n}\n\nexport interface LoadVideByIdOpts {\n    videoId: string;\n    startSeconds: number;\n    endSeconds: number;\n}\n\nexport interface VideoPlayerRef {\n    seekTo: (time: number) => void;\n    setPlaybackSpeed: (speed: number) => void;\n    setVolume: (newVolume: number) => void;\n    getCurrentTime: () => Promise<number>;\n    loadVideoById: (opts: LoadVideByIdOpts) => void;\n    setSize: (w: number, h: number) => void;\n    playVideo: () => void;\n    pauseVideo: () => void;\n    getDuration: () => Promise<number>;\n}\n\nexport default forwardRef(function YoutubeVideoPlayer(\n    { video, autoplay, startAt, controls, disablekb, volume, width, height, onStateChange }: Props,\n    ref: ForwardedRef<VideoPlayerRef>,\n) {\n    const player = useRef<YouTube | null>(null);\n    const [currentStatus, setCurrentStatus] = useState(YouTube.PlayerState.UNSTARTED);\n\n    const playerKey = useUnstuckYouTubePlayer(player, currentStatus);\n    usePlayerVolume(player, volume);\n    useEffect(() => {\n        if (!player.current) {\n            return;\n        }\n\n        player.current.getInternalPlayer().setSize(width, height);\n    }, [player, width, height, video, playerKey]);\n\n    useImperativeHandle(ref, () => ({\n        setSize: (w, h) => player.current?.getInternalPlayer().setSize(w, h),\n        seekTo: (timeSec: seconds) => player.current?.getInternalPlayer().seekTo(timeSec, true),\n        setPlaybackSpeed: (speed: number) => player.current?.getInternalPlayer().setPlaybackRate(speed),\n        setVolume: (newVolume: number) => player.current?.getInternalPlayer().setVolume(newVolume),\n        getCurrentTime: () => player.current?.getInternalPlayer().getCurrentTime(),\n        loadVideoById: (opts) => player.current?.getInternalPlayer().loadVideoById(opts),\n        playVideo: () => player.current?.getInternalPlayer().playVideo(),\n        pauseVideo: () => player.current?.getInternalPlayer().pauseVideo(),\n        getDuration: () => player.current?.getInternalPlayer().getDuration(),\n    }));\n\n    return (\n        <YouTube\n            title=\" \"\n            key={`${video}-${playerKey}`}\n            ref={player}\n            videoId={video}\n            opts={{\n                width: '0',\n                height: '0',\n                playerVars: {\n                    autoplay: autoplay ? 1 : 0,\n                    showinfo: 1,\n                    rel: 0,\n                    fs: 0,\n                    controls: controls ? 1 : 0,\n                    start: startAt ?? 0,\n                    end: 0,\n                    disablekb: disablekb ? 1 : 0,\n                    modestbranding: 1,\n                },\n            }}\n            onStateChange={(e) => {\n                setCurrentStatus(e.data);\n                onStateChange?.(stateMap[e.data]);\n            }}\n        />\n    );\n});\n","import {\n    ComponentProps,\n    ForwardedRef,\n    forwardRef,\n    useEffect,\n    useImperativeHandle,\n    useMemo,\n    useRef,\n    useState,\n} from 'react';\n\nimport Youtube, { VideoPlayerRef, VideoState } from './Youtube';\n\ntype Props = ComponentProps<typeof Youtube>;\n\nexport default forwardRef(function DirectVideoPlayer(\n    { video, autoplay, startAt, controls, disablekb, volume, width, height, onStateChange }: Props,\n    ref: ForwardedRef<VideoPlayerRef>,\n) {\n    const player = useRef<HTMLVideoElement | null>(null);\n    const [size, setSize] = useState({ w: width, h: height });\n    const [status, setStatus] = useState(VideoState.UNSTARTED);\n\n    useEffect(() => {\n        const createCallback = (status: VideoState) => () => setStatus(status);\n        const playerRef = player.current;\n\n        const onPlay = createCallback(VideoState.PLAYING);\n        const onPause = createCallback(VideoState.PAUSED);\n        const onEnded = createCallback(VideoState.ENDED);\n        const onLoadstart = createCallback(VideoState.BUFFERING);\n\n        playerRef?.addEventListener('playing', onPlay);\n        playerRef?.addEventListener('pause', onPause);\n        playerRef?.addEventListener('ended', onEnded);\n        playerRef?.addEventListener('loadstart', onLoadstart);\n\n        return () => {\n            playerRef?.removeEventListener('playing', onPlay);\n            playerRef?.removeEventListener('pause', onPause);\n            playerRef?.removeEventListener('ended', onEnded);\n            playerRef?.removeEventListener('loadstart', onLoadstart);\n        };\n    }, [player.current, setStatus]);\n\n    useEffect(() => {\n        onStateChange?.(status);\n    }, [status, onStateChange]);\n\n    const playerApi = useMemo<VideoPlayerRef>(\n        () => ({\n            setSize: (w, h) => setSize({ w, h }),\n            seekTo: (time: number) => {\n                player.current && (player.current.currentTime = time);\n\n                return time;\n            },\n            setPlaybackSpeed: () => undefined,\n            setVolume: () => undefined,\n            getCurrentTime: () => {\n                return Promise.resolve(player.current?.currentTime ?? 0);\n            },\n            loadVideoById: () => undefined,\n            playVideo: () => player.current?.play(),\n            pauseVideo: () => player.current?.pause(),\n            getDuration: () => Promise.resolve(player.current?.duration ?? 0),\n        }),\n        [player],\n    );\n\n    useEffect(() => {\n        playerApi.setSize(width, height);\n    }, [width, height, playerApi]);\n\n    useEffect(() => {\n        startAt !== undefined && playerApi.seekTo(startAt);\n    }, [startAt, playerApi]);\n\n    useImperativeHandle(ref, () => playerApi);\n\n    return (\n        <video width={size.w} height={size.h} autoPlay={autoplay ?? true} controls={controls} ref={player}>\n            <source src={video} />\n        </video>\n    );\n});\n","export default \"__VITE_ASSET__0d248451__\"","import { ComponentProps, ForwardedRef, forwardRef } from 'react';\n\nimport DirectVideo from 'Elements/VideoPlayer/DirectVideo';\nimport dummyVideo from './dummy.mp4';\nimport Youtube, { VideoPlayerRef } from './Youtube';\n\ntype Props = ComponentProps<typeof Youtube>;\n\nexport default forwardRef(function OfflineVideoPlayer(\n    { video, controls, ...restProps }: Props,\n    ref: ForwardedRef<VideoPlayerRef>,\n) {\n    return <DirectVideo ref={ref} video={dummyVideo} controls {...restProps} />;\n});\n","import { ComponentProps, ForwardedRef, forwardRef } from 'react';\nimport OfflineVideoPlayer from './Offline';\nimport YoutubeVideoPlayer, { VideoPlayerRef } from './Youtube';\nimport 'core-js/es/array/at';\n\nconst VideoPlayer = forwardRef(\n    (props: ComponentProps<typeof YoutubeVideoPlayer>, ref: ForwardedRef<VideoPlayerRef>) => {\n        if (import.meta.env.VITE_REACT_APP_OFFLINE) {\n            return <OfflineVideoPlayer {...props} ref={ref} />;\n        } else {\n            return <YoutubeVideoPlayer {...props} ref={ref} />;\n        }\n    },\n);\n\nexport default VideoPlayer;\n\nexport { VideoState } from './Youtube';\nexport type { VideoPlayerRef } from './Youtube';\n","import styled from '@emotion/styled';\nimport { MenuButton, MenuContainer } from 'Elements/Menu';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { useEffect, useRef } from 'react';\n\ninterface Props {\n    onResume: () => void;\n    onExit: () => void;\n    onRestart: () => void;\n}\n\nexport default function PauseMenu({ onResume, onExit, onRestart }: Props) {\n    const menuRef = useRef<null | HTMLButtonElement>(null);\n\n    useEffect(() => {\n        menuRef.current?.focus();\n    }, [menuRef]);\n\n    const { register } = useKeyboardNav();\n\n    return (\n        <Container>\n            <MenuContainer>\n                <MenuButton {...register('resume', onResume)} ref={menuRef} data-test=\"button-resume-song\">\n                    Resume song\n                </MenuButton>\n                <MenuButton {...register('restart', onRestart)} data-test=\"button-restart-song\">\n                    Restart song\n                </MenuButton>\n                <MenuButton {...register('exit', onExit)} data-test=\"button-exit-song\">\n                    Exit song\n                </MenuButton>\n            </MenuContainer>\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    position: absolute;\n    z-index: 10;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n\n    display: flex;\n\n    align-items: center;\n    justify-content: center;\n`;\n","import { Song, SongPreview } from 'interfaces';\nimport beatToMs from 'Scenes/Game/Singing/GameState/Helpers/beatToMs';\nimport { getFirstNoteStartFromSections } from 'Songs/utils/notesSelectors';\n\nexport default function getSongFirstNoteMs(song: Song | SongPreview): number {\n    const firstNote = Math.min(\n        ...song.tracks.map((track) =>\n            'sections' in track ? getFirstNoteStartFromSections(track.sections) : track.start,\n        ),\n    );\n    return beatToMs(firstNote, song) + song.gap;\n}\n","import { seconds, Song, SongPreview } from 'interfaces';\nimport getSongFirstNoteMs from 'Songs/utils/getSongFirstNoteMs';\nimport isDev from 'utils/isDev';\nimport isE2E from 'utils/isE2E';\n\nexport const SKIP_INTRO_MS = isDev() || isE2E() ? 1_000 : 8_000;\n\nexport default function getSkipIntroTime(song: Song | SongPreview): seconds {\n    return Math.floor((getSongFirstNoteMs(song) - SKIP_INTRO_MS) / 1000);\n}\n","import { Song, SongPreview } from 'interfaces';\nimport getSongFirstNoteMs from 'Songs/utils/getSongFirstNoteMs';\n\nconst SKIP_INTRO_THRESHOLD_MS = 20_000;\n\nexport default function songHasLongIntro(song: Song | SongPreview) {\n    const lyricStartMs = getSongFirstNoteMs(song);\n\n    return lyricStartMs - (song.videoGap ?? 0) * 1000 > SKIP_INTRO_THRESHOLD_MS;\n}\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport { VideoPlayerRef } from 'Elements/VideoPlayer';\nimport posthog from 'posthog-js';\nimport { useMemo } from 'react';\nimport GameState from 'Scenes/Game/Singing/GameState/GameState';\nimport getSongFirstNoteMs from 'Songs/utils/getSongFirstNoteMs';\nimport getSkipIntroTime, { SKIP_INTRO_MS } from 'Songs/utils/getSkipIntroTime';\nimport songHasLongIntro from 'utils/songHasLongIntro';\nimport useKeyboard from 'hooks/useKeyboard';\nimport useKeyboardHelp from 'hooks/useKeyboardHelp';\n\ninterface Props {\n    playerRef: VideoPlayerRef | null;\n    isEnabled: boolean;\n}\n\nfunction SkipIntro({ playerRef, isEnabled }: Props) {\n    const song = GameState.getSong()!;\n    const hasLongIntro = useMemo(() => songHasLongIntro(song), [song]);\n    const songFirstNoteMs = useMemo(() => getSongFirstNoteMs(song), [song]);\n    const shouldBeVisible = GameState.getCurrentTime(false) < songFirstNoteMs - SKIP_INTRO_MS * 1.2;\n\n    const canSkip = isEnabled && shouldBeVisible && hasLongIntro;\n\n    const skipIntro = () => {\n        playerRef?.seekTo(getSkipIntroTime(song));\n\n        const { artist, title } = GameState.getSong()!;\n        posthog.capture('introSkipped', { name: `${artist} - ${title}`, artist, title });\n    };\n    useKeyboard({ onEnter: skipIntro }, canSkip);\n\n    const help = useMemo(\n        () => ({\n            accept: 'Skip Intro',\n            back: 'Pause Menu',\n        }),\n        [],\n    );\n    useKeyboardHelp(help, canSkip);\n\n    return canSkip ? (\n        <Container visible={canSkip} data-test=\"skip-intro-info\">\n            Press <Kbd>Enter</Kbd> to skip the intro\n        </Container>\n    ) : null;\n}\n\nconst Container = styled.div<{ visible: boolean }>`\n    ${typography};\n    pointer-events: none;\n    position: fixed;\n    bottom: 29rem;\n    transform: scale(${(props) => (props.visible ? 1 : 0)});\n    opacity: ${(props) => (props.visible ? 1 : 0)};\n    text-align: center;\n    font-size: 5rem;\n    text-shadow: 0 0 3.5rem black;\n    width: 100%;\n    z-index: 4;\n    padding: 0.5rem;\n    transition: ease 500ms;\n    //-webkit-text-stroke: thin black;\n`;\n\nconst Kbd = styled.kbd<{ disabled?: boolean }>`\n    margin: 0.2rem;\n    padding: 0.2rem 2rem;\n    border-radius: 1.3rem;\n    border: 0.5rem solid rgb(204, 204, 204);\n    border-bottom-color: rgb(150, 150, 150);\n    border-right-color: rgb(150, 150, 150);\n    line-height: 1.4;\n    display: inline-block;\n    background-color: rgb(247, 247, 247);\n    text-shadow: 0 1rem 0 #fff;\n\n    opacity: ${(props) => (props.disabled ? 0.25 : 1)};\n`;\n\nexport default SkipIntro;\n","import { useEffect, useState } from 'react';\n\n// Hook\nexport default function useDebounce<T>(value: T, delay: number) {\n    // State and setters for debounced value\n    const [debouncedValue, setDebouncedValue] = useState(value);\n    useEffect(\n        () => {\n            // Update debounced value after delay\n            const handler = setTimeout(() => {\n                setDebouncedValue(value);\n            }, delay);\n            // Cancel the timeout if value changes (also on delay change or unmount)\n            // This is how we prevent debounced value from updating if value is changed ...\n            // .. within the delay period. Timeout gets cleared and restarted.\n            return () => {\n                clearTimeout(handler);\n            };\n        },\n        [value, delay], // Only re-call effect if value or delay changes\n    );\n    return debouncedValue;\n}\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport useDebounce from 'hooks/useDebounce';\nimport posthog from 'posthog-js';\nimport React, { useMemo, useState } from 'react';\nimport { useInterval } from 'react-use';\nimport GameState from 'Scenes/Game/Singing/GameState/GameState';\nimport beatToMs from 'Scenes/Game/Singing/GameState/Helpers/beatToMs';\nimport { getLastNoteEnd } from 'Songs/utils/notesSelectors';\nimport useKeyboard from 'hooks/useKeyboard';\nimport useKeyboardHelp from 'hooks/useKeyboardHelp';\n\ninterface Props {\n    onSongEnd: () => void;\n    isEnabled: boolean;\n}\n\nconst SHOW_OUTRO_THRESHOLD_MS = 15_000;\n\nfunction SkipOutro({ onSongEnd, isEnabled }: Props) {\n    const duration = GameState.getDuration();\n\n    const singingEndBeat = useMemo(\n        () => Math.max(...GameState.getPlayers().map((player) => getLastNoteEnd(player.getLastNotesSection()))),\n        [],\n    );\n\n    const canSkip = useMemo(() => {\n        const singingEndTime = beatToMs(singingEndBeat, GameState.getSong()!);\n\n        return isEnabled && duration * 1000 > singingEndTime + SHOW_OUTRO_THRESHOLD_MS;\n    }, [duration, singingEndBeat, isEnabled]);\n\n    const [currentBeat, setCurrentBeat] = useState(0);\n    const [skipping, setSkipping] = useState(false);\n\n    useInterval(() => setCurrentBeat(GameState.getCurrentBeat()), 1_000);\n\n    const shouldBeVisible = useDebounce(canSkip && currentBeat > singingEndBeat, 5_000) && !skipping;\n\n    const skipOutro = () => {\n        setSkipping(true);\n        setTimeout(onSongEnd, 700);\n\n        const { artist, title } = GameState.getSong()!;\n        posthog.capture('outroSkipped', { name: `${artist} - ${title}`, artist, title });\n    };\n    useKeyboard({ onEnter: skipOutro }, shouldBeVisible);\n\n    const help = useMemo(\n        () => ({\n            accept: 'Skip Outro',\n            back: 'Pause Menu',\n        }),\n        [],\n    );\n    useKeyboardHelp(help, shouldBeVisible);\n\n    return canSkip ? (\n        <Container visible={shouldBeVisible}>\n            Press <Kbd>Enter</Kbd> to skip the outro\n        </Container>\n    ) : null;\n}\n\nconst Container = styled.div<{ visible: boolean }>`\n    ${typography};\n    pointer-events: none;\n    position: fixed;\n    bottom: 29rem;\n    transform: scale(${(props) => (props.visible ? 1 : 0)});\n    opacity: ${(props) => (props.visible ? 1 : 0)};\n    text-align: center;\n    font-size: 5rem;\n    text-shadow: 0 0 3.5rem black;\n    width: 100%;\n    z-index: 4;\n    padding: 0.5rem;\n    transition: ease 500ms;\n    //-webkit-text-stroke: thin black;\n`;\n\nconst Kbd = styled.kbd<{ disabled?: boolean }>`\n    margin: 0.2rem;\n    padding: 0.2rem 2rem;\n    border-radius: 1.3rem;\n    border: 0.5rem solid rgb(204, 204, 204);\n    border-bottom-color: rgb(150, 150, 150);\n    border-right-color: rgb(150, 150, 150);\n    line-height: 1.4;\n    display: inline-block;\n    background-color: rgb(247, 247, 247);\n    text-shadow: 0 1rem 0 #fff;\n\n    opacity: ${(props) => (props.disabled ? 0.25 : 1)};\n`;\n\nexport default React.memo(SkipOutro);\n","import styled from '@emotion/styled';\nimport { PlayerSetup } from 'interfaces';\nimport { uniq } from 'lodash-es';\nimport { useMemo } from 'react';\nimport GameState from '../../GameState/GameState';\nimport { getFirstNoteStartFromSections, getLastNoteEndFromSections } from 'Songs/utils/notesSelectors';\nimport styles from '../Drawing/styles';\n\ninterface Props {\n    players: PlayerSetup[];\n}\n\nfunction DurationBar({ players }: Props) {\n    const currentTime = GameState.getCurrentTime(false);\n    const beatLength = GameState.getSongBeatLength();\n    const duration = GameState.getDuration();\n    const song = GameState.getSong()!;\n\n    const firstNotes = useMemo(\n        () =>\n            uniq(\n                song.tracks\n                    .filter((v, index) => players.find((player) => player.track === index))\n                    .map(({ sections }) => getFirstNoteStartFromSections(sections) * beatLength + song.gap),\n            ),\n        [song, beatLength, players],\n    );\n    const lastNotes = useMemo(\n        () =>\n            uniq(\n                song.tracks\n                    .filter((v, index) => players.find((player) => player.track === index))\n                    .map(({ sections }) => getLastNoteEndFromSections(sections) * beatLength + song.gap),\n            ),\n        [song, beatLength, players],\n    );\n\n    const durationMs = duration * 1000;\n\n    if (!currentTime || !duration) return null;\n\n    return (\n        <Bar>\n            {firstNotes.map((note) => (\n                <Marker key={note} position={note / durationMs} />\n            ))}\n            {lastNotes.map((note) => (\n                <Marker key={note} position={note / durationMs} />\n            ))}\n            <BarFill fill={currentTime / durationMs} />\n        </Bar>\n    );\n}\n\nconst Bar = styled.div`\n    position: absolute;\n    height: 0.6rem;\n    width: 100%;\n    background: rgba(0, 0, 0, 0.5);\n    left: 0;\n    top: calc(50% - 0.3rem);\n`;\n\nconst BaseMarker = styled(Bar)`\n    top: 0;\n    margin-left: -0.25rem;\n    width: 0.5rem;\n    background: ${styles.colors.text.active};\n    opacity: 75%;\n`;\n\nconst Marker = (props: { position: number }) => (\n    <BaseMarker style={{ left: `${Math.min(props.position * 100, 100)}%` }} />\n);\n\nconst BaseBarFill = styled(Bar)`\n    top: 0;\n    background: white;\n    opacity: 50%;\n`;\n\nconst BarFill = (props: { fill: number }) => (\n    <BaseBarFill style={{ width: `${Math.round(props.fill * 10_000) / 100}%` }} />\n);\n\nexport default DurationBar;\n","import styled from '@emotion/styled';\nimport SwapHorizIcon from '@mui/icons-material/SwapHoriz';\nimport { Note } from 'interfaces';\nimport { ComponentProps, Fragment, PropsWithChildren } from 'react';\nimport GameState from '../../GameState/GameState';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { getFirstNoteStartFromSections } from 'Songs/utils/notesSelectors';\nimport styles from '../Drawing/styles';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\n\ninterface Props {\n    player: number;\n    bottom?: boolean;\n    playerChanges: number[][];\n    effectsEnabled: boolean;\n}\n\nfunction Lyrics({ player, playerChanges, bottom = false, effectsEnabled }: Props) {\n    const playerColor = styles.colors.players[player].text;\n    const thisPlayerChanges = playerChanges[GameState.getPlayer(player).getTrackIndex()] ?? [];\n    const section = GameState.getPlayer(player).getCurrentSection();\n    const nextSection = GameState.getPlayer(player).getNextSection();\n    const subsequentSection = GameState.getPlayer(player).getNextSection(2);\n    const currentBeat = GameState.getCurrentBeat();\n    const beatLength = GameState.getSongBeatLength();\n\n    const previousChange = Math.max(0, ...thisPlayerChanges.filter((beat) => beat <= section?.start ?? -Infinity));\n    const nextChange = thisPlayerChanges.find((beat) => beat > section?.start ?? Infinity) ?? Infinity;\n    const timeToNextChange = (nextChange - currentBeat) * beatLength;\n\n    const passTheMicProgress = (nextChange - currentBeat) / (nextChange - previousChange);\n\n    const shouldBlink = timeToNextChange < 2500;\n\n    const hasNotes = isNotesSection(section);\n\n    const beatsBetweenSectionAndNote = hasNotes ? getFirstNoteStartFromSections([section]) - section.start : 0;\n\n    const playerVolume = InputManager.getPlayerVolume(player);\n\n    return (\n        <LyricsContainer shouldBlink={shouldBlink} bottom={bottom}>\n            <VolumeIndicator color={playerColor} volume={playerVolume} />\n            {timeToNextChange < Infinity && (\n                <PassTheMicProgress\n                    color={playerColor}\n                    progress={passTheMicProgress <= 1 ? passTheMicProgress * 100 : 0}\n                />\n            )}\n            {hasNotes ? (\n                <>\n                    <LyricsLine data-test={`lyrics-current-player-${player + 1}`} effectsEnabled={effectsEnabled}>\n                        <HeadstartContainer>\n                            <Headstart\n                                color={playerColor}\n                                percent={Math.min(2, (currentBeat - section.start) / beatsBetweenSectionAndNote)}\n                            />\n                        </HeadstartContainer>\n                        {section?.notes.map((note) => {\n                            const fill = effectsEnabled\n                                ? Math.max(0, Math.min(2, (currentBeat - note.start) / note.length))\n                                : currentBeat >= note.start\n                                ? 1\n                                : 0;\n                            return (\n                                <LyricContainer type={note.type} key={note.start}>\n                                    <LyricActiveContainer>\n                                        <LyricActive fill={fill} color={playerColor}>\n                                            {note.lyrics.trim()}\n                                        </LyricActive>\n                                        {note.lyrics.endsWith(' ') && ' '}\n                                    </LyricActiveContainer>\n                                    {note.lyrics}\n                                </LyricContainer>\n                            );\n                        })}\n                        {nextSection?.start === nextChange && <PassTheMicSymbol shouldShake />}\n                    </LyricsLine>\n                </>\n            ) : (\n                <LyricsLine effectsEnabled={effectsEnabled}>&nbsp;</LyricsLine>\n            )}\n            {isNotesSection(nextSection) ? (\n                <LyricsLine nextLine data-test={`lyrics-next-player-${player + 1}`} effectsEnabled={effectsEnabled}>\n                    {nextSection.notes.map((note) => (\n                        <Fragment key={note.start}>{note.lyrics}</Fragment>\n                    ))}\n                    {subsequentSection?.start === nextChange && <PassTheMicSymbol />}\n                </LyricsLine>\n            ) : (\n                <LyricsLine effectsEnabled={effectsEnabled} nextLine>\n                    &nbsp;\n                </LyricsLine>\n            )}\n        </LyricsContainer>\n    );\n}\n\nconst HeadstartContainer = styled.span`\n    position: relative;\n    height: 0;\n`;\n\nconst BaseHeadstart = styled.span`\n    position: absolute;\n    width: 15rem;\n    height: 3.1rem;\n    margin: 0.7rem 0;\n    right: 10rem;\n`;\n\nconst Headstart = ({ percent, color }: { percent: number; color: string }) => (\n    <BaseHeadstart\n        style={{\n            transformOrigin: 'right',\n            transform: `scaleX(${Math.min(1, 2 - percent)})`,\n            right: `${Math.max(0, 1 - percent) * 15}rem`,\n            background: `linear-gradient(270deg, rgba(${color}, 1) 0%, rgba(${color}, 0.5) 25%, rgba(${color}, 0) 100%)`,\n        }}\n    />\n);\n\nconst LyricsContainer = styled.div<{ shouldBlink: boolean; bottom: boolean }>`\n    @keyframes blink {\n        100% {\n            background-color: rgba(0, 0, 0, ${(props) => (props.bottom ? '0.85' : '0.5')});\n        }\n        30% {\n            background-color: rgba(0, 0, 0, ${(props) => (props.bottom ? '0.85' : '0.5')});\n        }\n        50% {\n            background-color: rgba(200, 200, 200, ${(props) => (props.bottom ? '0.85' : '0.5')});\n        }\n        30% {\n            background-color: rgba(0, 0, 0, ${(props) => (props.bottom ? '0.85' : '0.5')});\n        }\n        0% {\n            background-color: rgba(0, 0, 0, ${(props) => (props.bottom ? '0.85' : '0.5')});\n        }\n    }\n\n    box-sizing: border-box;\n\n    padding: 1rem;\n    background: rgba(0, 0, 0, ${(props) => (props.bottom ? '0.9' : '0.5')});\n    width: 100%;\n    text-align: center;\n    line-height: 1;\n    margin: 2rem 0;\n    position: relative;\n    ${(props) => (props.shouldBlink ? `animation: blink 350ms ease-in-out infinite both;` : ``)}\n`;\n\nconst LyricContainer = styled.span<{ type: Note['type'] }>`\n    font-style: ${(props) => (props.type === 'freestyle' ? 'italic' : 'normal')};\n`;\n\nconst LyricActiveContainer = styled.span`\n    position: absolute;\n    z-index: 1;\n`;\nconst BaseLyricActive = styled.span``;\n\nconst LyricActive = ({ fill, color, children }: PropsWithChildren<{ fill: number; color: string }>) => (\n    <BaseLyricActive\n        style={{\n            clipPath: `inset(0 ${(1 - (fill === 0 ? 0 : fill + 0.05)) * 100}% -5rem 0)`,\n            color: `rgb(${color})`,\n        }}>\n        {children}\n    </BaseLyricActive>\n);\n\nconst VolumeIndicatorBase = styled.div<{ color: string }>`\n    background: linear-gradient(270deg, rgba(${(props) => props.color}, 1) 0%, rgba(${(props) => props.color}, 0) 100%);\n    width: 20rem;\n    height: 100%;\n    position: absolute;\n    right: 0;\n    top: 0;\n    background-repeat: repeat-y;\n    overflow: visible;\n`;\n\nconst VolumeIndicator = ({ volume, ...rest }: PropsWithChildren<{ color: string; volume: number }>) => (\n    <VolumeIndicatorBase {...rest} style={{ backgroundPositionX: `${(1 - Math.min(1, volume * 15)) * 20}rem` }} />\n);\n\nconst BasePassTheMicProgress = styled.div<{ color: string }>`\n    position: absolute;\n    height: 1rem;\n    background: rgb(${(props) => props.color});\n    width: 100%;\n`;\n\nconst PassTheMicProgress = (props: { progress: number } & ComponentProps<typeof BasePassTheMicProgress>) => (\n    <BasePassTheMicProgress\n        style={{\n            transformOrigin: 'left',\n            transform: `scaleX(${props.progress / 100})`,\n        }}\n        color={props.color}\n    />\n);\n\nconst PassTheMicSymbol = styled(SwapHorizIcon, { shouldForwardProp: (prop) => prop !== 'shouldShake' })<{\n    shouldShake?: boolean;\n}>`\n    @keyframes shake {\n        10%,\n        90% {\n            transform: translate3d(-0.1rem, 0, 0);\n        }\n\n        20%,\n        80% {\n            transform: translate3d(0.2rem, 0, 0);\n        }\n\n        30%,\n        50%,\n        70% {\n            transform: translate3d(-0.4rem, 0, 0);\n        }\n\n        40%,\n        60% {\n            transform: translate3d(0.4rem, 0, 0);\n        }\n    }\n\n    ${(props) => props.shouldShake && 'animation: shake 0.92s cubic-bezier(0.36, 0.07, 0.19, 0.97) both infinite;'}\n    margin-left: 2rem;\n    ${(props) => (props.shouldShake ? `fill: ${styles.colors.text.active};` : '')}\n    font-size: ${(props) => (props.shouldShake ? 4 : 3)}rem;\n`;\nconst LyricsLine = styled.div<{ nextLine?: boolean; effectsEnabled: boolean }>`\n    font-size: ${({ nextLine, effectsEnabled }) => (effectsEnabled ? 3.5 + (nextLine ? 0 : 1) : 2)}rem;\n    height: ${({ effectsEnabled }) => (effectsEnabled ? 4.5 : 2)}rem;\n    ${({ effectsEnabled }) => (!effectsEnabled ? '-webkit-text-stroke-width: 2px' : '')};\n\n    color: ${({ nextLine }) => (nextLine ? styles.colors.text.inactive : styles.colors.text.default)};\n\n    font-family: 'Comic Sans MS', 'Comic Sans';\n    z-index: 10;\n`;\n\nexport default Lyrics;\n","interface Props {\n    score: number;\n}\n\nconst formatter = new Intl.NumberFormat(undefined, { maximumFractionDigits: 0 });\n\nexport default function ScoreText({ score }: Props) {\n    return <>{formatter.format(score)}</>;\n}\n","import { PlayerNote } from 'interfaces';\nimport styles from '../../styles';\n\nexport function getColor(\n    ctx: CanvasRenderingContext2D,\n    playerNumber: number,\n    isStar: boolean,\n    isHit: boolean,\n    isPerfect: boolean,\n) {\n    if (isPerfect && isStar) {\n        return styles.colors.players[playerNumber].starPerfect;\n    } else if (isPerfect) {\n        return styles.colors.players[playerNumber].perfect;\n    } else if (isStar && isHit) {\n        return styles.colors.players[playerNumber].star;\n    } else if (isHit) {\n        return styles.colors.players[playerNumber].hit;\n    } else {\n        return styles.colors.players[playerNumber].miss;\n    }\n}\n\nexport default function getNoteColor(\n    ctx: CanvasRenderingContext2D,\n    playerNumber: number,\n    isHit: boolean,\n    playerNote: PlayerNote,\n) {\n    return getColor(ctx, playerNumber, playerNote.note.type === 'star', isHit, playerNote.isPerfect);\n}\n","export default function triangle(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    angle: number,\n    color: string | CanvasGradient | CanvasPattern,\n    alpha: number = 1,\n) {\n    ctx.save();\n\n    // move to the center of the canvas\n    const finalX = x - width / 2;\n    const finalY = y - height / 2;\n\n    ctx.translate(finalX, finalY);\n\n    // rotate the canvas to the specified degrees\n    ctx.rotate((angle * Math.PI) / 180);\n\n    ctx.globalAlpha = alpha;\n    ctx.fillStyle = color;\n    ctx.beginPath();\n    ctx.moveTo(0 - width / 2, height / 2);\n    ctx.lineTo(width / 2, height / 2);\n    ctx.lineTo(width / 2, 0);\n    ctx.lineTo(width / 2, 0 - height / 2);\n    ctx.fill();\n    ctx.globalAlpha = 1;\n    ctx.restore();\n}\n","const spreadValue = (initial: number, spread: number) => initial - spread + Math.random() * spread * 2;\n\nexport default spreadValue;\n\nexport const randomSign = () => Math.sign(Math.random() - 0.5);\n","import triangle from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/triangle';\nimport spreadValue from 'Scenes/Game/Singing/GameOverlay/Drawing/Particles/utils';\nimport Particle from '../interfaces';\n\nconst baseTtlMs = 300;\nconst ttlSpreadMs = 50;\n\nconst velocityModifier = 1.3;\n\nexport default class SungTriangle implements Particle {\n    public finished = false;\n\n    private ttl;\n    private startingTtl;\n    private velocityX;\n    private velocityY;\n    private width;\n    private initialAngle;\n    private heightModifier;\n\n    constructor(private x: number, private y: number, private color: string) {\n        this.startingTtl = this.ttl = spreadValue(baseTtlMs, ttlSpreadMs);\n        this.velocityX = velocityModifier * Math.random() - velocityModifier / 2;\n        this.velocityY = velocityModifier * Math.random() - velocityModifier / 2;\n        this.width = 25;\n        this.initialAngle = 180 - Math.random() * 360;\n        this.heightModifier = 0.5 + Math.random() / 2;\n    }\n    public tick = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement, delta: number) => {\n        const percentage = 1 - this.ttl / this.startingTtl;\n        const ticksLeft = this.ttl;\n\n        const width = this.width * percentage;\n        const height = this.width * this.heightModifier * percentage;\n\n        const x = this.x - width / 2 + ticksLeft * this.velocityX;\n        const y = this.y + height / 2 + ticksLeft * this.velocityY;\n\n        triangle(ctx, x, y, width, height, this.initialAngle + ticksLeft, this.color, 0.7 * percentage);\n\n        this.ttl = this.ttl - delta;\n        this.finished = this.ttl <= 0;\n    };\n}\n","export const randomFloat = (from: number, to: number) => {\n    return from + Math.random() * (to - from);\n};\n\nexport const randomInt = (from: number, to: number) => Math.round(randomFloat(from, to));\n","import { FrequencyRecord, PlayerNote, Section, Song } from 'interfaces';\nimport isNotesSection from 'Songs/utils/isNotesSection';\n\nexport const pitchPadding = 6;\n\nexport const NOTE_HEIGHT = 30;\nexport const BIG_NOTE_HEIGHT = NOTE_HEIGHT + 6;\n\nexport default function calculateData({\n    canvas,\n    currentSectionIndex,\n    song,\n    songBeatLength,\n    minPitch,\n    maxPitch,\n    track,\n    paddingVertical,\n}: DrawingData) {\n    const sections = song.tracks[track].sections;\n    const currentSection = sections[currentSectionIndex];\n    const nextSection = sections[currentSectionIndex + 1];\n\n    // If the ratio is higher than 16/9 (e.g. 21/9), pad the excess horizontal space\n    // so in the end the notes are drawn over the same area as it would be on 16/9\n    const pixelsOverRatio = Math.max(0, (canvas.width - canvas.height * (16 / 9)) / 2);\n\n    const paddingHorizontal = 10 + (canvas.width - 2 * pixelsOverRatio) * 0.15 + pixelsOverRatio;\n    const lastNote = isNotesSection(currentSection) ? currentSection?.notes?.at(-1) : undefined;\n    const sectionEndBeat = isNotesSection(currentSection)\n        ? nextSection?.start ?? lastNote!.start + lastNote!.length\n        : currentSection.end;\n    const timeSectionGap = currentSection.start * songBeatLength;\n    const maxTime = (sectionEndBeat - currentSection.start) * songBeatLength;\n\n    const canvasHeight = canvas.height - 2 * paddingVertical;\n\n    const pitchStepHeight = (canvasHeight / 2 - 20 - NOTE_HEIGHT) / (maxPitch - minPitch + pitchPadding * 2);\n\n    return {\n        canvasHeight,\n        paddingHorizontal,\n        currentSection,\n        sectionEndBeat,\n        timeSectionGap,\n        maxTime,\n        pitchStepHeight,\n    };\n}\n\nexport interface DrawingData {\n    playerNumber: number;\n    song: Song;\n    songBeatLength: number;\n    minPitch: number;\n    maxPitch: number;\n    canvas: HTMLCanvasElement;\n    currentTime: number;\n    currentSectionIndex: number;\n    frequencies: FrequencyRecord[];\n    playerNotes: PlayerNote[];\n    currentPlayerNotes: PlayerNote[];\n    track: number;\n\n    currentBeat: number;\n    paddingVertical: number;\n    currentSection: Section;\n}\n","export default function applyColor(\n    ctx: CanvasRenderingContext2D,\n    style: { fill: string; stroke: string; lineWidth: number },\n) {\n    ctx.fillStyle = style.fill;\n    ctx.strokeStyle = style.stroke;\n    ctx.lineWidth = style.lineWidth;\n}\n","function simpleRoundRect(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    radius: number,\n    fill: boolean,\n    stroke: boolean,\n) {\n    const actualWidth = Math.max(width, height / 2);\n    const actualRadius = Math.min(actualWidth / 2, height / 2, radius);\n\n    ctx.beginPath();\n    ctx.moveTo(x + actualRadius, y);\n    ctx.lineTo(x + actualWidth - actualRadius, y);\n    ctx.quadraticCurveTo(x + actualWidth, y, x + actualWidth, y + actualRadius);\n    ctx.lineTo(x + actualWidth, y + height - actualRadius);\n    ctx.quadraticCurveTo(x + actualWidth, y + height, x + actualWidth - actualRadius, y + height);\n    ctx.lineTo(x + actualRadius, y + height);\n    ctx.quadraticCurveTo(x, y + height, x, y + height - actualRadius);\n    ctx.lineTo(x, y + actualRadius);\n    ctx.quadraticCurveTo(x, y, x + actualRadius, y);\n    ctx.closePath();\n    if (fill) {\n        ctx.fill();\n    }\n    if (stroke) {\n        ctx.stroke();\n    }\n}\n\nexport default function roundRect(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    radius: number,\n    fill: boolean,\n    stroke: boolean,\n    glass = 0.1,\n) {\n    simpleRoundRect(ctx, x, y, width, height, radius, fill, stroke);\n\n    if (fill && glass > 0) {\n        ctx.save();\n        simpleRoundRect(ctx, x, y, width, height, radius, false, false);\n        ctx.clip();\n\n        ctx.fillStyle = `rgba(255,255,255,${glass})`;\n        ctx.fillRect(x, y, width, height / 2.2);\n\n        ctx.restore();\n    }\n}\n","import { Note } from 'interfaces';\nimport applyColor from 'Scenes/Game/Singing/GameOverlay/Drawing/applyColor';\nimport roundRect from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/roundRect';\nimport styles from '../../../styles';\n\nexport default function drawRawNote(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    noteType: Note['type'],\n) {\n    if (noteType === 'star') {\n        applyColor(ctx, styles.colors.lines.star);\n    } else if (noteType === 'freestyle' || noteType === 'rap') {\n        applyColor(ctx, styles.colors.lines.freestyle);\n    } else {\n        applyColor(ctx, styles.colors.lines.normal);\n    }\n\n    ctx.shadowBlur = 10;\n    ctx.shadowColor = 'rgb(31,31,31)';\n    ctx.shadowOffsetX = 0;\n    ctx.shadowOffsetY = 0;\n    roundRect(ctx!, x, y, width, height, 100, true, true, 0.075);\n\n    ctx.shadowBlur = 0;\n    ctx.shadowOffsetX = 0;\n    ctx.shadowOffsetY = 0;\n}\n","import applyColor from 'Scenes/Game/Singing/GameOverlay/Drawing/applyColor';\nimport roundRect from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/roundRect';\nimport * as test from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/utils/getNoteColor';\n\nexport default function drawRawPlayerNote(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    playerNumber: number,\n    isHit: boolean,\n    isPerfect: boolean,\n    isStar: boolean,\n) {\n    applyColor(ctx, test.getColor(ctx, playerNumber, isStar, isHit, isPerfect));\n\n    ctx.shadowBlur = 5;\n    ctx.shadowColor = 'rgba(31,31,31, .7)';\n    ctx.shadowOffsetX = 1;\n    ctx.shadowOffsetY = 1;\n    roundRect(ctx!, x, y, width, height, 100, true, true, isHit ? 0.15 : 0);\n    ctx.shadowBlur = 0;\n    ctx.shadowOffsetX = 0;\n    ctx.shadowOffsetY = 0;\n}\n","import { BIG_NOTE_HEIGHT, NOTE_HEIGHT } from 'Scenes/Game/Singing/GameOverlay/Drawing/calculateData';\nimport drawRawNote from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/Elements/note';\nimport drawRawPlayerNote from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/Elements/playerNote';\n\nconst SHADOW_PAD = 10;\n\nexport const smallNoteFragments = {\n    start: { x: 0, y: 0, w: NOTE_HEIGHT / 2 + SHADOW_PAD, h: NOTE_HEIGHT + SHADOW_PAD * 2 },\n    middle: { x: NOTE_HEIGHT / 2 + SHADOW_PAD, y: 0, w: 1, h: NOTE_HEIGHT + SHADOW_PAD * 2 },\n    end: {\n        x: NOTE_HEIGHT / 2 + 1 + SHADOW_PAD,\n        y: 0,\n        w: NOTE_HEIGHT / 2 + SHADOW_PAD,\n        h: NOTE_HEIGHT + SHADOW_PAD * 2,\n    },\n};\nexport const bigNoteFragments = {\n    start: { x: 0, y: 0, w: BIG_NOTE_HEIGHT / 2 + SHADOW_PAD, h: BIG_NOTE_HEIGHT + SHADOW_PAD * 2 },\n    middle: { x: BIG_NOTE_HEIGHT / 2 + SHADOW_PAD, y: 0, w: 1, h: BIG_NOTE_HEIGHT + SHADOW_PAD * 2 },\n    end: {\n        x: BIG_NOTE_HEIGHT / 2 + 1 + SHADOW_PAD,\n        y: 0,\n        w: BIG_NOTE_HEIGHT / 2 + SHADOW_PAD,\n        h: BIG_NOTE_HEIGHT + SHADOW_PAD * 2,\n    },\n};\n\nconst spriteMap = {\n    blueMiss: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 0, false, false, false),\n        width: NOTE_HEIGHT + 1,\n        height: NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: smallNoteFragments,\n    },\n    blueHit: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 0, true, false, false),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    bluePerfect: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 0, true, true, false),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    blueStarMiss: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 0, false, false, true),\n        width: NOTE_HEIGHT + 1,\n        height: NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: smallNoteFragments,\n    },\n    blueStarHit: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 0, true, false, true),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    blueStarPerfect: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 0, true, true, true),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    redMiss: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 1, false, false, false),\n        width: NOTE_HEIGHT + 1,\n        height: NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: smallNoteFragments,\n    },\n    redHit: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 1, true, false, false),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    redPerfect: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 1, true, true, false),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    redStarMiss: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 1, false, false, true),\n        width: NOTE_HEIGHT + 1,\n        height: NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: smallNoteFragments,\n    },\n    redStarHit: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 1, true, false, true),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    redStarPerfect: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawPlayerNote(ctx, x, y, w, h, 1, true, true, true),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    noteNormal: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawNote(ctx, x, y, w, h, 'normal'),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    noteStar: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawNote(ctx, x, y, w, h, 'star'),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    noteFreestyle: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawNote(ctx, x, y, w, h, 'freestyle'),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n    noteRap: {\n        draw: (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number) =>\n            drawRawNote(ctx, x, y, w, h, 'rap'),\n        width: BIG_NOTE_HEIGHT + 1,\n        height: BIG_NOTE_HEIGHT,\n        padding: SHADOW_PAD,\n        fragments: bigNoteFragments,\n    },\n};\n\nexport type SpriteNames = keyof typeof spriteMap;\n\nexport default spriteMap;\n","// In tests this function is mocked so it creates node-canvas object\nexport default function createCanvas(w: number, h: number) {\n    const canvas = document.createElement('canvas');\n    canvas.width = w;\n    canvas.height = h;\n\n    return canvas;\n}\n","import { add } from 'lodash-es';\nimport spriteMap, {\n    smallNoteFragments,\n    SpriteNames,\n} from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/spriteMap';\nimport createCanvas from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/utils/createCanvas';\n\nconst maxWidth = Math.max(...Object.values(spriteMap).map((sprite) => sprite.padding * 2 + sprite.width));\nconst height = Object.values(spriteMap)\n    .map((sprite) => sprite.padding * 2 + sprite.height)\n    .reduce(add, 0);\n\nconst cachedCanvas = createCanvas(maxWidth, height);\nconst ctx = cachedCanvas.getContext('2d')!;\n\nlet currentHeight = 0;\nconst positions = Object.entries(spriteMap)\n    .map(([name, sprite]) => {\n        const pads = sprite.padding * 2;\n        const position = { name, x: 0, y: currentHeight, w: sprite.width + pads, h: sprite.height + pads };\n        currentHeight = currentHeight + sprite.height + pads;\n\n        return position;\n    })\n    .reduce(\n        (acc, position) => ({ ...acc, [position.name]: position }),\n        {} as Record<SpriteNames, { x: number; y: number; w: number; h: number }>,\n    );\n\ncurrentHeight = 0;\nObject.entries(spriteMap).forEach(([key, entry]) => {\n    entry.draw(ctx, entry.padding, currentHeight + entry.padding, entry.width, entry.height);\n    currentHeight = currentHeight + entry.padding * 2 + entry.height;\n});\n\nexport const getSprite = (sprite: SpriteNames, fragment: keyof typeof smallNoteFragments) => {\n    return {\n        canvas: cachedCanvas,\n        ctx,\n        x: positions[sprite].x + spriteMap[sprite].fragments[fragment].x,\n        y: positions[sprite].y + spriteMap[sprite].fragments[fragment].y,\n        w: spriteMap[sprite].fragments[fragment].w,\n        h: spriteMap[sprite].fragments[fragment].h,\n        padding: spriteMap[sprite].padding,\n    };\n};\n\nexport const drawSprite = (\n    destCtx: CanvasRenderingContext2D,\n    sprite: SpriteNames,\n    fragment: keyof typeof smallNoteFragments,\n    destX: number,\n    destY: number,\n    destW?: number,\n    destH?: number,\n    paddingWScale = 1,\n    paddingHScale = 1,\n) => {\n    const spriteData = getSprite(sprite, fragment);\n    const { canvas, w, h, y, x, padding } = spriteData;\n    const finalWPadding = padding * paddingWScale;\n    const finalHPadding = padding * paddingHScale;\n\n    destCtx.imageSmoothingEnabled = false;\n    destCtx.drawImage(canvas, x, y, w, h, destX - finalWPadding, destY - finalHPadding, destW ?? w, destH ?? h);\n    destCtx.imageSmoothingEnabled = true;\n\n    return spriteData;\n};\n","import { drawSprite, getSprite } from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/cachedSprites';\nimport { SpriteNames } from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/spriteMap';\n\nexport default function drawSpriteWithStartAndEnd(\n    ctx: CanvasRenderingContext2D,\n    spriteName: SpriteNames,\n    x: number,\n    y: number,\n    width: number,\n) {\n    const startData = getSprite(spriteName, 'start');\n\n    const actualWidth = Math.max(width, (startData.h - startData.padding * 2) / 2);\n\n    const widthScale = Math.min(1, actualWidth / 2 / (startData.w - startData.padding));\n    const endingsWidth = widthScale * startData.w;\n    const endingsSize = endingsWidth - startData.padding * widthScale;\n\n    const middleSize = actualWidth - 2 * endingsSize;\n\n    drawSprite(ctx, spriteName, 'start', x, y, endingsWidth, undefined, widthScale);\n    if (middleSize > 0) {\n        drawSprite(ctx, spriteName, 'middle', x + endingsWidth, y, middleSize, undefined, widthScale);\n    }\n    drawSprite(ctx, spriteName, 'end', x + middleSize + endingsWidth, y, endingsWidth, undefined, widthScale);\n}\n","import { Note } from 'interfaces';\nimport { capitalize } from 'lodash-es';\nimport { SpriteNames } from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/spriteMap';\nimport drawSpriteWithStartAndEnd from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/spriteWithStartAndEnd';\n\nconst getSpriteName = (noteType: Note['type']) => {\n    return `note${capitalize(noteType)}` as SpriteNames;\n};\n\nexport default function drawNote(ctx: CanvasRenderingContext2D, x: number, y: number, width: number, note: Note) {\n    const spriteName = getSpriteName(note.type);\n\n    drawSpriteWithStartAndEnd(ctx, spriteName, x, y, width);\n}\n","import { PlayerNote } from 'interfaces';\nimport roundRect from './roundRect';\n\nexport default function drawPlayerFrequencyTrace(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    playerNote: PlayerNote,\n) {\n    ctx.save();\n    roundRect(ctx, x, y, width, height, 100, false, false);\n    ctx.clip();\n\n    ctx.beginPath();\n    ctx.strokeStyle = 'rgba(255,255,255, .35)';\n    ctx.lineWidth = 3;\n    ctx.lineJoin = 'round';\n\n    ctx.moveTo(x, y + height / 2 - (playerNote.frequencyRecords[0].preciseDistance * height) / 3);\n    for (let i = 1; i < playerNote.frequencyRecords.length; i++) {\n        ctx.lineTo(\n            x + i * (width / (playerNote.frequencyRecords.length - 1)),\n            y + height / 2 - (playerNote.frequencyRecords[i].preciseDistance * height) / 3,\n        );\n    }\n    ctx.stroke();\n    ctx.closePath();\n\n    ctx.restore();\n    ctx.lineJoin = 'miter';\n}\n","import { PlayerNote } from 'interfaces';\nimport { SpriteNames } from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/Cache/spriteMap';\nimport drawSpriteWithStartAndEnd from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/spriteWithStartAndEnd';\n\nconst getSpriteName = (playerNumber: number, isHit: boolean, isPerfect: boolean, isStar: boolean) => {\n    let spriteName = playerNumber === 0 ? 'blue' : 'red';\n    if (isPerfect && isStar) {\n        spriteName = `${spriteName}StarPerfect`;\n    } else if (isPerfect) {\n        spriteName = `${spriteName}Perfect`;\n    } else if (isStar && isHit) {\n        spriteName = `${spriteName}StarHit`;\n    } else if (isHit) {\n        spriteName = `${spriteName}Hit`;\n    } else if (isStar && !isHit) {\n        spriteName = `${spriteName}StarMiss`;\n    } else {\n        spriteName = `${spriteName}Miss`;\n    }\n\n    return spriteName as SpriteNames;\n};\n\nexport default function drawPlayerNote(\n    ctx: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    playerNumber: number,\n    isHit: boolean,\n    playerNote: PlayerNote,\n) {\n    const spriteName = getSpriteName(playerNumber, isHit, playerNote.isPerfect, playerNote.note.type === 'star');\n\n    drawSpriteWithStartAndEnd(ctx, spriteName, x, y, width);\n}\n","import Particle from './interfaces';\n\nclass ParticleManager {\n    private particles: Particle[] = [];\n    private lastTick = Date.now();\n\n    private getTimeDelta = () => {\n        const currentTick = Date.now();\n        const delta = currentTick - this.lastTick;\n        this.lastTick = currentTick;\n\n        return delta;\n    };\n\n    public tick = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement) => {\n        const delta = this.getTimeDelta();\n\n        this.particles.forEach((particle) => particle.tick(ctx, canvas, delta));\n\n        this.particles = this.particles.filter((particle) => !particle.finished);\n    };\n\n    public add = (particle: Particle) => this.particles.push(particle);\n}\n\nexport default new ParticleManager();\n","import triangle from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/triangle';\nimport spreadValue, { randomSign } from 'Scenes/Game/Singing/GameOverlay/Drawing/Particles/utils';\nimport Particle from '../interfaces';\n\nconst baseTtl = (50 / 60) * 1000;\nconst ttlSpread = (25 / 60) * 1000;\n\nconst velocityModifier = 0.3;\n\nexport default class TriangleParticle implements Particle {\n    public finished = false;\n\n    private ttl;\n    private startingTtl;\n    private velocityX;\n    private velocityY;\n    private width;\n    private initialAngle;\n    private heightModifier;\n\n    constructor(private x: number, private y: number, private color: string, private delay: number) {\n        this.startingTtl = this.ttl = spreadValue(baseTtl, ttlSpread);\n        this.velocityX = spreadValue(0.5, velocityModifier) * randomSign();\n        this.velocityY = spreadValue(0.5, velocityModifier) * randomSign();\n        this.width = 25;\n        this.initialAngle = 180 - Math.random() * 360;\n        this.heightModifier = 0.5 + Math.random() / 2;\n    }\n    public tick = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement, delta: number) => {\n        if (this.delay-- > 0) return;\n\n        const percentage = this.ttl / this.startingTtl;\n        const elapsedTicks = this.startingTtl - this.ttl;\n\n        const width = this.width * percentage;\n        const height = this.width * this.heightModifier * percentage;\n\n        const x = this.x - width / 2 + elapsedTicks * this.velocityX;\n        const y = this.y - height / 2 + elapsedTicks * this.velocityY;\n\n        triangle(ctx, x, y, width, height, this.initialAngle + elapsedTicks, this.color, 0.8 * percentage);\n\n        this.ttl = this.ttl - delta;\n        this.finished = this.ttl <= 0;\n    };\n}\n","import { Note } from 'interfaces';\nimport tinycolor from 'tinycolor2';\nimport Particle from '../interfaces';\nimport ParticleManager from '../ParticleManager';\nimport styles from '../styles';\nimport TriangleParticle from './Triangle';\n\nexport default class ExplodingNoteParticle implements Particle {\n    public finished = true;\n\n    constructor(\n        x: number,\n        y: number,\n        width: number,\n        playerNumber: number,\n        note: Note,\n        particleManager: typeof ParticleManager,\n    ) {\n        const color =\n            note.type === 'star'\n                ? styles.colors.players[playerNumber].star.fill\n                : styles.colors.players[playerNumber].perfect.fill;\n\n        const lightColor = tinycolor(color).lighten(15).toRgbString();\n        const darkColor = tinycolor(color).darken(15).toRgbString();\n\n        const density = width / 6;\n        for (let i = 0; i < density; i++) {\n            const rand = Math.random();\n            let finalColor = color;\n            if (rand > 0.66) finalColor = lightColor;\n            else if (rand > 0.33) finalColor = darkColor;\n\n            const finalY = y + 20 * (Math.random() - 0.5);\n\n            particleManager.add(new TriangleParticle(x + i * 5, finalY, finalColor, (density - i) / 10));\n        }\n    }\n    public tick = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement) => {};\n}\n","import { Note } from 'interfaces';\nimport { BIG_NOTE_HEIGHT } from 'Scenes/Game/Singing/GameOverlay/Drawing/calculateData';\nimport drawNote from '../Elements/note';\nimport Particle from '../interfaces';\n\nconst initialTtl = 200;\n\nexport default class FadeoutNote implements Particle {\n    public finished = false;\n    public ttl = initialTtl;\n\n    constructor(private x: number, private y: number, private width: number, private note: Note) {}\n\n    public tick = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement, delta: number) => {\n        const percentage = this.ttl / initialTtl;\n\n        ctx.save();\n        ctx.globalAlpha = percentage;\n        ctx.translate(0, BIG_NOTE_HEIGHT * (1 - percentage));\n\n        drawNote(ctx, this.x, this.y, this.width, this.note);\n\n        ctx.globalAlpha = 1;\n        ctx.restore();\n\n        this.ttl = this.ttl - delta;\n        this.finished = this.ttl <= 0;\n    };\n}\n","export default function loadImage(path: string): Promise<HTMLImageElement> {\n    return new Promise((resolve) => {\n        const image = new Image();\n        image.onload = () => resolve(image);\n        image.src = path;\n    });\n}\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAQAAAC0jZKKAAACPElEQVR4AbXXcW/TMBAF8EtCypa1LCDB9/98ILG1dKNNCOZZT8h6N4562eZTzH8/ni6dfWns4kqtvbMOT2tmv+0XasG/F1aTLFxd5lDcCS8o0tyX58K9bVA9WZe40LNNqLkevrJr1HvrC1vgQoM820/UqQZubQBKWDKjDJjP+wg41/J/eAOQsGb2rWDlvKzMTyEMaJvBIHNpBdswOfhoZ4VL2h3Irc+srSiJPYv9B1Mr3IHcCS2ZJTFf2+RZ1NEWD5PF7mmQ/nfs85I9klb4KrNCa2YkZitcXmVZpwL3zFtwpYH6l3cWtqDMPP+Fb+zWPthW6BvUIJmZuOTN7APqKOjB9vZAuAM6ArvFE9CSeI5Y1B7PPfAFMPKMKMWVZmbCzKusoveoKcODjQDzgx3c6GnUFnADOAFGV5V16B7PI2BkBRjgmf4IWBbYu8I6lPuhSa2w4xP8k7CF/l5Q7HuiZW9ST+wpjgKLvP9ed6gAJXztWcG/2CaAJ/tKlJSnm7RTTHHATQAnwAFKWCn/H3y2eH2L2ZfDIf06rXD8m768l//cAvzN/kBe709a8cPFQ4jXFA8hHpvVh1D9scmrqfbYrD/oO0s5caYrDvraqwlwW3811V6mvXUrLtOq6x+NYCt0vIqv/2hgcUPWqoFFRixlB9tEIxZHWKHJLmuGQraifijUMTbIq63QzDLGrh+8wVYO3rI6nzdohc+81H3cDHiijxvNfAJ9Wv855hJL5nnlB2Tw8ojzC7UelrXqk/cPn233eGpGsfAAAAAASUVORK5CYII=\"","import loadImage from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/utils/loadImage';\nimport Particle from '../interfaces';\nimport particleImage from './ray-particle.png';\n\nlet image: HTMLImageElement | null = null;\nlet imageLoaded = false;\n\nloadImage(particleImage).then((img) => {\n    image = img;\n    imageLoaded = true;\n});\n\nconst initialTtl = (50 / 60) * 1000;\nconst velocity = 0.05;\n\nconst WIDTH = 100;\nconst WIDTH_SPREAD = 4;\n\nconst pow = Math.pow;\n\nfunction easeOutQuart(x: number): number {\n    return 1 - pow(1 - x, 2);\n}\n\nexport default class RayParticle implements Particle {\n    public finished = false;\n\n    private ttl;\n    private velocityX;\n    private velocityY;\n    private maxWidth;\n\n    constructor(private x: number, private y: number, seed: number, widthModifier: number) {\n        this.ttl = initialTtl;\n        this.velocityX = velocity * Math.random() - velocity / 2;\n        this.velocityY = velocity * Math.random() - velocity / 2;\n        this.maxWidth =\n            Math.min(0.1 + widthModifier, 1) * (Math.sin(seed / 70) * WIDTH_SPREAD + (WIDTH - WIDTH_SPREAD));\n    }\n    public tick = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement, delta: number) => {\n        if (imageLoaded) {\n            const percentage = this.ttl / initialTtl;\n            let easing = easeOutQuart(1 - Math.min(1, (1 - percentage) * 6));\n\n            const mainRayWidth = (this.maxWidth * easing * 3) / 4;\n            const mainRayHeight = this.maxWidth * easing;\n\n            ctx.globalAlpha = easing * 0.35;\n            ctx.drawImage(image!, this.x - mainRayWidth / 2, this.y - mainRayHeight / 2, mainRayWidth, mainRayHeight);\n\n            easing = easeOutQuart(percentage);\n\n            const width = (easing * this.maxWidth) / 4;\n            const height = (easing * this.maxWidth) / 4;\n\n            const x = this.x - width / 2;\n            const y = this.y - height / 2;\n\n            const elapsedTicks = initialTtl - this.ttl;\n\n            ctx.globalAlpha = easing * 0.2;\n            ctx.drawImage(image!, x + elapsedTicks * this.velocityX, y + elapsedTicks * this.velocityY, width, height);\n            ctx.globalAlpha = 1;\n        }\n\n        this.ttl = this.ttl - delta;\n        this.finished = this.ttl <= 0;\n    };\n}\n","import Particle from '../interfaces';\n\nconst INTERVAL_PX = 20;\n\nexport default class VibratoParticle implements Particle {\n    public finished = false;\n    public ttl = (2 / 60) * 1000;\n\n    constructor(private x: number, private y: number, private w: number, private h: number, private seed: number) {}\n    public tick = (ctx: CanvasRenderingContext2D, canvas: HTMLCanvasElement, delta: number) => {\n        ctx.strokeStyle = 'rgba(255,255,255,.25)';\n        ctx.lineWidth = 2;\n\n        ctx.beginPath();\n\n        for (let i = 0; i < this.w; i++) {\n            const x = this.x + this.w - i;\n            const deltaY = (this.h / 2 + 2) * Math.sin(x / INTERVAL_PX + this.seed / 250);\n            ctx.lineTo(x, this.y + this.h / 2 + deltaY);\n        }\n\n        ctx.stroke();\n\n        ctx.beginPath();\n\n        for (let i = 0; i < this.w; i++) {\n            const x = this.x + this.w - i;\n            const deltaY = -1 * (this.h / 2 + 2) * Math.sin(x / INTERVAL_PX + this.seed / 250);\n            ctx.lineTo(x, this.y + this.h / 2 + deltaY);\n        }\n\n        ctx.stroke();\n\n        this.ttl = this.ttl - delta;\n        this.finished = this.ttl <= 0;\n    };\n}\n","import { noDistanceNoteTypes } from 'consts';\nimport { Note, NotesSection, PlayerNote } from 'interfaces';\nimport getNoteColor from 'Scenes/Game/Singing/GameOverlay/Drawing/Elements/utils/getNoteColor';\nimport SungTriangle from 'Scenes/Game/Singing/GameOverlay/Drawing/Particles/SungTriangle';\nimport { FPSCountSetting, GraphicSetting } from 'Scenes/Settings/SettingsState';\nimport { randomFloat } from 'utils/randomValue';\nimport GameState from '../../GameState/GameState';\nimport getPlayerNoteDistance from '../../Helpers/getPlayerNoteDistance';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport calculateData, { BIG_NOTE_HEIGHT, DrawingData, NOTE_HEIGHT, pitchPadding } from './calculateData';\nimport debugPitches from './Elements/debugPitches';\nimport events from 'GameEvents/GameEvents';\nimport drawNote from './Elements/note';\nimport drawPlayerFrequencyTrace from './Elements/playerFrequencyTrace';\nimport drawPlayerNote from './Elements/playerNote';\nimport ParticleManager from './ParticleManager';\nimport ExplodingNoteParticle from './Particles/ExplodingNote';\nimport FadeoutNote from './Particles/FadeoutNote';\nimport RayParticle from './Particles/Ray';\nimport VibratoParticle from './Particles/Vibrato';\n\nfunction getPlayerNoteAtBeat(playerNotes: PlayerNote[], beat: number) {\n    return playerNotes.find((note) => note.start <= beat && note.start + note.length >= beat);\n}\n\nexport default class CanvasDrawing {\n    private loop = false;\n\n    public constructor(\n        private canvas: HTMLCanvasElement,\n        private verticalMargin: number = 0,\n        private scaleFactor: number = 1,\n    ) {}\n    public start = () => {\n        events.sectionChange.subscribe(this.onSectionEnd);\n        this.loop = true;\n\n        this.drawFrame();\n    };\n\n    public drawFrame = () => {\n        const startTime = Date.now();\n        const ctx = this.canvas.getContext('2d');\n        if (!ctx) return;\n\n        ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\n        for (let i = 0; i < GameState.getPlayerCount(); i++) this.drawPlayer(i, ctx);\n\n        ParticleManager.tick(ctx, this.canvas);\n\n        if (FPSCountSetting.get() === 30) {\n            const endTime = Date.now();\n            const baseTimeout = 1000 / 30;\n            const finalTimeout = endTime - startTime > baseTimeout ? baseTimeout : baseTimeout - (endTime - startTime);\n            if (this.loop) setTimeout(this.drawFrame, finalTimeout, FPSCountSetting.get());\n        }\n        if (FPSCountSetting.get() !== 30) {\n            if (this.loop) window.requestAnimationFrame(this.drawFrame);\n        }\n    };\n\n    public end = () => {\n        this.loop = false;\n        events.sectionChange.unsubscribe(this.onSectionEnd);\n    };\n\n    private drawPlayer = (playerNumber: number, ctx: CanvasRenderingContext2D) => {\n        const drawingData = this.getDrawingData(playerNumber);\n        const { currentSection } = calculateData(drawingData);\n        if (!isNotesSection(currentSection)) return;\n\n        const displacements = this.calculateDisplacements(currentSection, drawingData);\n\n        this.drawNotesToSing(ctx, drawingData, displacements);\n        this.drawSungNotes(ctx, drawingData, displacements);\n\n        if (GraphicSetting.get() === 'high') {\n            this.drawFlare(ctx, drawingData, displacements);\n        }\n\n        false && debugPitches(ctx!, drawingData);\n    };\n\n    private drawNotesToSing = (\n        ctx: CanvasRenderingContext2D,\n        drawingData: DrawingData,\n        displacements: Record<number, [number, number]>,\n    ) => {\n        if (!isNotesSection(drawingData.currentSection)) return;\n\n        drawingData.currentSection.notes.forEach((note) => {\n            const { x, y, w, h } = this.getNoteCoords(drawingData, note, note.pitch, true, displacements[note.start]);\n\n            drawNote(ctx, x, y, w, note);\n        });\n    };\n\n    private drawSungNotes = (\n        ctx: CanvasRenderingContext2D,\n        drawingData: DrawingData,\n        displacements: Record<number, [number, number]>,\n    ) => {\n        if (!isNotesSection(drawingData.currentSection)) return;\n\n        drawingData.currentPlayerNotes.forEach((playerNote) => {\n            const distance = getPlayerNoteDistance(playerNote);\n\n            const { x, y, w, h } = this.getNoteCoords(\n                drawingData,\n                playerNote,\n                playerNote.note.pitch + distance,\n                distance === 0,\n                displacements[playerNote.note.start],\n            );\n            if (distance > 0 || w > h / 2.5) {\n                drawPlayerNote(ctx, x, y, w, drawingData.playerNumber, distance === 0, playerNote);\n\n                if (playerNote.vibrato) {\n                    ParticleManager.add(new VibratoParticle(x, y, w, h, drawingData.currentTime));\n                }\n\n                if (\n                    distance === 0 &&\n                    playerNote.frequencyRecords.length > 3 &&\n                    !noDistanceNoteTypes.includes(playerNote.note.type)\n                ) {\n                    drawPlayerFrequencyTrace(ctx, x, y, w, h, playerNote);\n                }\n            }\n        });\n    };\n\n    private drawFlare = (\n        ctx: CanvasRenderingContext2D,\n        drawingData: DrawingData,\n        displacements: Record<number, [number, number]>,\n    ) => {\n        if (!isNotesSection(drawingData.currentSection)) return;\n\n        const lastNote = getPlayerNoteAtBeat(\n            drawingData.currentPlayerNotes,\n            drawingData.currentBeat - 185 / drawingData.songBeatLength,\n        );\n\n        if (lastNote && lastNote.distance === 0) {\n            const displacement = displacements[lastNote.note.start] || [0, 0];\n\n            const { x, y, w, h } = this.getNoteCoords(drawingData, lastNote, lastNote.note.pitch, true, displacement);\n            const preciseDistance = noDistanceNoteTypes.includes(lastNote.note.type)\n                ? 0\n                : lastNote.frequencyRecords.at(-1)!.preciseDistance;\n\n            const finalX = x + w;\n            const finalY = this.getPreciseY(y, h, preciseDistance);\n\n            ParticleManager.add(new RayParticle(finalX, finalY, drawingData.currentTime, 1));\n\n            ParticleManager.add(\n                new SungTriangle(\n                    randomFloat(Math.max(x, finalX - 50), finalX),\n                    finalY,\n                    getNoteColor(ctx, drawingData.playerNumber, true, lastNote).fill,\n                ),\n            );\n        }\n    };\n\n    private onSectionEnd = (playerNumber: number) => {\n        const drawingData = this.getDrawingData(playerNumber, -1);\n        if (!isNotesSection(drawingData.currentSection)) return;\n\n        this.fadeoutNotes(drawingData.currentSection, drawingData);\n        this.explodeNotes(drawingData.currentSection, drawingData);\n    };\n\n    private fadeoutNotes = (section: NotesSection, drawingData: DrawingData) => {\n        if (GraphicSetting.get() === 'high') {\n            section.notes.forEach((note) => {\n                const { x, y, w, h } = this.getNoteCoords(drawingData, note, note.pitch, true);\n\n                ParticleManager.add(new FadeoutNote(x, y, w, note));\n            });\n        }\n    };\n\n    private explodeNotes = (section: NotesSection, drawingData: DrawingData) => {\n        if (GraphicSetting.get() === 'high') {\n            const notesToExplode = drawingData.playerNotes.filter(\n                (note) =>\n                    (note.distance === 0 || noDistanceNoteTypes.includes(note.note.type)) &&\n                    section.notes.includes(note.note),\n            );\n\n            notesToExplode.forEach((note) => {\n                const { x, y, w, h } = this.getNoteCoords(drawingData, note, note.note.pitch, true);\n                ParticleManager.add(\n                    new ExplodingNoteParticle(x, y + h / 2, w, drawingData.playerNumber, note.note, ParticleManager),\n                );\n            });\n        }\n    };\n\n    private calculateDisplacements = (currentSection: NotesSection, drawingData: DrawingData) => {\n        const displacements: Record<number, [number, number]> = {};\n\n        if (GraphicSetting.get() === 'high') {\n            currentSection.notes.forEach((note) => {\n                const sungNotesStreak = drawingData.playerNotes\n                    .filter((sungNote) => sungNote.note.start === note.start)\n                    .filter(\n                        (sungNote) =>\n                            sungNote.note.start + sungNote.note.length + 30 >= drawingData.currentBeat &&\n                            sungNote.distance === 0,\n                    )\n                    .map((sungNote) =>\n                        sungNote.start + 30 < drawingData.currentBeat\n                            ? sungNote.length - (drawingData.currentBeat - 30 - sungNote.start)\n                            : sungNote.length,\n                    )\n                    .reduce((currLength, sungNoteLength) => Math.min(currLength + sungNoteLength, 30), 0);\n\n                const displacementRange = Math.max(0, (sungNotesStreak - 5) / (note.type === 'star' ? 3 : 5));\n                const displacementX = (Math.random() - 0.5) * displacementRange;\n                const displacementY = (Math.random() - 0.5) * displacementRange;\n\n                displacements[note.start] = [displacementX, displacementY];\n            });\n        } else {\n            currentSection.notes.forEach((note) => {\n                displacements[note.start] = [0, 0];\n            });\n        }\n\n        return displacements;\n    };\n\n    private getDrawingData = (playerNumber: number, sectionShift = 0): DrawingData => {\n        const playerState = GameState.getPlayer(playerNumber);\n        const currentSectionIndex = playerState.getCurrentSectionIndex() + sectionShift ?? 0;\n        const song = GameState.getSong()!;\n        const track = playerState.getTrackIndex();\n        const currentSection = song.tracks[track].sections[currentSectionIndex];\n        const playerNotes = playerState.getPlayerNotes();\n\n        return {\n            song,\n            songBeatLength: GameState.getSongBeatLength(),\n            minPitch: playerState.getMinPitch(),\n            maxPitch: playerState.getMaxPitch(),\n            canvas: this.canvas,\n            currentTime: GameState.getCurrentTime(),\n            frequencies: playerState.getPlayerFrequencies(),\n            playerNotes,\n            currentPlayerNotes: playerNotes.filter((note) => note.note.start >= currentSection.start),\n            playerNumber,\n            track: playerState.getTrackIndex(),\n            currentBeat: GameState.getCurrentBeat(),\n            currentSectionIndex,\n            currentSection,\n            paddingVertical: this.verticalMargin,\n        };\n    };\n\n    private getNoteCoords = (\n        drawingData: DrawingData,\n        { start, length }: Pick<Note, 'start' | 'length'>,\n        pitch: number,\n        big: boolean,\n        displacement: [number, number] = [0, 0],\n    ) => {\n        const { sectionEndBeat, currentSection, paddingHorizontal, canvasHeight, pitchStepHeight } =\n            calculateData(drawingData);\n\n        const regionPaddingTop = drawingData.playerNumber * (canvasHeight / 2) + drawingData.paddingVertical;\n\n        const sectionStart = isNotesSection(currentSection) ? currentSection.notes[0].start : 1;\n\n        const beatLength = (this.canvas.width - 2 * paddingHorizontal) / (sectionEndBeat - sectionStart);\n\n        const [dx, dy] = big ? displacement : [0, 0];\n        const pitchY = pitchStepHeight * (drawingData.maxPitch - pitch + pitchPadding);\n\n        return {\n            x: Math.floor(paddingHorizontal + beatLength * (start - sectionStart) + dx),\n            y: Math.floor(regionPaddingTop + 10 + pitchY + dy - (big ? 3 : 0)),\n            w: Math.floor(beatLength * length),\n            h: big ? BIG_NOTE_HEIGHT : NOTE_HEIGHT,\n        };\n    };\n\n    private getPreciseY = (y: number, h: number, preciseDistance: number) => y + h / 2 - (preciseDistance * h) / 3;\n}\n","import styled from '@emotion/styled';\nimport { VideoPlayerRef, VideoState } from 'Elements/VideoPlayer';\nimport { PlayerSetup, Song } from 'interfaces';\nimport { useEffect, useRef } from 'react';\nimport SkipIntro from 'Scenes/Game/Singing/GameOverlay/Components/SkipIntro';\nimport SkipOutro from 'Scenes/Game/Singing/GameOverlay/Components/SkipOutro';\nimport GameState from '../GameState/GameState';\nimport DurationBar from './Components/DurationBar';\nimport Lyrics from './Components/Lyrics';\nimport ScoreText from './Components/ScoreText';\nimport CanvasDrawing from './Drawing';\n\ninterface Props {\n    song: Song;\n    currentStatus: VideoState;\n    width: number;\n    height: number;\n    onSongEnd: () => void;\n    players: [PlayerSetup, PlayerSetup];\n    duration: number;\n    effectsEnabled: boolean;\n    playerChanges: number[][];\n    videoPlayerRef: VideoPlayerRef | null;\n    isPauseMenuVisible: boolean;\n}\n\nconst MAX_RENDER_RESOLUTION_W = 1920;\n\nfunction GameOverlay({\n    currentStatus,\n    width,\n    height,\n    players,\n    onSongEnd,\n    playerChanges,\n    effectsEnabled,\n    videoPlayerRef,\n    isPauseMenuVisible,\n}: Props) {\n    const canvas = useRef<HTMLCanvasElement | null>(null);\n    const drawer = useRef<CanvasDrawing | null>(null);\n    const lyrics = useRef<HTMLDivElement | null>(null);\n\n    useEffect(() => {\n        GameState.startInputMonitoring();\n\n        return () => {\n            GameState.stopInputMonitoring();\n        };\n    }, []);\n\n    const overlayWidth = MAX_RENDER_RESOLUTION_W;\n    const overlayHeight = overlayWidth * (height / width);\n\n    const overlayScaleFactor = overlayHeight / height;\n    const resolutionScaleFactor = overlayWidth / MAX_RENDER_RESOLUTION_W;\n\n    useEffect(() => {\n        if (!canvas.current || !lyrics.current) return;\n\n        drawer.current = new CanvasDrawing(\n            canvas.current,\n            lyrics.current.offsetHeight * overlayScaleFactor,\n            resolutionScaleFactor,\n        );\n        drawer.current.start();\n\n        return () => {\n            drawer.current?.end();\n        };\n    }, [canvas.current, lyrics.current?.offsetHeight, overlayScaleFactor]);\n\n    useEffect(() => {\n        if (currentStatus === VideoState.ENDED && onSongEnd) {\n            onSongEnd();\n        }\n    }, [currentStatus, onSongEnd]);\n\n    return (\n        <Screen>\n            <GameCanvas>\n                <canvas ref={canvas} width={overlayWidth} height={overlayHeight} />\n            </GameCanvas>\n            {effectsEnabled && (\n                <>\n                    <SkipIntro playerRef={videoPlayerRef} isEnabled={!isPauseMenuVisible} />\n                    <SkipOutro onSongEnd={onSongEnd} isEnabled={!isPauseMenuVisible} />\n                </>\n            )}\n            <DurationBar players={players} />\n            <div ref={lyrics}>\n                <Lyrics player={0} playerChanges={playerChanges} effectsEnabled={effectsEnabled} />\n            </div>\n            <Scores>\n                {effectsEnabled && (\n                    <>\n                        <span data-test=\"player-1-score\" data-score={GameState.getPlayer(0).getScore()}>\n                            <ScoreText score={GameState.getPlayer(0).getScore()} />\n                        </span>\n                        <span data-test=\"player-2-score\" data-score={GameState.getPlayer(1).getScore()}>\n                            <ScoreText score={GameState.getPlayer(1).getScore()} />\n                        </span>\n                    </>\n                )}\n            </Scores>\n            <Lyrics player={1} playerChanges={playerChanges} bottom effectsEnabled={effectsEnabled} />\n        </Screen>\n    );\n}\n\nexport default GameOverlay;\n\nconst Screen = styled.div`\n    height: 100%;\n    color: white;\n    -webkit-text-stroke: thick black;\n    font-weight: bold;\n    position: relative;\n    display: flex;\n    flex-direction: column;\n`;\n\nconst GameCanvas = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n\n    canvas {\n        width: 100%;\n        height: 100%;\n    }\n`;\n\nconst Scores = styled.div`\n    flex: 1;\n    height: 100%;\n    box-sizing: border-box;\n    font-size: 5.5rem;\n    display: flex;\n    justify-content: center;\n    gap: 4rem;\n    padding-right: 4rem;\n    flex-direction: column;\n    text-align: right;\n`;\n","import { PlayerSetup, SingSetup, Song } from 'interfaces';\nimport {\n    ForwardedRef,\n    forwardRef,\n    MutableRefObject,\n    useCallback,\n    useEffect,\n    useImperativeHandle,\n    useMemo,\n    useRef,\n    useState,\n} from 'react';\n\nimport styled from '@emotion/styled';\nimport VideoPlayer, { VideoPlayerRef, VideoState } from 'Elements/VideoPlayer';\nimport { FPSCountSetting } from 'Scenes/Settings/SettingsState';\nimport PauseMenu from './GameOverlay/Components/PauseMenu';\nimport GameOverlay from './GameOverlay/GameOverlay';\nimport GameState from './GameState/GameState';\nimport useKeyboard from 'hooks/useKeyboard';\nimport useKeyboardHelp from 'hooks/useKeyboardHelp';\n\ninterface Props {\n    singSetup: SingSetup;\n    song: Song;\n    width: number;\n    height: number;\n    autoplay?: boolean;\n    showControls?: boolean;\n    onTimeUpdate?: (newTime: number) => void;\n    onSongEnd: () => void;\n    onStatusChange?: (status: VideoState) => void;\n    players: [PlayerSetup, PlayerSetup];\n    playerChanges?: number[][];\n\n    effectsEnabled?: boolean;\n    restartSong?: () => void;\n}\n\nexport interface PlayerRef {\n    play: () => void;\n    pause: () => void;\n    seekTo: (time: number) => void;\n    setPlaybackSpeed: (speed: number) => void;\n}\n\nfunction usePlayerSetDuration(playerRef: MutableRefObject<VideoPlayerRef | null>, currentStatus: VideoState) {\n    const [duration, setDuration] = useState(0);\n    useEffect(() => {\n        if (playerRef.current && currentStatus === VideoState.PLAYING && duration === 0) {\n            playerRef.current.getDuration().then((dur: number) => {\n                setDuration(dur);\n                GameState.setDuration(dur);\n            });\n        }\n    }, [duration, playerRef, currentStatus]);\n\n    return duration;\n}\n\nfunction Player(\n    {\n        song,\n        width,\n        height,\n        autoplay = true,\n        showControls = false,\n        onTimeUpdate,\n        onSongEnd,\n        onStatusChange,\n        players,\n        playerChanges = [[], []],\n        effectsEnabled = true,\n        singSetup,\n        restartSong,\n    }: Props,\n    ref: ForwardedRef<PlayerRef>,\n) {\n    const player = useRef<VideoPlayerRef | null>(null);\n    const [currentTime, setCurrentTime] = useState(0);\n    const [currentStatus, setCurrentStatus] = useState(VideoState.UNSTARTED);\n\n    useEffect(() => {\n        GameState.setSong(song);\n        GameState.setSingSetup(singSetup);\n    }, [song, singSetup]);\n\n    useEffect(() => {\n        if (!player.current) {\n            return;\n        }\n        if (currentStatus === VideoState.PLAYING) {\n            const interval = setInterval(async () => {\n                if (!player.current) return;\n\n                const time = (await player.current.getCurrentTime()) * 1000;\n                setCurrentTime(time);\n                onTimeUpdate?.(time);\n                GameState.setCurrentTime(time);\n                GameState.update();\n            }, 1000 / FPSCountSetting.get());\n\n            return () => clearInterval(interval);\n        }\n    }, [player, onTimeUpdate, currentStatus]);\n\n    const duration = usePlayerSetDuration(player, currentStatus);\n\n    useImperativeHandle(ref, () => ({\n        seekTo: (time: number) => player.current!.seekTo(time),\n        setPlaybackSpeed: (speed: number) => player.current!.setPlaybackSpeed(speed),\n        play: () => player.current!.playVideo(),\n        pause: () => player.current!.pauseVideo(),\n    }));\n\n    const onStateChangeCallback = useCallback(\n        (state: VideoState) => {\n            setCurrentStatus(state);\n            onStatusChange?.(state);\n        },\n        [setCurrentStatus, onStatusChange],\n    );\n\n    useKeyboard(\n        {\n            onBackspace: () =>\n                currentStatus === VideoState.PAUSED ? player.current?.playVideo() : player.current?.pauseVideo(),\n        },\n        true,\n        [currentStatus],\n    );\n\n    const help = useMemo(\n        () => ({\n            back: 'Pause Menu',\n        }),\n        [],\n    );\n    useKeyboardHelp(help, effectsEnabled);\n\n    const isPauseMenuVisible = effectsEnabled && currentStatus === VideoState.PAUSED && onSongEnd !== undefined;\n\n    return (\n        <Container>\n            {isPauseMenuVisible && (\n                <PauseMenu onExit={onSongEnd} onResume={() => player.current?.playVideo()} onRestart={restartSong!} />\n            )}\n            {currentStatus !== VideoState.UNSTARTED && (\n                <Overlay>\n                    <GameOverlay\n                        isPauseMenuVisible={isPauseMenuVisible}\n                        effectsEnabled={effectsEnabled}\n                        playerChanges={playerChanges}\n                        duration={duration}\n                        currentStatus={currentStatus}\n                        song={song}\n                        width={width}\n                        height={height}\n                        onSongEnd={onSongEnd}\n                        players={players}\n                        videoPlayerRef={player.current}\n                    />\n                </Overlay>\n            )}\n            <PlayerContainer>\n                <VideoPlayer\n                    ref={player}\n                    video={song.video}\n                    width={width}\n                    height={height}\n                    controls={showControls}\n                    autoplay={autoplay}\n                    disablekb={process.env.NODE_ENV !== 'development'}\n                    volume={song.volume}\n                    startAt={song.videoGap ?? 0}\n                    onStateChange={onStateChangeCallback}\n                />\n            </PlayerContainer>\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    position: relative;\n`;\n\nconst Overlay = styled.div`\n    position: absolute;\n    z-index: 1;\n    background-color: rgba(0, 0, 0, 0.2);\n    pointer-events: none;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n`;\n\nconst PlayerContainer = styled.div`\n    overflow: hidden;\n    height: 100%;\n`;\n\nexport default forwardRef(Player);\n","import styled from '@emotion/styled';\nimport { Box, Grid, Typography } from '@mui/material';\nimport { GAME_MODE, SingSetup, Song } from 'interfaces';\nimport { cloneDeep } from 'lodash-es';\nimport { useEffect, useMemo, useRef, useState } from 'react';\nimport AdjustPlayback from 'Scenes/Convert/Steps/SyncLyricsToVideo/Components/AdjustPlayback';\nimport EditSection, { ChangeRecord } from 'Scenes/Convert/Steps/SyncLyricsToVideo/Components/EditSection';\nimport ListTracks from 'Scenes/Convert/Steps/SyncLyricsToVideo/Components/ListTracks';\nimport ManipulateBpm from 'Scenes/Convert/Steps/SyncLyricsToVideo/Components/ManipulateBpm';\nimport ShiftGap from 'Scenes/Convert/Steps/SyncLyricsToVideo/Components/ShiftGap';\nimport ShiftVideoGap from 'Scenes/Convert/Steps/SyncLyricsToVideo/Components/ShiftVideoGap';\nimport addHeadstart from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/addHeadstart';\nimport normaliseGap from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseGap';\nimport normaliseLyricSpaces from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseLyricSpaces';\nimport normaliseSectionPaddings from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseSectionPaddings';\nimport getSongBeatLength from 'Songs/utils/getSongBeatLength';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { getFirstNoteStartFromSections } from 'Songs/utils/notesSelectors';\nimport Player, { PlayerRef } from 'Scenes/Game/Singing/Player';\n\ninterface Props {\n    song: Song;\n    onUpdate?: (song: Song) => void;\n    visible: boolean;\n}\n\nconst shiftGap = (song: Song, gapShift: number): Song => ({ ...song, gap: song.gap + gapShift });\nconst shiftVideoGap = (song: Song, gapShift: number): Song => ({ ...song, videoGap: (song.videoGap ?? 0) + gapShift });\nconst setBpm = (song: Song, bpm: number): Song => ({ ...song, bpm });\n\nconst applyChanges = (song: Song, changes: ChangeRecord[]) => ({\n    ...song,\n    tracks: song.tracks.map((track, trackIndex) => {\n        const changeList = changes.filter((change) => change.track === trackIndex);\n\n        let sections = [...track.sections].filter(isNotesSection);\n\n        changeList.forEach((change) => {\n            if (change.type === 'delete') {\n                sections = sections.filter((_, index) => index !== change.section);\n            } else if (change.type === 'shift') {\n                const shift = change.shift - getFirstNoteStartFromSections([sections[change.section]]);\n                sections = sections.map((section, index) => {\n                    if (index < change.section) return section;\n\n                    return { ...section, notes: section.notes.map((note) => ({ ...note, start: note.start + shift })) };\n                });\n            }\n        });\n\n        return { ...track, sections };\n    }),\n});\n\nconst applyTrackNames = (song: Song, trackNames: (string | undefined)[]): Song => ({\n    ...song,\n    tracks: song.tracks.map((track, index) => ({\n        ...track,\n        name: trackNames[index] ?? track.name,\n    })),\n});\n\nconst playerWidth = 800;\nconst playerHeight = (playerWidth / 16) * 9;\n\nexport default function EditSong({ song, onUpdate, visible }: Props) {\n    const player = useRef<PlayerRef | null>(null);\n    const [currentTime, setCurrentTime] = useState<number>(0);\n\n    const [gapShift, setGapShift] = useState<number>(0);\n    const [videoGapShift, setVideoGapShift] = useState<number>(0);\n    const [overrideBpm, setOverrideBpm] = useState<number>(song.bpm);\n    const [playerKey, setPlayerKey] = useState(0);\n    const [changeRecords, setChangeRecords] = useState<ChangeRecord[]>([]);\n    const [effectsEnabled, setEffectsEnabled] = useState<boolean>(false);\n    const [trackNames, setTrackNames] = useState(song.tracks.map((track) => track.name ?? undefined));\n\n    const newSong = useMemo(() => {\n        let processed = cloneDeep(song);\n\n        processed = normaliseGap(processed);\n        processed = addHeadstart(processed);\n        processed = normaliseSectionPaddings(processed);\n        processed = shiftGap(processed, gapShift);\n        processed = shiftVideoGap(processed, videoGapShift);\n        processed = setBpm(processed, overrideBpm);\n        processed = applyChanges(processed, changeRecords);\n        processed = applyTrackNames(processed, trackNames);\n        processed = normaliseSectionPaddings(processed);\n        processed = normaliseLyricSpaces(processed);\n\n        return processed;\n    }, [gapShift, videoGapShift, song, overrideBpm, changeRecords, trackNames]);\n\n    useEffect(() => {\n        onUpdate?.(newSong);\n    }, [onUpdate, newSong]);\n\n    const singSetup = useMemo<SingSetup>(\n        () => ({\n            id: 'test',\n            mode: GAME_MODE.DUEL,\n            players: [\n                { name: 'Player 1', track: 0 },\n                { name: 'Player 2', track: song.tracks.length - 1 },\n            ],\n            tolerance: 6,\n        }),\n        [song],\n    );\n\n    let beatLength: number | undefined;\n    beatLength = getSongBeatLength(newSong);\n\n    useEffect(() => {\n        if (!visible) {\n            player.current?.pause();\n        }\n    }, [visible]);\n\n    return (\n        <Grid container spacing={2} sx={{ display: visible ? undefined : 'none' }}>\n            <Grid item xs={8} data-test=\"player-container\">\n                <Box sx={{ width: playerWidth, height: playerHeight }}>\n                    <Player\n                        key={playerKey}\n                        song={newSong}\n                        showControls\n                        autoplay={false}\n                        width={playerWidth}\n                        height={playerHeight}\n                        ref={player}\n                        onTimeUpdate={setCurrentTime}\n                        players={[\n                            { name: 'p1', track: 0 },\n                            { name: 'p1', track: song.tracks.length - 1 },\n                        ]}\n                        effectsEnabled={effectsEnabled}\n                        singSetup={singSetup}\n                        onSongEnd={() => undefined}\n                    />\n                </Box>\n            </Grid>\n            <Grid item xs={4}>\n                <Typography variant={'h5'} mb={2}>\n                    Playback controls\n                </Typography>\n                {player.current && (\n                    <AdjustPlayback\n                        player={player.current}\n                        currentTime={currentTime}\n                        effectsEnabled={effectsEnabled}\n                        onEffectsToggle={() => setEffectsEnabled((current) => !current)}\n                    />\n                )}\n                {!player.current && <h2>Start the song to see the manipulation form</h2>}\n            </Grid>\n            {player.current && (\n                <>\n                    <Grid item xs={8}>\n                        {/*<Typography variant={'h5'} mb={2}>*/}\n                        {/*    Basic adjustments*/}\n                        {/*</Typography>*/}\n                        <Box sx={{ display: 'flex', gap: 5, flex: 1 }}>\n                            <ShiftVideoGap\n                                player={player.current}\n                                onChange={setVideoGapShift}\n                                current={videoGapShift}\n                                finalGap={newSong.videoGap}\n                            />\n                            <ShiftGap\n                                player={player.current}\n                                onChange={setGapShift}\n                                current={gapShift}\n                                finalGap={newSong.gap}\n                            />\n                        </Box>\n                    </Grid>\n                    <Grid item xs={4}>\n                        <HelpText>\n                            Use <strong>Video shift gap</strong> to crop the beginning of the video if it starts with an\n                            intro.\n                        </HelpText>\n                        <HelpText>\n                            Use <strong>Shift gap</strong> to sync the start of the lyrics to the video. You can lower\n                            the <strong>Playback speed</strong> above to make sure you got it just right.\n                        </HelpText>\n                    </Grid>\n                    <Grid item xs={8}>\n                        <Typography variant={'h5'} mb={2}>\n                            Advanced\n                        </Typography>\n                        <ManipulateBpm\n                            player={player.current}\n                            onChange={setOverrideBpm}\n                            current={overrideBpm}\n                            song={newSong}\n                            key={newSong.gap}\n                        />\n                        <ListTracks player={player.current} song={newSong} beatLength={beatLength} />\n                    </Grid>\n                    <Grid item xs={4}>\n                        <HelpText>\n                            If the lyrics desynchronise over time, probably the tempo (BPM) of the lyrics is wrong.\n                        </HelpText>\n                        <HelpText>\n                            You can either use <strong>Last note end time</strong> - enter the millisecond when the last\n                            note should end (seek through the video for the moment as <strong>Current time</strong>{' '}\n                            panel show the exact millisecond) and a suggested BPM value will appear below.\n                        </HelpText>\n                        <HelpText>\n                            <strong>Tempo (BPM)</strong> field allows to fine-tune the tempo.\n                        </HelpText>\n                    </Grid>\n                    <Grid item xs={8}>\n                        <EditSection\n                            song={newSong}\n                            currentTime={currentTime}\n                            beatLength={beatLength}\n                            player={player.current}\n                            onRecordChange={setChangeRecords}\n                            onTrackNameChange={(track, newName) =>\n                                setTrackNames((current) => {\n                                    const newNames = [...current];\n                                    newNames[track] = newName === '' ? undefined : newName;\n\n                                    return newNames;\n                                })\n                            }\n                        />\n                    </Grid>\n                    <Grid item xs={4}>\n                        <HelpText>\n                            If the lyrics there are more lyrics than in the video or there are longer/shorter interludes\n                            between verses, you can <strong>Edit verses</strong>.\n                        </HelpText>\n                        <HelpText>Select a verse by clicking on it.</HelpText>\n                        <HelpText>\n                            You can either <strong>Change its start beat</strong> (which will \"move in time\" the verse\n                            and all subsequent ones) or <strong>Delete it</strong> (it won't affect the timing of other\n                            verses).\n                        </HelpText>\n                        <HelpText>\n                            <strong>List of changes</strong> on the right allows you to see and undo the actions one by\n                            one.\n                        </HelpText>\n                    </Grid>\n                </>\n            )}\n        </Grid>\n    );\n}\n\nconst HelpText = styled.p`\n    font-size: 0.85rem;\n    margin-bottom: 1rem;\n    line-height: 1.25rem;\n    strong {\n        font-weight: bold;\n    }\n`;\n","import { Box } from '@mui/material';\nimport { NotesSection, Song } from 'interfaces';\nimport EditSong from 'Scenes/Convert/Steps/SyncLyricsToVideo/EditSong';\n\ninterface Props {\n    onChange: (data: Song) => void;\n    data?: Song;\n    visible: boolean;\n}\n\nexport default function SyncLyricsToVideo(props: Props) {\n    return (\n        <Box data-test=\"sync-lyrics\">\n            {props.data &&\n                props.data.video.length < 15 &&\n                !!(props.data.tracks[0].sections[0] as NotesSection).notes.length && (\n                    <EditSong song={props.data} onUpdate={props.onChange} visible={props.visible} />\n                )}\n        </Box>\n    );\n}\n","const ALPHANUMERIC_REGEX = /[^0-9a-z]/gi;\n\nexport default function clearString(str: string) {\n    return str.toLowerCase().normalize('NFKD').replace(ALPHANUMERIC_REGEX, '');\n}\n","import { Song, SongPreview } from \"../src/interfaces\";\nimport { getFirstNoteStartFromSections } from \"../src/Songs/utils/notesSelectors\";\nimport clearString from \"../src/utils/clearString\";\n\nconst generateSearchString = (song: Pick<Song, 'title' | 'artist'>) => clearString(`${song.artist}${song.title}`);\n\nexport const getSongPreview = (file: string, songData: Song, local = false): SongPreview => ({\n    ...songData,\n    file,\n    tracksCount: songData.tracks.length,\n    tracks: songData.tracks.map(({ name, sections }) => ({\n        name,\n        start: getFirstNoteStartFromSections(sections),\n    })),\n    search: generateSearchString(songData),\n    local,\n});\n","import { Song, SongPreview } from 'interfaces';\nimport localForage from 'localforage';\nimport { getSongPreview } from '../../scripts/utils';\nimport { lastVisit } from 'Stats/lastVisit';\nimport { isAfter } from 'date-fns';\n\nconst storage = localForage.createInstance({\n    name: 'songs',\n});\n\nconst DELETED_SONGS_KEY = 'DELETED_SONGS';\nconst SONGS_KEY = 'STORED_SONGS';\n\nclass SongDao {\n    private finalIndex: SongPreview[] | null = null;\n    private indexWithDeletedSongs: SongPreview[] | null = null;\n    public store = async (song: Song) => {\n        await storage.setItem(this.generateSongFile(song), { ...song, lastUpdate: new Date().toISOString() });\n        await this.reloadIndex();\n    };\n\n    public get = async (fileName: string) => {\n        const localSong = await this.getLocal(fileName);\n\n        if (!localSong) {\n            return await fetch(`./songs/${fileName}`).then((response) => response.json());\n        }\n\n        return localSong;\n    };\n\n    public getIndex = async (includeDeleted = false): Promise<SongPreview[]> => {\n        if (this.finalIndex === null) {\n            await this.reloadIndex();\n        }\n\n        return includeDeleted ? this.indexWithDeletedSongs! : this.finalIndex!;\n    };\n\n    public getCurrentIndex = () => this.finalIndex;\n\n    private getDeletedSongsList = async () => {\n        const list = await storage.getItem<string[]>(DELETED_SONGS_KEY);\n\n        return list ?? [];\n    };\n\n    public generateSongFile = (song: Song | SongPreview) => `${song?.artist}-${song?.title}.json`;\n\n    public reloadIndex = async () => {\n        const [defaultIndex, storageIndex, deletedSongs] = await Promise.all([\n            fetch('./songs/index.json').then((response) => response.json() as Promise<SongPreview[]>),\n            this.getLocalIndex(),\n            this.getDeletedSongsList(),\n        ]);\n        const lastVisitDate = new Date(lastVisit);\n\n        const localSongs = storageIndex.map((song) => song.file);\n\n        this.indexWithDeletedSongs = [\n            ...storageIndex,\n            ...defaultIndex.filter((song) => !localSongs.includes(this.generateSongFile(song))),\n        ].map((song) => ({\n            ...song,\n            isNew: song.lastUpdate ? isAfter(new Date(song.lastUpdate), lastVisitDate) : false,\n            isDeleted: deletedSongs?.includes(this.generateSongFile(song)),\n        }));\n\n        this.indexWithDeletedSongs.sort((a, b) =>\n            `${a.artist} ${a.title}`.localeCompare(`${b.artist} ${b.title}`.toLowerCase()),\n        );\n\n        this.finalIndex = this.indexWithDeletedSongs.filter((song) => !song.isDeleted);\n    };\n\n    public deleteSong = async (fileName: string) => {\n        await storage.removeItem(fileName);\n\n        return this.reloadIndex();\n    };\n\n    public softDeleteSong = async (fileName: string) => {\n        const deletedItems = await this.getDeletedSongsList();\n        await storage.setItem(DELETED_SONGS_KEY, [...new Set([...deletedItems, fileName])]);\n        return this.reloadIndex();\n    };\n    public restoreSong = async (fileName: string) => {\n        const deletedItems = await this.getDeletedSongsList();\n        await storage.setItem(\n            DELETED_SONGS_KEY,\n            deletedItems.filter((item) => item !== fileName),\n        );\n        return this.reloadIndex();\n    };\n\n    private getLocal = async (fileName: string) => storage.getItem<Song>(decodeURIComponent(fileName));\n    private getLocalIndex = async () => {\n        const allSongs = await Promise.all((await this.getKeys()).map(this.getLocal));\n\n        return allSongs\n            .filter((song): song is Song => song !== null)\n            .map((song) => getSongPreview(this.generateSongFile(song), song, true));\n    };\n\n    private getKeys = async () => {\n        const specialKeys = [DELETED_SONGS_KEY];\n\n        return (await storage.keys()).filter((key) => !specialKeys.includes(key));\n    };\n}\n\nexport default new SongDao();\n","export default function NormalizeFontSize({ size = 16 }) {\n    return (\n        <style>\n            {`html {\n                font-size: ${size}px !important;\n            }`}\n        </style>\n    );\n}\n","import { useEffect } from 'react';\nimport { backgroundMusic } from 'SoundManager';\n\nexport default function useBackgroundMusic(play: boolean) {\n    useEffect(() => {\n        if (play) {\n            if (!backgroundMusic.playing()) {\n                backgroundMusic.play();\n            }\n        } else {\n            backgroundMusic.stop();\n        }\n    }, [play]);\n}\n","import styled from '@emotion/styled';\nimport { Box, Button, Step, StepLabel, StyledEngineProvider } from '@mui/material';\nimport Stepper from '@mui/material/Stepper';\nimport { Song } from 'interfaces';\nimport { useEffect, useMemo, useRef, useState } from 'react';\nimport AuthorAndVid, { AuthorAndVidEntity } from 'Scenes/Convert/Steps/AuthorAndVid';\nimport BasicData, { BasicDataEntity } from 'Scenes/Convert/Steps/BasicData';\nimport SongMetadata, { SongMetadataEntity } from 'Scenes/Convert/Steps/SongMetadata';\nimport SyncLyricsToVideo from 'Scenes/Convert/Steps/SyncLyricsToVideo';\nimport convertTxtToSong, { getVideoId } from 'Songs/utils/convertTxtToSong';\nimport SongDao from 'Songs/SongDao';\nimport NormalizeFontSize from 'Elements/NormalizeFontSize';\nimport { Link } from 'wouter';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport { useBackground } from 'Elements/LayoutWithBackground';\n\ninterface Props {\n    song?: Song;\n}\n\nconst steps = ['basic-data', 'author-and-video', 'sync', 'metadata'] as const;\nexport default function Convert({ song }: Props) {\n    useBackground(false);\n    const navigate = useSmoothNavigate();\n    useBackgroundMusic(false);\n    const [currentStep, setCurrentStep] = useState(0);\n\n    const [basicData, setBasicData] = useState<BasicDataEntity>({ sourceUrl: song?.sourceUrl ?? '', txtInput: '' });\n    const [authorAndVid, setAuthorAndVid] = useState<AuthorAndVidEntity>({\n        author: song?.author ?? '',\n        authorUrl: song?.authorUrl ?? '',\n        video: song?.video ? `https://www.youtube.com/watch?v=${song.video}` : '',\n    });\n    const [metadataEntity, setMetadataEntity] = useState<SongMetadataEntity>({\n        realBpm: String(song?.realBpm) ?? '',\n        year: song?.year ?? '',\n        language: song?.language ?? '',\n        volume: song?.volume ?? 0.5,\n    });\n\n    const [editedSong, setEditedSong] = useState<Song | undefined>(song);\n\n    const error = useRef<string>('');\n    const conversionResult: Song | undefined = useMemo(() => {\n        try {\n            if (song)\n                return {\n                    ...song,\n                    video: getVideoId(authorAndVid.video) || song.video,\n                    author: authorAndVid.author,\n                    authorUrl: authorAndVid.authorUrl,\n                    sourceUrl: basicData.sourceUrl,\n                };\n            if (!basicData.txtInput) return undefined;\n            return convertTxtToSong(\n                basicData.txtInput,\n                authorAndVid.video,\n                authorAndVid.author,\n                authorAndVid.authorUrl,\n                basicData.sourceUrl,\n            );\n        } catch (e: any) {\n            error.current = e.message;\n            console.error(e);\n        }\n        return undefined;\n    }, [\n        basicData.txtInput,\n        authorAndVid.video,\n        authorAndVid.author,\n        authorAndVid.authorUrl,\n        basicData.sourceUrl,\n        song,\n    ]);\n\n    useEffect(() => {\n        if (conversionResult) {\n            if (!!conversionResult.video && !authorAndVid.video) {\n                setAuthorAndVid((current) => ({\n                    ...current,\n                    video: `https://www.youtube.com/watch?v=${conversionResult.video}`,\n                }));\n            }\n            if (!!conversionResult.author && !authorAndVid.author) {\n                setAuthorAndVid((current) => ({\n                    ...current,\n                    author: current.author || conversionResult?.author || '',\n                    authorUrl: current.authorUrl || conversionResult?.authorUrl || '',\n                }));\n            }\n            if (!!conversionResult.sourceUrl && !basicData.sourceUrl) {\n                setBasicData((current) => ({\n                    ...current,\n                    sourceUrl: conversionResult.sourceUrl!,\n                }));\n            }\n            (['year', 'language', 'realBpm'] as const).forEach((property) => {\n                if (!!conversionResult[property] && !metadataEntity[property]) {\n                    setMetadataEntity((current) => ({\n                        ...current,\n                        [property]: conversionResult[property],\n                    }));\n                }\n            });\n        }\n    }, [conversionResult, metadataEntity.year, metadataEntity.language, basicData.sourceUrl, authorAndVid.video]);\n\n    const isBasicInfoCompleted = !!basicData.txtInput || !!song;\n    const isAuthorAndVidCompleted = !!authorAndVid.video;\n\n    const isNextStepAvailable = steps[currentStep] === 'author-and-video' ? isAuthorAndVidCompleted : true;\n\n    const finalSong: Song = {\n        ...editedSong!,\n        ...metadataEntity,\n        author: authorAndVid.author,\n        authorUrl: authorAndVid.authorUrl,\n        realBpm: +metadataEntity.realBpm,\n        sourceUrl: basicData.sourceUrl,\n    };\n    console.log(finalSong);\n\n    return (\n        <StyledEngineProvider injectFirst>\n            <NormalizeFontSize />\n            <Container>\n                {!song && (\n                    <div style={{ marginBottom: '1rem' }}>\n                        <Link to=\"/\">\n                            <a>Return to the main menu</a>\n                        </Link>\n                    </div>\n                )}\n                <Stepper activeStep={currentStep} sx={{ mb: 2 }}>\n                    <Step key={0} completed={isBasicInfoCompleted}>\n                        <StepLabel>Basic Info</StepLabel>\n                    </Step>\n                    <Step key={1} completed={isAuthorAndVidCompleted}>\n                        <StepLabel>Author and video data</StepLabel>\n                    </Step>\n                    <Step key={2}>\n                        <StepLabel>Sync lyrics to video</StepLabel>\n                    </Step>\n                    <Step key={3}>\n                        <StepLabel>Fill song metadata</StepLabel>\n                    </Step>\n                </Stepper>\n\n                <form\n                    onSubmit={(e) => {\n                        e.preventDefault();\n                        if (currentStep < steps.length - 1) setCurrentStep((current) => current + 1);\n                    }}>\n                    {steps.at(currentStep) === 'basic-data' && (\n                        <BasicData\n                            shouldAutoImport={!isAuthorAndVidCompleted}\n                            isTxtRequired={!song}\n                            onAutoImport={setAuthorAndVid}\n                            onChange={setBasicData}\n                            data={basicData}\n                        />\n                    )}\n\n                    {steps.at(currentStep) === 'author-and-video' && (\n                        <AuthorAndVid\n                            songArtist={conversionResult?.artist}\n                            songTitle={conversionResult?.title}\n                            onChange={setAuthorAndVid}\n                            data={authorAndVid}\n                        />\n                    )}\n\n                    {conversionResult && ( // Keep the component even if in different step so it preserves the state\n                        <SyncLyricsToVideo\n                            onChange={setEditedSong}\n                            data={conversionResult}\n                            visible={steps.at(currentStep) === 'sync'}\n                        />\n                    )}\n\n                    {steps.at(currentStep) === 'metadata' && (\n                        <SongMetadata\n                            onChange={setMetadataEntity}\n                            data={metadataEntity}\n                            songArtist={conversionResult?.artist}\n                            songTitle={conversionResult?.title}\n                            videoId={conversionResult!.video}\n                        />\n                    )}\n                    <Box sx={{ display: 'flex', justifyContent: 'flex-end' }}>\n                        <Button\n                            data-test=\"previous-button\"\n                            sx={{ mt: 2, align: 'right' }}\n                            onClick={() => setCurrentStep((current) => current - 1)}\n                            disabled={currentStep === 0}>\n                            Previous\n                        </Button>\n                        {steps.at(currentStep) === 'metadata' ? (\n                            <Button\n                                data-test=\"save-button\"\n                                onClick={() => {\n                                    SongDao.store(finalSong!).then(() => navigate('/edit'));\n                                }}\n                                sx={{ mt: 2, align: 'right' }}\n                                type=\"submit\"\n                                variant={'contained'}>\n                                Save\n                            </Button>\n                        ) : (\n                            <Button\n                                data-test=\"next-button\"\n                                sx={{ mt: 2, align: 'right' }}\n                                variant={'contained'}\n                                type=\"submit\"\n                                disabled={!isNextStepAvailable || currentStep === steps.length - 1}>\n                                Next\n                            </Button>\n                        )}\n                    </Box>\n                </form>\n            </Container>\n        </StyledEngineProvider>\n    );\n}\n\nconst Container = styled.div`\n    background: white;\n    margin: 0 auto;\n    margin-top: 30px;\n    width: 1260px;\n    height: 100%;\n`;\n","import { Song } from 'interfaces';\nimport addHeadstart from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/addHeadstart';\nimport normaliseGap from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseGap';\nimport normaliseLyricSpaces from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseLyricSpaces';\nimport normaliseSectionPaddings from 'Scenes/Convert/Steps/SyncLyricsToVideo/Helpers/normaliseSectionPaddings';\nimport { useEffect, useState } from 'react';\nimport SongDao from 'Songs/SongDao';\n\nconst processSong = (song: Song) => {\n    let processed = normaliseGap(song);\n    processed = addHeadstart(processed);\n    processed = normaliseSectionPaddings(processed);\n    processed = normaliseLyricSpaces(processed);\n\n    return processed;\n};\n\nexport default function useSong(fileName: string) {\n    const [song, setSong] = useState<Song | null>(null);\n\n    useEffect(() => {\n        SongDao.get(fileName).then((loadedSong) => setSong(loadedSong ? processSong(loadedSong) : loadedSong));\n    }, [fileName]);\n\n    return {\n        data: song,\n    };\n}\n","import styled from '@emotion/styled';\nimport useSong from 'Songs/hooks/useSong';\nimport Convert from 'Scenes/Convert/Convert';\nimport { Link } from 'wouter';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\n\ninterface Props {\n    file: string;\n}\n\nexport default function Edit(props: Props) {\n    useBackgroundMusic(false);\n    const song = useSong(props.file);\n\n    if (!song.data) return <>Loading</>;\n\n    return (\n        <Container>\n            <div>\n                <Link to=\"/edit\">\n                    <a>Return to the song list</a>\n                </Link>\n            </div>\n            <Convert song={song.data} />\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    margin: 30px auto 0 auto;\n    width: 1260px;\n    height: 100%;\n    background: white;\n`;\n","import { SongPreview } from 'interfaces';\nimport { useEffect, useRef, useState } from 'react';\nimport SongDao from 'Songs/SongDao';\n\nexport default function useSongIndex(includeDeleted = false) {\n    const [songIndex, setSongIndex] = useState<SongPreview[] | null>(SongDao.getCurrentIndex());\n    // Prevent recreating of the array every render\n    const emptyList = useRef<SongPreview[]>([]);\n\n    const loadSongs = () => SongDao.getIndex(includeDeleted).then(setSongIndex);\n\n    useEffect(() => {\n        loadSongs();\n    }, []);\n\n    return {\n        data: songIndex ?? emptyList.current,\n        reload: loadSongs,\n        isLoading: songIndex === null,\n    };\n}\n","import { Note, Song } from 'interfaces';\nimport { invert } from 'lodash-es';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { ValuesType } from 'utility-types';\nimport { SongTXTKeys, typesMap } from 'Songs/utils/convertTxtToSong';\n\nexport const txtTypesMap = invert(typesMap) as any as Record<ValuesType<typeof typesMap>, keyof typeof typesMap>;\n\nfunction toTxtValue(key: SongTXTKeys, value: string | number | undefined) {\n    if (value === undefined) return undefined;\n    return `#${key}:${typeof value === 'number' ? value.toString(10).replace('.', ',') : value}`;\n}\n\nconst notesToText = (notes: Note[]) =>\n    notes\n        .map((note) => `${txtTypesMap[note.type]} ${note.start} ${note.length} ${note.pitch} ${note.lyrics}`)\n        .join('\\n');\n\nexport default function convertSongToTxt(song: Song) {\n    const parsedValues: Record<keyof Omit<Song, 'tracks' | 'bar'>, string | undefined> = {\n        artist: toTxtValue('ARTIST', song.artist),\n        title: toTxtValue('TITLE', song.title),\n        author: toTxtValue('CREATOR', song.author),\n        authorUrl: toTxtValue('CREATORURL', song.authorUrl),\n        bpm: toTxtValue('BPM', song.bpm),\n        realBpm: toTxtValue('REALBPM', song.realBpm),\n        year: toTxtValue('YEAR', song.year),\n        sourceUrl: toTxtValue('SOURCEURL', song.sourceUrl),\n        previewStart: toTxtValue('PREVIEWSTART', song.previewStart),\n        previewEnd: toTxtValue('PREVIEWEND', song.previewEnd),\n        video: toTxtValue('VIDEOID', song.video),\n        videoGap: toTxtValue('VIDEOGAP', song.videoGap),\n        volume: toTxtValue('VOLUME', song.volume),\n        genre: toTxtValue('GENRE', song.genre),\n        language: toTxtValue('LANGUAGE', song.language),\n        lastUpdate: toTxtValue('LASTUPDATE', song.lastUpdate),\n        edition: toTxtValue('EDITION', song.edition),\n        gap: toTxtValue('GAP', song.gap),\n    };\n    const trackNames = song.tracks.map((track) => track.name ?? null);\n\n    const lines: string[] = [];\n    song.tracks\n        .map((track) => track.sections)\n        .forEach(([first, ...sections]) => {\n            lines.push(isNotesSection(first) ? notesToText(first.notes) : `- ${first.start} ${first.end}`);\n\n            sections.forEach((section) =>\n                lines.push(\n                    isNotesSection(section)\n                        ? `- ${section.start}\\n${notesToText(section.notes)}`\n                        : `- ${section.start} ${section.end}`,\n                ),\n            );\n        });\n\n    return Object.values(parsedValues)\n        .concat(trackNames.filter(Boolean).length ? toTxtValue('TRACKNAMES', JSON.stringify(trackNames)) : [])\n        .concat(lines)\n        .concat('E')\n        .filter((value) => value !== undefined)\n        .join('\\n');\n}\n","import styled from '@emotion/styled';\nimport { DataObject, Delete, Download, Edit as EditIcon, Visibility, VisibilityOff } from '@mui/icons-material';\nimport { Button, Grid, IconButton } from '@mui/material';\nimport useSongIndex from 'Songs/hooks/useSongIndex';\nimport { SongPreview } from 'interfaces';\nimport MaterialReactTable, { MRT_ColumnDef } from 'material-react-table';\nimport React, { useMemo } from 'react';\nimport SongDao from 'Songs/SongDao';\nimport convertSongToTxt from 'Songs/utils/convertSongToTxt';\nimport NormalizeFontSize from 'Elements/NormalizeFontSize';\nimport { Link } from 'wouter';\nimport { format } from 'date-fns';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport { useBackground } from 'Elements/LayoutWithBackground';\n\ninterface Props {}\n\nexport default function SongList(props: Props) {\n    useBackground(false);\n    useBackgroundMusic(false);\n    const { data, reload } = useSongIndex(true);\n\n    const columns: MRT_ColumnDef<SongPreview>[] = useMemo(\n        () => [\n            {\n                accessorKey: 'artist',\n                header: 'Artist',\n            },\n            {\n                accessorKey: 'title',\n                header: 'Title',\n            },\n            {\n                accessorKey: 'year',\n                header: 'Year',\n                size: 100,\n            },\n            {\n                accessorKey: 'language',\n                header: 'Language',\n                size: 100,\n            },\n            {\n                accessorKey: 'lastUpdate',\n                header: 'Last Update',\n                Cell: ({ cell }) => {\n                    const val = cell.getValue<string>();\n\n                    return val && <abbr title={val}>{format(new Date(val), 'LLL do y')}</abbr>;\n                },\n            },\n            {\n                accessorKey: 'local',\n                header: 'Local',\n                Cell: ({ cell }) => (cell.getValue<boolean>() ? `âœ”ï¸` : ''),\n            },\n            {\n                accessorKey: 'isDeleted',\n                header: 'Deleted',\n                Cell: ({ cell }) => (cell.getValue<boolean>() ? `âœ”ï¸` : ''),\n                size: 100,\n            },\n        ],\n        [],\n    );\n    if (!data) return <>Loading</>;\n\n    return (\n        <Container>\n            <NormalizeFontSize />\n            <Grid container>\n                <Grid item xs={3}>\n                    <Link to=\"/\">\n                        <a>Return to main menu</a>\n                    </Link>\n                </Grid>\n                <Grid item xs={3}>\n                    <h3>{data.length} songs</h3>\n                </Grid>\n                <Grid item xs={6} display={'flex'} alignItems={'center'} justifyContent={'flex-end'}>\n                    <Link to=\"/convert\">\n                        <Button data-test=\"convert-song\" variant={'contained'}>\n                            Import UltraStar .TXT\n                        </Button>\n                    </Link>\n                </Grid>\n            </Grid>\n            <MaterialReactTable\n                data={data}\n                columns={columns}\n                getRowId={(song) => song.file}\n                positionActionsColumn=\"last\"\n                enableRowActions\n                renderRowActions={({ row }) => (\n                    <>\n                        <IconButton\n                            title=\"Edit the song\"\n                            href={`/edit/${encodeURIComponent(row.original.file)}`}\n                            data-test=\"edit-song\"\n                            data-song={row.original.file}>\n                            <EditIcon />\n                        </IconButton>\n                        <IconButton\n                            title=\"Download .txt file\"\n                            onClick={async () => {\n                                const songData = await SongDao.get(row.original.file);\n                                const txt = convertSongToTxt(songData);\n\n                                const anchor = document.createElement('a');\n                                anchor.href = `data:plain/text;charset=utf-8,${encodeURIComponent(txt)}`;\n                                anchor.download = `${row.original.artist} - ${row.original.title}.txt`;\n                                document.body.appendChild(anchor);\n                                anchor.click();\n                                document.body.removeChild(anchor);\n                            }}\n                            data-test=\"download-song\"\n                            data-song={row.original.file}>\n                            <Download />\n                        </IconButton>\n                        <IconButton\n                            title=\"Download .json file\"\n                            onClick={async () => {\n                                const songData = await SongDao.get(row.original.file);\n                                const json = JSON.stringify(songData, undefined, 2);\n\n                                const anchor = document.createElement('a');\n                                anchor.href = `data:application/json;charset=utf-8,${encodeURIComponent(json)}`;\n                                anchor.download = `${row.original.artist}-${row.original.title}.json`;\n                                document.body.appendChild(anchor);\n                                anchor.click();\n                                document.body.removeChild(anchor);\n                            }}\n                            data-test=\"download-song-json\"\n                            data-song={row.original.file}>\n                            <DataObject />\n                        </IconButton>\n                        {!row.original.isDeleted && (\n                            <IconButton\n                                title=\"Hide the song\"\n                                onClick={async () => {\n                                    await SongDao.softDeleteSong(row.original.file);\n                                    reload();\n                                }}\n                                data-test=\"hide-song\"\n                                data-song={row.original.file}>\n                                <VisibilityOff />\n                            </IconButton>\n                        )}\n                        {row.original.isDeleted && (\n                            <IconButton\n                                title=\"Restore the song\"\n                                onClick={async () => {\n                                    await SongDao.restoreSong(row.original.file);\n                                    reload();\n                                }}\n                                data-test=\"restore-song\"\n                                data-song={row.original.file}>\n                                <Visibility />\n                            </IconButton>\n                        )}\n                        <IconButton\n                            title=\"Delete the song\"\n                            onClick={async () => {\n                                const proceed = window.confirm(`Are you sure you want to delete this song?`);\n\n                                if (proceed) {\n                                    await SongDao.deleteSong(row.original.file);\n                                    reload();\n                                }\n                            }}\n                            data-test=\"delete-song\"\n                            disabled={!row.original.local}\n                            data-song={row.original.file}>\n                            <Delete />\n                        </IconButton>\n                    </>\n                )}\n                initialState={{ density: 'compact', columnVisibility: { local: false, isDeleted: false } }}\n                enableDensityToggle={false}\n                enableFullScreenToggle={false}\n            />\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    margin: 0 auto;\n    height: 100%;\n    width: 1260px;\n    background: white;\n    padding: 60px 20px 0 20px;\n`;\n","import { useEffect } from 'react';\n\nexport default function useFullscreen() {\n    useEffect(() => {\n        try {\n            process.env.NODE_ENV !== 'development' && document.body.requestFullscreen().catch(console.info);\n        } catch (e) {}\n    }, []);\n}\n","import styled from '@emotion/styled';\nimport { PropsWithChildren } from 'react';\nimport { CSSTransition } from 'react-transition-group';\n\ninterface Props {\n    show: boolean;\n    children: React.ReactNode;\n}\n\nexport default function TransitionWrapper({ show, children }: PropsWithChildren<Props>) {\n    return (\n        <CSSTransition<HTMLDivElement> in={show} timeout={1000} classNames=\"fade\" unmountOnExit>\n            {() => <Box>{children}</Box>}\n        </CSSTransition>\n    );\n}\n\nconst Box = styled.div`\n    transition: opacity 1000ms;\n\n    // enter from\n    &.fade-enter {\n        opacity: 0;\n    }\n\n    // enter to\n    &.fade-enter-active {\n        opacity: 1;\n    }\n\n    // exit from\n    &.fade-exit {\n        opacity: 1;\n    }\n\n    // exit to\n    &.fade-exit-active {\n        opacity: 0;\n    }\n`;\n","import { useEffect, useState } from 'react';\n\nexport default function useViewportSize() {\n    // Learn more here: https://joshwcomeau.com/react/the-perils-of-rehydration/\n    const [windowSize, setWindowSize] = useState<{\n        width: number | undefined;\n        height: number | undefined;\n    }>({\n        width: undefined,\n        height: undefined,\n    });\n\n    function handleResize() {\n        setWindowSize({\n            width: window.document.body.clientWidth,\n            height: window.visualViewport!.height,\n        });\n    }\n\n    useEffect(() => {\n        window.addEventListener('resize', handleResize);\n        handleResize();\n\n        return () => window.removeEventListener('resize', handleResize);\n    }, []);\n\n    return { ...windowSize, handleResize };\n}\n","import { NotesSection, Section, Song } from 'interfaces';\nimport { cloneDeep, range } from 'lodash-es';\nimport getSongBeatLength from 'Songs/utils/getSongBeatLength';\nimport isNotesSection from 'Songs/utils/isNotesSection';\nimport { getFirstNoteStartFromSections, getLastNoteEndFromSections } from 'Songs/utils/notesSelectors';\n\nconst MAX_SECTION_PAUSE_MS = 250;\n\nconst getSingableBeats = (sections: Section[], start: number = 0, end: number = Infinity) =>\n    sections\n        .filter(isNotesSection)\n        .filter((section) => getFirstNoteStartFromSections([section]) >= start)\n        .filter((section) => getLastNoteEndFromSections([section]) <= end)\n        .reduce((current, section) => current + section.notes.reduce((length, note) => length + note.length, 0), 0);\n\n// Join sections into segments - group of sections that have shorter than MAX_SECTION_PAUSE_MS pause between\nexport const segmentSections = (sections: Section[], beatLength: number): NotesSection[][] => {\n    const [firstSection, ...noteSections] = sections.filter(isNotesSection);\n\n    const segments: NotesSection[][] = [[firstSection]];\n\n    noteSections.forEach((section) => {\n        const lastSegment = segments.at(-1)!;\n\n        const lastSectionEnd = getLastNoteEndFromSections(lastSegment);\n        const firstSectionNoteStart = getFirstNoteStartFromSections([section]);\n        const difference = firstSectionNoteStart - lastSectionEnd;\n\n        if (difference * beatLength > MAX_SECTION_PAUSE_MS) {\n            segments.push([section]);\n        } else {\n            lastSegment.push(section);\n        }\n    });\n\n    return segments;\n};\n\nconst sum = (acc: number, elem: number) => acc + elem;\n\nconst calculateAmplitude = (groups: number[][]) => {\n    const sums = groups.map((group) => group.reduce(sum, 0));\n    return Math.max(...sums) - Math.min(...sums);\n};\n\nconst shiftSolution = (groups: number[][], at: number): number[][] => {\n    const result = cloneDeep(groups);\n    const takeFromLeft = (pos: number) => {\n        if (result[pos - 1].length < 2) return;\n        const left = result[pos - 1].pop()!;\n        result[pos].push(left);\n    };\n    const takeFromRight = (pos: number) => {\n        if (result[pos + 1]?.length < 2) return;\n        const [first, ...rest] = result[pos + 1];\n        result[pos].push(first);\n        result[pos + 1] = rest;\n    };\n\n    at % 2 === 1 ? takeFromLeft(Math.ceil(at / 2)) : takeFromRight(Math.ceil(at / 2));\n\n    return result;\n};\n\nconst arrSum = (arr: number[]) => arr.reduce(sum, 0);\n\nexport default function generatePlayerChanges(song: Song): number[][] {\n    const CHANGES_COUNT = 9;\n    const beatLength = getSongBeatLength(song);\n\n    return song.tracks.map((track) => {\n        if (track.sections.length < 3) return [];\n\n        const segments = segmentSections(track.sections, beatLength);\n\n        // array of groups of singable beats count -- each element is the total singable beats in a segment\n        // The goal is to for the groups to have as similar total count of singable beats as possible\n        let result: number[][] = [];\n\n        // todo replace this hacky algorithm with https://en.wikipedia.org/wiki/Multiway_number_partitioning\n        // STEP1:   Build initial groups by calculating \"ideal\" group length (aka amount of singable beats)\n        //          And try to have them as close to the ideal as possible (by either overflowing or \"underflowing\")\n        let currentBuffer = [getSingableBeats(segments[0])]; // A candidate for the next group\n        for (let i = 0; i < segments.length - 2; i++) {\n            // get the last segment already put in the result\n            const lastSegment = segments[result.flat().length - 1] ?? [];\n            // How many beats are left to sing\n            const singableBeats = getSingableBeats(track.sections, getLastNoteEndFromSections(lastSegment) ?? 0);\n            const idealSize = singableBeats / (1 + CHANGES_COUNT - result.length);\n\n            const segmentSingableBeatsCount = getSingableBeats(segments[i + 1]);\n\n            const bufferSum = arrSum(currentBuffer);\n\n            if (bufferSum + segmentSingableBeatsCount < idealSize) {\n                // If adding the current segment to the candidate doesn't move us past the ideal size, just add it\n                currentBuffer = [...currentBuffer, segmentSingableBeatsCount];\n            } else if (idealSize - bufferSum < bufferSum + segmentSingableBeatsCount - idealSize) {\n                // If the candidate is closer to ideal size, add it as a new group\n                result.push(currentBuffer);\n                currentBuffer = [segmentSingableBeatsCount];\n            } else {\n                // If the candidate with currently inspected segment is closer to ideal size, add it as a new group\n                result.push([...currentBuffer, segmentSingableBeatsCount]);\n                currentBuffer = [];\n            }\n        }\n\n        // STEP2:   Try to make groups more even by trying to move segments between groups and checking if it\n        //          resulted in smaller differences between longest and shortest group (aka amplitude)\n        for (let i = 0; i < 100; i++) {\n            const currentAmplitude = calculateAmplitude(result);\n            // Create alternative results (by shifting one segment between groups in either way)\n            // Note this doesn't guarantee creating best results as moving multiple segments at the same time\n            // isn't accounted for\n            const candidates = range((result.length - 2) * 2 + 2).map((at) => shiftSolution(result, at));\n            const candidatesAmplitudes = candidates.map(calculateAmplitude);\n            const minimalAmplitude = Math.min(...candidatesAmplitudes);\n            if (currentAmplitude <= minimalAmplitude) break; // If no results are better, give up\n            const minimalAmplitudeIndex = candidatesAmplitudes.indexOf(minimalAmplitude);\n            result = candidates[minimalAmplitudeIndex];\n        }\n\n        return result\n            .map((group) => group.length)\n            .reduce<number[]>((acc, length) => [...acc, (acc.at(-1) ?? 0) + length], [])\n            .map((index) => getLastNoteEndFromSections(segments[index - 1]));\n    });\n}\n","import styled from '@emotion/styled';\nimport { Song, SongPreview } from 'interfaces';\nimport styles from './Singing/GameOverlay/Drawing/styles';\n\ninterface Props {\n    width: number;\n    height: number;\n    songData: SongPreview | Song;\n    children: React.ReactNode;\n    background?: React.ReactNode;\n}\n\nexport default function SongPage({ songData, background, width, height, children, ...restProps }: Props) {\n    return (\n        <FocusedSongContainer video={songData.video} width={width} height={height} {...restProps}>\n            <BackgroundImage video={songData.video} blur />\n            {background && <Background>{background}</Background>}\n            <ContentLayer>\n                <FocusedSongData>\n                    <SongTitle>{songData.title}</SongTitle>\n                    <br />\n                    <SongArtist>{songData.artist}</SongArtist>\n                    <br />\n                    {songData.author && (\n                        <SongCreator>\n                            by&nbsp;\n                            {songData.authorUrl ? <a href={songData.authorUrl}>{songData.author}</a> : songData.author}\n                        </SongCreator>\n                    )}\n                    {children}\n                </FocusedSongData>\n            </ContentLayer>\n        </FocusedSongContainer>\n    );\n}\n\nconst FocusedSongContainer = styled.div<{ video: string; width: number; height: number }>(\n    (props) => `\n    width: ${props.width}px;\n    top: 0;\n    height: ${props.height}px;\n    overflow-y: hidden;\n    background: black;\n    position: relative;\n`,\n);\n\nconst Background = styled.div`\n    z-index: 1;\n    top: 0;\n    left: 0;\n    position: absolute;\n    width: 100%;\n    height: 100%;\n`;\n\nconst BaseBackgroundImage = styled(Background)<{ blur: boolean; video: string }>`\n    background-size: cover;\n    background-position: center center;\n\n    filter: ${(props) => (props.blur ? 'blur(0.5rem)' : 'none')};\n`;\n\nconst BackgroundImage = (props: { blur: boolean; video: string }) => (\n    <BaseBackgroundImage\n        style={{ backgroundImage: `url('https://i3.ytimg.com/vi/${props.video}/hqdefault.jpg')` }}\n        {...props}\n    />\n);\n\nconst ContentLayer = styled.div`\n    z-index: 2;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    pointer-events: none;\n`;\n\nconst FocusedSongData = styled.div`\n    position: relative;\n    margin: 0 auto;\n    color: white;\n    max-width: 144rem;\n    height: 100%;\n    pointer-events: none;\n`;\n\nexport const ContentElement = styled.span`\n    background: rgba(0, 0, 0, 0.5);\n    display: inline-block;\n    backdrop-filter: blur(0.5rem);\n    -webkit-text-stroke: thin black;\n    padding: 0.5rem 2rem;\n    margin: 0 0 1rem 2rem;\n    font-weight: bold;\n\n    a {\n        text-decoration: none;\n        -webkit-text-stroke: thin black;\n        color: ${styles.colors.text.active};\n    }\n`;\n\nconst SongTitle = styled(ContentElement)`\n    color: ${styles.colors.text.active};\n    margin-top: 2rem;\n    font-size: 4.5rem;\n`;\n\nconst SongArtist = styled(ContentElement)`\n    font-size: 3.5rem;\n`;\n\nconst SongCreator = styled(ContentElement)`\n    font-size: 2rem;\n`;\n","import styled from '@emotion/styled';\nimport { Button, buttonFocused } from 'Elements/Button';\nimport useKeyboard from 'hooks/useKeyboard';\nimport { DetailedScore, HighScoreEntity } from 'interfaces';\nimport { useEffect, useMemo, useState } from 'react';\nimport ScoreText from 'Scenes/Game/Singing/GameOverlay/Components/ScoreText';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { MAX_POINTS, sumDetailedScore } from 'Scenes/Game/Singing/GameState/Helpers/calculateScore';\nimport { ContentElement } from 'Scenes/Game/SongPage';\nimport useKeyboardHelp from 'hooks/useKeyboardHelp';\n\ninterface PlayerScore {\n    detailedScore: [number, DetailedScore, DetailedScore];\n    name: string;\n}\n\ninterface Props {\n    onNextStep: () => void;\n    players: PlayerScore[];\n    singSetupId: string;\n    highScores: HighScoreEntity[];\n}\n\nconst MAX_TICKS = Math.floor(6100 / 16);\n\nconst POINTS_PER_TICK = MAX_POINTS / MAX_TICKS;\n\nfunction ResultsView({ onNextStep, players, highScores, singSetupId }: Props) {\n    const [currentTick, setCurrentTick] = useState(0);\n    useKeyboard({\n        onEnter: onNextStep,\n    });\n    const help = useMemo(\n        () => ({\n            accept: 'Next',\n        }),\n        [],\n    );\n    useKeyboardHelp(help, true);\n\n    useEffect(() => {\n        if (currentTick >= MAX_TICKS) return;\n        const timeout = setTimeout(() => setCurrentTick((tick) => tick + 1), 16);\n\n        return () => clearTimeout(timeout);\n    }, [currentTick]);\n\n    const getPlayerScoreText = ([pointsPerBeat, counts]: [number, DetailedScore, DetailedScore]) =>\n        Math.min(sumDetailedScore(counts) * pointsPerBeat, POINTS_PER_TICK * currentTick);\n\n    const player1sum = getPlayerScoreText(players[0].detailedScore);\n    const player2sum = getPlayerScoreText(players[1].detailedScore);\n\n    const isHighScore = (playerName: string) =>\n        highScores.some((score) => score.singSetupId === singSetupId && score.name === playerName);\n\n    const isAnimDone = currentTick === MAX_TICKS;\n\n    return (\n        <>\n            <ScoresContainer>\n                <ScoreTextPlayer color={styles.colors.players[0].text} data-test=\"player-1-name\">\n                    {players[0].name}\n                </ScoreTextPlayer>\n                <br />\n                <ScoreTextScore\n                    highscore={isAnimDone && isHighScore(players[0].name)}\n                    color={styles.colors.players[0].text}\n                    win={isAnimDone && player1sum > player2sum}\n                    data-test=\"player-1-score\"\n                    data-score={player1sum}>\n                    <ScoreText score={player1sum} />\n                    <HighScoreBadge highscore={isAnimDone && isHighScore(players[0].name)}>High score!</HighScoreBadge>\n                </ScoreTextScore>\n                <br /> {/* xD */}\n                <br />\n                <br />\n                <br />\n                <ScoreTextScore\n                    highscore={isAnimDone && isHighScore(players[1].name)}\n                    color={styles.colors.players[1].text}\n                    win={isAnimDone && player2sum > player1sum}\n                    data-test=\"player-2-score\"\n                    data-score={player2sum}>\n                    <ScoreText score={player2sum} />\n                    <HighScoreBadge highscore={isAnimDone && isHighScore(players[0].name)}>High score!</HighScoreBadge>\n                </ScoreTextScore>\n                <br />\n                <ScoreTextPlayer color={styles.colors.players[1].text} data-test=\"player-2-name\">\n                    {players[1].name}\n                </ScoreTextPlayer>\n            </ScoresContainer>\n            <SongSelectionButton onClick={onNextStep} focused data-test=\"highscores-button\">\n                Next\n            </SongSelectionButton>\n        </>\n    );\n}\n\nconst ScoresContainer = styled.div`\n    position: absolute;\n    top: 20rem;\n    width: 100%;\n    text-align: center;\n`;\n\nconst ScoreTextPlayer = styled(ContentElement)<{ color: string }>`\n    padding-left: 10rem;\n    padding-right: 10rem;\n    font-size: 3.5rem;\n    color: rgb(${(props) => props.color});\n`;\n\nconst ScoreTextScore = styled(ScoreTextPlayer)<{ win: boolean; highscore: boolean; color: string }>`\n    font-size: ${(props) => (props.win ? '10.5rem' : '5.5rem')};\n    color: ${(props) => (props.win ? styles.colors.text.active : 'white')};\n    //color: white;\n    transition: 400ms ease-in-out;\n    position: relative;\n`;\n\nconst HighScoreBadge = styled.span<{ highscore: boolean }>`\n    position: absolute;\n    top: -1.5rem;\n    right: -10rem;\n\n    font-size: 3rem;\n    -webkit-text-stroke: 0.1rem black;\n    color: ${styles.colors.text.default};\n    padding: 0.5rem 1rem;\n    border-radius: 1.5rem;\n\n    ${(props) => props.highscore && buttonFocused};\n\n    opacity: ${(props) => (props.highscore ? '1' : '0')};\n    transition: 400ms;\n`;\n\nconst SongSelectionButton = styled(Button)<{ focused: boolean }>`\n    position: absolute;\n    bottom: 4rem;\n    right: 2rem;\n    width: 40rem;\n    font-size: 1.9vw;\n`;\n\nexport default ResultsView;\n","import styled from '@emotion/styled';\nimport { focusable, typography } from 'Elements/cssMixins';\nimport { REGULAR_ALPHA_CHARS } from 'hooks/useKeyboard';\nimport {\n    DetailedHTMLProps,\n    ForwardedRef,\n    forwardRef,\n    InputHTMLAttributes,\n    ReactNode,\n    useImperativeHandle,\n    useRef,\n} from 'react';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\n\ninterface Props extends Omit<DetailedHTMLProps<InputHTMLAttributes<HTMLInputElement>, HTMLInputElement>, 'onChange'> {\n    focused: boolean;\n    label: ReactNode;\n    value: string;\n    onChange: (value: string) => void;\n    disabled?: boolean;\n}\n\nexport const Input = forwardRef(\n    (\n        { focused, label, value, onChange, disabled, className, ...restProps }: Props,\n        forwardedRef: ForwardedRef<HTMLInputElement>,\n    ) => {\n        const inputRef = useRef<HTMLInputElement>(null);\n        useImperativeHandle(forwardedRef, () => inputRef.current!);\n\n        useHotkeys(REGULAR_ALPHA_CHARS, () => inputRef.current?.focus(), { enabled: focused });\n\n        return (\n            <Container focused={focused} className={className}>\n                <Label>{label}</Label>\n                <StyledInput\n                    value={value}\n                    onChange={(e) => onChange(e.target.value)}\n                    {...restProps}\n                    disabled={disabled}\n                    ref={inputRef}\n                />\n            </Container>\n        );\n    },\n);\n\nconst Container = styled.div<{ focused: boolean }>`\n    background: black;\n    caret: underscore;\n    ${focusable};\n    ${typography};\n    width: auto;\n    display: flex;\n    cursor: text;\n    padding: 0.25em;\n    align-items: center;\n`;\n\nconst Label = styled.span`\n    padding-right: 0.5em;\n    white-space: nowrap;\n    width: auto;\n`;\n\nconst StyledInput = styled.input`\n    padding: 0;\n    border: 0;\n    background: transparent;\n    caret: underscore;\n    ${typography};\n    color: ${styles.colors.text.active};\n    width: 100%;\n    font-size: 1em;\n\n    &:focus {\n        outline: none;\n    }\n`;\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport { Input } from 'Elements/Input';\nimport { nextIndex } from 'Elements/Switcher';\nimport {\n    ForwardedRef,\n    forwardRef,\n    KeyboardEventHandler,\n    ReactNode,\n    useImperativeHandle,\n    useMemo,\n    useRef,\n    useState,\n} from 'react';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\n\ninterface Props {\n    focused: boolean;\n    label: ReactNode;\n    value: string;\n    onChange: (value: string) => void;\n    disabled?: boolean;\n    options: string[];\n    placeholder?: string;\n    keyboardNavigationChangeFocus?: (direction: -1 | 1) => void;\n    onBlur?: () => void;\n    className?: string;\n}\n\nexport const Autocomplete = forwardRef(\n    (\n        {\n            options,\n            focused,\n            label,\n            value,\n            onChange,\n            disabled,\n            placeholder,\n            keyboardNavigationChangeFocus,\n            onBlur,\n            className,\n            ...restProps\n        }: Props,\n        forwardedRef: ForwardedRef<HTMLInputElement | null>,\n    ) => {\n        const inputRef = useRef<HTMLInputElement>(null);\n        useImperativeHandle(forwardedRef, () => inputRef.current!);\n\n        const autocompleteMenu = useRef<HTMLDivElement>(null);\n\n        const [isInputFocused, setIsInputFocused] = useState(false);\n        const [focusedOption, setFocusedOption] = useState(-1);\n\n        const filteredOptions = useMemo(\n            () =>\n                options.filter(\n                    (option) => option.toLowerCase().trim().includes(value.toLowerCase().trim()) && option !== value,\n                ),\n            [options, value],\n        );\n\n        const handleKeyDown: KeyboardEventHandler<HTMLInputElement> = (e) => {\n            if (e.code === 'ArrowUp' || e.code === 'ArrowDown') {\n                if (filteredOptions.length) {\n                    e.preventDefault();\n                    const newIndex = nextIndex(filteredOptions, focusedOption, e.code === 'ArrowUp' ? -1 : 1);\n                    setFocusedOption(newIndex);\n\n                    const option = autocompleteMenu.current?.querySelector(\n                        `[data-index=\"${newIndex}\"]`,\n                    ) as HTMLDivElement;\n\n                    option?.scrollIntoView({ behavior: 'smooth', block: 'center' });\n                } else {\n                    inputRef.current?.blur();\n                    keyboardNavigationChangeFocus?.(e.code === 'ArrowUp' ? -1 : 1);\n                }\n            } else if (e.code === 'Enter') {\n                const option = filteredOptions[focusedOption];\n                if (option) {\n                    setFocusedOption(-1);\n                    onChange(option);\n                } else {\n                    inputRef.current?.blur();\n                }\n            }\n        };\n\n        const handleBlur = () => {\n            setTimeout(() => {\n                setIsInputFocused(false);\n                onBlur?.();\n            }, 300);\n        };\n\n        return (\n            <Container className={className}>\n                <Input\n                    onFocus={() => setIsInputFocused(true)}\n                    onBlur={handleBlur}\n                    onKeyDown={handleKeyDown}\n                    onChange={onChange}\n                    value={value}\n                    focused={focused}\n                    label={label}\n                    disabled={disabled}\n                    ref={inputRef}\n                    placeholder={placeholder}\n                    {...restProps}\n                />\n                {isInputFocused && !!filteredOptions.length && (\n                    <AutocompleteMenu ref={autocompleteMenu} role=\"listbox\">\n                        {filteredOptions.map((option, index) => (\n                            <AutocompleteMenuitem\n                                role=\"listitem\"\n                                data-index={index}\n                                data-focused={index === focusedOption}\n                                key={option}\n                                focused={index === focusedOption}\n                                onClick={() => {\n                                    onChange(option);\n                                    setFocusedOption(-1);\n                                    inputRef.current?.blur();\n                                }}>\n                                {option}\n                            </AutocompleteMenuitem>\n                        ))}\n                    </AutocompleteMenu>\n                )}\n            </Container>\n        );\n    },\n);\n\nconst Container = styled.div`\n    position: relative;\n`;\n\nconst AutocompleteMenu = styled.div`\n    margin-top: 0.1em;\n    position: absolute;\n    width: 100%;\n    background: black;\n    max-height: ${(1 + 2 * 0.3) * 4}em;\n    overflow-y: auto;\n    z-index: 2;\n`;\n\nconst AutocompleteMenuitem = styled.div<{ focused: boolean }>`\n    ${typography};\n    padding: 0.3em;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    color: ${(props) => (props.focused ? styles.colors.text.active : 'white')};\n    cursor: pointer;\n`;\n\ninterface TestWrapperProps {\n    label: string;\n    options: string[];\n    focused: boolean;\n}\n\nexport const AutocompleteTestWrapper = ({ label, options, focused }: TestWrapperProps) => {\n    const [value, setValue] = useState('');\n    return <Autocomplete value={value} onChange={setValue} label={label} options={options} focused={focused} />;\n};\n","import { PLAYER_NAMES_SESSION_STORAGE_KEY } from 'hooks/players/consts';\nimport { useMemo } from 'react';\n\nexport default function useRecentPlayerNames() {\n    return useMemo<string[]>(() => JSON.parse(sessionStorage.getItem(PLAYER_NAMES_SESSION_STORAGE_KEY)!) ?? [], []);\n}\n","import { Autocomplete } from 'Elements/Autocomplete';\nimport useRecentPlayerNames from 'hooks/players/useRecentPlayerNames';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { HighScoreEntity } from 'interfaces';\nimport { useRef, useState } from 'react';\n\ninterface Props {\n    index: number;\n    singSetupId: string;\n    score: HighScoreEntity;\n    register: ReturnType<typeof useKeyboardNav>['register'];\n    onSave: (singId: string, score: number, oldName: string, newName: string) => void;\n}\n\nfunction HighScoreRename({ score, register, singSetupId, onSave, index }: Props) {\n    const inputRef = useRef<HTMLInputElement | null>(null);\n    const [newName, setNewName] = useState('');\n    const playerNames = useRecentPlayerNames();\n\n    const onBlur = () => {\n        if (newName.trim().length && newName.trim() !== score.name)\n            onSave(singSetupId, score.score, score.name, newName);\n    };\n\n    return (\n        <Autocomplete\n            options={playerNames}\n            onChange={setNewName}\n            onBlur={onBlur}\n            value={newName}\n            label=\"\"\n            ref={inputRef}\n            {...register(`highscore-rename-${index}`, () => inputRef.current?.focus())}\n            placeholder={score.name}\n            data-test={`input-edit-highscore`}\n            data-original-name={score.name}\n        />\n    );\n}\n\nexport default HighScoreRename;\n","import styled from '@emotion/styled';\nimport { format } from 'date-fns';\nimport { Button } from 'Elements/Button';\nimport { typography } from 'Elements/cssMixins';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { HighScoreEntity, Song } from 'interfaces';\nimport ScoreText from 'Scenes/Game/Singing/GameOverlay/Components/ScoreText';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { useEditScore } from 'Songs/stats/hooks';\nimport HighScoreRename from './HighScoreRename';\n\ninterface Props {\n    onNextStep: () => void;\n    singSetupId: string;\n    highScores: HighScoreEntity[];\n    song: Song;\n}\n\nfunction HighScoresView({ onNextStep, highScores, singSetupId, song }: Props) {\n    const { register } = useKeyboardNav();\n    const editScore = useEditScore(song);\n\n    return (\n        <>\n            <ScoresContainer data-test=\"highscores-container\">\n                {highScores.map((score, index) => (\n                    <ScoreContainer isCurrentSing={score.singSetupId === singSetupId} key={index}>\n                        <ScorePosition>{index + 1}</ScorePosition>\n\n                        <ScorePlayerName>\n                            {score.singSetupId === singSetupId ? (\n                                <HighScoreRename\n                                    index={index}\n                                    score={score}\n                                    register={register}\n                                    singSetupId={singSetupId}\n                                    onSave={editScore}\n                                />\n                            ) : (\n                                score.name\n                            )}\n                        </ScorePlayerName>\n                        <ScoreScore>\n                            <ScoreText score={score.score} />\n                        </ScoreScore>\n                        <ScoreDate>{format(new Date(score.date), 'LLL do y')}</ScoreDate>\n                    </ScoreContainer>\n                ))}\n            </ScoresContainer>\n            <SongSelectionButton\n                {...register('play-next', onNextStep, undefined, true)}\n                data-test=\"play-next-song-button\">\n                Select song\n            </SongSelectionButton>\n        </>\n    );\n}\n\nconst ScoresContainer = styled.div`\n    position: absolute;\n    top: 20rem;\n    width: 100%;\n    text-align: center;\n    padding: 0 16rem;\n    box-sizing: border-box;\n`;\n\nconst ScoreContainer = styled.div<{ isCurrentSing: boolean }>`\n    position: relative;\n    ${typography};\n    font-size: 3.2rem;\n    display: flex;\n    background: ${(props) => (props.isCurrentSing ? 'rgba(0,0,0,.9)' : 'rgba(0,0,0,.5)')};\n    margin-bottom: 2rem;\n    padding: ${(props) => (props.isCurrentSing ? `0 1.5rem` : `1rem 3.2rem`)};\n    align-items: center;\n`;\nconst ScorePosition = styled.div`\n    padding: 0 1.6rem;\n    color: ${styles.colors.text.active};\n`;\nconst ScorePlayerName = styled.div`\n    text-align: left;\n    flex: 1;\n    padding: 1.6rem;\n`;\nconst ScoreScore = styled.div`\n    padding: 0 1rem;\n`;\nconst ScoreDate = styled.div`\n    position: absolute;\n    font-size: 2rem;\n    bottom: -1rem;\n    right: -1.6rem;\n    background: black;\n    padding: 0.5rem;\n`;\n\nconst SongSelectionButton = styled(Button)<{ focused: boolean }>`\n    position: absolute;\n    bottom: 4rem;\n    right: 2rem;\n    width: 40rem;\n    font-size: 1.9vw;\n`;\n\nexport default HighScoresView;\n","import { useRef } from 'react';\nimport { randomInt } from 'utils/randomValue';\nimport { QrCode2 } from '@mui/icons-material';\n\nconst data = [\n    <>\n        Start typing a name of a song in <strong>Song Selection</strong> to active Search feature\n    </>,\n    <>\n        Narrow down songs through <strong>playlists</strong> on the right in Song Selection\n    </>,\n    <>\n        Select <strong>Pass The Mic</strong> Game Mode to share the microphones and sing in a team\n    </>,\n    <>\n        Your scores and <strong>stats are saved</strong> in this browser - they will be available for the next party!\n    </>,\n    <>\n        You can remove irrelevant songs from the Song Selection in <strong>Edit Songs</strong> page\n    </>,\n    <>\n        If the game feels a bit jaggy with low FPS, check out <strong>Settings</strong> page\n    </>,\n    <>\n        Party is only getting started? Play <strong>Jukebox</strong> for the music and to see what songs are available\n    </>,\n    <>\n        Research shows that <strong>duet songs</strong> are that bit more fun than simple one-track ones\n    </>,\n    <>\n        Want to sing a <strong>new song</strong>? Find UltraStar version of it and import it with\n        <br />\n        <strong>Convert Ultrastar .txt</strong>\n    </>,\n    <>\n        The <strong>white pulse</strong> around selected song in Song Selection tries to match song's tempo\n    </>,\n    <>\n        The global karaoke market has been estimated to be worth nearly <strong>$10 billion</strong>\n    </>,\n    <>\n        Entire game (excl. song management) is navigable with <strong>Keyboard</strong>\n    </>,\n    <>\n        You can hide or show keyboard navigation help with <kbd>H</kbd> key\n    </>,\n    <>\n        In Song Selection, hold <kbd>â†‘</kbd> or <kbd>â†“</kbd> to jump to the next letter\n    </>,\n    <>\n        Add <strong>vibrato</strong> to the notes you sing to get additional <strong>bonus points</strong>\n    </>,\n    <>\n        You can control the game with your phone - click on the{' '}\n        <strong>\n            <QrCode2 />\n            QR Code Icon\n        </strong>{' '}\n        on the top right and follow the instructions\n    </>,\n];\n\ninterface Props {\n    as?: any;\n}\n\nexport const GameTip = ({ as = 'h4', ...restProps }: Props) => {\n    const randomValue = useRef(randomInt(0, data.length - 1));\n\n    const Component = as;\n    return <Component {...restProps}>{data[randomValue.current]}</Component>;\n};\n","import styled from '@emotion/styled';\nimport { DetailedScore, Song } from 'interfaces';\nimport { useState } from 'react';\nimport ResultsView from 'Scenes/Game/Singing/PostGame/Views/Results';\nimport SongPage from '../../SongPage';\nimport HighScoresView from './Views/HighScores';\nimport { GameTip } from 'Elements/GameTip';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\n\ninterface PlayerScore {\n    detailedScore: [number, DetailedScore, DetailedScore];\n    name: string;\n}\n\ninterface HighScoreEntity {\n    singSetupId: string;\n    name: string;\n    score: number;\n    date: string;\n}\n\ninterface Props {\n    width: number;\n    height: number;\n    song: Song;\n    onClickSongSelection: () => void;\n    players: PlayerScore[];\n    singSetupId: string;\n    highScores: HighScoreEntity[];\n}\n\nfunction PostGameView({ song, width, height, onClickSongSelection, players, highScores, singSetupId }: Props) {\n    useBackgroundMusic(true);\n    const [step, setStep] = useState<'results' | 'highscores'>('results');\n\n    return (\n        <SongPage songData={song} width={width} height={height}>\n            <Container>\n                {step === 'results' && (\n                    <ResultsView\n                        onNextStep={() => setStep('highscores')}\n                        players={players}\n                        singSetupId={singSetupId}\n                        highScores={highScores}\n                    />\n                )}\n                {step === 'highscores' && (\n                    <HighScoresView\n                        onNextStep={onClickSongSelection}\n                        singSetupId={singSetupId}\n                        highScores={highScores}\n                        song={song}\n                    />\n                )}\n                <PostGameTip active />\n            </Container>\n        </SongPage>\n    );\n}\n\nconst Container = styled.div`\n    pointer-events: auto;\n`;\n\nexport default PostGameView;\n\nconst PostGameTip = styled(GameTip)<{ active: boolean }>`\n    transition: 300ms;\n    transform: scale(${({ active }) => (active ? 1 : 0)});\n    position: absolute;\n    bottom: 20rem;\n    font-size: 3.2rem;\n    line-height: 1.25;\n    color: white;\n    text-align: center;\n    background: rgba(0, 0, 0, 0.75);\n    width: 100%;\n    box-sizing: border-box;\n\n    padding: 2rem 10rem;\n\n    kbd {\n        padding: 0.12rem 0.9rem;\n        border-radius: 1rem;\n        border: 0.5rem solid rgb(204, 204, 204);\n        border-bottom-color: rgb(150, 150, 150);\n        border-right-color: rgb(150, 150, 150);\n        color: rgb(51, 51, 51);\n        line-height: 1.4;\n        display: inline-block;\n        box-shadow: 0 0.1rem 0 rgba(0, 0, 0, 0.2), inset 0 0 0 0.2rem #ffffff;\n        background-color: rgb(247, 247, 247);\n        text-shadow: 0 0.1rem 0 #fff;\n        font-weight: normal;\n    }\n`;\n","import { HighScoreEntity, SingSetup, Song } from 'interfaces';\nimport { useMemo } from 'react';\nimport PostGameView from 'Scenes/Game/Singing/PostGame/PostGameView';\nimport { useSongStats } from 'Songs/stats/hooks';\nimport GameState from '../GameState/GameState';\nimport { calculateDetailedScoreData } from '../GameState/Helpers/calculateScore';\n\ninterface Props {\n    width: number;\n    height: number;\n    song: Song;\n    onClickSongSelection: () => void;\n    singSetup: SingSetup;\n}\n\nfunction useHighScores(song: Song, singSetup: SingSetup): HighScoreEntity[] {\n    const stats = useSongStats(song);\n\n    const highScores = useMemo(\n        () =>\n            stats?.scores\n                .filter(({ setup }) => setup.mode === singSetup.mode && setup.tolerance === singSetup.tolerance)\n                .map((score) =>\n                    score.scores.map((singleScore) => ({\n                        ...singleScore,\n                        date: score.date,\n                        singSetupId: score.setup.id,\n                    })),\n                )\n                .flat()\n                .sort((a, b) => b.score - a.score)\n                .slice(0, 5),\n        [stats, singSetup],\n    );\n\n    return highScores ?? [];\n}\n\nfunction PostGame({ song, width, height, onClickSongSelection, singSetup }: Props) {\n    const highScores = useHighScores(song, singSetup);\n    const playerScores = useMemo(\n        () =>\n            GameState.getPlayers().map((player, index) => ({\n                name: player.getName(),\n                detailedScore: calculateDetailedScoreData(player.getPlayerNotes(), song, player.getTrackIndex()),\n            })),\n        [song],\n    );\n\n    console.log(highScores);\n\n    return (\n        <PostGameView\n            singSetupId={singSetup.id}\n            song={song}\n            width={width}\n            height={height}\n            onClickSongSelection={onClickSongSelection}\n            players={playerScores}\n            highScores={highScores}\n        />\n    );\n}\n\nexport default PostGame;\n","export default \"__VITE_ASSET__0906c539__\"","const sleep = (ms: number) => new Promise<void>((resolve) => setTimeout(resolve, ms));\n\nexport default sleep;\n","import styled from '@emotion/styled';\nimport { SyntheticEvent, useEffect, useRef, useState } from 'react';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport { typography } from 'Elements/cssMixins';\nimport { useEventEffect, useEventListenerSelector } from 'GameEvents/hooks';\nimport GameState from 'Scenes/Game/Singing/GameState/GameState';\nimport { CircularProgress } from '@mui/material';\nimport { CheckCircleOutline } from '@mui/icons-material';\nimport backgroundMusic from 'assets/459342__papaninkasettratat__cinematic-music-short.mp3';\nimport { waitFinished } from 'SoundManager';\nimport sleep from 'utils/sleep';\nimport events from 'GameEvents/GameEvents';\n\ninterface Props {\n    onFinish: () => void;\n}\nfunction WaitForReadiness({ onFinish }: Props) {\n    const audio = useRef<HTMLAudioElement>(null);\n    const [areAllPlayersReady, setAreAllPlayersReady] = useState(false);\n\n    const [confirmedPlayers, setConfirmedPlayers] = useState<string[]>([]);\n    useEventEffect(events.readinessConfirmed, (deviceId) => {\n        setConfirmedPlayers((current) => [...current, deviceId]);\n    });\n\n    const players = useEventListenerSelector([events.inputListChanged, events.readinessConfirmed], () => {\n        return InputManager.getInputs().map((input, index) => [\n            input.deviceId!,\n            GameState.getPlayers()[index]?.getName() ?? undefined,\n        ]);\n    });\n\n    useEffect(() => {\n        (async () => {\n            // can't use `areAllPlayersReady` as it would need to be specified as useEffect dependency\n            let allInputsReady = false;\n            const inputsReady = InputManager.requestReadiness().then(() => {\n                allInputsReady = true;\n                setAreAllPlayersReady(true);\n            });\n            const minTimeElapsed = sleep(1_500);\n            const maxTimeElapsed = sleep(15_000);\n\n            // Only start the music if waiting for readiness takes some time\n            await sleep(250);\n            if (!allInputsReady) {\n                audio?.current?.play();\n            }\n\n            await Promise.race([Promise.all([inputsReady, minTimeElapsed]), maxTimeElapsed]);\n            if (!audio?.current?.paused) waitFinished.play();\n            await sleep(500);\n            audio?.current?.pause();\n            await sleep(1000);\n            onFinish();\n        })();\n    }, []);\n\n    const playerStatuses = players.map(([deviceId, name]) => ({\n        confirmed: confirmedPlayers.includes(deviceId),\n        name,\n    }));\n\n    return (\n        <>\n            {!areAllPlayersReady && (\n                <WaitingForReady>\n                    <span>\n                        Waiting for all players to click <strong>\"Ready\"</strong>\n                    </span>\n                    <PlayerList>\n                        {playerStatuses.map(({ confirmed, name }, index) => (\n                            <PlayerEntry\n                                key={index}\n                                data-test=\"player-confirm-status\"\n                                data-name={name}\n                                data-confirmed={confirmed}>\n                                {confirmed ? <CheckCircleOutline /> : <CircularProgress color=\"info\" size=\"1em\" />}{' '}\n                                {name ? name : 'Connecting...'}\n                            </PlayerEntry>\n                        ))}\n                    </PlayerList>\n                </WaitingForReady>\n            )}\n            <audio\n                src={backgroundMusic}\n                ref={audio}\n                hidden\n                autoPlay={false}\n                onPlay={(e: SyntheticEvent<HTMLAudioElement>) => {\n                    e.currentTarget.volume = 0.8;\n                }}\n            />\n        </>\n    );\n}\n\nconst WaitingForReady = styled.div`\n    top: 0;\n    left: 0;\n    z-index: 1000;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n    position: absolute;\n    width: 100%;\n    height: 100%;\n\n    font-size: 7rem;\n    ${typography};\n`;\n\nconst PlayerList = styled.div`\n    margin-top: 5rem;\n    display: flex;\n    flex-direction: column;\n    gap: 5rem;\n`;\n\nconst PlayerEntry = styled.div`\n    display: flex;\n    align-items: center;\n    //justify-content: center;\n    gap: 2rem;\n    svg {\n        width: 7rem;\n        height: 7rem;\n        stroke: black;\n    }\n`;\n\nexport default WaitForReadiness;\n","import { useEffect } from 'react';\n\nexport default function useBlockScroll() {\n    useEffect(() => {\n        document.body.classList.add('blockOverflow');\n        document.documentElement.classList.add('blockOverflow');\n\n        return () => {\n            document.body.classList.remove('blockOverflow');\n            document.documentElement.classList.remove('blockOverflow');\n        };\n    }, []);\n}\n","import styled from '@emotion/styled';\nimport { VideoState } from 'Elements/VideoPlayer';\nimport useSong from 'Songs/hooks/useSong';\nimport useFullscreen from 'hooks/useFullscreen';\nimport { GAME_MODE, SingSetup } from 'interfaces';\nimport { useMemo, useRef, useState } from 'react';\nimport GameState from 'Scenes/Game/Singing/GameState/GameState';\nimport events from 'GameEvents/GameEvents';\nimport calculateScore from 'Scenes/Game/Singing/GameState/Helpers/calculateScore';\nimport TransitionWrapper from '../../../Elements/TransitionWrapper';\nimport useViewportSize from '../../../hooks/useViewportSize';\nimport generatePlayerChanges from './Helpers/generatePlayerChanges';\nimport Player, { PlayerRef } from './Player';\nimport PostGame from './PostGame/PostGame';\nimport WaitForReadiness from 'Scenes/Game/Singing/WaitForReadiness';\nimport { useBackground } from 'Elements/LayoutWithBackground';\nimport useBlockScroll from 'hooks/useBlockScroll';\n\ninterface Props {\n    video: string;\n    songFile: string;\n    singSetup: SingSetup;\n    returnToSongSelection: () => void;\n    restartSong: () => void;\n}\nfunction Singing({ video, songFile, singSetup, returnToSongSelection, restartSong }: Props) {\n    useFullscreen();\n    useBlockScroll();\n    const player = useRef<PlayerRef | null>(null);\n    const song = useSong(songFile);\n\n    const { width, height } = useViewportSize();\n    const [isEnded, setIsEnded] = useState(false);\n    const [playerState, setPlayerState] = useState(VideoState.UNSTARTED);\n\n    const playerChanges = useMemo(() => {\n        if (!song.data) return [];\n        if (singSetup.mode !== GAME_MODE.PASS_THE_MIC) return song.data.tracks.map(() => []);\n\n        return generatePlayerChanges(song.data);\n    }, [song.data, singSetup]);\n\n    const [isTransitionTimeout, setIsTransitionTimeout] = useState(false);\n\n    useBackground(!isTransitionTimeout);\n\n    if (!width || !height || !song.data) return <>Loading</>;\n\n    if (isEnded) {\n        return (\n            <PostGame\n                width={width}\n                height={height}\n                song={song.data}\n                onClickSongSelection={returnToSongSelection}\n                singSetup={singSetup}\n            />\n        );\n    } else {\n        return (\n            <Container>\n                <BackgroundContainer>\n                    <TransitionWrapper show={!isTransitionTimeout && playerState === VideoState.UNSTARTED}>\n                        <>\n                            <Overlay video={video} width={width} height={height} />\n                            <WaitForReadiness\n                                onFinish={() => {\n                                    setIsTransitionTimeout(true);\n                                    player.current?.play();\n                                }}\n                            />\n                        </>\n                    </TransitionWrapper>\n                </BackgroundContainer>\n                <Player\n                    ref={player}\n                    onStatusChange={setPlayerState}\n                    playerChanges={playerChanges}\n                    players={singSetup.players}\n                    song={song.data}\n                    width={width}\n                    height={height}\n                    autoplay={false}\n                    onSongEnd={() => {\n                        const scores = GameState.getPlayers().map((player) => ({\n                            name: player.getName(),\n                            score: calculateScore(player.getPlayerNotes(), song.data!, player.getTrackIndex()),\n                        }));\n                        events.songEnded.dispatch(song.data!, singSetup, scores);\n                        setIsEnded(true);\n                    }}\n                    singSetup={singSetup}\n                    restartSong={restartSong}\n                />\n            </Container>\n        );\n    }\n}\n\nconst Container = styled.div`\n    position: relative;\n`;\n\nconst BackgroundContainer = styled.div`\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 10;\n    pointer-events: none;\n`;\n\nconst BaseOverlay = styled.div`\n    background-size: cover;\n    background-position: center center;\n    filter: blur(10px);\n`;\n\nconst Overlay = (props: { video: string; width: number; height: number }) => (\n    <BaseOverlay\n        style={{\n            backgroundImage: `url('https://i3.ytimg.com/vi/${props.video}/hqdefault.jpg')`,\n            width: `${props.width}px`,\n            height: `${props.height}px`,\n        }}\n    />\n);\n\nexport default Singing;\n","function generateLangMap() {\n    const langNames = new Intl.DisplayNames(['en'], { type: 'language' });\n    const langMap: Record<string, string> = {};\n    for (let i = 0; i < 26; i++) {\n        for (let j = 0; j < 26; j++) {\n            let code = String.fromCharCode(97 + i) + String.fromCharCode(97 + j);\n            let name = langNames.of(code);\n            if (name !== code && name !== undefined) {\n                langMap[name] = code;\n            }\n        }\n    }\n    const langMap2: Record<string, string> = {\n        // Avoid using deprecated codes:\n        Akan: 'ak',\n        Hebrew: 'he',\n        Indonesian: 'id',\n        Javanese: 'jv',\n        Romanian: 'ro',\n        Yiddish: 'yi',\n        // Optional extras:\n        Tagalog: 'tl',\n        English: 'gb',\n        Korean: 'kr',\n        Swedish: 'se',\n        Latin: 'va',\n    };\n    return { ...langMap, ...langMap2 };\n}\n\n// Usage:\nconst langMap = generateLangMap();\n\nexport default function (language: string) {\n    return langMap[language];\n}\n","import { MenuButton } from 'Elements/Menu';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { ExcludedLanguagesSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport useSongIndex from 'Songs/hooks/useSongIndex';\nimport styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport languageNameToIsoCode from 'utils/languageNameToIsoCode';\nimport { SongPreview } from 'interfaces';\nimport { useMemo } from 'react';\nimport { CheckBox, CheckBoxOutlineBlank } from '@mui/icons-material';\nimport { css } from '@emotion/react';\nimport isE2E from 'utils/isE2E';\nimport MenuWithLogo from 'Elements/MenuWithLogo';\n\nexport const useLanguageList = (list: SongPreview[]) => {\n    return useMemo(() => {\n        const langs: Record<string, { name: string; count: number }> = {};\n\n        list.forEach((song) => {\n            if (!song.language) return;\n\n            const langId = song.language?.toLowerCase();\n            if (!langs[langId]) {\n                langs[langId] = { name: song.language!, count: 0 };\n            }\n            langs[langId].count = langs[langId].count + 1;\n        });\n\n        return Object.values(langs);\n    }, [list]);\n};\n\ninterface Props {\n    onClose: () => void;\n    closeText: string;\n}\n\nconst MIN_SONGS_COUNT = isE2E() ? 0 : 3;\n\nfunction ExcludeLanguagesView({ onClose, closeText }: Props) {\n    const { register } = useKeyboardNav({ onBackspace: onClose });\n\n    const [excludedLanguages, setExcludedLanguages] = useSettingValue(ExcludedLanguagesSetting);\n    const { data } = useSongIndex();\n    const availableLanguages = useLanguageList(data);\n    const languageList = useMemo(\n        () =>\n            availableLanguages\n                .filter(({ name, count }) => languageNameToIsoCode(name) && count >= MIN_SONGS_COUNT)\n                .sort((a, b) => b.count - a.count),\n        [availableLanguages],\n    );\n\n    const toggleLanguage = (language: string) => {\n        if (excludedLanguages === null) setExcludedLanguages([language]);\n        else if (!excludedLanguages.includes(language)) setExcludedLanguages([...excludedLanguages, language]);\n        else setExcludedLanguages(excludedLanguages.filter((lang) => lang !== language));\n    };\n\n    return (\n        <MenuWithLogo>\n            <h1>Select Song Languages</h1>\n            <LanguageListContainer>\n                {languageList.map(({ name, count }) => {\n                    const excluded = excludedLanguages?.includes(name) ?? false;\n                    return (\n                        <LanguageEntry\n                            key={name}\n                            excluded={excluded}\n                            {...register(`lang-${name}`, () => toggleLanguage(name))}\n                            data-test={`lang-${name}`}>\n                            <Check>{excluded ? <CheckBoxOutlineBlank /> : <CheckBox />}</Check>\n                            <span>\n                                <LanguageName>{name}</LanguageName> ({count} songs)\n                            </span>\n                            <LanguageFlagBackground excluded={excluded}>\n                                <img\n                                    src={`https://flagcdn.com/${languageNameToIsoCode(name)}.svg`}\n                                    alt={languageNameToIsoCode(name)}\n                                />\n                            </LanguageFlagBackground>\n                        </LanguageEntry>\n                    );\n                })}\n            </LanguageListContainer>\n            <h4>\n                You can always update the selection in <strong>Manage Songs</strong> menu\n            </h4>\n            <MenuButton {...register('go back', onClose, undefined, true)} data-test=\"close-exclude-languages\">\n                {closeText}\n            </MenuButton>\n        </MenuWithLogo>\n    );\n}\n\nconst Check = styled.div`\n    svg {\n        width: 4rem;\n        height: 4rem;\n    }\n`;\n\nconst LanguageListContainer = styled.div`\n    margin-top: 2rem;\n`;\nconst LanguageName = styled.span`\n    transition: 300ms;\n`;\n\nconst LanguageFlagBackground = styled.div<{ excluded: boolean }>`\n    transition: 300ms;\n    opacity: 0.6;\n    ${(props) =>\n        props.excluded\n            ? css`\n                  filter: grayscale(1);\n                  opacity: 0.5;\n              `\n            : ''}\n\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    img {\n        width: 17rem;\n        margin: 1.5rem 0 0 0.5rem;\n    }\n    overflow: hidden;\n    width: 17rem;\n    height: 10rem;\n`;\n\nconst LanguageEntry = styled(MenuButton)<{ excluded: boolean; focused: boolean }>`\n    ${(props) =>\n        props.excluded\n            ? css`\n                  ${props.focused ? '' : 'background: rgba(0, 0, 0, 0.55)'};\n                  ${LanguageName} {\n                      text-decoration: line-through white;\n                      opacity: 0.5;\n                  }\n              `\n            : ''}\n    ${typography};\n    display: flex;\n    align-items: center;\n    gap: 2rem;\n    font-size: 3rem;\n    padding-left: 3rem;\n\n    position: relative;\n\n    width: 100%;\n`;\n\nexport default ExcludeLanguagesView;\n","import styled from '@emotion/styled';\nimport { Button } from 'Elements/Button';\nimport { typography } from 'Elements/cssMixins';\nimport useKeyboard from 'hooks/useKeyboard';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { useEffect, useMemo } from 'react';\nimport { AppliedFilters } from 'Scenes/SingASong/SongSelection/Hooks/useSongList';\nimport { addDays } from 'date-fns';\n\ninterface PlaylistEntry {\n    name: string;\n    filters: AppliedFilters;\n}\n\nconst usePlaylists = (): PlaylistEntry[] =>\n    useMemo(\n        () => [\n            { name: 'All', filters: {} },\n            { name: 'Polish', filters: { language: 'Polish' } },\n            { name: 'English', filters: { language: 'English' } },\n            { name: 'Classics', filters: { yearBefore: 1995 } },\n            { name: 'Modern', filters: { yearAfter: 1995 } },\n            { name: 'Duets', filters: { duet: true } },\n            { name: 'New', filters: { updatedAfter: addDays(new Date(), -21).toISOString() } },\n        ],\n        [],\n    );\n\ninterface Props {\n    setFilters: (filters: AppliedFilters) => void;\n    closePlaylist: (leavingKey: 'left' | 'right') => void;\n    active: boolean;\n}\n\nexport default function Playlists({ setFilters, active, closePlaylist }: Props) {\n    const playlists = usePlaylists();\n\n    const { register, focused, focusElement } = useKeyboardNav({\n        enabled: active,\n        additionalHelp: {\n            // It's possible to leave the playlists with left/right\n            vertical: undefined,\n            'horizontal-vertical': null,\n        },\n    });\n\n    useEffect(() => {\n        if (focused) {\n            const playlist = playlists.find((list) => list.name === focused);\n            playlist && setFilters(playlist.filters);\n        }\n    }, [focused, playlists]);\n\n    useKeyboard(\n        {\n            onLeftArrow: () => closePlaylist('left'),\n            onRightArrow: () => closePlaylist('right'),\n        },\n        active,\n    );\n\n    return (\n        <Container data-test=\"song-list-playlists\">\n            {playlists.map((playlist) => (\n                <Playlist\n                    data-test={`playlist-${playlist.name}`}\n                    key={playlist.name}\n                    {...register(playlist.name, () => focusElement(playlist.name))}\n                    {...(!active ? { focused: false, active: playlist.name === focused } : {})}>\n                    {playlist.name}\n                </Playlist>\n            ))}\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    background: rgba(0, 0, 0, 0.7);\n    width: 100vh;\n    transform-origin: 0 0;\n    transform: rotate(90deg);\n    position: absolute;\n    right: -100vh;\n    top: 0;\n    font-size: 3.6rem;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: row;\n\n    h2 {\n        ${typography};\n        margin: 0;\n    }\n`;\n\nconst Playlist = styled(Button)<{ active?: boolean }>`\n    font-size: 3rem;\n    flex: 1;\n    padding: 1.5rem;\n    ${(props) => props.active === false && `opacity: .5;`}\n`;\n","import styled from '@emotion/styled';\nimport { Input } from 'Elements/Input';\nimport { REGULAR_ALPHA_CHARS } from 'hooks/useKeyboard';\nimport { useEffect, useRef, useState } from 'react';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport { AppliedFilters } from 'Scenes/SingASong/SongSelection/Hooks/useSongList';\n\ninterface Props {\n    onSongFiltered: (filters: AppliedFilters) => void;\n    filters: AppliedFilters;\n    showFilters: boolean;\n}\nexport default function QuickSearch({ onSongFiltered, filters }: Props) {\n    const searchInput = useRef<HTMLInputElement | null>(null);\n    const [isFocused, setIsFocused] = useState(false);\n\n    const onLeave = () => {\n        searchInput.current?.blur();\n    };\n\n    useHotkeys('down', onLeave, { enabled: isFocused, enableOnTags: ['INPUT'] });\n\n    const focusSearch = (key?: string) => {\n        const searchLength = filters.search?.length ?? 0;\n        if (searchLength > 1) {\n            onSongFiltered({\n                ...filters,\n                search: ' ',\n            });\n        } else if (searchLength === 0 && key) {\n            onSongFiltered({\n                ...filters,\n                search: key,\n            });\n        }\n\n        searchInput.current?.focus();\n    };\n\n    useHotkeys(\n        REGULAR_ALPHA_CHARS,\n        (e) => {\n            focusSearch(e.key);\n        },\n        { enabled: !isFocused },\n    );\n\n    useHotkeys(\n        'Backspace',\n        (e) => {\n            focusSearch();\n        },\n        { enabled: !isFocused },\n    );\n    const setSearch = (value: string) => {\n        onSongFiltered({\n            ...filters,\n            search: value.trim(),\n        });\n    };\n\n    useEffect(() => {\n        searchInput.current?.focus();\n    }, [searchInput]);\n\n    return (\n        <Container data-test=\"song-list-search\">\n            <FilterItem large>\n                <form\n                    data-test=\"filters-search-form\"\n                    onSubmit={(e) => {\n                        e.preventDefault();\n                        searchInput.current?.blur();\n                    }}>\n                    <Input\n                        onFocus={() => setIsFocused(true)}\n                        onBlur={() => setIsFocused(false)}\n                        focused={isFocused}\n                        label=\"Search\"\n                        value={filters.search ?? ''}\n                        onChange={setSearch}\n                        ref={searchInput}\n                        data-test=\"filters-search\"\n                    />\n                </form>\n            </FilterItem>\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    background: rgba(0, 0, 0, 0.7);\n    padding: 2rem;\n    font-size: 3rem;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: row;\n    gap: 2rem;\n    position: fixed;\n    z-index: 200;\n    top: 4.5rem;\n    left: 30rem;\n    right: 30rem;\n`;\n\nconst FilterItem = styled.div<{ large?: boolean }>`\n    flex: ${(props) => (props.large ? 1.5 : 1)};\n`;\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport { useEffect, useState } from 'react';\n\ninterface Props {\n    keyboardControl: boolean;\n}\n\nconst SHOW_TIP_TIMEOUT_MS = 10_000;\n\nexport default function SelectRandomTip({ keyboardControl }: Props) {\n    const [isVisible, setIsVisible] = useState(false);\n    useEffect(() => {\n        if (!keyboardControl) {\n            setIsVisible(false);\n        } else {\n            const timeout = setTimeout(() => setIsVisible(true), SHOW_TIP_TIMEOUT_MS);\n\n            return () => clearTimeout(timeout);\n        }\n    }, [keyboardControl]);\n    return (\n        <Container visible={isVisible}>\n            Can't decide? Click <Kbd>Shift</Kbd> + <Kbd>R</Kbd> to pick random song\n        </Container>\n    );\n}\n\nconst Container = styled.div<{ visible: boolean }>`\n    @keyframes shake {\n        2.5%,\n        22.5% {\n            transform: translate3d(-0.1rem, 0, 0);\n        }\n\n        5%,\n        20% {\n            transform: translate3d(0.2rem, 0, 0);\n        }\n\n        7.5%,\n        12.5%,\n        17.5% {\n            transform: translate3d(-0.4rem, 0, 0);\n        }\n\n        10%,\n        15% {\n            transform: translate3d(0.4rem, 0, 0);\n        }\n    }\n    animation: shake 5s both infinite;\n    ${typography};\n    pointer-events: none;\n    position: fixed;\n    transform: scale(${(props) => (props.visible ? 1 : 0)});\n    opacity: ${(props) => (props.visible ? 1 : 0)};\n    text-align: center;\n    font-size: 4.8rem;\n    text-shadow: 0 0 3.5rem black, 0 0 3.5rem black, 0 0 3.5rem black, 0 0 3.5rem black, 0 0 3.5rem black,\n        0 0 3.5rem black, 0 0 3.5rem black;\n    width: 100%;\n    z-index: 4;\n    padding: 2.5rem;\n    transition: ease 500ms;\n`;\n\nconst Kbd = styled.kbd<{ disabled?: boolean }>`\n    margin: 0.1rem;\n    padding: 0.2rem 2rem;\n    border-radius: 1.5rem;\n    border: 0.6rem solid rgb(204, 204, 204);\n    border-bottom-color: rgb(150, 150, 150);\n    border-right-color: rgb(150, 150, 150);\n    line-height: 1.4;\n    display: inline-block;\n    background-color: rgb(247, 247, 247);\n    text-shadow: 0 0.5rem 0 #fff;\n\n    opacity: ${(props) => (props.disabled ? 0.25 : 1)};\n`;\n","import { useEffect, useRef, type MutableRefObject } from 'react';\n\n/**\n * a type-safe version of the `usePrevious` hook described here:\n * @see {@link https://reactjs.org/docs/hooks-faq.html#how-to-get-the-previous-props-or-state}\n */\nexport default function usePrevious<T>(value: T): MutableRefObject<T>['current'] {\n    const ref = useRef<T>(value);\n    useEffect(() => {\n        ref.current = value;\n    }, [value]);\n    return ref.current;\n}\n","import useSongIndex from 'Songs/hooks/useSongIndex';\nimport { SongPreview } from 'interfaces';\nimport { uniq } from 'lodash-es';\nimport { useMemo, useState } from 'react';\nimport clearString from 'utils/clearString';\nimport { isAfter } from 'date-fns';\nimport { ExcludedLanguagesSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\n\nexport interface SongGroup {\n    letter: string;\n    songs: Array<{ index: number; song: SongPreview }>;\n    isNew?: boolean;\n}\n\nexport interface AppliedFilters {\n    yearBefore?: number;\n    yearAfter?: number;\n    language?: string;\n    excludeLanguages?: string[];\n    search?: string;\n    updatedAfter?: string;\n    duet?: boolean | null;\n}\n\nexport function isEmptyFilters(filters: AppliedFilters) {\n    return (\n        (!filters.language || filters.language === '') &&\n        (!filters.search || filters.search === '') &&\n        (filters.duet === undefined || filters.duet === null) &&\n        !filters.yearBefore &&\n        !filters.yearAfter\n    );\n}\n\nexport interface FiltersData {\n    language: {\n        current: string;\n        available: string[];\n    };\n    status: {\n        allSongs: number;\n        visible: number;\n    };\n}\n\ntype FilterFunc = (songList: SongPreview[], ...args: any) => SongPreview[];\n\nconst filteringFunctions: Record<keyof AppliedFilters, FilterFunc> = {\n    language: (songList, language: string) => {\n        if (language === '') return songList;\n        const filterValue = language === 'Unknown' ? undefined : language;\n\n        return songList.filter((song) => song.language === filterValue);\n    },\n    excludeLanguages: (songList, languages: string[] = []) => {\n        if (languages.length === 0) return songList;\n\n        return songList.filter((song) => !languages.includes(song.language ?? ''));\n    },\n    search: (songList, search: string) => {\n        const cleanSearch = clearString(search);\n\n        return cleanSearch.length ? songList.filter((song) => song.search.includes(cleanSearch)) : songList;\n    },\n    duet: (songList, duet: boolean | null) => {\n        if (duet === null) return songList;\n\n        return songList.filter((song) => (duet ? song.tracksCount > 1 : song.tracksCount === 1));\n    },\n    yearBefore: (songList, yearBefore: number) => {\n        if (!yearBefore) return songList;\n\n        return songList.filter((song) => Number(song.year) < yearBefore);\n    },\n    yearAfter: (songList, yearAfter: number) => {\n        if (!yearAfter) return songList;\n\n        return songList.filter((song) => Number(song.year) >= yearAfter);\n    },\n    updatedAfter: (songList, after: string) => {\n        if (!after) return songList;\n        const dateAfter = new Date(after);\n\n        return songList.filter((song) => song.lastUpdate && isAfter(new Date(song.lastUpdate), dateAfter));\n    },\n};\n\nconst applyFilters = (list: SongPreview[], filters: AppliedFilters): SongPreview[] => {\n    return Object.entries(filters)\n        .filter((filters): filters is [keyof AppliedFilters, FilterFunc] => filters[0] in filteringFunctions)\n        .reduce((songList, [name, value]) => filteringFunctions[name](songList, value), list);\n};\n\nexport const useLanguageFilter = (list: SongPreview[]) => {\n    return useMemo(() => uniq(['', ...list.map((song) => song.language ?? 'Unknown')]), [list]);\n};\n\nexport const useSongListFilter = (list: SongPreview[]) => {\n    const availableLanguages = useLanguageFilter(list);\n    const [excludedLanguages] = useSettingValue(ExcludedLanguagesSetting);\n\n    const [filters, setFilters] = useState<AppliedFilters>({});\n\n    const initiallyFilteredList = useMemo(\n        () => applyFilters(list, { excludeLanguages: excludedLanguages ?? [] }),\n        [list, excludedLanguages],\n    );\n    const filteredList = useMemo(() => applyFilters(initiallyFilteredList, filters), [initiallyFilteredList, filters]);\n\n    const filtersData: FiltersData = {\n        language: {\n            current: filters.language ?? '',\n            available: availableLanguages,\n        },\n        status: {\n            allSongs: list.length,\n            visible: filteredList.length,\n        },\n    };\n\n    return { filters, filteredList, filtersData, setFilters };\n};\n\nexport default function useSongList() {\n    const songList = useSongIndex();\n\n    const { filters, filtersData, filteredList, setFilters } = useSongListFilter(songList.data);\n\n    const groupedSongList = useMemo(() => {\n        if (filteredList.length === 0) return [];\n\n        const groups: SongGroup[] = [];\n\n        if (!filters.search) {\n            const newSongs = filteredList.filter((song) => song.isNew);\n\n            if (newSongs.length) {\n                groups.push({\n                    letter: 'New',\n                    isNew: true,\n                    songs: newSongs.map((song) => ({ song, index: filteredList.indexOf(song) })),\n                });\n            }\n        }\n\n        filteredList.forEach((song, index) => {\n            const firstCharacter = isFinite(+song.artist[0]) ? '0-9' : song.artist[0].toUpperCase();\n            let group = groups.find((group) => group.letter === firstCharacter);\n            if (!group) {\n                group = { letter: firstCharacter, songs: [] };\n                groups.push(group);\n            }\n\n            group.songs.push({ index: index, song });\n        });\n\n        return groups;\n    }, [filteredList, filters.search]);\n\n    return {\n        groupedSongList,\n        songList: filteredList,\n        filtersData,\n        filters,\n        setFilters,\n        isLoading: songList.isLoading,\n    };\n}\n","import useKeyboard from 'hooks/useKeyboard';\nimport { chunk, throttle } from 'lodash-es';\nimport posthog from 'posthog-js';\nimport { useCallback, useEffect, useLayoutEffect, useMemo, useState } from 'react';\nimport { menuBack, menuEnter, menuNavigate } from 'SoundManager';\nimport { randomInt } from 'utils/randomValue';\nimport useKeyboardHelp from 'hooks/useKeyboardHelp';\nimport usePrevious from 'hooks/usePrevious';\nimport tuple from 'utils/tuple';\nimport { AppliedFilters, SongGroup } from 'Scenes/SingASong/SongSelection/Hooks/useSongList';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\n\nconst MAX_SONGS_PER_ROW = 4;\n\nconst useTwoDimensionalNavigation = (groups: SongGroup[] = []) => {\n    const [cursorPosition, setCursorPosition] = useState<[number, number]>([0, 0]);\n    const songIndexMatrix = useMemo(\n        () =>\n            groups\n                .map(({ songs }) =>\n                    chunk(\n                        songs.map((song) => song.index),\n                        MAX_SONGS_PER_ROW,\n                    ),\n                )\n                .flat(),\n        [groups],\n    );\n    const songGroupMatrix = useMemo(\n        () =>\n            groups\n                .map(({ songs, letter }) =>\n                    chunk(\n                        songs.map(() => letter),\n                        MAX_SONGS_PER_ROW,\n                    ),\n                )\n                .flat(),\n        [groups],\n    );\n    const previousMatrix = usePrevious(songIndexMatrix ?? []);\n\n    const isAtLastColumn = cursorPosition[0] === songIndexMatrix[cursorPosition[1]]?.length - 1;\n\n    const moveToSong = useCallback(\n        (songIndex: number) => {\n            const y = songIndexMatrix.findIndex((columns) => columns.includes(songIndex));\n            const x = songIndexMatrix[y]?.indexOf(songIndex);\n            if (x >= 0 && y >= 0) {\n                setCursorPosition([x ?? 0, y ?? 0]);\n            } else {\n                setCursorPosition([0, 0]);\n            }\n        },\n        [songIndexMatrix],\n    );\n\n    const positionToValue = <T>([x, y]: [number, number], matrix: T[][], def: T) => {\n        if (groups.length === 0) return def;\n        const row = matrix[y];\n        return row?.[x] ?? row?.at(-1) ?? matrix?.[0]?.[0] ?? def;\n    };\n    const positionToSongIndex = ([x, y]: [number, number], matrix: number[][] = songIndexMatrix) => {\n        return positionToValue([x, y], matrix, 0);\n    };\n    const positionToGroup = ([x, y]: [number, number], matrix: string[][] = songGroupMatrix) => {\n        return positionToValue([x, y], matrix, 'A');\n    };\n\n    useEffect(() => {\n        const previousFocusedSong = positionToSongIndex(cursorPosition, previousMatrix);\n        const currentFocusedSong = positionToSongIndex(cursorPosition, songIndexMatrix);\n        if (previousMatrix.length && previousFocusedSong !== currentFocusedSong) {\n            moveToSong(previousFocusedSong);\n        }\n    }, [cursorPosition, songIndexMatrix, previousMatrix, isAtLastColumn]);\n\n    const moveCursor = (plane: 'x' | 'y', delta: number) => {\n        menuNavigate.play();\n        setCursorPosition(([x, y]) => {\n            let newX = x;\n            let newY = y;\n            if (plane === 'y') {\n                newY = y + delta;\n            } else {\n                if (songIndexMatrix[y] === undefined) {\n                    debugger;\n                }\n                const maxXInRow = songIndexMatrix[y].length - 1;\n                newX = Math.min(x, maxXInRow) + delta;\n                if (newX < 0) {\n                    newY = (songIndexMatrix.length + y - 1) % songIndexMatrix.length;\n                    newX = songIndexMatrix[newY].length - 1;\n                } else if (newX > maxXInRow) {\n                    newY = y + 1;\n                    newX = 0;\n                }\n            }\n            return [newX % MAX_SONGS_PER_ROW, (songIndexMatrix.length + newY) % songIndexMatrix.length];\n        });\n    };\n\n    const focusedSong = positionToSongIndex(cursorPosition);\n    const focusedGroup = positionToGroup(cursorPosition);\n\n    return tuple([focusedSong, focusedGroup, cursorPosition, moveCursor, moveToSong, isAtLastColumn]);\n};\n\nexport const useSongSelectionKeyboardNavigation = (\n    enabled: boolean,\n    groupedSongs: SongGroup[] = [],\n    onEnter: () => void,\n    songCount: number,\n    appliedFilters: AppliedFilters,\n) => {\n    const navigate = useSmoothNavigate();\n    // We need to record how user entered (from which \"side\") and how left and based on that update the selection.\n    // Eg if user was at the last column, entered playlists, and returned to the last column (by clicking left)\n    // then effectively the selection shouldn't change\n    const [showPlaylistsState, setShowPlaylistsState] = useState<[boolean, 'left' | 'right' | null]>([false, null]);\n    const previousPlaylistsState = usePrevious(showPlaylistsState);\n    const [arePlaylistsVisible, leavingKey] = showPlaylistsState;\n\n    const [focusedSong, focusedGroup, cursorPosition, moveCursor, moveToSong, isAtLastColumn] =\n        useTwoDimensionalNavigation(groupedSongs);\n    const isAtFirstColumn = cursorPosition[0] === 0;\n\n    const handleEnter = () => {\n        menuEnter.play();\n        onEnter();\n    };\n\n    const handleBackspace = () => {\n        if (!appliedFilters.search) {\n            menuBack.play();\n            navigate('/');\n        }\n    };\n\n    const navigateToGroup = useCallback(\n        throttle(\n            (direction: 1 | -1, currentGroup: number) => {\n                const nextGroupIndex = (groupedSongs.length + currentGroup + direction) % groupedSongs.length;\n\n                moveToSong(groupedSongs[nextGroupIndex].songs[0].index);\n                menuNavigate.play();\n            },\n            700,\n            { trailing: false },\n        ),\n        [groupedSongs],\n    );\n\n    const navigateVertically = (e: KeyboardEvent | undefined, direction: 1 | -1) => {\n        if (!e?.repeat) {\n            moveCursor('y', direction);\n        } else {\n            const currentlySelectedGroupIndex = groupedSongs.findIndex(\n                (group) => !!group.songs.find((song) => song.index === focusedSong),\n            );\n            navigateToGroup(direction, currentlySelectedGroupIndex);\n        }\n    };\n\n    const navigateHorizontally = (direction: 1 | -1, ignoreFilters = false) => {\n        if (!ignoreFilters && direction === 1 && isAtLastColumn && !arePlaylistsVisible) {\n            setShowPlaylistsState([true, 'right']);\n        } else if (!ignoreFilters && direction === -1 && isAtFirstColumn && !arePlaylistsVisible) {\n            setShowPlaylistsState([true, 'left']);\n        } else {\n            moveCursor('x', direction);\n        }\n    };\n\n    const randomSong = () => {\n        const newIndex = randomInt(0, songCount - 1);\n        moveToSong(newIndex);\n    };\n\n    useKeyboard(\n        {\n            onEnter: handleEnter,\n            onDownArrow: (e) => navigateVertically(e, 1),\n            onUpArrow: (e) => navigateVertically(e, -1),\n            onLeftArrow: () => navigateHorizontally(-1),\n            onRightArrow: () => navigateHorizontally(1),\n            onBackspace: handleBackspace,\n            onR: () => {\n                randomSong();\n                posthog.capture('selectRandom');\n            },\n        },\n        enabled && !arePlaylistsVisible,\n        [groupedSongs, cursorPosition, arePlaylistsVisible, appliedFilters],\n    );\n\n    const help = useMemo(\n        () => ({\n            'horizontal-vertical': null,\n            accept: null,\n            back: null,\n            shiftR: null,\n        }),\n        [],\n    );\n    useKeyboardHelp(help, enabled);\n\n    const closePlaylist = useCallback(\n        (leavingKey: 'left' | 'right') => {\n            setShowPlaylistsState([false, leavingKey]);\n            // if (leavingKey === 'right') navigateHorizontally(1);\n        },\n        [setShowPlaylistsState, navigateHorizontally, groupedSongs, cursorPosition],\n    );\n\n    useLayoutEffect(() => {\n        const [previousShowFilters, enteringKey] = previousPlaylistsState;\n        if (previousShowFilters && !arePlaylistsVisible) {\n            if (enteringKey === leavingKey) navigateHorizontally(leavingKey === 'right' ? 1 : -1, true);\n        }\n    }, [arePlaylistsVisible, leavingKey, isAtFirstColumn, isAtLastColumn, ...cursorPosition]);\n\n    return tuple([focusedSong, focusedGroup, moveToSong, arePlaylistsVisible, closePlaylist]);\n};\n","import { useEffect, useState } from 'react';\nimport useSongList from 'Scenes/SingASong/SongSelection/Hooks/useSongList';\nimport { useSongSelectionKeyboardNavigation } from 'Scenes/SingASong/SongSelection/Hooks/useSongSelectionKeyboardNavigation';\nimport { randomInt } from 'utils/randomValue';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\n\nexport default function useSongSelection(preselectedSong: string | null) {\n    const { songList, groupedSongList, filtersData, setFilters, filters, isLoading } = useSongList();\n    const navigate = useSmoothNavigate();\n    const [keyboardControl, setKeyboardControl] = useState(true);\n\n    const [focusedSong, focusedGroup, moveToSong, showFilters, setShowFilters] = useSongSelectionKeyboardNavigation(\n        keyboardControl,\n        groupedSongList,\n        () => setKeyboardControl(false),\n        songList.length,\n        filters,\n    );\n\n    const [preselected, setPreselected] = useState(false);\n    useEffect(() => {\n        if (!preselected && songList.length) {\n            const preselectedSongIndex = songList.findIndex((song) => song.file === preselectedSong);\n            const firstNewSongIndex = songList.findIndex((song) => song.isNew);\n\n            let songIndex = randomInt(0, songList.length - 1);\n            if (preselectedSongIndex > -1) songIndex = preselectedSongIndex;\n            else if (firstNewSongIndex > -1) songIndex = preselectedSongIndex;\n\n            moveToSong(songIndex);\n            setPreselected(true);\n        }\n    }, [songList, moveToSong, preselectedSong]);\n\n    useEffect(() => {\n        if (preselected && songList.length && songList[focusedSong]) {\n            navigate(`/game/${encodeURIComponent(songList[focusedSong].file)}`, { replace: true, smooth: false });\n        }\n    }, [preselected, focusedSong, songList]);\n\n    const songPreview = songList?.[focusedSong];\n    return {\n        groupedSongList,\n        focusedSong,\n        focusedGroup,\n        moveToSong,\n        setKeyboardControl,\n        keyboardControl,\n        songPreview,\n        songList: songList ?? [],\n        filtersData,\n        filters,\n        setFilters,\n        showFilters,\n        setShowFilters,\n        isLoading,\n    };\n}\n","import styled from '@emotion/styled';\nimport { Button } from 'Elements/Button';\nimport { nextIndex, nextValue, Switcher } from 'Elements/Switcher';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { GAME_MODE, PlayerSetup, SingSetup, SongPreview } from 'interfaces';\nimport createPersistedState from 'use-persisted-state';\nimport { ValuesType } from 'utility-types';\nimport isDev from 'utils/isDev';\nimport { v4 } from 'uuid';\n\ninterface Props {\n    songPreview: SongPreview;\n    onNextStep: (setup: SingSetup) => void;\n    keyboardControl: boolean;\n    onExitKeyboardControl: () => void;\n}\n\nconst gameModeNames = {\n    [GAME_MODE.DUEL]: 'Duel',\n    [GAME_MODE.PASS_THE_MIC]: 'Pass The Mic',\n};\n\nconst difficultyNames = ['Real', 'Hard', 'Medium', 'Easy'];\n\nif (isDev()) {\n    difficultyNames.push('Debug 4');\n    difficultyNames.push('Debug 5');\n    difficultyNames.push('Debug 6');\n}\n\n// added -v2 to the key as the value has changed from number to ValuesType<typeof GAME_MODE>\nconst useSetGameMode = createPersistedState<ValuesType<typeof GAME_MODE>>('song_settings-game_mode-v2');\nconst useSetTolerance = createPersistedState<number>('song_settings-tolerance');\n\nexport default function GameSettings({ songPreview, onNextStep, keyboardControl, onExitKeyboardControl }: Props) {\n    const [mode, setMode] = useSetGameMode(GAME_MODE.DUEL);\n    const [tolerance, setTolerance] = useSetTolerance(2);\n\n    const startSong = () => {\n        const singSetup = {\n            id: v4(),\n            players: [\n                { name: '', track: 0 },\n                { name: '', track: 0 },\n            ] as [PlayerSetup, PlayerSetup],\n            mode,\n            tolerance,\n        };\n        onNextStep(singSetup);\n    };\n\n    const changeMode = () => {\n        setMode((currentMode) => nextValue(Object.values(GAME_MODE), currentMode));\n    };\n\n    const changeTolerance = () => setTolerance((current) => nextIndex(difficultyNames, current, -1));\n\n    const { register } = useKeyboardNav({ enabled: keyboardControl, onBackspace: onExitKeyboardControl });\n\n    return (\n        <>\n            <GSSwitcher\n                {...register('difficulty', changeTolerance, 'Change difficulty')}\n                label=\"Difficulty\"\n                value={difficultyNames[tolerance]}\n                data-test=\"difficulty-setting\"\n                data-test-value={difficultyNames[tolerance]}\n            />\n            <GSSwitcher\n                {...register('mode', changeMode, 'Change mode')}\n                label=\"Mode\"\n                value={gameModeNames[mode]}\n                data-test=\"game-mode-setting\"\n                data-test-value={gameModeNames[mode]}\n            />\n            <PlayButton {...register('play', startSong, undefined, true)} data-test=\"next-step-button\">\n                Players âž¤\n            </PlayButton>\n        </>\n    );\n}\n\nconst PlayButton = styled(Button)`\n    padding: 0.5rem 9rem;\n    font-size: 4.3rem;\n    width: 50rem;\n`;\n\nconst GSSwitcher = styled(Switcher)`\n    font-size: 4.3rem;\n    padding: 1rem;\n    min-width: 50rem;\n    box-sizing: border-box;\n`;\n","import styled from '@emotion/styled';\nimport { ReactNode, useEffect, useState } from 'react';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport { FPSCountSetting } from 'Scenes/Settings/SettingsState';\n\ninterface Props {\n    playerNumber: number;\n    children: ReactNode;\n}\n\nexport default function VolumeIndicator({ playerNumber, children, ...props }: Props) {\n    const [volume, setVolume] = useState(0);\n\n    useEffect(() => {\n        const interval = setInterval(() => {\n            const playerVolume = InputManager.getPlayerVolume(playerNumber) ?? 0;\n            setVolume(playerVolume);\n        }, 1000 / FPSCountSetting.get());\n\n        return () => {\n            clearInterval(interval);\n        };\n    }, [playerNumber]);\n\n    return (\n        <Indicator volume={volume} color={styles.colors.players[playerNumber].hit.fill} {...props}>\n            {children}\n        </Indicator>\n    );\n}\n\nconst Indicator = styled.div<{ volume: number; color: string }>`\n    border: 0.1rem solid white;\n    padding: 1rem 3rem;\n\n    transition: 300ms;\n\n    background: ${(props) => (props.volume > 0.025 ? props.color : 'black')};\n    text-align: center;\n    gap: 1.25rem;\n    font-size: 2.3rem;\n    color: white;\n\n    svg {\n        transition: 300ms;\n        opacity: ${(props) => (props.volume > 0.025 ? 1 : 0.5)};\n    }\n`;\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport { useEffect } from 'react';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport VolumeIndicator from 'Scenes/Game/VolumeIndicator';\n\nexport default function MicCheck() {\n    useEffect(() => {\n        InputManager.startMonitoring();\n    }, []);\n\n    return (\n        <MicChecksContainer>\n            Microphone Check\n            <VolumeIndicator playerNumber={0}>Player 1</VolumeIndicator>\n            <VolumeIndicator playerNumber={1}>Player 2</VolumeIndicator>\n        </MicChecksContainer>\n    );\n}\n\nconst MicChecksContainer = styled.div`\n    font-size: 3rem;\n    gap: 1.25rem;\n    display: flex;\n    flex-direction: column;\n    ${typography};\n    margin-bottom: 8.6rem;\n`;\n","import { MenuButton } from 'Elements/Menu';\nimport styled from '@emotion/styled';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { css } from '@emotion/react';\nimport { focused } from 'Elements/cssMixins';\nimport { Laptop, Person, PhoneAndroid, PhoneIphone, PhotoCamera, QrCode, Usb } from '@mui/icons-material';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport { SvgIcon } from '@mui/material';\nimport { MicSetupPreference } from 'Scenes/Settings/SettingsState';\n\ninterface Props {\n    onPreferenceSelected: (preference: (typeof MicSetupPreference)[number]) => void;\n    previouslySelected: string | null;\n    onBack?: () => void;\n}\n\nfunction SelectPreference({ onPreferenceSelected, previouslySelected, onBack }: Props) {\n    const { register } = useKeyboardNav({ onBackspace: onBack });\n    return (\n        <>\n            <Option\n                {...register(\n                    'remoteMics',\n                    () => onPreferenceSelected('remoteMics'),\n                    undefined,\n                    previouslySelected === 'remoteMics',\n                )}\n                data-test=\"remote-mics\">\n                <OptionIconContainer>\n                    <PhoneAndroid />\n                    <PhoneIphone />\n                </OptionIconContainer>\n                <div>\n                    Use Smartphones\n                    <OptionDescription>\n                        Use{' '}\n                        <strong>\n                            <PhotoCamera />\n                            Camera app\n                        </strong>{' '}\n                        to scan a{' '}\n                        <strong>\n                            <QrCode /> QR code\n                        </strong>{' '}\n                        that will open Remote Mic website - no need to download an app!\n                    </OptionDescription>\n                </div>\n            </Option>\n            <Option\n                {...register(\n                    'built-in',\n                    () => onPreferenceSelected('built-in'),\n                    undefined,\n                    previouslySelected === 'built-in',\n                )}\n                data-test=\"built-in\">\n                <OptionIconContainer>\n                    <Person />\n                    <Laptop />\n                </OptionIconContainer>\n                <div>\n                    This computer's microphone\n                    <OptionDescription>\n                        Great to <strong>test</strong> the app, <strong>sing alone</strong> or don't care about the\n                        rivalry at the party\n                    </OptionDescription>\n                </div>\n            </Option>\n            <hr />\n            <Option\n                {...register('mics', () => onPreferenceSelected('mics'), undefined, previouslySelected === 'mics')}\n                data-test=\"mics\">\n                <OptionIconContainer>\n                    <MicIcon />\n                    <MicIcon />\n                </OptionIconContainer>\n                <div>\n                    SingStar (-ish) microphones\n                    <OptionDescription>\n                        Select this option and <Usb /> connect your Mics to the computer. It should be selected{' '}\n                        <strong>automatically</strong>.\n                    </OptionDescription>\n                </div>\n            </Option>\n            <Option\n                {...register(\n                    'advanced',\n                    () => onPreferenceSelected('advanced'),\n                    undefined,\n                    previouslySelected === 'advanced',\n                )}\n                data-test=\"advanced\">\n                <OptionIconContainer>\n                    <MicIcon />\n                    <PhoneIphone />\n                </OptionIconContainer>\n                <div>\n                    Advanced (manual) setup\n                    <OptionDescription>\n                        Assign the specific device to a player manually, e.g. if you don't have regular SingStar\n                        microphones.\n                    </OptionDescription>\n                </div>\n            </Option>\n            <hr />\n            <MenuButton\n                {...register('skip', () => onPreferenceSelected('skip'), undefined, previouslySelected === 'skip')}\n                data-test=\"skip\">\n                Skip\n            </MenuButton>\n        </>\n    );\n}\n\nconst MicIcon = () => (\n    <SvgIcon viewBox=\"0 0 512 512\">\n        <path\n            xmlns=\"http://www.w3.org/2000/svg\"\n            d=\"M252.529,162.029l168.125,210.156c-12.313,1.25-24.031,6.438-33.031,15.438s-14.188,20.719-15.438,33.031L162.029,252.545  c-3.563-24.922,4.813-50.078,22.625-67.891C202.467,166.857,227.623,158.467,252.529,162.029z M398.936,398.936  c-9.063,9.063-13.031,22.063-10.625,34.656l45.281,45.25c12.5,12.5,32.75,12.5,45.25,0s12.5-32.75,0-45.25l-45.25-45.281  C420.998,385.904,407.998,389.873,398.936,398.936z M162.029,162.029c18.594-18.594,43.188-29.891,68.969-32.297  c-3.375-24.563-14.906-49.391-35.031-69.516c-43.75-43.75-109.594-48.813-147.063-11.313  c-37.5,37.484-32.438,103.328,11.313,147.078c20.125,20.125,44.938,31.656,69.5,35.031  C132.154,205.217,143.436,180.623,162.029,162.029z\"\n        />\n    </SvgIcon>\n);\n\nconst OptionDescription = styled.div<{ focused?: boolean }>`\n    padding: 0 0 0 2.5rem;\n    font-size: 1.6rem;\n    max-height: 0;\n    overflow: clip;\n    transition: 300ms;\n\n    svg {\n        font-size: 1.4rem;\n    }\n    opacity: 0;\n`;\n\nconst OptionIconContainer = styled.div`\n    position: relative;\n    margin: 0rem 0.6rem 0 2.5rem;\n    transition: 300ms;\n\n    svg {\n        transition: 300ms;\n        width: 3.6rem;\n        height: 3.6rem;\n        color: rgba(${styles.colors.players[1].text});\n    }\n\n    svg:first-of-type {\n        top: 0.6rem;\n        left: 1.25rem;\n        position: absolute;\n        color: rgba(${styles.colors.players[0].text});\n        z-index: 100;\n        transform: scaleX(-1);\n    }\n`;\n\nconst moreInfoMixin = css`\n    height: 16.5rem;\n    background: black;\n    ${focused};\n\n    ${OptionDescription} {\n        padding-top: 1.6rem;\n        max-height: 10rem;\n        opacity: 1;\n    }\n\n    ${OptionIconContainer} {\n        transform: scale(1.75);\n    }\n`;\n\nconst Option = styled(MenuButton)<{ focused?: boolean }>`\n    display: flex;\n    align-items: center;\n\n    :hover {\n        ${moreInfoMixin};\n    }\n\n    ${(props) => (props.focused ? moreInfoMixin : '')};\n`;\n\nexport default SelectPreference;\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport { QRCodeSVG } from 'qrcode.react';\nimport { useEffect } from 'react';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport WebRTCServer from 'RemoteMic/Network/WebRTCServer';\nimport { useRoute } from 'wouter';\n\nconst linkObject = new URL(window.location.href);\n\nfunction ConnectRemoteMic() {\n    const [match, params] = useRoute<{ roomId: string }>('/remote-mic/:roomId');\n    linkObject.pathname = `/remote-mic/${match ? params.roomId : WebRTCServer.getRoomId()}`;\n    const link = linkObject.href;\n\n    useEffect(() => {\n        if (!match) {\n            WebRTCServer.start();\n        }\n    }, [match]);\n\n    return (\n        <Container>\n            <QRCode>\n                <QRCodeSVG value={link} width=\"100%\" height=\"100%\" includeMargin />\n            </QRCode>\n            <Description>\n                <QRCodeInstruction>\n                    <h3>Use your phone as a microphone</h3>\n                    <ol>\n                        <li>\n                            Open <b>Camera App</b> on your phone\n                        </li>\n                        <li>\n                            Point the camera to the <b>QR Code</b> on the left\n                        </li>\n                        <li>\n                            Open <b>the link</b> that should appear\n                        </li>\n                        <li>Follow the instructions</li>\n                    </ol>\n                </QRCodeInstruction>\n                <CopyLinkInstruction>\n                    <h4>Or copy and send the link</h4>\n                    <InputCopyContainer>\n                        <InputCopy disabled value={link} data-test=\"server-link-input\" />\n                        <CopyButton\n                            onClick={() => {\n                                navigator.clipboard.writeText(link);\n                            }}>\n                            Copy\n                        </CopyButton>\n                    </InputCopyContainer>\n                </CopyLinkInstruction>\n            </Description>\n        </Container>\n    );\n}\nconst QRCodeInstruction = styled.div`\n    flex: 1;\n`;\n\nconst CopyLinkInstruction = styled.div`\n    flex: 0;\n`;\n\nconst InputCopyContainer = styled.div`\n    position: relative;\n    margin-top: 0.5rem;\n`;\n\nconst CopyButton = styled.button`\n    cursor: pointer;\n    position: absolute;\n    padding: 0 2rem;\n    right: 0;\n    height: 100%;\n    box-sizing: border-box;\n\n    background: ${styles.colors.text.active};\n\n    ${typography};\n    font-weight: bold;\n    font-size: 2.2rem;\n    border: 0;\n\n    :active {\n        background-color: black;\n    }\n`;\n\nconst InputCopy = styled.input`\n    padding: 1rem;\n    box-sizing: border-box;\n    background: grey;\n    border: none;\n    width: 100%;\n    font-size: 1.3rem;\n`;\n\nconst Container = styled.div`\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    align-items: stretch;\n    flex: 1;\n    gap: 2%;\n\n    @media (max-width: 560px) {\n        flex-direction: column;\n    }\n`;\n\nconst QRCode = styled.div`\n    flex: 0.6;\n    @media (max-width: 560px) {\n        flex: 0;\n    }\n`;\n\nconst Description = styled.div`\n    @media (max-width: 560px) {\n        display: none;\n    }\n    flex: 1;\n\n    display: flex;\n    flex-direction: column;\n\n    b {\n        font-weight: bold;\n        ${typography};\n        color: ${styles.colors.text.active};\n    }\n\n    h3 {\n        margin-bottom: 1.9rem;\n    }\n    h4 {\n        margin: 1.25rem 0;\n    }\n\n    ol {\n        padding-left: 2.3rem;\n        margin: 1.25rem 0;\n        list-style: decimal inside;\n    }\n    li {\n        color: white;\n        font-size: 1.9rem;\n        line-height: 3.2rem;\n    }\n`;\n\nexport default ConnectRemoteMic;\n","import { useEventEffect } from 'GameEvents/hooks';\nimport { useRef } from 'react';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport { RemoteMicrophoneInputSource } from 'Scenes/SelectInput/InputSources/Remote';\nimport events from 'GameEvents/GameEvents';\n\nexport function useRemoteMicAutoselect() {\n    const nextPlayerToAutoSwitch = useRef(0);\n\n    useEventEffect(events.remoteMicConnected, ({ id }) => {\n        console.log('useRemoteMicAutoselect', id);\n        InputManager.setPlayerInput(nextPlayerToAutoSwitch.current, RemoteMicrophoneInputSource.inputName, 0, id);\n        nextPlayerToAutoSwitch.current = (nextPlayerToAutoSwitch.current + 1) % 2;\n    });\n}\n","import styled from '@emotion/styled';\nimport VolumeIndicator from 'Scenes/Game/VolumeIndicator';\n\ninterface Props {\n    names: [string, string];\n}\n\nfunction MicCheck(props: Props) {\n    return (\n        <MicCheckContainer>\n            <VolumeIndicator playerNumber={0} data-test=\"mic-check-p1\">\n                {props.names[0]}\n            </VolumeIndicator>\n            <VolumeIndicator playerNumber={1} data-test=\"mic-check-p2\">\n                {props.names[1]}\n            </VolumeIndicator>\n        </MicCheckContainer>\n    );\n}\n\nconst MicCheckContainer = styled.div`\n    display: flex;\n    gap: 1.25rem;\n\n    div {\n        flex: 1;\n    }\n`;\n\nexport default MicCheck;\n","import ConnectRemoteMic from 'Scenes/ConnectRemoteMic/ConnectRemoteMic';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { MenuButton } from 'Elements/Menu';\nimport { useEffect } from 'react';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport { useEventListenerSelector } from 'GameEvents/hooks';\nimport InputSources from 'Scenes/SelectInput/InputSources';\nimport { useRemoteMicAutoselect } from 'Scenes/SelectInput/hooks/useRemoteMicAutoselect';\nimport MicCheck from 'Scenes/SelectInput/MicCheck';\nimport events from 'GameEvents/GameEvents';\n\ninterface Props {\n    onSetupComplete: (complete: boolean) => void;\n    onBack: () => void;\n    onSave: () => void;\n    closeButtonText: string;\n}\n\nfunction RemoteMics(props: Props) {\n    const { register } = useKeyboardNav({ onBackspace: props.onBack });\n\n    useEffect(() => {\n        InputManager.startMonitoring();\n        return () => {\n            InputManager.stopMonitoring();\n        };\n    }, []);\n    useRemoteMicAutoselect();\n\n    const players = useEventListenerSelector(\n        // Subscribing to inputListChanged otherwise as it's InputManager.getInputs returns dummy input as the input\n        // list is not yet updated with the connected remote mic.\n        // The event sequence is wrongly remoteMicConnected -> playerInputChanged -> inputListChanged - needs to be fixed\n        // e.g. remove remoteMicConnected event?\n        [events.inputListChanged, events.playerInputChanged],\n        () => {\n            return InputManager.getInputs()\n                .map((input) => (input.inputSource === 'Remote Microphone' ? input : null))\n                .map((input) => (input ? InputSources.getInputForPlayerSelected(input) : null));\n        },\n    );\n\n    const onContinue = () => {\n        props.onSave();\n    };\n\n    const isComplete = !!players[0]?.label && !!players[1]?.label;\n\n    useEffect(() => {\n        props.onSetupComplete(isComplete);\n    }, [isComplete]);\n\n    return (\n        <>\n            <ConnectRemoteMic />\n            <h4>You can connect multiple phones in advance.</h4>\n\n            <h4>You will be able to connect phones later.</h4>\n            <MicCheck names={[players[0]?.label ?? '...', players[1]?.label ?? '...']} />\n            <MenuButton {...register('back', props.onBack)} data-test=\"back-button\">\n                Back\n            </MenuButton>\n            <MenuButton {...register('Sing a song', onContinue, undefined, true)} data-test=\"save-button\">\n                {props.closeButtonText}\n            </MenuButton>\n        </>\n    );\n}\n\nexport default RemoteMics;\n","import events from 'GameEvents/GameEvents';\nimport { useEventListenerSelector } from 'GameEvents/hooks';\nimport inputSourceListManager from 'Scenes/SelectInput/InputSources';\nimport { InputSource } from 'Scenes/SelectInput/InputSources/interfaces';\nimport { useEffect } from 'react';\n\nexport interface SourceInputDefault {\n    list: InputSource[];\n    getDefault: () => string | null;\n}\n\nexport type SourceMap = Record<string, SourceInputDefault>;\n\nexport function useMicrophoneList(load = false) {\n    const inputs = useEventListenerSelector(events.inputListChanged, () => inputSourceListManager.getInputList());\n\n    useEffect(() => {\n        if (load) {\n            inputSourceListManager.loadMics();\n        }\n    }, [load]);\n\n    return inputs;\n}\n","export default \"__VITE_ASSET__d22be881__\"","export default \"__VITE_ASSET__862d35ec__\"","import userMediaService from 'UserMedia/userMediaService';\nimport { useEffect, useState } from 'react';\n\nexport const useMicrophoneStatus = () => {\n    const [status, setStatus] = useState(userMediaService.getStatus());\n\n    useEffect(() => userMediaService.addListener(setStatus), []);\n\n    return status;\n};\n","import styled from '@emotion/styled';\nimport { Warning } from '@mui/icons-material';\nimport { PropsWithChildren, ReactNode } from 'react';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport enableMic from './enable-mic.png';\nimport allowMic from './allow-mic.png';\nimport { useMicrophoneStatus } from 'UserMedia/hooks';\n\ninterface Props extends PropsWithChildren {\n    fallback: ReactNode;\n    showImages?: boolean;\n}\nconst UserMediaEnabled = ({ children, fallback, showImages }: Props) => {\n    const status = useMicrophoneStatus();\n    return (\n        <>\n            {status === 'accepted' && children}\n            {status !== 'accepted' && (\n                <>\n                    <WarningContainer>\n                        <WarningIcon />\n                    </WarningContainer>\n                    {fallback}\n                    <AdditionalInfo>\n                        {status === 'requested' && showImages && <img src={allowMic} alt=\"how-to-allow\" />}\n                        {status === 'declined' && (\n                            <>\n                                <h3>Access is blocked, you can unblock it here</h3>\n                                {showImages && <img src={enableMic} alt=\"how-to-enable\" />}\n                            </>\n                        )}\n                    </AdditionalInfo>\n                </>\n            )}\n        </>\n    );\n};\n\nconst AdditionalInfo = styled.div`\n    text-align: center;\n\n    img {\n        margin: 0.5rem;\n        box-shadow: 0.5rem 0.5rem 0.5rem rgba(0, 0, 0, 0.5);\n    }\n`;\n\nconst WarningContainer = styled.div`\n    width: 100%;\n    display: flex;\n    justify-content: center;\n`;\nconst WarningIcon = styled(Warning)`\n    color: ${styles.colors.text.active};\n    font-size: 3rem;\n`;\nexport default UserMediaEnabled;\n","export default function isWindows() {\n    return navigator?.userAgent?.includes?.('Win') ?? false;\n}\n","import useKeyboardNav from 'hooks/useKeyboardNav';\nimport { MenuButton } from 'Elements/Menu';\nimport { useMicrophoneList } from 'Scenes/SelectInput/hooks/useMicrophoneList';\nimport { useEventEffect, useEventListenerSelector } from 'GameEvents/hooks';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport { MicrophoneInputSource } from 'Scenes/SelectInput/InputSources/Microphone';\nimport { useEffect, useState } from 'react';\nimport MicCheck from 'Scenes/SelectInput/MicCheck';\nimport InputSources from 'Scenes/SelectInput/InputSources';\nimport styled from '@emotion/styled';\nimport UserMediaEnabled from 'UserMedia/UserMediaEnabled';\nimport isWindows from 'utils/isWindows';\nimport events from 'GameEvents/GameEvents';\n\ninterface Props {\n    onSetupComplete: (complete: boolean) => void;\n    onBack: () => void;\n    onSave: () => void;\n    closeButtonText: string;\n}\n\nfunction SingStarMics(props: Props) {\n    const { register } = useKeyboardNav({ onBackspace: props.onBack });\n    const { Microphone } = useMicrophoneList(true);\n    const [showAdvancedTip, setShowAdvancedTip] = useState(false);\n\n    const isSetup = useEventListenerSelector([events.playerInputChanged, events.inputListChanged], () => {\n        const inputs = InputManager.getInputs();\n\n        const isSameDeviceId = [...new Set(inputs.map((input) => input.deviceId))].length === 1;\n        const isMicInput = !inputs.find((input) => input.inputSource !== 'Microphone');\n        const areAllPreferred = !inputs.find(\n            (input) => InputSources.getInputForPlayerSelected(input)!.preferred === undefined,\n        );\n\n        return isSameDeviceId && isMicInput && areAllPreferred;\n    });\n\n    useEffect(() => {\n        if (isSetup) {\n            InputManager.startMonitoring();\n        }\n        return () => {\n            InputManager.stopMonitoring();\n        };\n    }, [isSetup]);\n\n    const onContinue = () => {\n        props.onSave();\n    };\n\n    // Look for proper microphones in the list when the list changes\n    useEventEffect(events.inputListChanged, () => {\n        const preferred = Microphone.list.filter((input) => input.preferred !== undefined);\n        if (preferred.length === 2 && preferred[0].deviceId === preferred[1].deviceId) {\n            preferred.forEach((input) => {\n                InputManager.setPlayerInput(\n                    input.preferred!,\n                    MicrophoneInputSource.inputName,\n                    input.channel,\n                    input.deviceId,\n                );\n            });\n        }\n    });\n\n    useEffect(() => {\n        props.onSetupComplete(isSetup);\n    }, [isSetup]);\n\n    useEffect(() => {\n        if (isSetup) {\n            setShowAdvancedTip(false);\n        } else {\n            const timeout = setTimeout(() => setShowAdvancedTip(true), 2500);\n\n            return () => clearTimeout(timeout);\n        }\n    }, [isSetup]);\n\n    return (\n        <>\n            <UserMediaEnabled fallback={<h2>Please allow access to the microphone so we can find SingStar ones.</h2>}>\n                {!isSetup && (\n                    <>\n                        <h3>Connect your SingStar microphones.</h3>\n                        <h4 data-test=\"setup-not-completed\">Make sure you only connect one pair.</h4>\n                        {showAdvancedTip && (\n                            <>\n                                <h4 data-test=\"advanced-tip\">\n                                    If detection doesn't happen, try{' '}\n                                    <AdvancedLink onClick={props.onBack}>Advanced</AdvancedLink> section in the previous\n                                    menu.\n                                </h4>\n                                {window.chrome && isWindows() && (\n                                    <h4>\n                                        <strong>Chrome</strong> is known for not handling SingStar mics well. If you\n                                        notice any problems, try using an alternative browser (eg.{' '}\n                                        <strong>MS Edge</strong> or <strong>Firefox</strong>)\n                                    </h4>\n                                )}\n                            </>\n                        )}\n                    </>\n                )}\n                {isSetup && (\n                    <>\n                        <h2 data-test=\"setup-completed\">\n                            <strong>SingStar</strong> microphone connected!\n                        </h2>\n\n                        <MicCheck names={['Blue', 'Red']} />\n                    </>\n                )}\n            </UserMediaEnabled>\n\n            <MenuButton {...register('back', props.onBack)} data-test=\"back-button\">\n                Back\n            </MenuButton>\n            <MenuButton\n                {...(isSetup ? register('Sing a song', onContinue, undefined, true) : {})}\n                disabled={!isSetup}\n                data-test=\"save-button\">\n                {props.closeButtonText}\n            </MenuButton>\n        </>\n    );\n}\n\nconst AdvancedLink = styled.strong`\n    cursor: pointer;\n`;\n\nexport default SingStarMics;\n","import { useEffect } from 'react';\n\ninterface Props {\n    onSetupComplete: (complete: boolean) => void;\n    onBack: () => void;\n    onSave: () => void;\n    closeButtonText: string;\n}\n\nfunction Skip(props: Props) {\n    useEffect(() => {\n        props.onSave();\n    }, []);\n\n    return null;\n}\n\nexport default Skip;\n","import { nextIndex, nextValue } from 'Elements/Switcher';\nimport { useEffect } from 'react';\nimport events from 'GameEvents/GameEvents';\nimport { useEventListenerSelector } from 'GameEvents/hooks';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport InputSources from 'Scenes/SelectInput/InputSources';\nimport { InputSourceList, InputSourceNames } from 'Scenes/SelectInput/InputSources/interfaces';\nimport tuple from 'utils/tuple';\n\nexport function usePlayerInput(playerNumber: number, sources: Record<InputSourceNames, InputSourceList>) {\n    const sourceList = Object.keys(sources) as Array<InputSourceNames>;\n    const [selectedPlayerInput, playerInputData] = useEventListenerSelector(\n        [events.playerInputChanged, events.inputListChanged],\n        () => {\n            const playerInput = InputManager.getPlayerInput(playerNumber);\n\n            if (!playerInput) return tuple([null, null]);\n            return tuple([playerInput, InputSources.getInputForPlayerSelected(playerInput)]);\n        },\n    );\n\n    useEffect(() => {\n        if (playerInputData === null) {\n            const source = sourceList[0];\n            const input = sources[source].getDefault();\n            if (input) {\n                InputManager.setPlayerInput(playerNumber, sourceList[0], input.channel, input.deviceId);\n            }\n        }\n    });\n\n    const cycleSource = () => {\n        const nextSource = nextValue(sourceList, selectedPlayerInput?.inputSource ?? sourceList[0]);\n        const input = sources[nextSource].getDefault();\n\n        InputManager.setPlayerInput(playerNumber, nextSource, input?.channel, input?.deviceId);\n    };\n    const cycleInput = () => {\n        if (!selectedPlayerInput) return;\n        const list = sources[selectedPlayerInput.inputSource].list;\n        const currentIndex = playerInputData ? list.findIndex((item) => item.id === playerInputData.id) : 0;\n        const input = list[nextIndex(list, currentIndex)];\n\n        InputManager.setPlayerInput(playerNumber, selectedPlayerInput.inputSource, input?.channel, input?.deviceId);\n    };\n\n    return tuple([selectedPlayerInput?.inputSource ?? null, cycleSource, playerInputData, cycleInput]);\n}\n","import { MenuButton } from 'Elements/Menu';\nimport { Switcher } from 'Elements/Switcher';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport ConnectRemoteMic from 'Scenes/ConnectRemoteMic/ConnectRemoteMic';\nimport { useMicrophoneList } from 'Scenes/SelectInput/hooks/useMicrophoneList';\nimport { usePlayerInput } from 'Scenes/SelectInput/hooks/usePlayerInput';\nimport { MicrophoneInputSource } from 'Scenes/SelectInput/InputSources/Microphone';\nimport { useRemoteMicAutoselect } from 'Scenes/SelectInput/hooks/useRemoteMicAutoselect';\nimport { useEffect } from 'react';\nimport VolumeIndicator from 'Scenes/Game/VolumeIndicator';\nimport styled from '@emotion/styled';\nimport { Mic } from '@mui/icons-material';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport UserMediaEnabled from 'UserMedia/UserMediaEnabled';\nimport { useMicrophoneStatus } from 'UserMedia/hooks';\nimport isWindows from 'utils/isWindows';\n\ninterface Props {\n    onSetupComplete: (complete: boolean) => void;\n    onBack: () => void;\n    onSave: () => void;\n    closeButtonText: string;\n    playerNames?: string[];\n}\n\nfunction Advanced(props: Props) {\n    const inputs = useMicrophoneList(true);\n    const [p1Source, p1CycleSource, p1Input, p1CycleInput] = usePlayerInput(0, inputs);\n    const [p2Source, p2CycleSource, p2Input, p2CycleInput] = usePlayerInput(1, inputs);\n    const status = useMicrophoneStatus();\n\n    useEffect(() => {\n        props.onSetupComplete(status === 'accepted');\n    }, [status]);\n\n    useEffect(() => {\n        InputManager.startMonitoring();\n        return () => {\n            InputManager.stopMonitoring();\n        };\n    }, []);\n\n    useRemoteMicAutoselect();\n\n    const { register } = useKeyboardNav({ onBackspace: props.onBack });\n\n    return (\n        <>\n            <UserMediaEnabled fallback={<h2>Please allow access to the microphone so we can show them.</h2>}>\n                <ConnectRemoteMic />\n                <Heading>\n                    <MicCheck playerNumber={0}>\n                        <Mic />\n                    </MicCheck>{' '}\n                    Player 1 {props.playerNames?.[0] && `(${props.playerNames[0]})`}\n                </Heading>\n                <Switcher\n                    {...register('player 1 source', p1CycleSource)}\n                    label=\"Source\"\n                    value={p1Source}\n                    data-test=\"player-1-source\"\n                />\n                <Switcher\n                    {...register('player 1 input', p1CycleInput)}\n                    label=\"Input\"\n                    value={p1Input?.label}\n                    data-test=\"player-1-input\"\n                />\n                <Heading>\n                    <MicCheck playerNumber={1}>\n                        <Mic />\n                    </MicCheck>{' '}\n                    Player 2 {props.playerNames?.[1] && `(${props.playerNames[1]})`}\n                </Heading>\n                <Switcher\n                    {...register('player 2 source', p2CycleSource)}\n                    label=\"Source\"\n                    value={p2Source}\n                    data-test=\"player-2-source\"\n                />\n                <Switcher\n                    {...register('player 2 input', p2CycleInput)}\n                    label=\"Input\"\n                    value={p2Input?.label}\n                    data-test=\"player-2-input\"\n                />\n                <hr />\n                {p1Source === MicrophoneInputSource.inputName &&\n                    p2Source === MicrophoneInputSource.inputName &&\n                    p1Input?.deviceId !== p2Input?.deviceId && (\n                        <h3 data-test=\"mic-mismatch-warning\">\n                            Using different microphone devices is not yet supported\n                        </h3>\n                    )}\n                {p1Source === MicrophoneInputSource.inputName &&\n                    p2Source === MicrophoneInputSource.inputName &&\n                    window.chrome &&\n                    isWindows() && (\n                        <h3>\n                            <strong>Chrome</strong> is known for not handling SingStar mics well. If you notice any\n                            problems, try using an alternative browser (eg. <strong>MS Edge</strong> or{' '}\n                            <strong>Firefox</strong>)\n                        </h3>\n                    )}\n            </UserMediaEnabled>\n            <MenuButton {...register('back', props.onBack)} data-test=\"back-button\">\n                Back\n            </MenuButton>\n            <MenuButton {...register('on save', props.onSave)} data-test=\"save-button\">\n                {props.closeButtonText}\n            </MenuButton>\n        </>\n    );\n}\n\nconst MicCheck = styled(VolumeIndicator)`\n    display: inline-flex;\n    padding: 0.1rem 1rem;\n\n    svg {\n        font-size: 2.4rem;\n    }\n`;\n\nconst Heading = styled.h2`\n    display: flex;\n    align-items: center;\n    gap: 1.25rem;\n`;\n\nexport default Advanced;\n","import useKeyboardNav from 'hooks/useKeyboardNav';\nimport { MenuButton } from 'Elements/Menu';\nimport { useEffect, useState } from 'react';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport { useEventEffect } from 'GameEvents/hooks';\nimport MicCheck from 'Scenes/SelectInput/MicCheck';\nimport { useMicrophoneList } from 'Scenes/SelectInput/hooks/useMicrophoneList';\nimport { MicrophoneInputSource } from 'Scenes/SelectInput/InputSources/Microphone';\nimport UserMediaEnabled from 'UserMedia/UserMediaEnabled';\nimport events from 'GameEvents/GameEvents';\n\ninterface Props {\n    onSetupComplete: (complete: boolean) => void;\n    onBack: () => void;\n    onSave: () => void;\n    closeButtonText: string;\n}\n\nfunction BuiltIn(props: Props) {\n    const { register } = useKeyboardNav({ onBackspace: props.onBack });\n    const [selectedMic, setSelectedMic] = useState('');\n\n    useEffect(() => {\n        InputManager.startMonitoring();\n        return () => {\n            InputManager.stopMonitoring();\n        };\n    }, []);\n\n    const { Microphone } = useMicrophoneList(true);\n\n    const autoselect = () => {\n        const defaultDevice = Microphone.getDefault();\n        console.log(defaultDevice);\n        if (defaultDevice) {\n            [0, 1].forEach((playerNumber) =>\n                InputManager.setPlayerInput(\n                    playerNumber,\n                    MicrophoneInputSource.inputName,\n                    defaultDevice.channel,\n                    defaultDevice.deviceId,\n                ),\n            );\n            setSelectedMic(defaultDevice.label);\n        }\n    };\n\n    useEffect(autoselect, []);\n    useEventEffect(events.inputListChanged, autoselect);\n\n    useEffect(() => {\n        props.onSetupComplete(!!selectedMic);\n    }, [selectedMic]);\n\n    return (\n        <>\n            <UserMediaEnabled\n                fallback={<h2>Please allow access to the microphone so the default one can be selected.</h2>}>\n                {!selectedMic && <h4>The default device is being selected.</h4>}\n                {selectedMic && (\n                    <h4>\n                        You'll sing using <strong data-test=\"selected-mic\">{selectedMic}</strong>.\n                    </h4>\n                )}\n\n                <h4>\n                    You can change the device in <strong>Advanced</strong> section in the previous menu.\n                </h4>\n                <MicCheck names={['These light up when', 'singing is detected']} />\n            </UserMediaEnabled>\n            <MenuButton {...register('back', props.onBack)} data-test=\"back-button\">\n                Back\n            </MenuButton>\n            <MenuButton {...register('Sing a song', props.onSave, undefined, true)} data-test=\"save-button\">\n                {props.closeButtonText}\n            </MenuButton>\n        </>\n    );\n}\n\nexport default BuiltIn;\n","import { useState } from 'react';\nimport SelectPreference from 'Scenes/SelectInput/SelectPreference/SelectPreference';\nimport RemoteMics from 'Scenes/SelectInput/Variants/RemoteMics';\nimport { MicSetupPreference, MicSetupPreferenceSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport SingStarMics from 'Scenes/SelectInput/Variants/SingStarMics';\nimport Skip from 'Scenes/SelectInput/Variants/Skip';\nimport Advanced from 'Scenes/SelectInput/Variants/Advanced';\nimport BuiltIn from 'Scenes/SelectInput/Variants/BuiltIn';\nimport completedAnimation from './completed-animation.json';\nimport Lottie from 'lottie-react';\nimport styled from '@emotion/styled';\nimport tuple from 'utils/tuple';\nimport posthog from 'posthog-js';\nimport startViewTransition from 'utils/startViewTransition';\nimport { flushSync } from 'react-dom';\n\ninterface Props {\n    onFinish: (pref: (typeof MicSetupPreference)[number]) => void;\n    onBack?: () => void;\n    smooth?: boolean;\n    closeButtonText: string;\n    playerNames?: string[];\n}\n\n// needs to be a \"stable\" array - reference can't change\nconst completedAnimationSegment = tuple([0, 50]);\n\nconst LAST_SELECTED_KEY = 'Previously selected input type';\n\nconst previouslySelected = localStorage.getItem(LAST_SELECTED_KEY);\n\nfunction SelectInputView({ onFinish, closeButtonText, playerNames, onBack, smooth }: Props) {\n    const [preference, setPreference] = useState<(typeof MicSetupPreference)[number]>(null);\n    const [isComplete, setIsComplete] = useState(false);\n\n    const [storedPreference, setStoredPreference] = useSettingValue(MicSetupPreferenceSetting);\n\n    const storePreference = (...args: Parameters<typeof setPreference>) => {\n        startViewTransition(() => {\n            setPreference(...args);\n        });\n    };\n\n    const onSave = (pref: (typeof MicSetupPreference)[number]) => () => {\n        // Keep currently selected preference unless nothing (null) is selected - then store `skip` directly\n        // skip is needed to mark that user explicitly didn't select anything\n        if (smooth) {\n            startViewTransition(() => {\n                flushSync(() => {\n                    setStoredPreference(pref === 'skip' ? storedPreference ?? 'skip' : pref);\n                });\n            });\n        } else {\n            setStoredPreference(pref === 'skip' ? storedPreference ?? 'skip' : pref);\n        }\n        if (pref) {\n            localStorage.setItem(LAST_SELECTED_KEY, pref);\n            posthog.capture('sourcePreferenceSet', { source: pref });\n        }\n\n        onFinish(pref);\n    };\n    const back = () => {\n        startViewTransition(() => {\n            setPreference(null);\n            setIsComplete(false);\n        });\n    };\n\n    return (\n        <>\n            <Heading>\n                {isComplete ? (\n                    <>\n                        <CompletedAnim\n                            initialSegment={completedAnimationSegment}\n                            animationData={completedAnimation}\n                            loop={false}\n                        />{' '}\n                        Setup completed!\n                    </>\n                ) : (\n                    'How do you want to sing?'\n                )}\n            </Heading>\n            {(preference === null || preference === 'skip') && (\n                <SelectPreference\n                    onPreferenceSelected={storePreference}\n                    previouslySelected={previouslySelected}\n                    onBack={onBack}\n                />\n            )}\n            {preference === 'remoteMics' && (\n                <RemoteMics\n                    onSetupComplete={setIsComplete}\n                    onBack={back}\n                    onSave={onSave('remoteMics')}\n                    closeButtonText={closeButtonText}\n                />\n            )}\n            {preference === 'mics' && (\n                <SingStarMics\n                    onSetupComplete={setIsComplete}\n                    onBack={back}\n                    onSave={onSave('mics')}\n                    closeButtonText={closeButtonText}\n                />\n            )}\n            {preference === 'built-in' && (\n                <BuiltIn\n                    onSetupComplete={setIsComplete}\n                    onBack={back}\n                    onSave={onSave('built-in')}\n                    closeButtonText={closeButtonText}\n                />\n            )}\n            {preference === 'advanced' && (\n                <Advanced\n                    onSave={onSave('advanced')}\n                    onSetupComplete={setIsComplete}\n                    onBack={back}\n                    closeButtonText={closeButtonText}\n                    playerNames={playerNames}\n                />\n            )}\n            {preference === 'skip' && (\n                <Skip\n                    onSetupComplete={setIsComplete}\n                    onBack={back}\n                    onSave={onSave('skip')}\n                    closeButtonText={closeButtonText}\n                />\n            )}\n        </>\n    );\n}\n\nconst Heading = styled.h1`\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    position: relative;\n`;\n\nconst CompletedAnim = styled(Lottie)`\n    display: inline-block;\n    width: 10rem;\n    height: 10rem;\n    margin: -3rem -2rem -3rem -3rem;\n`;\n\nexport default SelectInputView;\n","import styled from '@emotion/styled';\nimport { PropsWithChildren } from 'react';\n\ninterface Props extends PropsWithChildren {\n    onClose?: () => void;\n}\n\nexport default function Modal({ children, onClose }: Props) {\n    return (\n        <>\n            <Backdrop onClick={onClose} />\n            <Container onClick={onClose}>\n                <div onClick={(e) => e.stopPropagation()}>{children}</div>\n            </Container>\n        </>\n    );\n}\n\nconst Container = styled.div`\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 1000;\n    overflow: auto;\n`;\n\nconst Backdrop = styled.div`\n    position: fixed;\n    top: 0;\n    left: 0;\n    background: rgba(0, 0, 0, 0.7);\n    width: 100vw;\n    height: 100vh;\n    z-index: 2;\n    backdrop-filter: blur(20px);\n`;\n","import { MenuContainer } from 'Elements/Menu';\nimport SelectInputView from 'Scenes/SelectInput/SelectInputView';\nimport Modal from 'Elements/Modal';\n\ninterface Props {\n    onClose: () => void;\n    playerNames: string[];\n    required: boolean;\n}\n\nexport default function SelectInputModal({ onClose, playerNames, required }: Props) {\n    return (\n        <Modal onClose={onClose}>\n            <MenuContainer>\n                <SelectInputView\n                    onBack={onClose}\n                    onFinish={onClose}\n                    closeButtonText={required ? 'Continue to the song' : 'Back to player setup'}\n                    playerNames={playerNames}\n                />\n            </MenuContainer>\n        </Modal>\n    );\n}\n","import styled from '@emotion/styled';\nimport { Autocomplete } from 'Elements/Autocomplete';\nimport { Switcher } from 'Elements/Switcher';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { PlayerSetup, SongPreview } from 'interfaces';\nimport { useRef } from 'react';\n\ninterface Props {\n    index: number;\n    songPreview: SongPreview;\n    onChange: (setup: PlayerSetup) => void;\n    setup: PlayerSetup;\n    playerNames: string[];\n    defaultName: string;\n    register: ReturnType<typeof useKeyboardNav>['register'];\n}\n\nconst getTrackName = (tracks: SongPreview['tracks'], index: number) => tracks[index]?.name ?? `Track ${index + 1}`;\n\nexport default function SinglePlayer({\n    index,\n    songPreview,\n    playerNames,\n    register,\n    onChange,\n    setup,\n    defaultName,\n}: Props) {\n    const p1NameRef = useRef<HTMLInputElement | null>(null);\n\n    const togglePlayerTrack = () => onChange({ ...setup, track: (setup.track + 1) % songPreview.tracksCount });\n\n    const onNameChange = (newName: string) => onChange({ ...setup, name: newName });\n\n    return (\n        <>\n            <PlayerName\n                value={setup.name}\n                options={playerNames}\n                onChange={onNameChange}\n                label=\"Name:\"\n                ref={p1NameRef}\n                {...register(`p${index} name`, () => p1NameRef.current?.focus())}\n                placeholder={defaultName}\n                data-test={`player-${index}-name`}\n            />\n            {songPreview.tracksCount > 1 && (\n                <Track\n                    {...register(`p${index} track`, togglePlayerTrack, 'Change track')}\n                    label=\"Track\"\n                    value={getTrackName(songPreview.tracks, setup.track)}\n                    data-test={`player-${index}-track-setting`}\n                    data-test-value={setup.track + 1}\n                />\n            )}\n        </>\n    );\n}\n\nconst PlayerName = styled(Autocomplete)`\n    input {\n        font-size: 4.5rem;\n    }\n\n    [role='listbox'] {\n        max-height: ${6 * (4.5 + 0.3)}rem;\n    }\n`;\nconst Track = styled(Switcher)`\n    font-size: 4.5rem;\n    padding: 1.1rem;\n`;\n","import styled from '@emotion/styled';\nimport { Button } from 'Elements/Button';\nimport { PLAYER_NAMES_SESSION_STORAGE_KEY, PREVIOUS_PLAYER_NAMES_STORAGE_KEY } from 'hooks/players/consts';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { PlayerSetup, SongPreview } from 'interfaces';\nimport { useEffect, useMemo, useState } from 'react';\nimport { useEventListenerSelector } from 'GameEvents/hooks';\nimport InputManager from 'Scenes/Game/Singing/Input/InputManager';\nimport SelectInputModal from 'Scenes/SingASong/SongSelection/SongSettings/PlayerSettings/SelectInputModal';\nimport SinglePlayer from 'Scenes/SingASong/SongSelection/SongSettings/PlayerSettings/SinglePlayer';\nimport { MicSetupPreferenceSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport events from 'GameEvents/GameEvents';\n\ninterface Props {\n    songPreview: SongPreview;\n    onNextStep: (players: PlayerSetup[]) => void;\n    keyboardControl: boolean;\n    onExitKeyboardControl: () => void;\n}\n\nfunction useDefaultPlayerName(index: number): string {\n    // If the player input changed in the meantime\n    return useEventListenerSelector(events.playerInputChanged, () => {\n        let defaultName = '';\n\n        const source = InputManager.getPlayerInput(index);\n\n        if (source?.inputSource === 'Remote Microphone') {\n            defaultName = RemoteMicManager.getRemoteMicById(source.deviceId!)?.name || defaultName;\n        }\n        if (!defaultName) {\n            const previousPlayerNames =\n                JSON.parse(window.sessionStorage.getItem(PREVIOUS_PLAYER_NAMES_STORAGE_KEY)!) || [];\n\n            defaultName = previousPlayerNames[index] ?? defaultName;\n        }\n\n        return defaultName || `Player #${index + 1}`;\n    });\n}\n\nexport default function PlayerSettings({ songPreview, onNextStep, keyboardControl, onExitKeyboardControl }: Props) {\n    const defaultNames = [useDefaultPlayerName(0), useDefaultPlayerName(1)];\n    const [storedPreference, setStoredPreference] = useSettingValue(MicSetupPreferenceSetting);\n\n    const playerNames = useMemo<string[]>(\n        () => JSON.parse(sessionStorage.getItem(PLAYER_NAMES_SESSION_STORAGE_KEY)!) ?? [],\n        [],\n    );\n\n    const startSong = () => {\n        onNextStep(playerSetup.map((setup, index) => ({ ...setup, name: setup.name || defaultNames[index] })));\n    };\n\n    const [playerSetup, setPlayerSetup] = useState<[PlayerSetup, PlayerSetup]>([\n        { name: '', track: 0 },\n        { name: '', track: Math.min(1, songPreview.tracksCount - 1) },\n    ]);\n\n    const updatePlayer = (index: number) => (setup: PlayerSetup) => {\n        setPlayerSetup((current) => {\n            const clone = [...current] as [PlayerSetup, PlayerSetup];\n            clone[index] = setup;\n\n            return clone;\n        });\n    };\n\n    const [showModal, setShowModal] = useState(false);\n\n    useEffect(() => {\n        if (!showModal) {\n            InputManager.startMonitoring();\n        }\n    }, [showModal]);\n\n    const { register } = useKeyboardNav({ enabled: keyboardControl && !showModal, onBackspace: onExitKeyboardControl });\n\n    const areInputsConfigured = !!storedPreference && storedPreference !== 'skip';\n\n    return (\n        <>\n            {showModal && (\n                <SelectInputModal\n                    required={!areInputsConfigured}\n                    onClose={() => setShowModal(false)}\n                    playerNames={playerSetup.map((setup) => setup.name)}\n                />\n            )}\n            <PlayerSettingContainer>\n                <h3>Player 1</h3>\n                <div>\n                    <SinglePlayer\n                        index={1}\n                        setup={playerSetup[0]}\n                        onChange={updatePlayer(0)}\n                        playerNames={playerNames}\n                        register={register}\n                        defaultName={defaultNames[0]}\n                        songPreview={songPreview}\n                    />\n                </div>\n            </PlayerSettingContainer>\n            <PlayerSettingContainer>\n                <h3>Player 2</h3>\n                <div>\n                    <SinglePlayer\n                        index={2}\n                        setup={playerSetup[1]}\n                        onChange={updatePlayer(1)}\n                        playerNames={playerNames}\n                        register={register}\n                        defaultName={defaultNames[1]}\n                        songPreview={songPreview}\n                    />\n                </div>\n            </PlayerSettingContainer>\n            {areInputsConfigured && (\n                <PlayButton {...register('play', startSong, undefined, true)} data-test=\"play-song-button\">\n                    Play\n                </PlayButton>\n            )}\n            <PlayButton\n                {...register('mic-setup', () => setShowModal(true), undefined, false)}\n                data-test=\"select-inputs-button\">\n                Setup mics\n            </PlayButton>\n        </>\n    );\n}\n\nconst PlayerSettingContainer = styled.div`\n    display: flex;\n    flex-direction: row;\n\n    h3 {\n        padding: 1.3rem;\n        font-size: 4.5rem;\n    }\n`;\n\nconst PlayButton = styled(Button)<{ focused: boolean }>`\n    padding: 0.5rem 9rem;\n    font-size: 4.3rem;\n`;\n","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport { PlayerSetup, SingSetup, SongPreview } from 'interfaces';\nimport { useState } from 'react';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport events from 'GameEvents/GameEvents';\nimport GameSettings from 'Scenes/SingASong/SongSelection/SongSettings/GameSettings';\nimport MicCheck from 'Scenes/SingASong/SongSelection/SongSettings/MicCheck';\nimport PlayerSettings from 'Scenes/SingASong/SongSelection/SongSettings/PlayerSettings';\n\ninterface Props {\n    songPreview: SongPreview;\n    onPlay: (setup: SingSetup & { file: string; video: string }) => void;\n    keyboardControl: boolean;\n    onExitKeyboardControl: () => void;\n}\n\nexport default function SongSettings({ songPreview, onPlay, keyboardControl, onExitKeyboardControl }: Props) {\n    const [singSetup, setSingSetup] = useState<SingSetup | null>(null);\n    const [step, setStep] = useState<'song' | 'players'>('song');\n\n    const onSongStepFinish = (setup: SingSetup) => {\n        setSingSetup(setup);\n        setStep('players');\n    };\n    const startSong = (players: PlayerSetup[]) => {\n        if (!singSetup) return;\n        const finalSetup = {\n            ...singSetup,\n            players: players as [PlayerSetup, PlayerSetup],\n        };\n        events.songStarted.dispatch(songPreview, finalSetup);\n        onPlay({ file: songPreview.file, video: songPreview.video, ...finalSetup });\n    };\n    return (\n        <Container>\n            <MicCheck />\n            <GameConfiguration>\n                {step === 'song' && (\n                    <GameSettings\n                        songPreview={songPreview}\n                        onNextStep={onSongStepFinish}\n                        keyboardControl={keyboardControl}\n                        onExitKeyboardControl={onExitKeyboardControl}\n                    />\n                )}\n                {step === 'players' && (\n                    <PlayerSettings\n                        songPreview={songPreview}\n                        onNextStep={startSong}\n                        keyboardControl={keyboardControl}\n                        onExitKeyboardControl={() => setStep('song')}\n                    />\n                )}\n            </GameConfiguration>\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    display: flex;\n    flex-direction: row;\n    align-items: flex-end;\n    justify-content: space-between;\n    width: 100%;\n\n    h1 {\n        ${typography};\n        margin: 0;\n        text-align: center;\n        font-size: 3.6rem;\n        color: ${styles.colors.text.active};\n    }\n\n    h2 {\n        ${typography};\n        margin: 0;\n        font-size: 1.15rem;\n    }\n\n    h3 {\n        ${typography};\n        margin: 0;\n        font-size: 1.05rem;\n\n        strong {\n            color: ${styles.colors.text.active};\n        }\n    }\n\n    h4 {\n        ${typography};\n        margin: 0;\n        font-size: 0.85rem;\n    }\n\n    hr {\n        margin: 1rem;\n        opacity: 0.25;\n    }\n`;\n\nconst GameConfiguration = styled.div`\n    width: auto;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    gap: 1.25rem;\n`;\n","import styled from '@emotion/styled';\nimport { focused } from 'Elements/cssMixins';\nimport VideoPlayer, { VideoPlayerRef, VideoState } from 'Elements/VideoPlayer';\nimport { SingSetup, SongPreview } from 'interfaces';\nimport { ComponentProps, PropsWithChildren, useEffect, useLayoutEffect, useRef, useState } from 'react';\nimport { useSongStats } from 'Songs/stats/hooks';\nimport useDebounce from 'hooks/useDebounce';\nimport useViewportSize from 'hooks/useViewportSize';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport {\n    SongCard,\n    SongCardBackground,\n    SongCardContainer,\n    SongCardStatsIndicator,\n    SongListEntryDetailsArtist,\n    SongListEntryDetailsTitle,\n} from 'Scenes/SingASong/SongSelection/SongCard';\nimport SongSettings from 'Scenes/SingASong/SongSelection/SongSettings';\n\ninterface Props {\n    songPreview: SongPreview;\n    onPlay: (setup: SingSetup & { file: string; video: string }) => void;\n    keyboardControl: boolean;\n    onExitKeyboardControl: () => void;\n    top: number;\n    left: number;\n    width: number;\n    height: number;\n    focusEffect: boolean;\n}\n\nconst PREVIEW_LENGTH = 30;\n\nexport default function SongPreviewComponent({\n    songPreview,\n    top,\n    left,\n    width,\n    height,\n    keyboardControl,\n    onExitKeyboardControl,\n    onPlay,\n    focusEffect,\n}: Props) {\n    const [showVideo, setShowVideo] = useState(false);\n    const player = useRef<VideoPlayerRef | null>(null);\n    const { width: windowWidth, height: windowHeight } = useViewportSize();\n\n    const active = keyboardControl;\n\n    // need to use layout effect otherwise newly selected song name is displayed briefly before the element is removed\n    useLayoutEffect(() => {\n        setShowVideo(false);\n    }, [songPreview]);\n\n    const start = songPreview.previewStart ?? (songPreview.videoGap ?? 0) + 60;\n    const [videoId, previewStart, previewEnd, volume] = useDebounce(\n        [songPreview.video, start, songPreview.previewEnd ?? start + PREVIEW_LENGTH, songPreview.volume],\n        350,\n    );\n\n    useEffect(() => {\n        player.current?.loadVideoById({\n            videoId: videoId,\n            startSeconds: previewStart,\n            endSeconds: previewEnd,\n        });\n    }, [videoId, player, previewStart, previewEnd]);\n\n    const finalWidth = active ? windowWidth! : width;\n    const finalHeight = active ? Math.min((windowWidth! / 20) * 9, windowHeight! * (4 / 5)) : height;\n\n    useEffect(() => {\n        player.current?.setSize(finalWidth, (finalWidth / 16) * 9);\n    }, [finalWidth, keyboardControl]);\n\n    return (\n        <>\n            {active && <Backdrop onClick={onExitKeyboardControl} />}\n            {!active && showVideo && (\n                <SongBPMIndicator width={finalWidth} height={finalHeight} left={left} top={top} song={songPreview} />\n            )}\n            <SongPreviewContainer\n                top={top}\n                left={left}\n                width={finalWidth}\n                height={finalHeight}\n                active={active}\n                data-test=\"song-preview\"\n                data-song={songPreview.file}>\n                <Content\n                    width={finalWidth}\n                    height={finalHeight}\n                    active={active}\n                    focus={focusEffect}\n                    blurBackground={active && !showVideo}\n                    isVideoPlaying={showVideo}>\n                    {(showVideo || active) && (\n                        <>\n                            <SongInfo active={active}>\n                                {!active && <SongCardStatsIndicator song={songPreview} />}\n                                <SongListEntryDetailsArtist active={active}>\n                                    {songPreview.artist}\n                                </SongListEntryDetailsArtist>\n                                <SongListEntryDetailsTitle active={active}>\n                                    {songPreview.title}\n                                </SongListEntryDetailsTitle>\n                                {active && (\n                                    <>\n                                        {songPreview.author && (\n                                            <SongAuthor active={active}>\n                                                by&nbsp;\n                                                {songPreview.authorUrl ? (\n                                                    <a href={songPreview.authorUrl} target=\"_blank\" rel=\"noreferrer\">\n                                                        {songPreview.author}\n                                                    </a>\n                                                ) : (\n                                                    songPreview.author\n                                                )}\n                                            </SongAuthor>\n                                        )}\n                                        <SongListEntryStats song={songPreview} />\n                                    </>\n                                )}\n                            </SongInfo>\n                            {active && (\n                                <SongSettings\n                                    songPreview={songPreview}\n                                    onPlay={onPlay}\n                                    keyboardControl={keyboardControl}\n                                    onExitKeyboardControl={onExitKeyboardControl}\n                                />\n                            )}\n                        </>\n                    )}\n                </Content>\n                {active && (\n                    <>\n                        <SongCardBackground\n                            video={songPreview.video}\n                            focused\n                            style={{\n                                backgroundImage: `url('https://i3.ytimg.com/vi/${songPreview.video}/hqdefault.jpg')`,\n                            }}\n                        />\n                    </>\n                )}\n                <Video show={showVideo} active={keyboardControl} height={finalHeight}>\n                    <VideoPlayer\n                        width={0}\n                        height={0}\n                        disablekb\n                        ref={player}\n                        video={''}\n                        volume={volume}\n                        onStateChange={(state) => {\n                            if (state === VideoState.ENDED) {\n                                player.current?.seekTo(start);\n                                player.current?.playVideo();\n                            } else if (state === VideoState.PLAYING) {\n                                setShowVideo(true);\n                            }\n                        }}\n                    />\n                </Video>\n            </SongPreviewContainer>\n        </>\n    );\n}\n\nconst BaseSongPreviewContainer = styled.div<{ width: number; height: number; active: boolean }>`\n    width: ${(props) => props.width}px;\n    height: ${(props) => props.height}px;\n    position: absolute;\n    z-index: 3;\n    overflow: hidden;\n    padding: 0;\n\n    ${(props) => (props.active ? 'position: fixed;' : 'transform: scale(1.2);')}\n    ${(props) => !props.active && 'pointer-events: none;'}\n    ${(props) => !props.active && 'border-radius: 0.5rem;'}\n`;\n\ninterface SongPreviewContainerProps\n    extends PropsWithChildren<{\n        top: number;\n        left: number;\n        active: boolean;\n        width: number;\n        height: number;\n    }> {}\n\nconst SongPreviewContainer = (props: SongPreviewContainerProps) => (\n    <BaseSongPreviewContainer\n        style={{\n            top: props.active ? `calc(50vh - ${props.height}px / 2)` : props.top,\n            left: props.active ? 0 : props.left,\n        }}\n        {...props}\n    />\n);\n\nconst Backdrop = styled.div`\n    position: fixed;\n    top: 0;\n    left: 0;\n    background: rgba(0, 0, 0, 0.8);\n    width: 100vw;\n    height: 100vh;\n    z-index: 2;\n`;\n\nconst Video = styled(SongCard)<{ show: boolean; active: boolean; height: number }>`\n    div {\n        opacity: ${({ show }) => (show ? 1 : 0)};\n        transition: ${({ show, active }) => (show || active ? 1000 : 0)}ms;\n    }\n    ${(props) => !props.active && 'background-image: none !important;'}\n    ${(props) => !props.active && 'border-radius: 0.5rem;'}\n    ${(props) => props.active && `margin-top: calc(-1 * (100vw / 16 * 9) / 2 + ${props.height / 2}px);`}\n`;\n\nconst ContentBase = styled(SongCardContainer)<{\n    active: boolean;\n    blurBackground: boolean;\n    isVideoPlaying: boolean;\n    focus: boolean;\n}>`\n    position: fixed; /* makes sure Autocomplete dropdown doesn't get clipped */\n    z-index: 100;\n    padding: ${(props) => (props.active ? '3.1rem' : '1.3rem')};\n    ${(props) => props.blurBackground && 'backdrop-filter: blur(1rem);'}\n\n    ${(props) => props.focus && !props.active && props.isVideoPlaying && focused}\n    ${(props) => props.focus && !props.active && props.isVideoPlaying && 'border: 0.1rem solid black;'}\n    border-radius: 0.5rem;\n`;\n\nconst Content = (props: ComponentProps<typeof ContentBase> & { width: number; height: number }) => (\n    <ContentBase\n        {...props}\n        style={{\n            width: props.width,\n            height: props.height,\n        }}\n    />\n);\n\nconst SongInfo = styled.div<{ active: boolean }>`\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n\n    flex-direction: column;\n\n    ${(props) =>\n        props.active &&\n        `\n        align-items: flex-start;\n        justify-content: flex-start;\n    `}\n`;\n\nconst SongAuthor = styled(SongListEntryDetailsTitle)`\n    font-size: 3rem;\n    margin-top: 3rem;\n\n    a {\n        text-decoration: none;\n        -webkit-text-stroke: thin black;\n        color: ${styles.colors.text.active};\n    }\n`;\n\nexport const SongListEntryStats = ({ song }: { song: SongPreview }) => {\n    const stats = useSongStats(song);\n\n    return (\n        <SongAuthor>\n            {stats?.plays ? `Played ${stats.plays} time${stats.plays > 1 ? 's' : ''}` : 'Never played yet'}\n        </SongAuthor>\n    );\n};\n\nconst BaseSongBPMIndicator = styled.div<{ width: number; height: number }>`\n    background: white;\n    width: ${(props) => props.width}px;\n    height: ${(props) => props.height}px;\n    z-index: 2;\n    top: 0;\n    left: 0;\n    position: absolute;\n    animation: bpm 1s infinite;\n    border-radius: 0.5rem;\n    pointer-events: none;\n\n    @keyframes bpm {\n        0% {\n            transform: scale(1.15);\n            opacity: 1;\n        }\n        100% {\n            transform: scale(1.5);\n            opacity: 0;\n        }\n    }\n`;\n\nconst SongBPMIndicator = (\n    props: {\n        top: number;\n        left: number;\n        song: SongPreview;\n    } & ComponentProps<typeof BaseSongBPMIndicator>,\n) => {\n    const realBpm = props.song.realBpm ?? (props.song.bpm > 300 ? props.song.bpm / 4 : props.song.bpm / 2);\n    return (\n        <BaseSongBPMIndicator\n            width={props.width}\n            height={props.height}\n            style={{\n                left: props.left,\n                top: props.top,\n                animationDuration: `${60 / realBpm}s`,\n            }}\n        />\n    );\n};\n","import styled from '@emotion/styled';\nimport { focused } from 'Elements/cssMixins';\nimport { REGULAR_ALPHA_CHARS } from 'hooks/useKeyboard';\nimport { KeyHandler } from 'hotkeys-js';\nimport { SingSetup } from 'interfaces';\nimport { useEffect, useRef, useState } from 'react';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport Playlists from 'Scenes/SingASong/SongSelection/Playlists';\nimport QuickSearch from 'Scenes/SingASong/SongSelection/QuickSearch';\nimport SelectRandomTip from 'Scenes/SingASong/SongSelection/SelectRandomTip';\nimport usePrevious from 'hooks/usePrevious';\nimport useViewportSize from 'hooks/useViewportSize';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport useSongSelection from 'Scenes/SingASong/SongSelection/Hooks/useSongSelection';\nimport {\n    SongCard,\n    SongCardBackground,\n    SongCardStatsIndicator,\n    SongListEntryDetailsArtist,\n    SongListEntryDetailsTitle,\n} from 'Scenes/SingASong/SongSelection/SongCard';\nimport SongPreview from 'Scenes/SingASong/SongSelection/SongPreview';\nimport { CircularProgress } from '@mui/material';\nimport { css } from '@emotion/react';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport { useBackground } from 'Elements/LayoutWithBackground';\nimport useBlockScroll from 'hooks/useBlockScroll';\n\ninterface Props {\n    onSongSelected: (songSetup: SingSetup & { file: string; video: string }) => void;\n    preselectedSong: string | null;\n}\n\nconst focusMultiplier = 1.2;\n\nexport default function SongSelection({ onSongSelected, preselectedSong }: Props) {\n    useBackground(true);\n    useBlockScroll();\n    const [{ previewTop, previewLeft, previewWidth, previewHeight }, setPositions] = useState({\n        previewTop: 0,\n        previewLeft: 0,\n        previewWidth: 0,\n        previewHeight: 0,\n    });\n    const {\n        focusedGroup,\n        focusedSong,\n        moveToSong,\n        groupedSongList,\n        keyboardControl,\n        songPreview,\n        setKeyboardControl,\n        setFilters,\n        filters,\n        filtersData,\n        setShowFilters,\n        showFilters,\n        isLoading,\n    } = useSongSelection(preselectedSong);\n    useBackgroundMusic(false);\n\n    const onSearchSong: KeyHandler = (e) => {\n        e.stopPropagation();\n        e.preventDefault();\n\n        setFilters({\n            search: e.key,\n        });\n    };\n    useHotkeys(REGULAR_ALPHA_CHARS, onSearchSong, { enabled: !filters.search && keyboardControl });\n\n    const list = useRef<HTMLDivElement | null>(null);\n    const { width, handleResize } = useViewportSize();\n    const previouslyFocusedGroup = usePrevious(focusedGroup);\n    const previouslyFocusedSong = usePrevious(focusedSong);\n\n    useEffect(() => {\n        const selector = (group: string, index: number) => `[data-group-letter=\"${group}\"] [data-index=\"${index}\"]`;\n        handleResize(); // Recalculate width/height to account possible scrollbar appearing\n\n        const previousSong = list.current?.querySelector(\n            selector(previouslyFocusedGroup, previouslyFocusedSong),\n        ) as HTMLDivElement;\n        const song = list.current?.querySelector(selector(focusedGroup, focusedSong)) as HTMLDivElement;\n        if (song) {\n            if (!previousSong || previousSong.offsetTop !== song.offsetTop) {\n                song.scrollIntoView?.({\n                    behavior: 'smooth',\n                    inline: 'center',\n                    block: 'center',\n                });\n            }\n            setPositions({\n                previewLeft: song.offsetLeft,\n                previewTop: song.offsetTop,\n                previewWidth: song.offsetWidth,\n                previewHeight: song.offsetHeight,\n            });\n        }\n    }, [width, list, focusedSong, focusedGroup, groupedSongList]);\n\n    const onSongClick = (index: number) => (focusedSong === index ? setKeyboardControl(false) : moveToSong(index));\n    if (!groupedSongList || !width) return <>Loading</>;\n\n    if (isLoading) {\n        return (\n            <LoaderContainer>\n                <CircularProgress size=\"15em\" color=\"secondary\" />\n            </LoaderContainer>\n        );\n    }\n    return (\n        <Container>\n            {filters.search ? (\n                <QuickSearch showFilters={showFilters} onSongFiltered={setFilters} filters={filters} />\n            ) : (\n                <SelectRandomTip keyboardControl={keyboardControl} />\n            )}\n            <SongListContainer ref={list} active={keyboardControl} data-test=\"song-list-container\" dim={showFilters}>\n                {songPreview && (\n                    <SongPreview\n                        songPreview={songPreview}\n                        onPlay={onSongSelected}\n                        keyboardControl={!keyboardControl}\n                        onExitKeyboardControl={() => setKeyboardControl(true)}\n                        top={previewTop}\n                        left={previewLeft}\n                        width={previewWidth}\n                        height={previewHeight}\n                        focusEffect={!showFilters}\n                    />\n                )}\n                {groupedSongList.map((group) => (\n                    <SongsGroupContainer\n                        key={group.letter}\n                        data-group-letter={group.letter}\n                        highlight={group.letter === 'New'}>\n                        <SongsGroupHeader>{group.letter}</SongsGroupHeader>\n                        <SongsGroup>\n                            {group.songs.map(({ song, index }) => (\n                                <SongListEntry\n                                    key={song.file}\n                                    onClick={() => onSongClick(index)}\n                                    video={song.video}\n                                    focused={!showFilters && keyboardControl && index === focusedSong}\n                                    data-index={index}\n                                    {...(!showFilters && keyboardControl\n                                        ? { 'data-focused': index === focusedSong }\n                                        : {})}\n                                    data-test={`song-${song.file}${group.isNew ? '-new-group' : ''}`}>\n                                    <SongCardBackground\n                                        style={{\n                                            backgroundImage: `url('https://i3.ytimg.com/vi/${song.video}/hqdefault.jpg')`,\n                                        }}\n                                        video={song.video}\n                                        focused={!showFilters && keyboardControl && index === focusedSong}\n                                    />\n                                    <SongCardStatsIndicator song={song} />\n                                    <SongListEntryDetailsArtist>{song.artist}</SongListEntryDetailsArtist>\n\n                                    <SongListEntryDetailsTitle>{song.title}</SongListEntryDetailsTitle>\n                                </SongListEntry>\n                            ))}\n                        </SongsGroup>\n                    </SongsGroupContainer>\n                ))}\n            </SongListContainer>\n            <Playlists setFilters={setFilters} active={showFilters} closePlaylist={setShowFilters} />\n        </Container>\n    );\n}\n\nconst Container = styled.div`\n    view-transition-name: song-list-container;\n    display: flex;\n    flex-direction: row;\n    max-height: 100vh;\n    --song-list-gap: 3.5rem;\n`;\n\nconst SongsGroupContainer = styled.div<{ highlight: boolean }>`\n    padding: 0 11rem 0 4.5rem;\n    ${(props) =>\n        props.highlight &&\n        css`\n            background: rgba(0, 0, 0, 0.5);\n            padding-bottom: 3rem;\n            border-bottom: 0.2rem solid black;\n\n            ${SongsGroupHeader} {\n                @keyframes new-song-group-header {\n                    0%,\n                    100% {\n                        transform: scale(1);\n                    }\n                    50% {\n                        transform: scale(1.1);\n                    }\n                }\n                animation: new-song-group-header 600ms ease-in-out infinite both;\n                background: #ffffff;\n            }\n        `}\n`;\n\nconst SongsGroupHeader = styled.div`\n    display: inline-block;\n    padding: 0.5rem 1rem;\n    margin-bottom: 2rem;\n    font-size: 3.5rem;\n    position: sticky;\n    z-index: 1;\n    top: calc(-1 * var(--song-list-gap));\n    font-weight: bold;\n    color: ${styles.colors.text.active};\n    -webkit-text-stroke: thin black;\n    background: rgba(0, 0, 0, 0.7);\n`;\n\nconst SongListContainer = styled.div<{ active: boolean; dim: boolean }>`\n    position: relative;\n    flex: 1 1 auto;\n    display: flex;\n    flex-direction: column;\n    gap: var(--song-list-gap);\n    padding: 4.5rem 0;\n    overflow-y: auto;\n    overflow-x: clip;\n    box-sizing: border-box;\n    min-height: 100vh;\n    max-height: 100vh;\n    ::-webkit-scrollbar {\n        display: none;\n    }\n    transition: opacity 500ms;\n    opacity: ${(props) => (props.dim ? 0.5 : 1)};\n`;\n\nconst SongsGroup = styled.div`\n    display: flex;\n    flex-direction: row;\n    flex-wrap: wrap;\n    gap: var(--song-list-gap);\n`;\n\nconst SongListEntry = styled(SongCard)<{ video: string; focused: boolean }>`\n    flex-basis: calc(25% - ((3 / 4) * var(--song-list-gap)));\n    box-sizing: border-box;\n    aspect-ratio: 16/9;\n    padding: 1.3rem;\n\n    transition: 300ms;\n    transform: scale(${(props) => (props.focused ? focusMultiplier : 1)});\n    ${(props) => props.focused && 'z-index: 2;'}\n    // transform: ${(props) => (props.focused ? 'scale(1.1) perspective(50rem) rotateY(7.5deg)' : 'scale(1)')};\n    ${(props) => props.focused && focused}\n    border: 0.1rem black solid;\n    border-radius: 0.5rem;\n\n    content-visibility: auto;\n    contain-intrinsic-size: calc((25% - ((3 / 4) * var(--song-list-gap))) / 16 * 9);\n`;\n\nconst LoaderContainer = styled.div`\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100vh;\n`;\n","import ExcludeLanguagesView from 'Scenes/ExcludeLanguages/ExcludeLanguagesView';\nimport { ExcludedLanguagesSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport { ComponentProps, useState } from 'react';\nimport SongSelection from 'Scenes/SingASong/SongSelection/SongSelection';\n\nfunction SingASong(props: ComponentProps<typeof SongSelection>) {\n    const [excludedLanguages, setExcludedLanguages] = useSettingValue(ExcludedLanguagesSetting);\n    const [languageSelection, setLanguageSelection] = useState(excludedLanguages === null);\n    const goBack = () => {\n        setExcludedLanguages(excludedLanguages ?? []);\n        setLanguageSelection(false);\n    };\n\n    return languageSelection ? (\n        <ExcludeLanguagesView onClose={goBack} closeText=\"Continue to Song Selection\" />\n    ) : (\n        <SongSelection {...props} />\n    );\n}\n\nexport default SingASong;\n","import useFullscreen from 'hooks/useFullscreen';\nimport { SingSetup } from 'interfaces';\nimport { useState } from 'react';\nimport RemoteMicManager from 'RemoteMic/RemoteMicManager';\nimport TransitionWrapper from '../../Elements/TransitionWrapper';\nimport Singing from './Singing/Singing';\nimport SingASong from 'Scenes/SingASong/SingASong';\n\ninterface Props {\n    file?: string;\n}\n\nfunction Game(props: Props) {\n    const [singSetup, setSingSetup] = useState<(SingSetup & { file: string; video: string }) | null>(null);\n    const [preselectedSong, setPreselectedSong] = useState<string | null>(props.file ?? null);\n    const [resetKey, setResetKey] = useState(0);\n\n    useFullscreen();\n\n    return (\n        <>\n            <TransitionWrapper show={!!singSetup}>\n                {singSetup && (\n                    <Singing\n                        restartSong={() => setResetKey((current) => current + 1)}\n                        key={resetKey}\n                        video={singSetup.video}\n                        songFile={singSetup.file}\n                        singSetup={singSetup}\n                        returnToSongSelection={() => {\n                            setPreselectedSong(singSetup.file);\n                            setSingSetup(null);\n                        }}\n                    />\n                )}\n            </TransitionWrapper>\n            <TransitionWrapper show={!singSetup}>\n                <SingASong\n                    onSongSelected={(setup) => {\n                        RemoteMicManager.broadcast({ t: 'reload-mic' });\n                        setSingSetup(setup);\n                    }}\n                    preselectedSong={preselectedSong}\n                />\n            </TransitionWrapper>\n        </>\n    );\n}\nexport default Game;\n","import styled from '@emotion/styled';\nimport { Button } from 'Elements/Button';\nimport VideoPlayer, { VideoState } from 'Elements/VideoPlayer';\nimport useSongIndex from 'Songs/hooks/useSongIndex';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { SongPreview } from 'interfaces';\nimport { shuffle } from 'lodash-es';\nimport { useEffect, useState } from 'react';\nimport { Link } from 'wouter';\nimport useViewportSize from '../../hooks/useViewportSize';\nimport SongPage from '../Game/SongPage';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport { useBackground } from 'Elements/LayoutWithBackground';\n\ninterface Props {}\n\nfunction Jukebox(props: Props) {\n    useBackground(false);\n    useBackgroundMusic(false);\n    const navigate = useSmoothNavigate();\n    const { width, height } = useViewportSize();\n    const [currentlyPlaying, setCurrentlyPlaying] = useState(0);\n    const songList = useSongIndex();\n\n    const [shuffledList, setShuffledList] = useState<SongPreview[]>([]);\n    const { register } = useKeyboardNav({ onBackspace: () => navigate('/') });\n\n    useEffect(() => songList.data && setShuffledList(shuffle(songList.data)), [songList.data]);\n\n    const playNext = () => songList.data && setCurrentlyPlaying((current) => (current + 1) % songList.data.length);\n\n    if (!shuffledList.length || !width || !height) return null;\n\n    const navigateUrl = `/game/${encodeURIComponent(shuffledList[currentlyPlaying].file)}`;\n\n    return (\n        <SongPage\n            width={width}\n            height={height}\n            songData={shuffledList[currentlyPlaying]}\n            data-test=\"jukebox-container\"\n            data-song={shuffledList[currentlyPlaying].file}\n            background={\n                <VideoPlayer\n                    autoplay\n                    controls\n                    width={width}\n                    height={height}\n                    volume={shuffledList[currentlyPlaying]?.volume}\n                    video={shuffledList[currentlyPlaying].video}\n                    startAt={shuffledList[currentlyPlaying].videoGap}\n                    onStateChange={(state) => {\n                        if (state === VideoState.ENDED) playNext();\n                    }}\n                />\n            }>\n            <SkipSongButton {...register('skip', playNext)} data-test=\"skip-button\">\n                Skip\n            </SkipSongButton>\n            <Link to={navigateUrl}>\n                <PlayThisSongButton\n                    {...register('sing a song', () => navigate(navigateUrl), undefined, true)}\n                    data-test=\"sing-button\">\n                    Sing this song\n                </PlayThisSongButton>\n            </Link>\n        </SongPage>\n    );\n}\n\nconst PlayThisSongButton = styled(Button)<{ focused: boolean }>`\n    bottom: 7rem;\n    right: 2rem;\n    width: 50rem;\n    position: absolute;\n    font-size: 1.9vw;\n`;\n\nconst SkipSongButton = styled(Button)<{ focused: boolean }>`\n    bottom: 15rem;\n    right: 2rem;\n    width: 30rem;\n    position: absolute;\n    font-size: 1.9vw;\n`;\n\nexport default Jukebox;\n","import styled from '@emotion/styled';\nimport WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport { Games, KeyboardArrowDown, KeyboardArrowLeft, KeyboardArrowRight, KeyboardArrowUp } from '@mui/icons-material';\nimport { css } from '@emotion/react';\nimport { useEventListener } from 'GameEvents/hooks';\nimport events from 'GameEvents/GameEvents';\nimport { keyStrokes } from 'RemoteMic/Network/events';\n\nexport default function RemoteMicKeyboard() {\n    const [keyboard] = useEventListener(events.remoteKeyboardLayout) ?? [];\n\n    const isHorizontal = keyboard?.horizontal !== undefined || keyboard?.['horizontal-vertical'] !== undefined;\n    const isVertical = keyboard?.vertical !== undefined || keyboard?.['horizontal-vertical'] !== undefined;\n\n    const onPress = (key: keyStrokes) => () => {\n        // navigator?.vibrate?.(200);\n        WebRTCClient.sendKeyStroke(key);\n    };\n\n    return keyboard !== undefined ? (\n        <Container>\n            {(isHorizontal || isVertical) && (\n                <ActionsContainer>\n                    <ArrowsContainer>\n                        <ArrowButton onClick={onPress('up')} disabled={!isVertical} data-test=\"arrow-up\">\n                            <KeyboardArrowUp />\n                        </ArrowButton>\n                    </ArrowsContainer>\n                    <ArrowsContainer>\n                        <ArrowButton onClick={onPress('left')} disabled={!isHorizontal} data-test=\"arrow-left\">\n                            <KeyboardArrowLeft />\n                        </ArrowButton>\n                        <ArrowButton disabled>\n                            <Games />\n                        </ArrowButton>\n                        <ArrowButton onClick={onPress('right')} disabled={!isHorizontal} data-test=\"arrow-right\">\n                            <KeyboardArrowRight />\n                        </ArrowButton>\n                    </ArrowsContainer>\n                    <ArrowsContainer>\n                        <ArrowButton onClick={onPress('down')} disabled={!isVertical} data-test=\"arrow-down\">\n                            <KeyboardArrowDown />\n                        </ArrowButton>\n                    </ArrowsContainer>\n                </ActionsContainer>\n            )}\n            <ActionsContainer>\n                <ActionButton\n                    onClick={onPress('Backspace')}\n                    disabled={keyboard?.back === undefined}\n                    data-test=\"keyboard-backspace\">\n                    {keyboard?.back || 'Back'}\n                </ActionButton>\n                <ActionButton\n                    onClick={onPress('Enter')}\n                    disabled={keyboard?.accept === undefined}\n                    data-test=\"keyboard-enter\">\n                    {keyboard?.accept || 'Enter'}\n                </ActionButton>\n            </ActionsContainer>\n            <Break />\n            <ActionsContainer disabled={keyboard?.shiftR === undefined} data-test=\"keyboard-shift-r\">\n                <ActionButton onClick={onPress('Shift+R')}>{keyboard?.shiftR || 'Random Song'}</ActionButton>\n            </ActionsContainer>\n        </Container>\n    ) : null;\n}\n\nconst Container = styled.div`\n    gap: 1rem;\n    display: flex;\n    flex-wrap: wrap;\n`;\nconst ArrowsContainer = styled.div`\n    display: flex;\n    justify-content: center;\n    flex: 1;\n    color: white;\n    font-size: 2rem;\n`;\n\nconst ActionsContainer = styled.div<{ disabled?: boolean }>`\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    justify-content: space-between;\n    opacity: ${(props) => (props.disabled ? 0 : 1)};\n`;\n\nconst Break = styled.div`\n    flex-basis: 100%;\n    height: 0;\n`;\n\nconst ButtonBase = styled.button<{ disabled?: boolean }>`\n    background: none;\n    border: none;\n    box-sizing: border-box;\n    margin: 0.25rem;\n    width: 4.5rem;\n    height: 4.5rem;\n\n    svg {\n        width: 2.5rem;\n        height: 2.5rem;\n    }\n\n    opacity: ${(props) => (props.disabled ? 0.25 : 1)};\n`;\n\nconst ArrowButton = styled(ButtonBase)<{ disabled?: boolean }>`\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 0.3rem;\n    border: 0.3rem solid rgb(204, 204, 204);\n    border-bottom-color: rgb(130, 130, 130);\n    border-right-color: rgb(130, 130, 130);\n\n    ${(props) =>\n        !props.disabled\n            ? css`\n                  cursor: pointer;\n                  &:active {\n                      border: 0.3rem solid rgb(130, 130, 130);\n                      border-bottom-color: rgb(204, 204, 204);\n                      border-right-color: rgb(204, 204, 204);\n                  }\n              `\n            : ''}\n\n    color: rgb(51, 51, 51);\n    font-weight: normal;\n    font-size: 2.5rem;\n    box-shadow: 0 0.1rem 0 rgba(0, 0, 0, 0.2), inset 0 0 0 0.2rem #ffffff;\n    background-color: rgb(247, 247, 247);\n    text-shadow: 0 0.1rem 0 #fff;\n`;\n\nconst ActionButton = styled(ArrowButton)<{ disabled?: boolean }>`\n    width: 100%;\n`;\n","import styled from '@emotion/styled';\nimport { useState } from 'react';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport SwapHorizIcon from '@mui/icons-material/SwapHoriz';\nimport { focused, typography } from 'Elements/cssMixins';\nimport { buttonFocused } from 'Elements/Button';\nimport { MenuButton, MenuContainer } from 'Elements/Menu';\nimport Modal from 'Elements/Modal';\nimport WebRTCClient from 'RemoteMic/Network/WebRTCClient';\n\ninterface Props {\n    playerNumber: number | null;\n}\n\nexport default function PlayerChange({ playerNumber }: Props) {\n    const [isOpen, setIsOpen] = useState(false);\n\n    const closeModal = () => setIsOpen(false);\n\n    const selectPlayer = (player: number | null) => {\n        WebRTCClient.requestPlayerChange(player);\n        closeModal();\n    };\n\n    return (\n        <>\n            <PlayerChangeContainer onClick={() => setIsOpen(true)} data-test=\"change-player\">\n                {playerNumber === null ? 'Join game' : 'Change'} <SwapHorizIcon />\n            </PlayerChangeContainer>\n            {isOpen && (\n                <Modal onClose={closeModal}>\n                    <MenuContainer>\n                        <MenuButton\n                            data-test=\"change-to-player-1\"\n                            onClick={() => selectPlayer(0)}\n                            disabled={0 === playerNumber}\n                            style={{ color: styles.colors.players[0].perfect.fill }}>\n                            Blue\n                        </MenuButton>\n                        <MenuButton\n                            data-test=\"change-to-player-2\"\n                            onClick={() => selectPlayer(1)}\n                            disabled={1 === playerNumber}\n                            style={{ color: styles.colors.players[1].perfect.fill }}>\n                            Red\n                        </MenuButton>\n                        <MenuButton\n                            onClick={() => selectPlayer(null)}\n                            disabled={null === playerNumber}\n                            data-test=\"change-to-unset\">\n                            Unassign\n                        </MenuButton>\n                        <hr />\n                        <MenuButton onClick={closeModal}>Close</MenuButton>\n                    </MenuContainer>\n                </Modal>\n            )}\n        </>\n    );\n}\n\nconst PlayerChangeContainer = styled.button`\n    position: absolute;\n    color: white;\n    right: 1rem;\n    top: 1rem;\n    padding: 1rem;\n    font-size: 2rem;\n    text-transform: uppercase;\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    border: none;\n    ${typography};\n    background: rgba(0, 0, 0, 0.75);\n\n    :hover {\n        ${focused};\n    }\n\n    :active {\n        ${buttonFocused};\n    }\n\n    svg {\n        width: 2rem;\n        height: 2rem;\n    }\n`;\n","import styled from '@emotion/styled';\nimport { useEffect, useState } from 'react';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport PlayerChange from 'Scenes/RemoteMic/Panels/PlayerChange';\n\ninterface Props {\n    volume: number;\n    playerNumber: number | null;\n    frequency: number | null;\n    isMicOn: boolean;\n    isConnected: boolean;\n}\n\nexport default function VolumeIndicator({ playerNumber, volume, frequency, isMicOn, isConnected }: Props) {\n    const [maxVolume, setMaxVolume] = useState(0.000001);\n\n    useEffect(() => {\n        setMaxVolume((current) => (volume > current ? volume : current * 0.99));\n    }, [volume]);\n\n    const backgroundColor =\n        playerNumber !== null ? styles.colors.players[playerNumber].miss.stroke : styles.colors.lines.normal.fill;\n    const indicatorColor =\n        playerNumber !== null ? styles.colors.players[playerNumber].perfect.fill : styles.colors.lines.normal.fill;\n\n    return (\n        <IndicatorContainer\n            isMicOn={isMicOn}\n            color={backgroundColor}\n            data-player-number={`${playerNumber ?? 'none'}`}\n            data-test=\"indicator\">\n            {isMicOn && (\n                <>\n                    <Debug>\n                        {frequency ? `${Math.round(frequency)}Hz` : ' '}\n                        <br />\n                        {String(volume * 100).slice(0, 5)}\n                    </Debug>\n                </>\n            )}\n            {isConnected && <PlayerChange playerNumber={playerNumber} />}\n            <Indicator\n                color={indicatorColor}\n                style={{ height: `${isMicOn ? 100 - Math.min(100, (volume / maxVolume) * 100) : 100}%` }}\n            />\n        </IndicatorContainer>\n    );\n}\n\nconst Debug = styled.span`\n    position: absolute;\n    color: white;\n    opacity: 0.125;\n`;\n\nconst Indicator = styled.div<{ color: string }>`\n    width: 100%;\n    background-color: ${(props) => props.color};\n    transition: 200ms;\n`;\n\nconst IndicatorContainer = styled.div<{ color: string; isMicOn: boolean }>`\n    position: relative;\n    border: 0.1rem solid white;\n    flex: 1;\n    min-height: 200px;\n    max-height: 100vw;\n    transition: 300ms;\n\n    background: ${(props) => props.color};\n`;\n","import { throttle } from 'lodash-es';\nimport { useCallback, useEffect, useState } from 'react';\nimport events from 'GameEvents/GameEvents';\nimport { useEventListener } from 'GameEvents/hooks';\nimport VolumeIndicator from './VolumeIndicator';\nimport SimplifiedMic from 'Scenes/Game/Singing/Input/SimplifiedMic';\n\ninterface Props {\n    isVisible: boolean;\n    isMicOn: boolean;\n    isConnected: boolean;\n}\n\nfunction MicPreview({ isVisible, isMicOn, isConnected }: Props) {\n    const [volume, setVolume] = useState(0);\n    const [frequency, setFrequency] = useState(0);\n    const [playerNumber] = useEventListener(events.remoteMicPlayerNumberSet) ?? [null];\n\n    const updateVolumes = useCallback(\n        throttle((freq: number, volume: number) => {\n            setFrequency(freq);\n            setVolume(volume);\n        }, 150),\n        [setVolume, setFrequency],\n    );\n\n    useEffect(() => {\n        SimplifiedMic.startMonitoring(undefined);\n        return SimplifiedMic.addListener(updateVolumes);\n    }, [updateVolumes]);\n\n    return isVisible ? (\n        <>\n            <VolumeIndicator\n                volume={volume}\n                frequency={frequency}\n                playerNumber={playerNumber}\n                isMicOn={isMicOn}\n                isConnected={isConnected}\n            />\n        </>\n    ) : null;\n}\nexport default MicPreview;\n","import styled from '@emotion/styled';\nimport { Input } from 'Elements/Input';\nimport { MenuButton } from 'Elements/Menu';\nimport { FormEventHandler, useEffect, useRef, useState } from 'react';\nimport events from 'GameEvents/GameEvents';\nimport createPersistedState from 'use-persisted-state';\nimport WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport { Wifi } from '@mui/icons-material';\nimport { CircularProgress } from '@mui/material';\n\ninterface Props {\n    roomId: string;\n    isVisible: boolean;\n    connectionStatus: Parameters<typeof events.karaokeConnectionStatusChange.dispatch>[0] | 'uninitialised';\n    onConnect: (silent: boolean) => void;\n}\n\nconst usePersistedName = createPersistedState<string>('remote_mic_name');\n\nfunction Connect({ isVisible, roomId, connectionStatus, onConnect }: Props) {\n    const [name, setName] = usePersistedName('');\n    const inputRef = useRef<HTMLInputElement | null>(null);\n\n    const disabled = connectionStatus !== 'uninitialised';\n\n    const connectToServer = (silent = false) => {\n        WebRTCClient.connect(roomId, name, silent);\n        try {\n            process.env.NODE_ENV !== 'development' && document.body.requestFullscreen().catch(console.info);\n        } catch (e) {}\n        onConnect(silent);\n    };\n\n    const handleConnect: FormEventHandler<HTMLFormElement> = (e) => {\n        e.preventDefault();\n\n        if (name === '') {\n            inputRef.current?.focus();\n        } else {\n            connectToServer();\n        }\n    };\n\n    useEffect(() => {\n        inputRef.current?.focus();\n\n        if (window.sessionStorage.getItem('reload-mic-request') !== null) {\n            // give other components option to read the property on mount before its removed\n            window.setTimeout(() => window.sessionStorage.removeItem('reload-mic-request'), 1);\n            connectToServer(true);\n        }\n    }, []);\n\n    const [showConnectionTip, setShowConnectionTip] = useState(false);\n\n    useEffect(() => {\n        setShowConnectionTip(false);\n        if (connectionStatus === 'connecting' || connectionStatus === 'reconnecting') {\n            const timeout = setTimeout(() => setShowConnectionTip(true), 2000);\n\n            return () => clearTimeout(timeout);\n        }\n    }, [connectionStatus]);\n\n    return isVisible ? (\n        <>\n            <Form onSubmit={handleConnect}>\n                <Input\n                    focused={false}\n                    label=\"Name\"\n                    value={name}\n                    onChange={setName}\n                    ref={inputRef}\n                    disabled={disabled}\n                    autoFocus\n                    data-test=\"player-name-input\"\n                />\n                <MenuButton type=\"submit\" disabled={disabled} data-test=\"connect-button\">\n                    {connectionStatus === 'connecting' && <CircularProgress size={'1em'} />}\n                    {connectionStatus === 'uninitialised' ? 'Connect' : connectionStatus.toUpperCase()}\n                </MenuButton>\n                {showConnectionTip && (\n                    <>\n                        <h3>If it doesn't connect</h3>\n                        <h5>\n                            Make sure you are in the same <Wifi /> Wi-Fi\n                        </h5>\n                        <h5>Refresh (F5) the Karaoke on the PC</h5>\n                    </>\n                )}\n            </Form>\n        </>\n    ) : null;\n}\nexport default Connect;\n\nconst Form = styled.form`\n    display: flex;\n    flex-direction: column;\n`;\n","import styled from '@emotion/styled';\nimport { MenuButton, MenuContainer } from 'Elements/Menu';\nimport { useEffect, useState } from 'react';\nimport { useEventEffect } from 'GameEvents/hooks';\nimport events from 'GameEvents/GameEvents';\nimport WebRTCClient from 'RemoteMic/Network/WebRTCClient';\nimport { focused } from 'Elements/cssMixins';\n\ninterface Props {\n    onConfirm: () => void;\n}\n\nfunction ConfirmReadiness({ onConfirm }: Props) {\n    const [visible, setVisible] = useState(false);\n    const [isAfterReload, setIsAfterReload] = useState(false);\n\n    // Try to predict the readiness request from the game. If the refresh request happened and after reconnection\n    // The player number is set for the phone, it's likely that a readiness confirmation is needed so the button\n    // is displayed even before the event comes around\n    useEffect(() => {\n        if (window.sessionStorage.getItem('reload-mic-request') !== null) {\n            setIsAfterReload(true);\n        }\n    }, []);\n    useEventEffect(events.remoteMicPlayerNumberSet, () => {\n        if (isAfterReload) {\n            setIsAfterReload(false);\n            setVisible(true);\n        }\n    });\n\n    useEventEffect(events.remoteReadinessRequested, () => {\n        setVisible(true);\n    });\n    const confirm = () => {\n        WebRTCClient.confirmReadiness();\n        setVisible(false);\n        onConfirm();\n    };\n\n    return visible ? (\n        <Form>\n            <MenuContainer>\n                <ReadyButton data-test=\"ready-button\" onClick={confirm}>\n                    Ready\n                </ReadyButton>\n            </MenuContainer>\n        </Form>\n    ) : null;\n}\nexport default ConfirmReadiness;\n\nconst Form = styled.div`\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    backdrop-filter: blur(10px);\n    z-index: 1000;\n`;\n\nconst ReadyButton = styled(MenuButton)`\n    aspect-ratio: 1;\n\n    ${focused};\n`;\n","import styled from '@emotion/styled';\nimport NoSleep from '@uriopass/nosleep.js';\nimport { typography } from 'Elements/cssMixins';\nimport { useBackground } from 'Elements/LayoutWithBackground';\nimport { MenuButton, MenuContainer } from 'Elements/Menu';\nimport { useEffect, useRef, useState } from 'react';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\nimport events from 'GameEvents/GameEvents';\nimport { useEventEffect, useEventListener } from 'GameEvents/hooks';\nimport SimplifiedMic from 'Scenes/Game/Singing/Input/SimplifiedMic';\nimport UserMediaEnabled from 'UserMedia/UserMediaEnabled';\nimport NormalizeFontSize from 'Elements/NormalizeFontSize';\nimport RemoteMicKeyboard from './Panels/Keyboard';\nimport MicPreview from 'Scenes/RemoteMic/Panels/MicPreview';\nimport Connect from 'Scenes/RemoteMic/Panels/Connect';\nimport ConfirmReadiness from 'Scenes/RemoteMic/Panels/ConfirmReadiness';\n\ninterface Props {\n    roomId: string;\n}\n\nconst noSleep = new NoSleep();\n\nfunction RemoteMic({ roomId }: Props) {\n    useBackground(true);\n    const inputRef = useRef<HTMLInputElement | null>(null);\n    const [connectionStatus] = useEventListener(events.karaokeConnectionStatusChange) ?? ['uninitialised'];\n\n    const [monitoringStarted, setMonitoringStarted] = useState(false);\n    useEventEffect(events.micMonitoringStarted, () => setMonitoringStarted(true));\n    useEventEffect(events.micMonitoringStopped, () => setMonitoringStarted(false));\n\n    const [isKeepAwakeOn, setIsKeepAwakeOn] = useState(false);\n\n    const setKeepAwake = async (turnOn: boolean) => {\n        try {\n            if (turnOn && !noSleep.isEnabled) {\n                await noSleep.enable();\n            } else if (!turnOn && noSleep.isEnabled) {\n                await noSleep.disable();\n            }\n            setIsKeepAwakeOn(turnOn);\n        } catch (e) {\n            console.warn('Couldnt set wakelock', e);\n        }\n    };\n\n    useEffect(() => {\n        inputRef.current?.focus();\n    }, []);\n\n    const onConnect = () => {\n        setKeepAwake(true);\n    };\n\n    const onConfirm = () => {\n        setKeepAwake(true);\n    };\n\n    return (\n        <>\n            <NormalizeFontSize size={10} />\n            <Container id=\"phone-ui-container\">\n                <MicPreview isVisible isMicOn={monitoringStarted} isConnected={connectionStatus === 'connected'} />\n                <UserMediaEnabled fallback={<h2>Please allow access to the microphone.</h2>}>\n                    <ConfirmReadiness onConfirm={onConfirm} />\n                    <Connect\n                        roomId={roomId}\n                        isVisible={true}\n                        connectionStatus={connectionStatus}\n                        onConnect={onConnect}\n                    />\n                    <RemoteMicKeyboard />\n                    <KeepAwake onClick={() => setKeepAwake(!isKeepAwakeOn)}>\n                        WakeLock: <strong>{isKeepAwakeOn ? 'ON' : 'OFF'}</strong>\n                    </KeepAwake>\n                    <MicInputState\n                        onClick={() =>\n                            monitoringStarted\n                                ? SimplifiedMic.stopMonitoring()\n                                : SimplifiedMic.startMonitoring(undefined)\n                        }>\n                        Microphone: <strong data-test=\"monitoring-state\">{monitoringStarted ? 'ON' : 'OFF'}</strong>\n                    </MicInputState>\n                </UserMediaEnabled>\n            </Container>\n        </>\n    );\n}\nexport default RemoteMic;\n\nconst Container = styled(MenuContainer)`\n    margin: 0 auto;\n    width: 100%;\n    max-width: 400px;\n    box-sizing: border-box;\n    height: 100vh;\n    max-height: 800px;\n\n    ${MenuButton} {\n        padding: 0.5em;\n        height: 72px;\n\n        margin-bottom: 1em;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 0.5em;\n    }\n\n    h5 {\n        margin-top: 0.5em;\n\n        svg {\n            font-size: 0.9em;\n        }\n    }\n`;\n\nconst MicInputState = styled.div`\n    ${typography}\n    strong {\n        color: ${styles.colors.text.active};\n    }\n    align-self: flex-end;\n`;\nconst KeepAwake = styled(MicInputState)`\n    margin-top: auto;\n`;\n","import SelectInputView from 'Scenes/SelectInput/SelectInputView';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport MenuWithLogo from 'Elements/MenuWithLogo';\n\ninterface Props {\n    // file?: string;\n}\n\nfunction SelectInput(props: Props) {\n    const navigate = useSmoothNavigate();\n    return (\n        <MenuWithLogo>\n            <SelectInputView onFinish={() => navigate('/')} closeButtonText={'Go to main menu'} />\n        </MenuWithLogo>\n    );\n}\nexport default SelectInput;\n","import useSongIndex from 'Songs/hooks/useSongIndex';\nimport { useEffect } from 'react';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\n\ninterface GetSongBpmSearchEntry {\n    song_id: string;\n    song_title: string;\n    song_uri: string;\n    tempo: string;\n    time_sig: string;\n    key_of: string;\n    open_key: null;\n    artist: {\n        id: string;\n        name: string;\n        uri: string;\n        img: string;\n        genres: string[];\n        from: string;\n        mbid: string;\n    };\n    album: {\n        title: string;\n        uri: string;\n        img: string;\n        year: string;\n    };\n}\n\nexport default function GetSongsBPMs(props: {}) {\n    useBackgroundMusic(false);\n    const songList = useSongIndex();\n\n    useEffect(() => {\n        if (songList.data) {\n            const bpms: Record<string, GetSongBpmSearchEntry | null> = {};\n            (async () => {\n                for (const song of songList.data) {\n                    if (song.realBpm) continue;\n                    const params = [\n                        `lookup=song:${encodeURIComponent(song.title)}+artist:${encodeURIComponent(song.artist)}`,\n                        'type=both',\n                        `api_key=${import.meta.env.VITE_APP_GET_SONG_BPM_API_TOKEN!}`,\n                    ].join('&');\n\n                    const response = await fetch(`https://api.getsongbpm.com/search/?${params}`);\n                    const getSongBPMData: { search: GetSongBpmSearchEntry[] } = await response.json();\n\n                    bpms[song.file] = Array.isArray(getSongBPMData.search) ? getSongBPMData.search[0] || null : null;\n                }\n                console.log(bpms);\n            })();\n        }\n    }, [songList.data]);\n\n    return <>Copy resulting object to `scripts/scraped-bpm-data.json` file and run fillMetadata script</>;\n}\n","import LayoutWithBackground from 'Elements/LayoutWithBackground';\nimport { MenuContainer } from 'Elements/Menu';\nimport RecommendedBrowsers from 'Elements/RecommendedBrowsers';\nimport Logo from 'Elements/Logo';\nimport styled from '@emotion/styled';\nimport SelectInputView from 'Scenes/SelectInput/SelectInputView';\nimport { MicSetupPreference } from 'Scenes/Settings/SettingsState';\nimport GithubRibbon from 'Scenes/Welcome/GithubRibbon';\nimport { useLocation } from 'wouter';\n\ninterface Props {\n    // file?: string;\n}\n\nfunction QuickSetup(props: Props) {\n    const [, navigate] = useLocation();\n    const onFinish = (pref: (typeof MicSetupPreference)[number]) => {\n        // navigate('/');\n    };\n\n    return (\n        <LayoutWithBackground>\n            <GithubRibbon />\n            <Container>\n                <Logo />\n                <RecommendedBrowsers />\n                <MenuContainer>\n                    <SelectInputView onFinish={onFinish} closeButtonText=\"Sing a song\" smooth />\n                </MenuContainer>\n            </Container>\n        </LayoutWithBackground>\n    );\n}\n\nconst Container = styled.div`\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n`;\n\nexport default QuickSetup;\n","export default \"__VITE_ASSET__02fbe063__\"","import styled from '@emotion/styled';\nimport { typography } from 'Elements/cssMixins';\nimport { MenuButton } from 'Elements/Menu';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { Link } from 'wouter';\nimport getSongBpm from './logo_bpm.png';\nimport useBackgroundMusic from 'hooks/useBackgroundMusic';\nimport { useBackground } from 'Elements/LayoutWithBackground';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport MenuWithLogo from 'Elements/MenuWithLogo';\nimport { MouseEventHandler } from 'react';\n\nfunction Welcome() {\n    useBackground(true);\n\n    const navigate = useSmoothNavigate();\n\n    const handleClick: (url: string) => MouseEventHandler<HTMLAnchorElement> = (url) => (e) => {\n        e.preventDefault();\n        navigate(url);\n    };\n\n    useBackgroundMusic(/* true */ false);\n    const { register } = useKeyboardNav();\n    return (\n        <>\n            <BackgroundMusicCredit>\n                <span>â€¢ Song: Funk Cool Groove (Music Today 80)</span>\n                <span>â€¢ Composed & Produced by : Anwar Amr</span>\n                <span>\n                    â€¢ Video Link:{' '}\n                    <a href=\"https://youtu.be/FGzzBbYRjFY\" target=\"_blank\" rel=\"noreferrer\">\n                        https://youtu.be/FGzzBbYRjFY\n                    </a>\n                </span>\n            </BackgroundMusicCredit>\n            <MenuWithLogo supportedBrowsers>\n                <Link href=\"/game/\" onClick={handleClick('/game/')}>\n                    <MenuButton data-test=\"sing-a-song\" {...register('sing a song', () => navigate('/game/'))}>\n                        Sing a song\n                    </MenuButton>\n                </Link>\n                <Link href=\"/select-input\" onClick={handleClick('/select-input')}>\n                    <MenuButton data-test=\"select-input\" {...register('select input', () => navigate('/select-input'))}>\n                        Setup Microphones\n                    </MenuButton>\n                </Link>\n                <Link href=\"/settings\" onClick={handleClick('/settings')}>\n                    <MenuButton data-test=\"settings\" {...register('settings', () => navigate('/settings'))}>\n                        Settings\n                    </MenuButton>\n                </Link>\n                <Link href=\"/jukebox\" onClick={handleClick('/jukebox')}>\n                    <MenuButton data-test=\"jukebox\" {...register('jukebox', () => navigate('/jukebox'))}>\n                        Jukebox\n                    </MenuButton>\n                </Link>\n                <Link href=\"/manage-songs\" onClick={handleClick('/manage-songs')}>\n                    <MenuButton data-test=\"manage-songs\" {...register('manage songs', () => navigate('/manage-songs'))}>\n                        Manage Songs\n                    </MenuButton>\n                </Link>\n                <GetSongBPM target=\"_blank\" href=\"https://getsongbpm.com/\">\n                    Bpm data and release year provided by <img src={getSongBpm} />\n                </GetSongBPM>\n            </MenuWithLogo>\n        </>\n    );\n}\n\nconst GetSongBPM = styled.a`\n    ${typography};\n    text-decoration: none;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 2.1rem;\n    img {\n        width: 20%;\n        height: 20%;\n    }\n`;\nconst BackgroundMusicCredit = styled.div`\n    ${typography};\n    text-decoration: none;\n    flex-direction: column;\n    display: flex;\n    font-size: 1.5rem;\n    gap: 1rem;\n    opacity: 0.75;\n    position: absolute;\n    bottom: 0;\n    left: 1rem;\n\n    view-transition-name: background-music-credit;\n`;\n\nexport default Welcome;\n","import { css } from '@emotion/react';\nimport { typography } from 'Elements/cssMixins';\nimport styles from 'Scenes/Game/Singing/GameOverlay/Drawing/styles';\n\nexport default css`\n    h1 {\n        ${typography};\n        margin: 0;\n        text-align: center;\n        font-size: 4rem;\n        color: ${styles.colors.text.active};\n    }\n\n    h2 {\n        ${typography};\n        margin: 0;\n        font-size: 2.9rem;\n    }\n\n    h3 {\n        ${typography};\n        margin: 0;\n        font-size: 2.7rem;\n\n        strong {\n            color: ${styles.colors.text.active};\n        }\n    }\n\n    h4 {\n        ${typography};\n        margin: 0;\n        font-size: 2.2rem;\n    }\n\n    h5 {\n        ${typography};\n        margin: 0;\n        font-size: 1.6rem;\n    }\n\n    hr {\n        margin: 0.5rem 1rem;\n        opacity: 0.25;\n    }\n\n    a {\n        color: ${styles.colors.text.active};\n    }\n\n    strong {\n        color: ${styles.colors.text.active};\n    }\n`;\n","import styled from '@emotion/styled';\nimport { Warning } from '@mui/icons-material';\nimport { FallbackRender } from '@sentry/react';\nimport { MenuButton } from 'Elements/Menu';\nimport localForage from 'localforage';\nimport MenuWithLogo from 'Elements/MenuWithLogo';\n\nexport const ErrorFallback: FallbackRender = ({ error, resetError }) => {\n    return (\n        <MenuWithLogo supportedBrowsers>\n            <h1>\n                <Warning fontSize=\"large\" /> An error occurred :(\n            </h1>\n            <h3>The game crashed with following error</h3>\n            <Pre>{error.message}</Pre>\n            <h3>\n                Help me fix it by reporting what exactly has happened at{' '}\n                <a href=\"https://github.com/Asvarox/allkaraoke\" target=\"_blank\" rel=\"noreferrer\">\n                    GitHub\n                </a>\n            </h3>\n            <MenuButton onClick={resetError}>Reset Error</MenuButton>\n            <h4>If that doesn't help</h4>\n            <MenuButton onClick={() => (window.location.href = window.location.origin)}>Reload the game</MenuButton>\n            <h4>If that doesn't help</h4>\n            <MenuButton\n                onClick={() => {\n                    if (\n                        window.confirm(\n                            'Are you sure? It will delete all custom songs and scores. Before doing that, try opening the game in an private window or another browser to make sure it will actually help',\n                        )\n                    ) {\n                        sessionStorage.clear();\n                        localStorage.clear();\n                        localForage.clear();\n                        window.location.href = window.location.origin;\n                    }\n                }}>\n                Clear all data\n            </MenuButton>\n        </MenuWithLogo>\n    );\n};\n\nexport const Pre = styled.span`\n    color: white;\n    font-family: monospace;\n`;\n","import 'Stats';\nimport 'RemoteMic/eventListeners';\nimport Modal from 'Elements/Modal';\nimport ConnectRemoteMic from 'Scenes/ConnectRemoteMic/ConnectRemoteMic';\nimport { MenuContainer } from 'Elements/Menu';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { Button } from 'Elements/Button';\n\ninterface Props {\n    closeModal: () => void;\n}\nfunction QRCodeModal({ closeModal }: Props) {\n    const { register } = useKeyboardNav({\n        onBackspace: closeModal,\n    });\n\n    return (\n        <Modal onClose={closeModal}>\n            <MenuContainer>\n                <ConnectRemoteMic />\n                <Button {...register('close', closeModal)}>Close</Button>\n            </MenuContainer>\n        </Modal>\n    );\n}\n\nexport default QRCodeModal;\n","import styled from '@emotion/styled';\nimport 'Stats';\nimport 'RemoteMic/eventListeners';\nimport { IconButton, Tooltip } from '@mui/material';\nimport { Fullscreen, QrCode2 } from '@mui/icons-material';\nimport { useState } from 'react';\nimport QRCodeModal from 'Toolbar/QRCodeModal';\n\nfunction Toolbar() {\n    const [isModalOpen, setIsModalOpen] = useState(false);\n\n    const closeModal = () => setIsModalOpen(false);\n\n    return (\n        <>\n            {isModalOpen && <QRCodeModal closeModal={closeModal} />}\n            <ToolbarContainer>\n                <Tooltip title=\"Enter fullscreen\">\n                    <IconButton\n                        size=\"small\"\n                        onClick={() => {\n                            try {\n                                document.body.requestFullscreen().catch(console.info);\n                            } catch (e) {}\n                        }}>\n                        <Fullscreen fontSize=\"large\" />\n                    </IconButton>\n                </Tooltip>\n                <Tooltip title=\"Connect phone\">\n                    <IconButton size=\"small\" onClick={() => setIsModalOpen((current) => !current)}>\n                        <QrCode2 fontSize=\"large\" />\n                    </IconButton>\n                </Tooltip>\n            </ToolbarContainer>\n        </>\n    );\n}\n\nconst ToolbarContainer = styled.div`\n    view-transition-name: toolbar;\n\n    cursor: pointer;\n    background: rgba(0, 0, 0, 0.75);\n    color: white;\n    padding: 0.2rem;\n    padding-left: 1rem;\n    margin: 0;\n    position: fixed;\n    top: 0;\n    right: 0;\n    z-index: 10000;\n    color: white;\n\n    svg {\n        fill: white;\n    }\n\n    display: flex;\n    gap: 0.75rem;\n    border-bottom-left-radius: 1.5rem;\n`;\n\nexport default Toolbar;\n","import ExcludeLanguagesView from './ExcludeLanguagesView';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\n\ninterface Props {}\n\nfunction ExcludeLanguages(props: Props) {\n    const navigate = useSmoothNavigate();\n    const goBack = () => navigate('/');\n\n    return <ExcludeLanguagesView onClose={goBack} closeText=\"Return to Main Menu\" />;\n}\n\nexport default ExcludeLanguages;\n","import { MenuButton } from 'Elements/Menu';\nimport useKeyboardNav from 'hooks/useKeyboardNav';\nimport { Link } from 'wouter';\nimport useSmoothNavigate from 'hooks/useSmoothNavigate';\nimport MenuWithLogo from 'Elements/MenuWithLogo';\nimport { MouseEventHandler } from 'react';\n\ninterface Props {}\n\nfunction ManageSongs(props: Props) {\n    const navigate = useSmoothNavigate();\n    const goBack = () => navigate('/');\n\n    const { register } = useKeyboardNav({ onBackspace: goBack });\n\n    const handleClick: (url: string) => MouseEventHandler<HTMLAnchorElement> = (url) => (e) => {\n        e.preventDefault();\n        navigate(url);\n    };\n\n    return (\n        <MenuWithLogo>\n            <h1>Manage Songs</h1>\n            <Link href=\"/exclude-languages\" onClick={handleClick('/exclude-languages')}>\n                <MenuButton\n                    data-test=\"exclude-languages\"\n                    {...register('exclude-languages', () => navigate('/exclude-languages'))}>\n                    Select Song Languages\n                </MenuButton>\n            </Link>\n            <Link href=\"/edit\" onClick={handleClick('/edit')}>\n                <MenuButton data-test=\"edit-songs\" {...register('edit songs', () => navigate('/edit'))}>\n                    Edit songs\n                </MenuButton>\n            </Link>\n            <Link href=\"/convert\" onClick={handleClick('/convert')}>\n                <MenuButton data-test=\"convert-song\" {...register('convert', () => navigate('/convert'))}>\n                    Convert UltraStar .txt\n                </MenuButton>\n            </Link>\n            <hr />\n            <MenuButton {...register('go back', goBack)} data-test=\"back-button\">\n                Return To Main Menu\n            </MenuButton>\n        </MenuWithLogo>\n    );\n}\n\nexport default ManageSongs;\n","import styled from '@emotion/styled';\nimport { KeyboardHelpProvider } from 'Scenes/KeyboardHelp/Context';\nimport Settings from 'Scenes/Settings/Settings';\nimport { Redirect, Route, Router } from 'wouter';\nimport Convert from './Scenes/Convert/Convert';\nimport Edit from './Scenes/Edit/Edit';\nimport SongList from './Scenes/Edit/SongList';\nimport Game from './Scenes/Game/Game';\nimport Jukebox from './Scenes/Jukebox/Jukebox';\nimport RemoteMic from 'Scenes/RemoteMic/RemoteMic';\nimport SelectInput from './Scenes/SelectInput/SelectInput';\nimport * as Sentry from '@sentry/react';\n\nimport GetSongsBPMs from 'Scenes/Edit/GetSongsBPMs';\nimport QuickSetup from 'Scenes/QuickSetup/QuickSetup';\nimport { MicSetupPreferenceSetting, useSettingValue } from 'Scenes/Settings/SettingsState';\nimport Welcome from 'Scenes/Welcome/Welcome';\nimport styles from 'styles';\nimport { ErrorFallback } from 'Elements/ErrorFallback';\nimport Toolbar from 'Toolbar/Toolbar';\nimport ExcludeLanguages from 'Scenes/ExcludeLanguages/ExcludeLanguages';\nimport ManageSongs from 'Scenes/ManageSongs/ManageSongs';\nimport LayoutWithBackgroundProvider from 'Elements/LayoutWithBackground';\n\nfunction App() {\n    const [setupPreference] = useSettingValue(MicSetupPreferenceSetting);\n\n    return (\n        <>\n            <Sentry.ErrorBoundary fallback={ErrorFallback}>\n                <LayoutWithBackgroundProvider>\n                    <KeyboardHelpProvider>\n                        <Router>\n                            <GameScreens>\n                                <Toolbar />\n                                <Route path=\"/game/:file?\">\n                                    {({ file }) => <Game file={file ? decodeURIComponent(file) : undefined} />}\n                                </Route>\n                                <Route path=\"/jukebox\" component={Jukebox} />\n                                <Route path=\"/remote-mic/:roomId\">\n                                    {({ roomId }) => <RemoteMic roomId={roomId!} />}\n                                </Route>\n                                <Route path=\"/phone/:roomId\">\n                                    {({ roomId }) => <Redirect to={`/remote-mic/${roomId}`} />}\n                                </Route>\n                                <Route path=\"/select-input\" component={SelectInput} />\n                                <Route path=\"/settings\" component={Settings} />\n                                <Route path=\"/manage-songs\" component={ManageSongs} />\n                                <Route path=\"/exclude-languages\" component={ExcludeLanguages} />\n                                {setupPreference === null ? (\n                                    <Route path=\"/\" component={QuickSetup} />\n                                ) : (\n                                    <Route path=\"/\" component={Welcome} />\n                                )}\n                            </GameScreens>\n                            <Route path=\"/convert\" component={() => <Convert />} />\n                            <Route path=\"/edit\" component={SongList} />\n                            <Route path=\"/edit/get-songs-bpms\" component={GetSongsBPMs} />\n                            <Route path=\"/edit/:filename\">{({ filename }) => <Edit file={filename!} />}</Route>\n                        </Router>\n                    </KeyboardHelpProvider>\n                </LayoutWithBackgroundProvider>\n            </Sentry.ErrorBoundary>\n        </>\n    );\n}\n\nconst GameScreens = styled.div`\n    ${styles};\n`;\n\nexport default App;\n","import 'utils/exposeSingletons';\nimport 'Stats';\nimport 'GameEvents/eventListeners';\n\nimport * as Sentry from '@sentry/react';\nimport posthog from 'posthog-js';\nimport { createRoot } from 'react-dom/client';\nimport { toast, ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport isDev from 'utils/isDev';\nimport isE2E from 'utils/isE2E';\nimport { v4 } from 'uuid';\nimport App from './App';\nimport './index.css';\n\nif (import.meta.env.VITE_APP_SENTRY_DSN_URL) {\n    Sentry.init({\n        dsn: import.meta.env.VITE_APP_SENTRY_DSN_URL,\n\n        // Set tracesSampleRate to 1.0 to capture 100%\n        // of transactions for performance monitoring.\n        // We recommend adjusting this value in production\n        tracesSampleRate: 1.0,\n        environment: isDev() ? 'development' : isE2E() ? 'e2e' : 'production',\n    });\n}\n\nif (!isE2E() && import.meta.env.VITE_APP_POSTHOG_KEY) {\n    posthog.init(import.meta.env.VITE_APP_POSTHOG_KEY, {\n        debug: true,\n        api_host: 'https://allkaraoke-posthog.fly.dev',\n        test: isDev() || window.location.port !== '',\n        loaded: (ph) => {\n            let storedUser = localStorage.getItem('posthog-user-id');\n            if (!storedUser) {\n                storedUser = v4();\n                localStorage.setItem('posthog-user-id', storedUser);\n            }\n            ph.identify(storedUser);\n        },\n    });\n}\n\nconst container = document.getElementById('root');\nconst root = createRoot(container!);\n\nroot.render(\n    <>\n        <App />\n        <ToastContainer position={toast.POSITION.BOTTOM_LEFT} theme={'colored'} />\n    </>,\n);\n"],"names":["GameEvent","constructor","name","track","subscribers","subscribe","callback","unsubscribe","push","filter","cb","dispatch","args","console","log","forEach","capture","Function","events","sectionChange","songStarted","songEnded","remoteMicConnected","remoteMicDisconnected","playerInputChanged","player","oldI","newI","old","inputSource","new","inputListChanged","karaokeConnectionStatusChange","remoteMicPlayerNumberSet","remoteMicMonitoringStarted","remoteMicMonitoringStopped","micMonitoringStarted","micMonitoringStopped","playerChangeRequested","songStatStored","songScoreUpdated","remoteKeyboardPressed","remoteKeyboardLayout","remoteReadinessRequested","readinessConfirmed","AubioStrategy","init","context","buffer","Pitch","aubio","detector","sampleRate","setTolerance","getFrequency","data","do","getSampleSize","Listener","listeners","onUpdate","addListener","listener","removeListener","UserMediaService","status","getUserMedia","requestAndTrack","navigator","mediaDevices","enumerateDevices","fnc","setStatus","result","e","newStatus","getStatus","userMediaService","SimplifiedMic","stream","interval","frequencies","volumes","startedMonitoring","startMonitoring","deviceId","echoCancellation","audio","noiseSuppression","autoGainControl","video","AudioContext","source","createMediaStreamSource","analyserCh0","createAnalyser","fftSize","minDecibels","connect","strategy","setInterval","dataCh0","Float32Array","getFloatTimeDomainData","freq","volume","calculateVolume","getFrequencies","getVolumes","stopMonitoring","clearInterval","_a","getTracks","stop","_b","close","getInputLag","getChannelsCount","requestReadiness","Promise","resolve","input","i","sum","length","Math","sqrt","SimplifiedMic$1","isE2E","window","isE2ETests","location","search","includes","e2eOverrides","host","port","path","options","sendEvent","connection","type","payload","send","t","MIC_ID_KEY","roundTo","num","precision","multiplier","pow","round","WebRTCClient","clientId","sessionStorage","getItem","peer","reconnecting","sendFrequencies","throttle","freqs","map","onFrequencyUpdate","setClientId","id","setItem","roomId","silent","v4","Peer","peerJSOptions","debug","on","connectToServer","addEventListener","disconnect","undefined","playerNumber","help","removeEventListener","getElementById","remove","reload","warn","setTimeout","reconnect","getRoomId","sendKeyStroke","key","requestPlayerChange","confirmReadiness","WebRTCClient$1","RemoteMicInput$2","requestReadinessPromise","Array","isArray","at","off","handleRTCData","RemoteMic$1","getInput","setPlayerNumber","RemoteMicInput","RemoteMicManager","remoteMics","readinessRequestPromise","addRemoteMic","RemoteMic","removeRemoteMic","remoteMic","find","getRemoteMics","getRemoteMicById","broadcast","event","RemoteMicManager$1","ROOM_ID_KEY","WebRTCServer","started","start","conn","state","WebRTCServer$1","isNotesSection","section","notes","getFirstNoteStartFromSections","sections","firstNoteSection","Infinity","getLastNoteEndFromSections","lastSection","getLastNoteEnd","lastNote","getNoteAtBeat","beat","tolerance","note","DrawingTestInput","setFrequency","channel","value","DrawingTestInput$1","DummyInput","timestamp","isMonitoring","sin","cos","dummyInput","MicInput","exact","splitter","createChannelSplitter","analyserCh1","dataCh1","all","MicInput$1","remoteMicId","RemoteMicInput$1","inputs","channels","label","DrawingTestInputSource","inputName","getDefault","getInputs","subscribeToListChange","unsubscribeToListChange","singstarWirelessMicMapper","test","toLowerCase","singstarWiredMicMapper","singstarGenericMapper","getPreferred","ch","mapInputName","MicrophoneInputSource","_MicrophoneInputSource","inputList","devices","device","kind","getCapabilities","channelCount","max","range","preferred","flat","mapRemoteMicToInput","RemoteMicrophoneInputSource","storage$1","storeValue","JSON","stringify","getValue","val","parse","DummyInputSource","selectedPlayerInputToId","InputSourceListManager","initialiseInputSource","lazily","then","list","loadMics","Microphone","getInputList","getInputForPlayerSelected","returnDefault","item","InputSources","PLAYER_INPUTS_LOCAL_STORAGE_KEY","InputManager","requestingPromise","playerInputs","storage","getRawInputs","getPlayerFrequency","sourceNameToInput","getPlayerVolume","getPlayerInputLag","setPlayerInput","restartMonitoringPromise","newInput","oldInput","getPlayerInput","playerInput","inputSourceListManager","monitoringStarted","request","some","sourceName","InputManager$1","noDistanceNoteTypes","noPointsNoteTypes","MIDDLEA","SEMITONE","pitchToFrequency","pitchFromFrequency","getDistanceInCents","noteFreq","floor","getCentDistance","targetNote","cents","distance","sign","abs","calcDistanceBetweenPitches","noteDistance","calcDistance","frequency","GameState","getTolerance","preciseDistance","WINDOW_SIZE","detectVibrato","opChangePoints","change","lastChange","changePoints","intervals","slice","record","maxInterval","minInterval","min","averageIntervals","reduce","SINGING_BREAK_TOLERANCE_MS","appendFrequencyToPlayerNotes","playerNotes","beatLength","noteCandidate","pitch","breakToleranceBeat","noteEndBeat","isThisNoteDifferentThanLast","isDistanceDifferent","roundedStart","isPerfect","vibrato","frequencyRecords","lastPlayerNoteEndBeat","lastNoteEndBeat","roundedLength","getPlayerNoteDistance","MAX_POINTS","noteTypesMultipliers","freestyle","rap","star","normal","perfect","countsToBeats","counts","sumDetailedScore","countSungBeats","memoize","song","tracks","calculateDetailedScoreData","trackNumber","beatsPerTrack","error","maxCounts","pointsPerBeat","calculateScore","getCurrentBeat","currentTime","gap","currentBeat","getSongBeatLength","bpm","bar","PlayerState","index","gameState","realFrequencyRecords","realPlayerNotes","storedSectionIndex","getName","setName","update","getCurrentTime","currentTimestamp","lastRealRecord","lastTimestamp","timestampStep","updatePlayerNotes","dispatchSectionUpdate","currentSectionIndex","getCurrentSectionIndex","recordBeat","recordSection","getSectionByBeat","getPlayerNotes","getPlayerFrequencies","getSectionIndexByBeat","getTrack","findIndex","getCurrentSection","sectionIndex","getNextSection","getPreviousSection","getLastNotesSection","last","getScore","getSong","getTrackIndex","getMinPitch","getMaxPitch","getSingSetup","players","resetNotes","duration","singSetup","playerStates","setCurrentTime","accountGap","setSong","setSingSetup","setDuration","getDuration","getPlayer","getPlayers","getPlayerCount","startInputMonitoring","stopInputMonitoring","resetPlayerNotes","GameState$1","__exposeSingletons","__singletons","GameEvents","PLAYER_NAMES_SESSION_STORAGE_KEY","PREVIOUS_PLAYER_NAMES_STORAGE_KEY","_","currentNames","thisPlayNames","trim","newNamesSet","concat","Set","Boolean","__","newName","CURRENT_VISIT_KEY","LAST_VISIT_KEY","VISIT_TIMEOUT_MS","Date","now","currentVisit","Number","localStorage","isFirstVisit","defaultLastVisit","lastVisit","String","getSongKey","artist","title","fetchSongStats","storageKey","localForage","plays","scores","storeSongStats","stats","setup","currentState","score","date","toISOString","unselectedRemoteMic","selectedRemoteMic","playerNumberIndex","phoneId","newPlayerNumber","currentPlayerNumber","toast","success","jsxs","Fragment","jsx","warning","trackSongData","input0","input1","posthog","mode","curr","blueFillBase","blueFill","a","blueStroke","redFillBase","redFill","redStroke","playerColors","text","fill","stroke","lineWidth","starPerfect","hit","miss","styles","colors","lines","active","activeBorder","default","inactive","focusable","props","css","focused","focusAnimation","keyframes","typography","useIsVisible","createPersistedState","KeyboardHelpView","isVisible","setIsVisible","useHotkeys","helps","Object","entries","Container","view","Component","defaultLabel","KeyhelpComponent","Section","SectionHelp","SectionKeys","Kbd","HorizontalVerticalBase","vertical","horizontal","Horizontal","Vertical","HorizontalVertical","Accept","Back","ShiftLetter","letter","toUpperCase","accept","back","shiftR","_styled","target","process","disabled","useEventListener","setValue","useState","useEffect","subscriber","useEventEffect","effect","eventList","useEventListenerSelector","selector","initialValueRef","useMemo","KeyboardHelpContext","createContext","setKeyboard","helpEntry","unsetKeyboard","KeyboardHelpProvider","children","keyboards","setKeyboards","kbs","omit","Button","buttonFocused","buttonFocusedAnimation","MenuButton","MenuContainer","useSongStats","setStats","setSongStats","useEditScore","singId","oldName","newScores","previousScore","newData","SongCardContainer","SongCardBackground","SongCard","SongListEntryDetails","SongListEntryDetailsArtist","SongListEntryDetailsTitle","SongCardStatsIndicator","lastPlayed","playedToday","isAfter","addDays","SongStatIndicator","nextIndex","values","current","direction","nextValueIndex","indexOf","nextValue","Switcher","onClick","restProps","ConfigurationPosition","ConfigValue","REGULAR_ALPHA_CHARS","paramsToKeys","onUpArrow","onDownArrow","onLeftArrow","onRightArrow","onEnter","onBackspace","onR","keysToParams","invert","useKeyboard","params","enabled","deps","handledKeys","keys","param","join","hkEvent","preventDefault","stopPropagation","menuBackSound","menuEnterSound","menuNavigateSound","waitFinishedSound","backgroundMusic$2","menuNavigate","Howl","src","menuEnter","menuBack","waitFinished","preload","backgroundMusic","backgroundMusicSound","loop","useKeyboardHelp","useRef","random","useContext","setHelp","clearHelp","useKeyboardNav","backspaceHelp","additionalHelp","currentlySelected","setCurrentlySelected","elementList","newElementList","actions","currentlySelectedActionLabel","handleEnter","play","handleBackspace","handleNavigation","currentIndex","defaultSelection","register","onActive","isDefault","propName","keyboardNavigationChangeFocus","newElements","focusElement","Setting","defaultValue","driver","get","set","newValue","newListener","GraphicsLevel","GRAPHICS_LEVEL_KEY","GraphicSetting","MicSetupPreference","MIC_SETUP_PREFERENCE_KEY","MicSetupPreferenceSetting","FpsCount","FPS_COUNT_KEY","FPSCountSetting","EXCLUDED_LANGUAGES_KEY","ExcludedLanguagesSetting","useSettingValue","currentValue","setCurrentValue","startViewTransition","document","useSmoothNavigate","baseNavigate","useLocation","to","smooth","GithubRibbon","Ribbon","color","position","top","border","left","transform","transformOrigin","logo","pride","dotparty","Logo","PrideLogo","StyledLogo","DotParty","RecommendedBrowsers","chrome","RecommendChrome","BackgroundContext","visible","setVisibility","useBackground","shouldBeVisible","background","LayoutWithBackgroundProvider","setVisible","useCallback","Background","MenuWithLogo","supportedBrowsers","Settings","navigate","goBack","graphicLevel","setGraphicLevel","fpsCount","setFpsCount","typesMap","R","F","getPropertyValueFromTxt","txt","number","regex","RegExp","match","replace","LINE_BREAK_RELATIVE_REGEXP","getVideoId","url","URL","searchParams","safeJsonParse","str","convertTxtToSong","videoLink","author","authorUrl","sourceUrl","trackNames","additionalData","year","lastUpdate","edition","genre","language","videoGap","realBpm","previewStart","previewEnd","linkUrl","message","lastStart","split","line","startsWith","end","lyrics","AuthorAndVid","searchForVideo","open","encodeURIComponent","songArtist","songTitle","isSearchableForVideo","videoId","Box","display","flexWrap","TextField","mt","onChange","flexDirection","alignItems","width","endAdornment","Tooltip","YouTube","importSongFromSource","urlObj","importUsDbAnimuxSong","importUltrastarEsSong","fetch","doc","DOMParser","parseFromString","txtUrl","querySelector","getAttribute","href","authorPath","textContent","obj","BasicData","onSourceUrlEdit","shouldAutoImport","onAutoImport","isTxtRequired","txtInput","fixDiacritics","inputProps","replaceAll","VolumeAdjustment","getInternalPlayer","setVolume","currentVolume","getVolume","currentTarget","Slider","SongMetadata","searchGoogle","phrase","GAME_MODE","DUEL","PASS_THE_MIC","Pre","formatMs","msec","minutes","seconds","miliseconds","padStart","ms","py","mb","seekTo","AdjustPlayback","effectsEnabled","onEffectsToggle","seekBy","bySec","currentSpeed","setCurrentSpeed","Typography","ButtonGroup","flex","px","Divider","speed","setPlaybackSpeed","useCurrentSectionIndex","wholeBeat","EditSection","onRecordChange","onTrackNameChange","setTrack","selectedSection","setSelectedSection","changeRecords","setChangeRecords","onSectionClick","deleteSection","records","selected","shiftSection","newStart","lastRecord","newRecords","shift","SectionEdtiorContainer","Stack","ml","height","List","overflowY","ListItem","ListItemButton","ListItemText","fontWeight","SectionEditForm","step","SectionChangeList","maxHeight","SectionChangeDelete","SectionChangeShift","ChangeEntry","ListTracks","calculateProperBPM","desiredEndMs","notesSections","desiredLengthMs","bpmLength","toFixed","beatToMs","ManipulateBpm","lastNoteEndMs","desiredLastNoteEnd","setDesiredLastNoteEnd","ShiftGap","finalGap","ShiftVideoGap","HEADSTART_MS","shortenNoteSections","getSectionEnd","addPauseSections","padSizeBeats","lastEnd","sectionsWithPauses","normaliseSectionPaddings","desiredPadding","shiftSections","shiftBeats","addHeadstart","desiredHeadstart","actualHeadstart","normaliseGap","earliestTrack","currentNoteStart","thisNoteStart","firstSection","normaliseSpaces","normaliseLyricSpaces","usePlayerVolume","playerRef","useUnstuckOnStartSong","currentStatus","playerKey","setPlayerKey","UNSTARTED","timeout","clearTimeout","useUnstuckOnBuffering","BUFFERING","onLine","useUnstuckYouTubePlayer","VideoState","ENDED","PLAYING","PAUSED","CUED","stateMap","YoutubeVideoPlayer","forwardRef","autoplay","startAt","controls","disablekb","onStateChange","ref","setCurrentStatus","setSize","useImperativeHandle","w","h","timeSec","setPlaybackRate","newVolume","loadVideoById","opts","playVideo","pauseVideo","playerVars","showinfo","rel","fs","modestbranding","DirectVideo","size","createCallback","onPlay","onPause","onEnded","onLoadstart","playerApi","time","pause","dummyVideo","OfflineVideoPlayer","VideoPlayer","import","VITE_REACT_APP_OFFLINE","PauseMenu","onResume","onExit","onRestart","menuRef","focus","getSongFirstNoteMs","firstNote","SKIP_INTRO_MS","getSkipIntroTime","SKIP_INTRO_THRESHOLD_MS","songHasLongIntro","SkipIntro","isEnabled","hasLongIntro","songFirstNoteMs","canSkip","skipIntro","useDebounce","delay","debouncedValue","setDebouncedValue","handler","SHOW_OUTRO_THRESHOLD_MS","SkipOutro","onSongEnd","singingEndBeat","singingEndTime","setCurrentBeat","skipping","setSkipping","useInterval","skipOutro","SkipOutro$1","React","memo","DurationBar","firstNotes","uniq","v","lastNotes","durationMs","Bar","Marker","BarFill","BaseMarker","BaseBarFill","Lyrics","playerChanges","bottom","playerColor","thisPlayerChanges","nextSection","subsequentSection","previousChange","nextChange","timeToNextChange","passTheMicProgress","shouldBlink","hasNotes","beatsBetweenSectionAndNote","playerVolume","LyricsContainer","VolumeIndicator","PassTheMicProgress","LyricsLine","HeadstartContainer","Headstart","LyricContainer","LyricActiveContainer","LyricActive","endsWith","PassTheMicSymbol","BaseHeadstart","percent","right","BaseLyricActive","clipPath","VolumeIndicatorBase","rest","backgroundPositionX","BasePassTheMicProgress","progress","SwapHorizIcon","shouldForwardProp","prop","shouldShake","nextLine","formatter","Intl","NumberFormat","maximumFractionDigits","ScoreText","format","getColor","ctx","isStar","isHit","getNoteColor","playerNote","triangle","x","y","angle","alpha","save","finalX","finalY","translate","rotate","PI","globalAlpha","fillStyle","beginPath","moveTo","lineTo","restore","spreadValue","initial","spread","randomSign","baseTtlMs","ttlSpreadMs","velocityModifier","SungTriangle","finished","tick","canvas","delta","percentage","ttl","startingTtl","ticksLeft","heightModifier","velocityX","velocityY","initialAngle","randomFloat","from","randomInt","pitchPadding","NOTE_HEIGHT","BIG_NOTE_HEIGHT","calculateData","songBeatLength","minPitch","maxPitch","paddingVertical","currentSection","pixelsOverRatio","paddingHorizontal","sectionEndBeat","timeSectionGap","maxTime","canvasHeight","pitchStepHeight","applyColor","style","strokeStyle","simpleRoundRect","radius","actualWidth","actualRadius","quadraticCurveTo","closePath","roundRect","glass","clip","fillRect","drawRawNote","noteType","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","drawRawPlayerNote","SHADOW_PAD","smallNoteFragments","middle","bigNoteFragments","spriteMap","blueMiss","draw","padding","fragments","blueHit","bluePerfect","blueStarMiss","blueStarHit","blueStarPerfect","redMiss","redHit","redPerfect","redStarMiss","redStarHit","redStarPerfect","noteNormal","noteStar","noteFreestyle","noteRap","createCanvas","createElement","maxWidth","sprite","add","cachedCanvas","getContext","currentHeight","positions","pads","acc","entry","getSprite","fragment","drawSprite","destCtx","destX","destY","destW","destH","paddingWScale","paddingHScale","spriteData","finalWPadding","finalHPadding","imageSmoothingEnabled","drawImage","drawSpriteWithStartAndEnd","spriteName","startData","widthScale","endingsWidth","endingsSize","middleSize","getSpriteName","capitalize","drawNote","drawPlayerFrequencyTrace","lineJoin","drawPlayerNote","ParticleManager","particles","lastTick","getTimeDelta","currentTick","particle","ParticleManager$1","baseTtl","ttlSpread","TriangleParticle","elapsedTicks","ExplodingNoteParticle","particleManager","lightColor","tinycolor","lighten","toRgbString","darkColor","darken","density","rand","finalColor","initialTtl","FadeoutNote","loadImage","image","Image","onload","particleImage","imageLoaded","img","velocity","WIDTH","WIDTH_SPREAD","easeOutQuart","RayParticle","seed","widthModifier","easing","mainRayWidth","mainRayHeight","INTERVAL_PX","VibratoParticle","deltaY","getPlayerNoteAtBeat","CanvasDrawing","verticalMargin","scaleFactor","onSectionEnd","drawFrame","startTime","clearRect","drawPlayer","endTime","baseTimeout","finalTimeout","requestAnimationFrame","drawingData","getDrawingData","displacements","calculateDisplacements","drawNotesToSing","drawSungNotes","drawFlare","getNoteCoords","currentPlayerNotes","displacement","getPreciseY","fadeoutNotes","explodeNotes","sungNotesStreak","sungNote","currLength","sungNoteLength","displacementRange","displacementX","displacementY","sectionShift","playerState","big","regionPaddingTop","sectionStart","dx","dy","pitchY","MAX_RENDER_RESOLUTION_W","GameOverlay","videoPlayerRef","isPauseMenuVisible","drawer","overlayWidth","overlayHeight","overlayScaleFactor","resolutionScaleFactor","offsetHeight","Screen","GameCanvas","Scores","usePlayerSetDuration","dur","Player","showControls","onTimeUpdate","onStatusChange","restartSong","onStateChangeCallback","Overlay","PlayerContainer","shiftGap","gapShift","shiftVideoGap","setBpm","applyChanges","changes","trackIndex","changeList","applyTrackNames","playerWidth","playerHeight","EditSong","setGapShift","videoGapShift","setVideoGapShift","overrideBpm","setOverrideBpm","setEffectsEnabled","setTrackNames","newSong","processed","cloneDeep","Grid","HelpText","newNames","SyncLyricsToVideo","ALPHANUMERIC_REGEX","clearString","normalize","generateSearchString","getSongPreview","file","songData","local","tracksCount","createInstance","DELETED_SONGS_KEY","SongDao","finalIndex","indexWithDeletedSongs","store","generateSongFile","reloadIndex","fileName","localSong","getLocal","response","json","getIndex","includeDeleted","getCurrentIndex","getDeletedSongsList","defaultIndex","storageIndex","deletedSongs","getLocalIndex","lastVisitDate","localSongs","isNew","isDeleted","sort","b","localeCompare","deleteSong","removeItem","softDeleteSong","deletedItems","restoreSong","decodeURIComponent","getKeys","specialKeys","SongDao$1","NormalizeFontSize","useBackgroundMusic","playing","steps","Convert","currentStep","setCurrentStep","basicData","setBasicData","authorAndVid","setAuthorAndVid","metadataEntity","setMetadataEntity","editedSong","setEditedSong","conversionResult","property","isBasicInfoCompleted","isAuthorAndVidCompleted","isNextStepAvailable","finalSong","StyledEngineProvider","marginBottom","Link","Stepper","Step","StepLabel","justifyContent","align","processSong","useSong","loadedSong","Edit","useSongIndex","songIndex","setSongIndex","emptyList","loadSongs","isLoading","txtTypesMap","toTxtValue","toString","notesToText","convertSongToTxt","parsedValues","first","SongList","columns","accessorKey","header","Cell","cell","MaterialReactTable","row","IconButton","original","EditIcon","anchor","download","body","appendChild","click","removeChild","Download","DataObject","VisibilityOff","Visibility","confirm","Delete","columnVisibility","useFullscreen","requestFullscreen","catch","info","TransitionWrapper","show","CSSTransition","useViewportSize","windowSize","setWindowSize","handleResize","clientWidth","visualViewport","MAX_SECTION_PAUSE_MS","getSingableBeats","segmentSections","noteSections","segments","lastSegment","lastSectionEnd","elem","calculateAmplitude","groups","sums","group","shiftSolution","takeFromLeft","pos","pop","takeFromRight","ceil","arrSum","arr","generatePlayerChanges","currentBuffer","idealSize","CHANGES_COUNT","segmentSingableBeatsCount","bufferSum","currentAmplitude","candidates","candidatesAmplitudes","minimalAmplitude","minimalAmplitudeIndex","SongPage","FocusedSongContainer","BackgroundImage","ContentLayer","FocusedSongData","SongTitle","SongArtist","SongCreator","BaseBackgroundImage","blur","backgroundImage","ContentElement","MAX_TICKS","POINTS_PER_TICK","ResultsView","onNextStep","highScores","singSetupId","setCurrentTick","getPlayerScoreText","player1sum","detailedScore","player2sum","isHighScore","playerName","isAnimDone","ScoresContainer","ScoreTextPlayer","ScoreTextScore","HighScoreBadge","SongSelectionButton","win","highscore","Input","className","forwardedRef","inputRef","Label","StyledInput","Autocomplete","placeholder","onBlur","autocompleteMenu","isInputFocused","setIsInputFocused","focusedOption","setFocusedOption","filteredOptions","option","handleBlur","code","newIndex","scrollIntoView","behavior","block","AutocompleteMenu","AutocompleteMenuitem","useRecentPlayerNames","HighScoreRename","onSave","setNewName","playerNames","HighScoresView","editScore","ScoreContainer","ScorePosition","ScorePlayerName","ScoreScore","ScoreDate","isCurrentSing","QrCode2","GameTip","as","randomValue","PostGameView","onClickSongSelection","setStep","PostGameTip","useHighScores","singleScore","PostGame","playerScores","sleep","WaitForReadiness","onFinish","areAllPlayersReady","setAreAllPlayersReady","confirmedPlayers","setConfirmedPlayers","allInputsReady","inputsReady","minTimeElapsed","maxTimeElapsed","race","paused","playerStatuses","confirmed","WaitingForReady","PlayerList","PlayerEntry","CheckCircleOutline","CircularProgress","useBlockScroll","classList","documentElement","Singing","songFile","returnToSongSelection","isEnded","setIsEnded","setPlayerState","isTransitionTimeout","setIsTransitionTimeout","BackgroundContainer","BaseOverlay","generateLangMap","langNames","DisplayNames","langMap","j","fromCharCode","of","Akan","Hebrew","Indonesian","Javanese","Romanian","Yiddish","Tagalog","English","Korean","Swedish","Latin","langMap2","languageNameToIsoCode","useLanguageList","langs","langId","count","MIN_SONGS_COUNT","ExcludeLanguagesView","onClose","closeText","excludedLanguages","setExcludedLanguages","availableLanguages","languageList","toggleLanguage","lang","LanguageListContainer","excluded","LanguageEntry","Check","CheckBoxOutlineBlank","CheckBox","LanguageName","LanguageFlagBackground","_ref","usePlaylists","filters","yearBefore","yearAfter","duet","updatedAfter","Playlists","setFilters","closePlaylist","playlists","playlist","Playlist","QuickSearch","onSongFiltered","searchInput","isFocused","setIsFocused","onLeave","enableOnTags","focusSearch","searchLength","setSearch","FilterItem","large","SHOW_TIP_TIMEOUT_MS","SelectRandomTip","keyboardControl","usePrevious","filteringFunctions","songList","filterValue","excludeLanguages","languages","cleanSearch","after","dateAfter","applyFilters","useLanguageFilter","useSongListFilter","initiallyFilteredList","filteredList","filtersData","available","allSongs","useSongList","groupedSongList","newSongs","songs","firstCharacter","isFinite","MAX_SONGS_PER_ROW","useTwoDimensionalNavigation","cursorPosition","setCursorPosition","songIndexMatrix","chunk","songGroupMatrix","previousMatrix","isAtLastColumn","moveToSong","positionToValue","matrix","def","positionToSongIndex","positionToGroup","previousFocusedSong","currentFocusedSong","moveCursor","plane","newX","newY","maxXInRow","focusedSong","focusedGroup","tuple","useSongSelectionKeyboardNavigation","groupedSongs","songCount","appliedFilters","showPlaylistsState","setShowPlaylistsState","previousPlaylistsState","arePlaylistsVisible","leavingKey","isAtFirstColumn","navigateToGroup","currentGroup","nextGroupIndex","trailing","navigateVertically","repeat","currentlySelectedGroupIndex","navigateHorizontally","ignoreFilters","randomSong","useLayoutEffect","previousShowFilters","enteringKey","useSongSelection","preselectedSong","setKeyboardControl","showFilters","setShowFilters","preselected","setPreselected","preselectedSongIndex","firstNewSongIndex","songPreview","gameModeNames","difficultyNames","useSetGameMode","useSetTolerance","GameSettings","onExitKeyboardControl","setMode","startSong","changeMode","currentMode","changeTolerance","GSSwitcher","PlayButton","Indicator","MicCheck","MicChecksContainer","SelectPreference","onPreferenceSelected","previouslySelected","onBack","Option","OptionIconContainer","PhoneAndroid","PhoneIphone","OptionDescription","PhotoCamera","QrCode","Person","Laptop","MicIcon","Usb","SvgIcon","moreInfoMixin","linkObject","ConnectRemoteMic","useRoute","pathname","link","QRCode","QRCodeSVG","Description","QRCodeInstruction","CopyLinkInstruction","InputCopyContainer","InputCopy","CopyButton","clipboard","writeText","useRemoteMicAutoselect","nextPlayerToAutoSwitch","MicCheckContainer","names","RemoteMics","onContinue","isComplete","onSetupComplete","closeButtonText","useMicrophoneList","load","enableMic","allowMic","useMicrophoneStatus","UserMediaEnabled","fallback","showImages","WarningContainer","WarningIcon","AdditionalInfo","Warning","isWindows","userAgent","SingStarMics","showAdvancedTip","setShowAdvancedTip","isSetup","isSameDeviceId","isMicInput","areAllPreferred","AdvancedLink","Skip","usePlayerInput","sources","sourceList","selectedPlayerInput","playerInputData","cycleSource","nextSource","cycleInput","Advanced","p1Source","p1CycleSource","p1Input","p1CycleInput","p2Source","p2CycleSource","p2Input","p2CycleInput","Heading","Mic","BuiltIn","selectedMic","setSelectedMic","autoselect","defaultDevice","completedAnimationSegment","LAST_SELECTED_KEY","SelectInputView","preference","setPreference","setIsComplete","storedPreference","setStoredPreference","storePreference","pref","flushSync","CompletedAnim","completedAnimation","Lottie","Modal","Backdrop","SelectInputModal","required","getTrackName","SinglePlayer","defaultName","p1NameRef","togglePlayerTrack","onNameChange","PlayerName","Track","useDefaultPlayerName","previousPlayerNames","PlayerSettings","defaultNames","playerSetup","setPlayerSetup","updatePlayer","clone","showModal","setShowModal","areInputsConfigured","PlayerSettingContainer","SongSettings","GameConfiguration","finalSetup","PREVIEW_LENGTH","SongPreviewComponent","focusEffect","showVideo","setShowVideo","windowWidth","windowHeight","startSeconds","endSeconds","finalWidth","finalHeight","SongBPMIndicator","SongPreviewContainer","Content","SongInfo","SongAuthor","SongListEntryStats","Video","BaseSongPreviewContainer","ContentBase","blurBackground","isVideoPlaying","BaseSongBPMIndicator","animationDuration","focusMultiplier","SongSelection","onSongSelected","previewTop","previewLeft","previewWidth","previewHeight","setPositions","previouslyFocusedGroup","previouslyFocusedSong","previousSong","offsetTop","inline","offsetLeft","offsetWidth","onSongClick","LoaderContainer","SongListContainer","SongPreview","SongsGroupContainer","SongsGroupHeader","SongsGroup","SongListEntry","highlight","dim","SingASong","languageSelection","setLanguageSelection","Game","setPreselectedSong","resetKey","setResetKey","Jukebox","currentlyPlaying","setCurrentlyPlaying","shuffledList","setShuffledList","shuffle","playNext","navigateUrl","SkipSongButton","PlayThisSongButton","RemoteMicKeyboard","keyboard","isHorizontal","isVertical","onPress","ActionsContainer","ArrowsContainer","ArrowButton","KeyboardArrowUp","KeyboardArrowLeft","Games","KeyboardArrowRight","KeyboardArrowDown","ActionButton","Break","ButtonBase","PlayerChange","isOpen","setIsOpen","closeModal","selectPlayer","PlayerChangeContainer","isMicOn","isConnected","maxVolume","setMaxVolume","backgroundColor","indicatorColor","IndicatorContainer","Debug","MicPreview","updateVolumes","usePersistedName","Connect","connectionStatus","onConnect","handleConnect","showConnectionTip","setShowConnectionTip","Form","Wifi","ConfirmReadiness","onConfirm","isAfterReload","setIsAfterReload","ReadyButton","noSleep","NoSleep","setMonitoringStarted","isKeepAwakeOn","setIsKeepAwakeOn","setKeepAwake","turnOn","enable","disable","KeepAwake","MicInputState","SelectInput","GetSongsBPMs","bpms","VITE_APP_GET_SONG_BPM_API_TOKEN","getSongBPMData","QuickSetup","LayoutWithBackground","getSongBpm","Welcome","handleClick","BackgroundMusicCredit","GetSongBPM","ErrorFallback","resetError","origin","clear","QRCodeModal","Toolbar","isModalOpen","setIsModalOpen","ToolbarContainer","Fullscreen","ExcludeLanguages","ManageSongs","App","setupPreference","Sentry.ErrorBoundary","Router","GameScreens","Route","Redirect","filename","Sentry","dsn","tracesSampleRate","environment","api_host","loaded","ph","storedUser","identify","container","root","createRoot","render","ToastContainer","POSITION","BOTTOM_LEFT"],"mappings":"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"}
import{af as Me,r as p,h as Y,e as H,s as U,i as b,A as X,k as F,m as W,j as w,q as A,w as E,t as D,B as Ce,y as Ee,a as Ue,p as Ne,c as Se,ag as ze,ah as Ae,ae as _,a6 as a,a0 as ke,ai as Ve,aj as Le,ak as we,al as Be,am as J,an as $e,ao as Ge,a4 as Te,ap as Fe,aq as le,ar as We,as as De,at as _e,au as Oe,av as he,aw as qe,ax as Ye,ay as He,az as Ke,a2 as Xe,aA as Je,a3 as Qe,ad as re,aB as Ze,aC as et,aa as tt,ab as at}from"./index-pmCi6Run.js";import{E as ot,H as rt,J as K,L as ce,K as nt,l as xe,T as z,N as st,B as k,n as T,k as R,v as me,G as I,t as ne,m as it,S as fe,i as lt,j as ct,O as dt,A as ut,o as pt}from"./ShareSongsModal-OEKXP3UX.js";var ht=1,xt=4;function mt(e){return Me(e,ht|xt)}function ft(e){return p.Children.toArray(e).filter(t=>p.isValidElement(t))}function vt(e){return H("MuiButtonGroup",e)}const gt=Y("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),M=gt,bt=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],yt=(e,t)=>{const{ownerState:o}=e;return[{[`& .${M.grouped}`]:t.grouped},{[`& .${M.grouped}`]:t[`grouped${E(o.orientation)}`]},{[`& .${M.grouped}`]:t[`grouped${E(o.variant)}`]},{[`& .${M.grouped}`]:t[`grouped${E(o.variant)}${E(o.orientation)}`]},{[`& .${M.grouped}`]:t[`grouped${E(o.variant)}${E(o.color)}`]},{[`& .${M.firstButton}`]:t.firstButton},{[`& .${M.lastButton}`]:t.lastButton},{[`& .${M.middleButton}`]:t.middleButton},t.root,t[o.variant],o.disableElevation===!0&&t.disableElevation,o.fullWidth&&t.fullWidth,o.orientation==="vertical"&&t.vertical]},jt=e=>{const{classes:t,color:o,disabled:r,disableElevation:n,fullWidth:d,orientation:l,variant:u}=e,s={root:["root",u,l==="vertical"&&"vertical",d&&"fullWidth",n&&"disableElevation"],grouped:["grouped",`grouped${E(l)}`,`grouped${E(u)}`,`grouped${E(u)}${E(l)}`,`grouped${E(u)}${E(o)}`,r&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return D(s,vt,t)},Ct=U("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:yt})(({theme:e,ownerState:t})=>b({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius},t.variant==="contained"&&{boxShadow:(e.vars||e).shadows[2]},t.disableElevation&&{boxShadow:"none"},t.fullWidth&&{width:"100%"},t.orientation==="vertical"&&{flexDirection:"column"},{[`& .${M.grouped}`]:b({minWidth:40,"&:hover":b({},t.variant==="contained"&&{boxShadow:"none"})},t.variant==="contained"&&{boxShadow:"none"}),[`& .${M.firstButton},& .${M.middleButton}`]:b({},t.orientation==="horizontal"&&{borderTopRightRadius:0,borderBottomRightRadius:0},t.orientation==="vertical"&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},t.variant==="text"&&t.orientation==="horizontal"&&{borderRight:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${M.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}},t.variant==="text"&&t.orientation==="vertical"&&{borderBottom:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${M.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}},t.variant==="text"&&t.color!=="inherit"&&{borderColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / 0.5)`:X(e.palette[t.color].main,.5)},t.variant==="outlined"&&t.orientation==="horizontal"&&{borderRightColor:"transparent"},t.variant==="outlined"&&t.orientation==="vertical"&&{borderBottomColor:"transparent"},t.variant==="contained"&&t.orientation==="horizontal"&&{borderRight:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${M.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}},t.variant==="contained"&&t.orientation==="vertical"&&{borderBottom:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${M.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}},t.variant==="contained"&&t.color!=="inherit"&&{borderColor:(e.vars||e).palette[t.color].dark},{"&:hover":b({},t.variant==="outlined"&&t.orientation==="horizontal"&&{borderRightColor:"currentColor"},t.variant==="outlined"&&t.orientation==="vertical"&&{borderBottomColor:"currentColor"})}),[`& .${M.lastButton},& .${M.middleButton}`]:b({},t.orientation==="horizontal"&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},t.orientation==="vertical"&&{borderTopRightRadius:0,borderTopLeftRadius:0},t.variant==="outlined"&&t.orientation==="horizontal"&&{marginLeft:-1},t.variant==="outlined"&&t.orientation==="vertical"&&{marginTop:-1})})),St=p.forwardRef(function(t,o){const r=F({props:t,name:"MuiButtonGroup"}),{children:n,className:d,color:l="primary",component:u="div",disabled:s=!1,disableElevation:i=!1,disableFocusRipple:c=!1,disableRipple:v=!1,fullWidth:y=!1,orientation:S="horizontal",size:j="medium",variant:x="outlined"}=r,B=W(r,bt),$=b({},r,{color:l,component:u,disabled:s,disableElevation:i,disableFocusRipple:c,disableRipple:v,fullWidth:y,orientation:S,size:j,variant:x}),L=jt($),h=p.useMemo(()=>({className:L.grouped,color:l,disabled:s,disableElevation:i,disableFocusRipple:c,disableRipple:v,fullWidth:y,size:j,variant:x}),[l,s,i,c,v,y,j,x,L.grouped]),m=ft(n),f=m.length,C=g=>{const P=g===0,N=g===f-1;return P&&N?"":P?L.firstButton:N?L.lastButton:L.middleButton};return w.jsx(Ct,b({as:u,role:"group",className:A(L.root,d),ref:o,ownerState:$},B,{children:w.jsx(ot.Provider,{value:h,children:m.map((g,P)=>w.jsx(rt.Provider,{value:C(P),children:g},P))})}))}),q=St,kt=["alignItems","autoFocus","component","children","dense","disableGutters","divider","focusVisibleClassName","selected","className"],Lt=(e,t)=>{const{ownerState:o}=e;return[t.root,o.dense&&t.dense,o.alignItems==="flex-start"&&t.alignItemsFlexStart,o.divider&&t.divider,!o.disableGutters&&t.gutters]},wt=e=>{const{alignItems:t,classes:o,dense:r,disabled:n,disableGutters:d,divider:l,selected:u}=e,i=D({root:["root",r&&"dense",!d&&"gutters",l&&"divider",n&&"disabled",t==="flex-start"&&"alignItemsFlexStart",u&&"selected"]},nt,o);return b({},o,i)},Bt=U(Ce,{shouldForwardProp:e=>Ee(e)||e==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:Lt})(({theme:e,ownerState:t})=>b({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${K.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:X(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${K.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:X(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${K.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:X(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:X(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${K.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${K.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},t.divider&&{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"},t.alignItems==="flex-start"&&{alignItems:"flex-start"},!t.disableGutters&&{paddingLeft:16,paddingRight:16},t.dense&&{paddingTop:4,paddingBottom:4})),$t=p.forwardRef(function(t,o){const r=F({props:t,name:"MuiListItemButton"}),{alignItems:n="center",autoFocus:d=!1,component:l="div",children:u,dense:s=!1,disableGutters:i=!1,divider:c=!1,focusVisibleClassName:v,selected:y=!1,className:S}=r,j=W(r,kt),x=p.useContext(ce),B=p.useMemo(()=>({dense:s||x.dense||!1,alignItems:n,disableGutters:i}),[n,x.dense,s,i]),$=p.useRef(null);Ue(()=>{d&&$.current&&$.current.focus()},[d]);const L=b({},r,{alignItems:n,dense:B.dense,disableGutters:i,divider:c,selected:y}),h=wt(L),m=Ne($,o);return w.jsx(ce.Provider,{value:B,children:w.jsx(Bt,b({ref:m,href:j.href||j.to,component:(j.href||j.to)&&l==="div"?"button":l,focusVisibleClassName:A(h.focusVisible,v),ownerState:L,className:A(h.root,S)},j,{classes:h,children:u}))})}),Tt=$t,It=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],Rt=e=>{const{classes:t,inset:o,primary:r,secondary:n,dense:d}=e;return D({root:["root",o&&"inset",d&&"dense",r&&n&&"multiline"],primary:["primary"],secondary:["secondary"]},st,t)},Pt=U("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[{[`& .${xe.primary}`]:t.primary},{[`& .${xe.secondary}`]:t.secondary},t.root,o.inset&&t.inset,o.primary&&o.secondary&&t.multiline,o.dense&&t.dense]}})(({ownerState:e})=>b({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},e.primary&&e.secondary&&{marginTop:6,marginBottom:6},e.inset&&{paddingLeft:56})),Mt=p.forwardRef(function(t,o){const r=F({props:t,name:"MuiListItemText"}),{children:n,className:d,disableTypography:l=!1,inset:u=!1,primary:s,primaryTypographyProps:i,secondary:c,secondaryTypographyProps:v}=r,y=W(r,It),{dense:S}=p.useContext(ce);let j=s??n,x=c;const B=b({},r,{disableTypography:l,inset:u,primary:!!j,secondary:!!x,dense:S}),$=Rt(B);return j!=null&&j.type!==z&&!l&&(j=w.jsx(z,b({variant:S?"body2":"body1",className:$.primary,component:i!=null&&i.variant?void 0:"span",display:"block"},i,{children:j}))),x!=null&&x.type!==z&&!l&&(x=w.jsx(z,b({variant:"body2",className:$.secondary,color:"text.secondary",display:"block"},v,{children:x}))),w.jsxs(Pt,b({className:A($.root,d),ownerState:B,ref:o},y,{children:[j,x]}))}),Et=Mt,Ut=p.createContext({}),Z=Ut,Nt=p.createContext({}),oe=Nt;function zt(e){return H("MuiStep",e)}Y("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const At=["active","children","className","component","completed","disabled","expanded","index","last"],Vt=e=>{const{classes:t,orientation:o,alternativeLabel:r,completed:n}=e;return D({root:["root",o,r&&"alternativeLabel",n&&"completed"]},zt,t)},Gt=U("div",{name:"MuiStep",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation],o.alternativeLabel&&t.alternativeLabel,o.completed&&t.completed]}})(({ownerState:e})=>b({},e.orientation==="horizontal"&&{paddingLeft:8,paddingRight:8},e.alternativeLabel&&{flex:1,position:"relative"})),Ft=p.forwardRef(function(t,o){const r=F({props:t,name:"MuiStep"}),{active:n,children:d,className:l,component:u="div",completed:s,disabled:i,expanded:c=!1,index:v,last:y}=r,S=W(r,At),{activeStep:j,connector:x,alternativeLabel:B,orientation:$,nonLinear:L}=p.useContext(Z);let[h=!1,m=!1,f=!1]=[n,s,i];j===v?h=n!==void 0?n:!0:!L&&j>v?m=s!==void 0?s:!0:!L&&j<v&&(f=i!==void 0?i:!0);const C=p.useMemo(()=>({index:v,last:y,expanded:c,icon:v+1,active:h,completed:m,disabled:f}),[v,y,c,h,m,f]),g=b({},r,{active:h,orientation:$,alternativeLabel:B,completed:m,disabled:f,expanded:c,component:u}),P=Vt(g),N=w.jsxs(Gt,b({as:u,className:A(P.root,l),ref:o,ownerState:g},S,{children:[x&&B&&v!==0?x:null,d]}));return w.jsx(oe.Provider,{value:C,children:x&&!B&&v!==0?w.jsxs(p.Fragment,{children:[x,N]}):N})}),ee=Ft,Wt=Se(w.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),Dt=Se(w.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function _t(e){return H("MuiStepIcon",e)}const Ot=Y("MuiStepIcon",["root","active","completed","error","text"]),se=Ot;var ve;const qt=["active","className","completed","error","icon"],Yt=e=>{const{classes:t,active:o,completed:r,error:n}=e;return D({root:["root",o&&"active",r&&"completed",n&&"error"],text:["text"]},_t,t)},ie=U(ze,{name:"MuiStepIcon",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),color:(e.vars||e).palette.text.disabled,[`&.${se.completed}`]:{color:(e.vars||e).palette.primary.main},[`&.${se.active}`]:{color:(e.vars||e).palette.primary.main},[`&.${se.error}`]:{color:(e.vars||e).palette.error.main}})),Ht=U("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(e,t)=>t.text})(({theme:e})=>({fill:(e.vars||e).palette.primary.contrastText,fontSize:e.typography.caption.fontSize,fontFamily:e.typography.fontFamily})),Kt=p.forwardRef(function(t,o){const r=F({props:t,name:"MuiStepIcon"}),{active:n=!1,className:d,completed:l=!1,error:u=!1,icon:s}=r,i=W(r,qt),c=b({},r,{active:n,completed:l,error:u}),v=Yt(c);if(typeof s=="number"||typeof s=="string"){const y=A(d,v.root);return u?w.jsx(ie,b({as:Dt,className:y,ref:o,ownerState:c},i)):l?w.jsx(ie,b({as:Wt,className:y,ref:o,ownerState:c},i)):w.jsxs(ie,b({className:y,ref:o,ownerState:c},i,{children:[ve||(ve=w.jsx("circle",{cx:"12",cy:"12",r:"12"})),w.jsx(Ht,{className:v.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:c,children:s})]}))}return s}),Xt=Kt;function Jt(e){return H("MuiStepLabel",e)}const Qt=Y("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),O=Qt,Zt=["children","className","componentsProps","error","icon","optional","slotProps","StepIconComponent","StepIconProps"],ea=e=>{const{classes:t,orientation:o,active:r,completed:n,error:d,disabled:l,alternativeLabel:u}=e;return D({root:["root",o,d&&"error",l&&"disabled",u&&"alternativeLabel"],label:["label",r&&"active",n&&"completed",d&&"error",l&&"disabled",u&&"alternativeLabel"],iconContainer:["iconContainer",r&&"active",n&&"completed",d&&"error",l&&"disabled",u&&"alternativeLabel"],labelContainer:["labelContainer",u&&"alternativeLabel"]},Jt,t)},ta=U("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation]]}})(({ownerState:e})=>b({display:"flex",alignItems:"center",[`&.${O.alternativeLabel}`]:{flexDirection:"column"},[`&.${O.disabled}`]:{cursor:"default"}},e.orientation==="vertical"&&{textAlign:"left",padding:"8px 0"})),aa=U("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(e,t)=>t.label})(({theme:e})=>b({},e.typography.body2,{display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),[`&.${O.active}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${O.completed}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${O.alternativeLabel}`]:{marginTop:16},[`&.${O.error}`]:{color:(e.vars||e).palette.error.main}})),oa=U("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(e,t)=>t.iconContainer})(()=>({flexShrink:0,display:"flex",paddingRight:8,[`&.${O.alternativeLabel}`]:{paddingRight:0}})),ra=U("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(e,t)=>t.labelContainer})(({theme:e})=>({width:"100%",color:(e.vars||e).palette.text.secondary,[`&.${O.alternativeLabel}`]:{textAlign:"center"}})),Ie=p.forwardRef(function(t,o){var r;const n=F({props:t,name:"MuiStepLabel"}),{children:d,className:l,componentsProps:u={},error:s=!1,icon:i,optional:c,slotProps:v={},StepIconComponent:y,StepIconProps:S}=n,j=W(n,Zt),{alternativeLabel:x,orientation:B}=p.useContext(Z),{active:$,disabled:L,completed:h,icon:m}=p.useContext(oe),f=i||m;let C=y;f&&!C&&(C=Xt);const g=b({},n,{active:$,alternativeLabel:x,completed:h,disabled:L,error:s,orientation:B}),P=ea(g),N=(r=v.label)!=null?r:u.label;return w.jsxs(ta,b({className:A(P.root,l),ref:o,ownerState:g},j,{children:[f||C?w.jsx(oa,{className:P.iconContainer,ownerState:g,children:w.jsx(C,b({completed:h,active:$,error:s,icon:f},S))}):null,w.jsxs(ra,{className:P.labelContainer,ownerState:g,children:[d?w.jsx(aa,b({ownerState:g},N,{className:A(P.label,N==null?void 0:N.className),children:d})):null,c]})]}))});Ie.muiName="StepLabel";const na=Ie;function sa(e){return H("MuiStepButton",e)}const ia=Y("MuiStepButton",["root","horizontal","vertical","touchRipple"]),ge=ia,la=["children","className","icon","optional"],ca=e=>{const{classes:t,orientation:o}=e;return D({root:["root",o],touchRipple:["touchRipple"]},sa,t)},da=U(Ce,{name:"MuiStepButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[{[`& .${ge.touchRipple}`]:t.touchRipple},t.root,t[o.orientation]]}})(({ownerState:e})=>b({width:"100%",padding:"24px 16px",margin:"-24px -16px",boxSizing:"content-box"},e.orientation==="vertical"&&{justifyContent:"flex-start",padding:"8px",margin:"-8px"},{[`& .${ge.touchRipple}`]:{color:"rgba(0, 0, 0, 0.3)"}})),ua=p.forwardRef(function(t,o){const r=F({props:t,name:"MuiStepButton"}),{children:n,className:d,icon:l,optional:u}=r,s=W(r,la),{disabled:i,active:c}=p.useContext(oe),{orientation:v}=p.useContext(Z),y=b({},r,{orientation:v}),S=ca(y),j={icon:l,optional:u},x=Ae(n,["StepLabel"])?p.cloneElement(n,j):w.jsx(na,b({},j,{children:n}));return w.jsx(da,b({focusRipple:!0,disabled:i,TouchRippleProps:{className:S.touchRipple},className:A(S.root,d),ref:o,ownerState:y,"aria-current":c?"step":void 0},s,{children:x}))}),te=ua;function pa(e){return H("MuiStepConnector",e)}Y("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const ha=["className"],xa=e=>{const{classes:t,orientation:o,alternativeLabel:r,active:n,completed:d,disabled:l}=e,u={root:["root",o,r&&"alternativeLabel",n&&"active",d&&"completed",l&&"disabled"],line:["line",`line${E(o)}`]};return D(u,pa,t)},ma=U("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation],o.alternativeLabel&&t.alternativeLabel,o.completed&&t.completed]}})(({ownerState:e})=>b({flex:"1 1 auto"},e.orientation==="vertical"&&{marginLeft:12},e.alternativeLabel&&{position:"absolute",top:8+4,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"})),fa=U("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.line,t[`line${E(o.orientation)}`]]}})(({ownerState:e,theme:t})=>{const o=t.palette.mode==="light"?t.palette.grey[400]:t.palette.grey[600];return b({display:"block",borderColor:t.vars?t.vars.palette.StepConnector.border:o},e.orientation==="horizontal"&&{borderTopStyle:"solid",borderTopWidth:1},e.orientation==="vertical"&&{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24})}),va=p.forwardRef(function(t,o){const r=F({props:t,name:"MuiStepConnector"}),{className:n}=r,d=W(r,ha),{alternativeLabel:l,orientation:u="horizontal"}=p.useContext(Z),{active:s,disabled:i,completed:c}=p.useContext(oe),v=b({},r,{alternativeLabel:l,orientation:u,active:s,completed:c,disabled:i}),y=xa(v);return w.jsx(ma,b({className:A(y.root,n),ref:o,ownerState:v},d,{children:w.jsx(fa,{className:y.line,ownerState:v})}))}),ga=va;function ba(e){return H("MuiStepper",e)}Y("MuiStepper",["root","horizontal","vertical","alternativeLabel"]);const ya=["activeStep","alternativeLabel","children","className","component","connector","nonLinear","orientation"],ja=e=>{const{orientation:t,alternativeLabel:o,classes:r}=e;return D({root:["root",t,o&&"alternativeLabel"]},ba,r)},Ca=U("div",{name:"MuiStepper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation],o.alternativeLabel&&t.alternativeLabel]}})(({ownerState:e})=>b({display:"flex"},e.orientation==="horizontal"&&{flexDirection:"row",alignItems:"center"},e.orientation==="vertical"&&{flexDirection:"column"},e.alternativeLabel&&{alignItems:"flex-start"})),Sa=w.jsx(ga,{}),ka=p.forwardRef(function(t,o){const r=F({props:t,name:"MuiStepper"}),{activeStep:n=0,alternativeLabel:d=!1,children:l,className:u,component:s="div",connector:i=Sa,nonLinear:c=!1,orientation:v="horizontal"}=r,y=W(r,ya),S=b({},r,{alternativeLabel:d,orientation:v,component:s}),j=ja(S),x=p.Children.toArray(l).filter(Boolean),B=x.map((L,h)=>p.cloneElement(L,b({index:h,last:h+1===x.length},L.props))),$=p.useMemo(()=>({activeStep:n,alternativeLabel:d,connector:i,nonLinear:c,orientation:v}),[n,d,i,c,v]);return w.jsx(Z.Provider,{value:$,children:w.jsx(Ca,b({as:s,ownerState:S,className:A(j.root,u),ref:o},y,{children:B}))})}),La=ka,ae=_("span",{target:"e1juu05a0"})({name:"1n7r223",styles:"font-family:monospace"}),de=(e,t,o="Lookup")=>({InputProps:{endAdornment:a.jsx(ke,{title:t?"Open search results for the song":"Artist or title of the song is unknown",children:a.jsx("span",{children:a.jsx(k,{sx:{mr:-1},endIcon:a.jsx(Ve,{}),color:"secondary",variant:"text",onClick:e,disabled:!t,children:o})})})}});function wa(e){const t=()=>{window.open(`https://www.youtube.com/results?search_query=${encodeURIComponent((e==null?void 0:e.songArtist)+" "+(e==null?void 0:e.songTitle))}`,"_blank")},o=!!e.songTitle&&!!e.songArtist,r=Le(e.data.video);return a.jsxs(T,{sx:{display:"flex",flexWrap:"wrap"},"data-test":"author-and-vid",children:[a.jsx(R,{"data-test":"author-name",sx:{mt:2},value:e.data.author,onChange:n=>e.onChange({...e.data,author:n.target.value}),label:"Author name (optional)",fullWidth:!0,size:"small",helperText:"Nickname of the person that created the .txt file."}),a.jsx(R,{"data-test":"author-url",sx:{mt:2},value:e.data.authorUrl,onChange:n=>e.onChange({...e.data,authorUrl:n.target.value}),label:"Author URL (optional)",helperText:"Link to authors page/profile.",fullWidth:!0,size:"small"}),a.jsx(T,{sx:{display:"flex",flexDirection:"row",mt:2,alignItems:"center",width:"100%"},children:a.jsx(R,{"data-test":"video-url",required:!0,value:e.data.video,onChange:n=>e.onChange({...e.data,video:n.target.value}),label:"YouTube Video URL",placeholder:"https://www.youtube.com/watch?v=",fullWidth:!0,size:"small",helperText:"Link to YouTube video, eg https://www.youtube.com/watch?v=xxxxxxxxx. Click the 'Lookup' button to look for it on YouTube",name:"videoUrl",...de(t,o)})}),r&&a.jsx(T,{children:a.jsx(we,{videoId:r})})]})}const Ba={polish:{È:"é",í:"'","¥":"'","¯":"Ż","¹":"ą",π:"ą",ê:"ę",Í:"ę",Œ:"Ś",å:"Ś",œ:"ś",ú:"ś",æ:"ć",Ê:"ć","¿":"ż",ø:"ż",Ø:"Ż",ñ:"ń",Ò:"ń","³":"ł","≥":"ł","£":"Ł",Û:"ó",ü:"ź",Ÿ:"ź"},spanish:{ø:"¿",È:"é",Ì:"í",Ò:"ñ",ń:"ñ","·":"á",Û:"ó","°":"!","˙":"ú",ś:"ú"}};function $a(e,t){const o=Ba[t];if(o===void 0)return e;let r=e;for(const[n,d]of Object.entries(o))r=r.replaceAll(n,d);return r}function Ta(e){const t=e.split(`
`),o=["#TITLE","#ARTIST","#BPM"];for(const r of o)if(!t.some(n=>n.startsWith(r)))return!1;if(!t.some(r=>r.startsWith(":")))return!1;try{Be(e)}catch(r){return console.log(r),!1}return!0}async function Ia(e){try{const t=new URL(e);if(t.host==="usdb.animux.de")return Pa(e,t);if(t.host==="ultrastar-es.org")return Ra(e)}catch(t){console.warn(t)}}async function Ra(e){var s,i,c,v;const o=await(await fetch(`https://backend.allkaraoke.party/proxy?url=${encodeURIComponent(e)}`)).text(),r=new DOMParser().parseFromString(o,"text/html"),d=`https://ultrastar-es.org/pl/canciones/descargar/txt/${(s=r.querySelector("ul[data-id]"))==null?void 0:s.getAttribute("data-id")}`;window.location.href=d;const l=(i=r.querySelector("#listado > ul > li > dl > dd:nth-child(6) > a"))==null?void 0:i.getAttribute("href"),u=(c=r.querySelector("#listado > ul > li"))==null?void 0:c.getAttribute("data-id");return{authorUrl:l?"https://ultrastar-es.org"+l:"",author:((v=r.querySelector("#listado > ul > li > dl > dd:nth-child(6)"))==null?void 0:v.textContent)??"",video:u?"https://www.youtube.com/watch?v="+u:""}}async function Pa(e,t){var i,c,v,y,S;const r=await(await fetch(`https://backend.allkaraoke.party/proxy?url=${encodeURIComponent(e)}`)).text(),n=new DOMParser().parseFromString(r,"text/html"),d=(i=n.querySelector('a[href^="?link=profil&id="]'))==null?void 0:i.textContent,l=(v=(c=n.querySelector('a[href^="?link=profil&id="]'))==null?void 0:c.getAttribute)==null?void 0:v.call(c,"href"),u=(y=n.querySelector("#tablebg > tbody > tr:nth-child(3) > td > table:nth-child(2) > tbody > tr.list_head > td:nth-child(1)"))==null?void 0:y.textContent,s=(S=n.querySelector("#tablebg > tbody > tr:nth-child(3) > td > table:nth-child(2) > tbody > tr.list_head > td:nth-child(2)"))==null?void 0:S.textContent;return window.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(u+" "+s)}`,"_blank"),window.open(`http://usdb.animux.de/index.php?link=gettxt&id=${t.searchParams.get("id")}`,"_blank"),{authorUrl:l?"http://usdb.animux.de/index.php"+l:"",author:d??"",video:""}}function Ma(e){var d,l;const t=async u=>{if(e.onChange({...e.data,sourceUrl:u.target.value}),e.shouldAutoImport){const s=await Ia(u.target.value);s&&e.onAutoImport(s)}},o=u=>{e.onChange({...e.data,txtInput:$a(e.data.txtInput,u)})},n=!p.useMemo(()=>Ta(e.data.txtInput),[e.data.txtInput])&&e.data.txtInput.length>0;return a.jsxs(T,{sx:{display:"flex",flexWrap:"wrap"},"data-test":"basic-data",children:[e.isTxtRequired&&a.jsxs("div",{children:[a.jsx("h4",{children:"Where to find songs?"}),a.jsxs("p",{children:["Any UltraStar compatible .txt file will do. You can find many already made songs on"," ",a.jsx("a",{href:"https://usdb.animux.de/",target:"_blank",rel:"noreferrer",children:"usdb.animux.de"})," or ",a.jsx("a",{href:"https://ultrastar-es.org/en",target:"_blank",rel:"noreferrer",children:"ultrastar-es.org"}),".",a.jsx("br",{}),a.jsx("br",{})]}),a.jsx("p",{children:"You don't need audio/video files, you'll be able to search for appropriate YouTube video and synchronise the lyrics to it in subsequent steps."})]}),a.jsx(R,{sx:{mt:2},value:e.data.sourceUrl,onChange:t,label:"Source URL (optional)",fullWidth:!0,size:"small","data-test":"source-url",helperText:"The link to the page from which the .TXT file was downloaded."}),e.isTxtRequired?a.jsxs(a.Fragment,{children:[a.jsx(R,{error:n,helperText:n?"This doesn't look like a valid UltraStar .TXT format":"",required:!0,sx:{mt:2},fullWidth:!0,size:"small",multiline:!0,label:"Song's UltraStar .TXT file contents",onChange:u=>e.onChange({...e.data,txtInput:u.target.value}),value:e.data.txtInput,maxRows:15,minRows:15,InputProps:{inputProps:{"data-test":"input-txt",sx:{fontFamily:"monospace"}}}}),a.jsxs(T,{sx:{display:"flex",gap:1,mt:1},children:[a.jsx(k,{onClick:()=>o("polish"),children:"Fix 🇵🇱 Polish accents"}),a.jsx(k,{onClick:()=>o("spanish"),children:"Fix 🇪🇸 Spanish accents"})]})]}):a.jsx(T,{sx:{display:"flex",width:"100%",height:500,overflow:"auto"},children:(l=(d=e.finalSong)==null?void 0:d.tracks)==null?void 0:l.map((u,s)=>a.jsxs(T,{sx:{flex:1},children:[a.jsx("h4",{children:u.name??`Track #${s+1}`}),u.sections.filter(J).map(i=>a.jsx("p",{children:i.notes.map(c=>c.lyrics).join("")},i.start))]},s))})]})}const Re=e=>{const t=Math.floor(e/1e3/60),o=Math.floor(e/1e3)-t*60,r=Math.floor(e%1e3);return a.jsxs(ae,{children:[String(t).padStart(2,"0"),":",String(o).padStart(2,"0"),".",String(r).padStart(3,"0")]})},Ea=e=>"playVideo"in e?{play:()=>e.playVideo(),pause:()=>e.pauseVideo(),seekTo:t=>e.seekTo(t,!0),setPlaybackSpeed:t=>e.setPlaybackRate(t)}:e,Q=(e,t)=>a.jsx(ke,{title:"Click to play the moment just before this time",placement:"top",arrow:!0,children:a.jsx(k,{sx:{py:.15,mb:.5},variant:"contained",size:"small",disabled:!t,onClick:t?()=>{$e.resetPlayerNotes(),Ea(t).seekTo((e??0)/1e3-.7)}:void 0,children:Re(e??0)})}),Ua=Re,be=10;function Na({data:e,onChange:t,videoId:o,videoGap:r=0}){var L;const n=p.useRef(null),d=p.useRef(null),[l,u]=p.useState(!1);p.useEffect(()=>{(async()=>{var h,m,f,C;e.volume===0?(t({...e,volume:.5}),await((m=(h=n.current)==null?void 0:h.getInternalPlayer())==null?void 0:m.setVolume(50))):await((C=(f=n.current)==null?void 0:f.getInternalPlayer())==null?void 0:C.setVolume(e.volume*100)),u(!0)})()},[]),p.useEffect(()=>{if(!l)return;const h=setInterval(async()=>{var f,C;const m=await((C=(f=n.current)==null?void 0:f.getInternalPlayer())==null?void 0:C.getVolume());m!==void 0&&m!==e.volume*100&&t({...e,volume:m/100})},500);return()=>{clearInterval(h)}},[l,e,t]);const[s,i]=p.useState(!1),[c,v]=p.useState(!1),y=async(h,m)=>{var f,C;await((C=(f=n.current)==null?void 0:f.getInternalPlayer())==null?void 0:C.setVolume(+m*100)),t({...e,volume:+m})},S=e.previewStart??r+60,j=e.previewEnd??S+30,[x,B]=p.useState(null);p.useEffect(()=>{var h,m;d.current&&(d.current.currentTime=35),(m=(h=n.current)==null?void 0:h.getInternalPlayer())==null||m.getDuration().then(B)},[]);const $=(L=n.current)==null?void 0:L.getInternalPlayer();return a.jsxs(T,{sx:{display:"flex",flexDirection:"column",width:"100%"},children:[a.jsxs("h3",{children:["Set song preview (start: ",Q(S*1e3,$),", end:"," ",Q(j*1e3,$),")"]}),a.jsx(T,{sx:{display:"flex",gap:5},children:a.jsx(me,{"data-test":"song-preview",disabled:x===null,step:1,value:[S,j],max:(x??500)-be,onChange:(h,m)=>{const[f,C]=m;C-f>be&&t({...e,previewStart:f,previewEnd:C})}})}),a.jsx("h3",{children:"Adjust volume"}),a.jsxs(T,{sx:{display:"flex",gap:5},children:[a.jsxs(T,{children:[a.jsx("h4",{children:"Song"}),a.jsx(we,{videoId:o,ref:n,onPlay:()=>{var h;i(!0),c&&((h=d.current)==null||h.pause(),setTimeout(()=>v(!0),200))},onPause:()=>{v(!1)}})]}),a.jsxs(T,{children:[a.jsx("h4",{children:"Reference sound"}),a.jsx("p",{children:"Use the slider below to make the video volume roughly the same as this music."}),a.jsx("br",{}),a.jsx("audio",{ref:d,controls:!0,src:Ge,loop:!0,onLoad:h=>h.currentTarget.currentTime=35,onPlay:h=>{var m,f;h.currentTarget.volume=.5,v(!0),s&&((f=(m=n.current)==null?void 0:m.getInternalPlayer())==null||f.pauseVideo(),setTimeout(()=>i(!0),200))},onPause:()=>{var h,m;v(!1),s&&((m=(h=n.current)==null?void 0:h.getInternalPlayer())==null||m.playVideo())}})]})]}),a.jsxs("h4",{children:["Final Song Volume (",e.volume*100,")"]}),a.jsx(T,{children:a.jsx(me,{"data-test":"volume",min:.1,max:1,step:.01,"aria-label":"Volume",value:e.volume,onChange:y})})]})}function za(e){var s;const t=Te(!0),o=p.useMemo(()=>[...new Set(t.data.map(({language:i})=>Array.isArray(i)?i:[i]).flat().filter(Boolean))],[t.data]),r=p.useMemo(()=>[...new Set(t.data.map(i=>i.genre).filter(Boolean).map(i=>i.toLowerCase().replace(/\b\w/g,c=>c.toUpperCase().trim())))],[t.data]),n=p.useMemo(()=>[...new Set(t.data.map(i=>i.edition).filter(Boolean).map(i=>i.toLowerCase().replace(/\b\w/g,c=>c.toUpperCase().trim())))].sort(),[t.data]),d=i=>{window.open(`https://www.google.com/search?q=${encodeURIComponent(`${e.songArtist} ${e.songTitle} ${i}`)}`,"_blank")},l=!!e.songTitle&&!!e.songArtist,u=+(((s=e.data)==null?void 0:s.realBpm)??0)>200;return a.jsxs(I,{container:!0,spacing:2,"data-test":"song-metadata",sx:{mt:6},children:[a.jsx(I,{item:!0,xs:6,children:a.jsx(R,{value:e.data.artist,onChange:i=>e.onChange({...e.data,artist:i.target.value}),label:"Song artist",size:"small","data-test":"song-artist",required:!0,fullWidth:!0})}),a.jsx(I,{item:!0,xs:6,children:a.jsx(R,{value:e.data.title,onChange:i=>e.onChange({...e.data,title:i.target.value}),label:"Song title",fullWidth:!0,size:"small",required:!0,"data-test":"song-title"})}),a.jsx(I,{item:!0,xs:3,children:a.jsx(ne,{onKeyDown:i=>{i.key==="Enter"&&i.preventDefault()},freeSolo:!0,disableClearable:!0,options:r,value:e.data.genre??"",onChange:(i,c)=>e.onChange({...e.data,genre:c}),renderInput:i=>a.jsx(R,{...i,onBlur:c=>e.onChange({...e.data,genre:c.target.value}),label:"Song genre (optional)",size:"small","data-test":"song-genre",fullWidth:!0})})}),a.jsx(I,{item:!0,xs:3,children:a.jsx(ne,{onKeyDown:i=>{i.key==="Enter"&&i.preventDefault()},freeSolo:!0,disableClearable:!0,options:n,value:e.data.edition??"",onChange:(i,c)=>e.onChange({...e.data,edition:c}),renderInput:i=>a.jsx(R,{...i,onBlur:c=>e.onChange({...e.data,edition:c.target.value}),label:"Song edition (optional)",size:"small","data-test":"song-edition",helperText:"Songs with the same theme, e.g. 'Christmas'",fullWidth:!0})})}),a.jsx(I,{item:!0,xs:6,children:a.jsx(ne,{onKeyDown:i=>{i.key==="Enter"&&i.preventDefault()},multiple:!0,freeSolo:!0,disableClearable:!0,options:o,value:typeof e.data.language=="string"?[e.data.language]:e.data.language,onChange:(i,c)=>{e.onChange({...e.data,language:c?c.filter(Boolean):e.data.language})},renderInput:i=>{var c;return a.jsx(R,{...i,label:"Song language",fullWidth:!0,size:"small",required:!((c=e.data.language)!=null&&c.length),"data-test":"song-language"})}})}),a.jsx(I,{item:!0,xs:6,children:a.jsx(R,{"data-test":"release-year",value:e.data.year,onChange:i=>e.onChange({...e.data,year:i.target.value}),label:"Release year",helperText:"The year the song was released. Click the 'Lookup' button to look for it on Google",fullWidth:!0,size:"small",required:!0,...de(()=>d("release year"),l)})}),a.jsx(I,{item:!0,xs:6,children:a.jsx(R,{"data-test":"song-bpm",value:e.data.realBpm,onChange:i=>e.onChange({...e.data,realBpm:i.target.value}),label:"Song (real) BPM",focused:u?!0:void 0,helperText:u?a.jsxs(a.Fragment,{children:["Usually songs don't have higher BPM than ",a.jsx("b",{children:"200"}),". Make sure the value is correct"]}):"The actual tempo of the song. Click the 'Lookup' button to look for it on Google",color:u?"warning":void 0,fullWidth:!0,type:"number",size:"small",required:!0,...de(()=>d("tempo"),l)})}),a.jsx(I,{item:!0,xs:12}),a.jsx(I,{item:!0,xs:12,children:a.jsx(Na,{...e})})]})}function Aa({player:e,currentTime:t,effectsEnabled:o,onEffectsToggle:r}){const n=u=>e.seekTo((t+u)/1e3),[d,l]=p.useState(1);return a.jsxs(a.Fragment,{children:[a.jsxs(T,{sx:{mb:2},children:[a.jsxs(z,{variant:"h6","data-test":"current-time",children:["Current time: ",Ua(t)," (",a.jsx(ae,{children:Math.round(t)})," ms)"]}),a.jsxs(T,{sx:{display:"flex",gap:1},children:[a.jsxs(q,{variant:"contained",sx:{display:"flex",mt:1,flex:1},children:[a.jsx(k,{sx:{flex:1,px:1},onClick:()=>n(-1e4),"data-test":"seek-10s",children:"-10"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>n(-5e3),"data-test":"seek-5s",children:"-5"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>n(-1e3),"data-test":"seek-1s",children:"-1"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>n(-500),"data-test":"seek-0.5s",children:"-0.5"})]}),a.jsx(it,{}),a.jsxs(q,{variant:"contained",sx:{display:"flex",mt:1,flex:1},children:[a.jsx(k,{sx:{flex:1,px:1},onClick:()=>n(500),"data-test":"seek+0.5s",children:"+0.5"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>n(1e3),"data-test":"seek+1s",children:"+1"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>n(5e3),"data-test":"seek+5s",children:"+5"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>n(1e4),"data-test":"seek+10s",children:"+10"})]})]})]}),a.jsxs(T,{sx:{mb:2},children:[a.jsxs(z,{variant:"h6",children:["Playback speed: ",a.jsxs(ae,{"data-test":"current-speed",children:[d*100,"%"]})]}),a.jsx(q,{variant:"contained",sx:{display:"flex",mt:1},children:[.25,.5,.75,1,1.25,1.5,2].map(u=>a.jsxs(k,{"data-test":`speed-${u}`,sx:{flex:1},onClick:()=>{l(u),e.setPlaybackSpeed(u)},disabled:d===u,children:[u*100,"%"]},u))})]})]})}function Va(e,t){const o=Math.floor(t);return p.useMemo(()=>e.findIndex((r,n)=>o<0?!0:o<r.start?!1:n===e.length-1||e[n+1].start>o),[o,e])}function Ga({song:e,currentTime:t,beatLength:o,player:r,onRecordChange:n,onTrackNameChange:d}){var L;const[l,u]=p.useState(0),[s,i]=p.useState(-1),[c,v]=p.useState([]),y=Fe(t,o,e.gap),S=e.tracks[l].sections.filter(J),j=Va(S,y),x=h=>{i(h),$e.resetPlayerNotes(),r.seekTo((S[h].start*o+e.gap)/1e3)},B=()=>{v(h=>[...h,{type:"delete",section:s,track:l}]),s===S.length-1&&i(h=>h-1)},$=h=>{v(m=>{const f=m.at(-1);if(f&&f.type==="shift"&&f.track===l&&f.section===s){const C=[...m];return C.at(-1).shift=h,C}return[...m,{type:"shift",section:s,track:l,shift:h}]})};return p.useEffect(()=>{n(c)},[n,c]),a.jsxs(Da,{children:[a.jsxs(fe,{direction:"row",children:[a.jsxs(z,{variant:"h6",mb:0,sx:{flex:1},children:["Edit verses",e.tracks.length>1&&a.jsx(q,{variant:"contained",sx:{ml:2},size:"small",children:e.tracks.map((h,m)=>a.jsxs(k,{onClick:()=>u(m),disabled:l===m,"data-test":`track-${m+1}`,children:["Track ",m+1]},m))})]}),a.jsx(R,{placeholder:"Set track name",sx:{flex:1},size:"small",value:((L=e.tracks[l])==null?void 0:L.name)??"",onChange:h=>d(l,h.target.value),"data-test":"track-name"})]}),a.jsxs(fe,{direction:"row",spacing:2,sx:{height:"400px"},children:[a.jsx(lt,{sx:{overflowY:"auto"},children:S.map((h,m)=>a.jsx(ct,{disablePadding:!0,"data-test":`section-${m}`,children:a.jsx(Tt,{onClick:()=>x(m),selected:s===m,children:a.jsx(Et,{primaryTypographyProps:{fontWeight:m===j?"bold":"normal"},primary:J(h)?h.notes.map(f=>f.lyrics).join(""):"[pause]"})})},h.start))}),a.jsx(_a,{children:s>-1&&a.jsxs(a.Fragment,{children:[s===0&&a.jsx("h3",{"data-test":"use-gap-info",children:"Use gap shift to change when this section starts"}),s>0&&a.jsx(a.Fragment,{children:a.jsx(R,{"data-test":"change-start-beat",size:"small",type:"number",onChange:h=>$(+h.target.value),value:le([S[s]]),label:"Change start beat",InputProps:{inputProps:{step:1}},fullWidth:!0,sx:{mb:2},helperText:a.jsxs(a.Fragment,{children:["Timestamp:"," ",Q(le([S[s]])*o+e.gap,r)]})})}),a.jsx(k,{variant:"contained",color:"error",onClick:B,fullWidth:!0,"data-test":"delete-section",children:"Delete section"})]})}),a.jsxs(Fa,{children:[a.jsx(T,{sx:{overflowY:"auto",maxHeight:"34rem"},"data-test":"change-list",children:c.map((h,m)=>{let f="",C=ye;return h.type==="delete"?(C=ye,f="Deleted"):h.type==="shift"&&(C=Wa,f=`Start -> ${h.shift}`),a.jsx(C,{children:a.jsxs("strong",{children:["Track: ",h.track+1,", Section: ",h.section+1,", ",f]})},m)})}),c.length>0&&a.jsx(k,{"data-test":"undo-change",variant:"contained",color:"warning",onClick:()=>v(h=>h.filter((m,f)=>f!==h.length-1)),fullWidth:!0,children:"Undo last change"})]})]})]})}const Fa=_("div",{target:"edf68o88"})({name:"82a6rk",styles:"flex:1"}),Pe=_("div",{target:"edf68o87"})({name:"m1a2da",styles:"padding:0.5rem"}),ye=_(Pe,{target:"edf68o86"})({name:"hwfcu5",styles:"color:red"}),Wa=_(Pe,{target:"edf68o85"})({name:"zzs6wi",styles:"color:#0059ff"}),Da=_("div",{target:"edf68o83"})(""),_a=_("div",{target:"edf68o82"})({name:"82a6rk",styles:"flex:1"});function Oa({song:e,player:t,beatLength:o}){return a.jsx(a.Fragment,{})}function qa(e,t){var l;const r=(l=t.tracks[0].sections.filter(J).at(-1))==null?void 0:l.notes.at(-1),n=e-t.gap,d=r.start+r.length;return Number((6e4/(n/d*t.bar)).toFixed(2))}function Ya({current:e,onChange:t,player:o,song:r}){const n=Math.max(...r.tracks.map(s=>We(s.sections))),d=De(n,r)+r.gap,[l,u]=p.useState(Math.round(d));return a.jsxs(T,{sx:{display:"flex",gap:2,mb:2},children:[a.jsx(R,{"data-test":"desired-end",size:"small",type:"number",value:l,onChange:s=>u(+s.target.value),label:"Desired last note end time (in milliseconds)",sx:{flex:1},helperText:l?a.jsxs(a.Fragment,{children:["Estimated proper Tempo (BPM) of the lyrics:"," ",a.jsx(ae,{"data-test":"desired-bpm",children:qa(l,r)})]}):" "}),a.jsx(R,{"data-test":"change-bpm",size:"small",type:"number",value:e,onChange:s=>t(+s.target.value),label:"Tempo (BPM) of the lyrics",sx:{flex:.5},helperText:" ",InputProps:{inputProps:{step:"0.1"}}})]})}function Ha({current:e,onChange:t,player:o,finalGap:r}){return a.jsxs(T,{sx:{flex:1},children:[a.jsxs(z,{variant:"h6",children:["Lyrics Gap shift (final: ",Q(r,o),")"]}),a.jsxs(T,{sx:{display:"flex",gap:1,mt:1},children:[a.jsxs(q,{sx:{flex:1},children:[a.jsx(k,{sx:{flex:1,px:1},onClick:()=>t(e-1e3),"data-test":"shift-gap-1s",children:"-1000"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>t(e-500),"data-test":"shift-gap-0.5s",children:"-500"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>t(e-50),"data-test":"shift-gap-0.05s",children:"-50"})]}),a.jsx(R,{sx:{py:0,flex:1},size:"small",type:"text",value:e,onChange:n=>t(+n.target.value),label:"Miliseconds","data-test":"shift-gap"}),a.jsxs(q,{sx:{flex:1},children:[a.jsx(k,{sx:{flex:1,px:1},onClick:()=>t(e+50),"data-test":"shift-gap+0.05s",children:"+50"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>t(e+500),"data-test":"shift-gap+0.5s",children:"+500"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>t(e+1e3),"data-test":"shift-gap+1s",children:"+1000"})]})]})]})}function Ka({current:e,onChange:t,player:o,finalGap:r}){return a.jsxs(T,{sx:{flex:1},children:[a.jsxs(z,{variant:"h6",children:["Video Gap shift (final: ",Q((r??0)*1e3,o),")"]}),a.jsxs(T,{sx:{display:"flex",gap:1,mt:1},children:[a.jsxs(q,{sx:{flex:1},children:[a.jsx(k,{sx:{flex:1,px:1.25},onClick:()=>t(e-10),"data-test":"shift-video-gap-10s",children:"-10"}),a.jsx(k,{sx:{flex:1,px:1.25},onClick:()=>t(e-5),"data-test":"shift-video-gap-5s",children:"-5"}),a.jsx(k,{sx:{flex:1,px:1.25},onClick:()=>t(e-1),"data-test":"shift-video-gap-1s",children:"-1"})]}),a.jsx(R,{"data-test":"shift-video-gap",sx:{py:0,flex:1},size:"small",type:"text",value:e,onChange:n=>t(+n.target.value),label:"Seconds"}),a.jsxs(q,{sx:{flex:1},children:[a.jsx(k,{sx:{flex:1,px:1.25},onClick:()=>t(e+1),"data-test":"shift-video-gap+1s",children:"+1"}),a.jsx(k,{sx:{flex:1,px:1.25},onClick:()=>t(e+5),"data-test":"shift-video-gap+5s",children:"+5"}),a.jsx(k,{sx:{flex:1,px:1.25},onClick:()=>t(e+10),"data-test":"shift-video-gap+10s",children:"+10"})]})]})]})}const Xa=(e,t)=>({...e,gap:e.gap+t}),Ja=(e,t)=>({...e,videoGap:(e.videoGap??0)+t}),Qa=(e,t)=>({...e,bpm:t}),Za=(e,t)=>({...e,tracks:e.tracks.map((o,r)=>{const n=t.filter(l=>l.track===r);let d=[...o.sections].filter(J);return n.forEach(l=>{if(l.type==="delete")d=d.filter((u,s)=>s!==l.section);else if(l.type==="shift"){const u=l.shift-le([d[l.section]]);d=d.map((s,i)=>i<l.section?s:{...s,notes:s.notes.map(c=>({...c,start:c.start+u}))})}}),{...o,sections:d}})}),eo=(e,t)=>({...e,tracks:e.tracks.map((o,r)=>({...o,name:t[r]??o.name}))}),ue=800,je=ue/16*9;function to({song:e,onUpdate:t,visible:o}){const r=p.useRef(null),[n,d]=p.useState(0),[l,u]=p.useState(0),[s,i]=p.useState(0),[c,v]=p.useState(e.bpm),[y,S]=p.useState(0),[j,x]=p.useState([]),[B,$]=p.useState(!1),[L,h]=p.useState(e.tracks.map(g=>g.name??void 0)),m=p.useMemo(()=>{let g=mt(e);return g=_e(g),g=Oe(g),g=he(g),g=Xa(g,l),g=Ja(g,s),g=Qa(g,c),g=Za(g,j),g=eo(g,L),g=he(g),g=qe(g),g},[l,s,e,c,j,L]);p.useEffect(()=>{t==null||t(m)},[t,m]);const f=p.useMemo(()=>({id:"test",mode:Ye.DUEL,players:[{number:0,track:0},{number:1,track:e.tracks.length-1}],tolerance:6}),[e]);let C;return C=He(m),p.useEffect(()=>{var g;o||(g=r.current)==null||g.pause()},[o]),a.jsxs(I,{container:!0,spacing:2,sx:{display:o?void 0:"none"},children:[a.jsx(I,{item:!0,xs:8,"data-test":"player-container",children:a.jsx(T,{sx:{width:ue,height:je},children:a.jsx(Ke,{song:m,showControls:!0,autoplay:!1,width:ue,height:je,ref:r,onCurrentTimeUpdate:d,players:f.players,effectsEnabled:B,singSetup:f,onSongEnd:()=>{}},y)})}),a.jsxs(I,{item:!0,xs:4,children:[a.jsx(z,{variant:"h5",mb:2,children:"Playback controls"}),r.current&&a.jsx(Aa,{player:r.current,currentTime:n,effectsEnabled:B,onEffectsToggle:()=>$(g=>!g)}),!r.current&&a.jsx("h2",{children:"Start the song to see the manipulation form"})]}),r.current&&a.jsxs(a.Fragment,{children:[a.jsx(I,{item:!0,xs:8,children:a.jsxs(T,{sx:{display:"flex",gap:5,flex:1},children:[a.jsx(Ka,{player:r.current,onChange:g=>{const P=g-s;i(g),u(N=>N+P*1e3)},current:s,finalGap:m.videoGap}),a.jsx(Ha,{player:r.current,onChange:u,current:l,finalGap:m.gap})]})}),a.jsxs(I,{item:!0,xs:4,children:[a.jsxs(V,{children:["Use ",a.jsx("strong",{children:"Video shift gap"})," to crop the beginning of the video if it starts with an intro."]}),a.jsxs(V,{children:["Use ",a.jsx("strong",{children:"Lyrics shift gap"})," to sync the start of the lyrics to the video. You can lower the"," ",a.jsx("strong",{children:"Playback speed"})," above to make sure you got it just right."]})]}),a.jsxs(I,{item:!0,xs:8,children:[a.jsx(z,{variant:"h5",mb:2,children:"Advanced"}),a.jsx(Ya,{player:r.current,onChange:v,current:c,song:m},m.gap),a.jsx(Oa,{player:r.current,song:m,beatLength:C})]}),a.jsxs(I,{item:!0,xs:4,children:[a.jsx(V,{children:"If the lyrics desynchronise over time, probably the tempo (BPM) of the lyrics is wrong."}),a.jsxs(V,{children:["You can either use ",a.jsx("strong",{children:"Last note end time"})," - enter the millisecond when the last note should end (seek through the video for the moment as ",a.jsx("strong",{children:"Current time"})," panel show the exact millisecond) and a suggested BPM value will appear below."]}),a.jsxs(V,{children:[a.jsx("strong",{children:"Tempo (BPM)"})," field allows to fine-tune the tempo."]})]}),a.jsx(I,{item:!0,xs:8,children:a.jsx(Ga,{song:m,currentTime:n,beatLength:C,player:r.current,onRecordChange:x,onTrackNameChange:(g,P)=>h(N=>{const pe=[...N];return pe[g]=P===""?void 0:P,pe})})}),a.jsxs(I,{item:!0,xs:4,children:[a.jsxs(V,{children:["If the lyrics there are more lyrics than in the video or there are longer/shorter interludes between verses, you can ",a.jsx("strong",{children:"Edit verses"}),"."]}),a.jsx(V,{children:"Select a verse by clicking on it."}),a.jsxs(V,{children:["You can either ",a.jsx("strong",{children:"Change its start beat"}),' (which will "move in time" the verse and all subsequent ones) or ',a.jsx("strong",{children:"Delete it"})," (it won't affect the timing of other verses)."]}),a.jsxs(V,{children:[a.jsx("strong",{children:"List of changes"})," on the right allows you to see and undo the actions one by one."]})]})]})]})}const V=_("p",{target:"enb6wj40"})({name:"1tcko1c",styles:"font-size:0.85rem;margin-bottom:1rem;line-height:1.25rem;strong{font-weight:bold;}"});function ao(e){var t,o,r;return a.jsx(T,{"data-test":"sync-lyrics",children:e.data&&e.data.video.length<15&&!!((r=(o=(t=e.data.tracks)==null?void 0:t[0])==null?void 0:o.sections)!=null&&r.length)&&a.jsx(to,{song:e.data,onUpdate:e.onChange,visible:e.visible})})}const G=["basic-data","author-and-video","sync","metadata"];function so({song:e}){const t=!!e,{data:o}=Te(!0);Xe(!1);const r=Je();Qe(!1);const[n,d]=p.useState(0),[l,u]=p.useState({sourceUrl:(e==null?void 0:e.sourceUrl)??"",txtInput:""}),[s,i]=p.useState({author:(e==null?void 0:e.author)??"",authorUrl:(e==null?void 0:e.authorUrl)??"",video:e!=null&&e.video?`https://www.youtube.com/watch?v=${e.video}`:""}),[c,v]=p.useState({artist:(e==null?void 0:e.artist)??"",title:(e==null?void 0:e.title)??"",realBpm:e!=null&&e.realBpm?String(e.realBpm):"",year:(e==null?void 0:e.year)??"",language:(e==null?void 0:e.language)??"",volume:(e==null?void 0:e.volume)??0,previewStart:(e==null?void 0:e.previewStart)??void 0,previewEnd:(e==null?void 0:e.previewEnd)??void 0,genre:e==null?void 0:e.genre,edition:e==null?void 0:e.edition}),[y,S]=p.useState(e),j=p.useRef(""),x=p.useMemo(()=>{try{return t?{...e,video:Le(s.video)||e.video,author:s.author,authorUrl:s.authorUrl,sourceUrl:l.sourceUrl}:l.txtInput?Be(l.txtInput,s.video,s.author,s.authorUrl,l.sourceUrl):void 0}catch(f){j.current=f.message,console.error(f)}},[l.txtInput,s.video,s.author,s.authorUrl,l.sourceUrl,e,t]),B=p.useMemo(()=>!t&&x&&(o==null?void 0:o.find(f=>re.generateSongFile(f)===re.generateSongFile(x))),[o,x,t]);p.useEffect(()=>{x&&(x.video&&!s.video&&i(f=>({...f,video:`https://www.youtube.com/watch?v=${x.video}`})),x.author&&!s.author&&i(f=>({...f,author:f.author||(x==null?void 0:x.author)||"",authorUrl:f.authorUrl||(x==null?void 0:x.authorUrl)||""})),x.sourceUrl&&!l.sourceUrl&&u(f=>({...f,sourceUrl:x.sourceUrl})),["year","language","realBpm","genre","artist","title","volume","previewStart","previewEnd"].forEach(f=>{x[f]&&!c[f]&&v(C=>({...C,[f]:x[f]}))}))},[x,c.year,c.language,c.realBpm,c.genre,c.artist,c.volume,c.title,c.previewStart,c.previewEnd,l.sourceUrl,s.video]);const $=!!l.txtInput||t,L=!!s.video,h=G[n]==="author-and-video"?L:!0,m={...y,...c,author:s.author,authorUrl:s.authorUrl,realBpm:+c.realBpm,sourceUrl:l.sourceUrl,id:Ze(c)};return a.jsxs(et,{injectFirst:!0,children:[a.jsx(tt,{}),a.jsxs(oo,{children:[!t&&a.jsx("div",{style:{marginBottom:"1rem"},children:a.jsx(at,{to:"menu/",children:a.jsx("a",{children:"Return to the main menu"})})}),a.jsxs(La,{activeStep:n,sx:{mb:2},nonLinear:t,children:[a.jsx(ee,{completed:$,children:a.jsx(te,{color:"inherit",onClick:()=>d(0),children:"Basic Info"})},0),a.jsx(ee,{completed:L,children:a.jsx(te,{color:"inherit",onClick:()=>d(1),children:"Author and video data"})},1),a.jsx(ee,{children:a.jsx(te,{color:"inherit",onClick:()=>d(2),children:"Sync lyrics to video"})},2),a.jsx(ee,{children:a.jsx(te,{color:"inherit",onClick:()=>d(3),children:"Fill song metadata"})},3)]}),a.jsxs("form",{onSubmit:async f=>{f.preventDefault(),n<G.length-1?d(C=>C+1):G.at(n)==="metadata"&&(await re.store(m),t||dt(m.id),r("edit/list/",{id:m.id,created:t?null:"true",song:null}))},children:[G.at(n)==="basic-data"&&a.jsx(Ma,{shouldAutoImport:!L,isTxtRequired:!e,onAutoImport:i,onChange:u,data:l,finalSong:m}),G.at(n)==="author-and-video"&&a.jsx(wa,{songArtist:x==null?void 0:x.artist,songTitle:x==null?void 0:x.title,onChange:i,data:s}),x&&a.jsx(ao,{onChange:S,data:x,visible:G.at(n)==="sync"}),G.at(n)==="metadata"&&a.jsx(za,{videoGap:y==null?void 0:y.videoGap,onChange:v,data:c,songArtist:x==null?void 0:x.artist,songTitle:x==null?void 0:x.title,videoId:x.video}),B&&a.jsxs(ut,{severity:"warning","data-test":"possible-duplicate",children:[a.jsx(pt,{children:"Possible duplicate"}),"There is already a song with similar artist and/or name:"," ",a.jsxs("b",{children:[B.artist," - ",B.title]})]}),a.jsxs(T,{sx:{display:"flex",justifyContent:"flex-end"},children:[a.jsx(k,{"data-test":"previous-button",sx:{mt:2,align:"right"},onClick:()=>d(f=>f-1),disabled:n===0,children:"Previous"}),G.at(n)==="metadata"?a.jsx(k,{"data-test":"save-button",sx:{mt:2,align:"right"},type:"submit",variant:"contained",children:"Save"}):a.jsx(k,{"data-test":"next-button",sx:{mt:2,align:"right"},variant:"contained",type:"submit",disabled:!h||n===G.length-1,children:"Next"})]})]})]})]})}const oo=_("div",{target:"e1qxoxak0"})({name:"1ec6m7r",styles:"background:white;margin:30px auto 0;width:1260px;height:100%"});export{so as default};

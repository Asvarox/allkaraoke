try{let e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]=`15039baf-51ac-4cb1-8943-d8a1a228bf84`,e._sentryDebugIdIdentifier=`sentry-dbid-15039baf-51ac-4cb1-8943-d8a1a228bf84`)}catch{}{let e=typeof window<`u`?window:typeof global<`u`?global:typeof globalThis<`u`?globalThis:typeof self<`u`?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:allkaraoke-party-sentry-key":!0})}import{A as e,B as t,C as n,D as r,E as i,b as a,c as o,d as s,e as c,f as l,g as u,h as d,i as f,j as p,k as m,l as h,m as g,n as _,o as v,p as y,q as b,r as x,s as S,t as C,u as w,v as T,w as E,x as D,y as O,z as k}from"./SongsTable-CFHMxu-z.js";import{A as ee,B as te,C as ne,D as re,E as ie,F as ae,G as oe,H as se,I as ce,J as le,L as ue,N as de,P as fe,Q as pe,R as A,U as me,W as he,a3 as ge,a4 as _e,a7 as ve,a8 as ye,a9 as j,aB as M,aI as N,aJ as P,aL as F,aa as I,ac as L,ad as be,al as R,b as xe,b1 as Se,b2 as Ce,b3 as we,b4 as Te,b5 as z,b6 as B,b7 as Ee,b8 as V,b9 as De,bA as Oe,bD as ke,bc as Ae,bd as je,be as Me,bf as Ne,bh as Pe,bi as H,bj as Fe,bk as Ie,bl as Le,bn as Re,bo as ze,bp as Be,bq as Ve,br as He,bs as Ue,bt as We,bu as Ge,bv as Ke,bw as qe,bx as U,by as Je,bz as Ye,d as Xe,e as Ze,f as Qe,g as $e,h as et,i as tt,k as W,l as nt,u as rt,x as G,y as it,z as at}from"./index-DuSk1Woo.js";var K=ke(Ye());function ot(e){return K.Children.toArray(e).filter(e=>K.isValidElement(e))}var q=ke(Pe());const st=(e,t)=>{let n=je(e);return n.sheet=new t({key:n.key,nonce:n.sheet.nonce,container:n.sheet.container,speedy:n.sheet.isSpeedy,prepend:n.sheet.prepend,insertionPoint:n.sheet.insertionPoint}),n};let ct;if(typeof document==`object`){let e=document.querySelector(`[name="emotion-insertion-point"]`);if(!e){e=document.createElement(`meta`),e.setAttribute(`name`,`emotion-insertion-point`),e.setAttribute(`content`,``);let t=document.querySelector(`head`);t&&t.prepend(e)}class t extends Me{insert(t,n){return this.key&&this.key.endsWith(`global`)&&(this.before=e),super.insert(t,n)}}ct=st({key:`css`,insertionPoint:e},t)}function lt(e){let{injectFirst:t,children:n}=e;return t&&ct?(0,q.jsx)(Ae,{value:ct,children:n}):n}const ut=e=>{let{classes:t,inset:n,primary:r,secondary:i,dense:a}=e,o={root:[`root`,n&&`inset`,a&&`dense`,r&&i&&`multiline`],primary:[`primary`],secondary:[`secondary`]};return F(o,T,t)},dt=L(`div`,{name:`MuiListItemText`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${E.primary}`]:t.primary},{[`& .${E.secondary}`]:t.secondary},t.root,n.inset&&t.inset,n.primary&&n.secondary&&t.multiline,n.dense&&t.dense]}})({flex:`1 1 auto`,minWidth:0,marginTop:4,marginBottom:4,[`.${nt.root}:where(& .${E.primary})`]:{display:`block`},[`.${nt.root}:where(& .${E.secondary})`]:{display:`block`},variants:[{props:({ownerState:e})=>e.primary&&e.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:56}}]}),ft=K.forwardRef(function(e,t){let n=j({props:e,name:`MuiListItemText`}),{children:r,className:i,disableTypography:a=!1,inset:o=!1,primary:s,primaryTypographyProps:c,secondary:l,secondaryTypographyProps:u,slots:d={},slotProps:f={},...p}=n,{dense:m}=K.useContext(k),h=s??r,g=l,_={...n,disableTypography:a,inset:o,primary:!!h,secondary:!!g,dense:m},v=ut(_),y={slots:d,slotProps:{primary:c,secondary:u,...f}},[b,x]=rt(`primary`,{className:v.primary,elementType:W,externalForwardedProps:y,ownerState:_}),[S,C]=rt(`secondary`,{className:v.secondary,elementType:W,externalForwardedProps:y,ownerState:_});return h!=null&&h.type!==W&&!a&&(h=(0,q.jsx)(b,{variant:m?`body2`:`body1`,component:x?.variant?void 0:`span`,...x,children:h})),g!=null&&g.type!==W&&!a&&(g=(0,q.jsx)(S,{variant:`body2`,color:`textSecondary`,...C,children:g})),(0,q.jsxs)(dt,{className:z(v.root,i),ownerState:_,ref:t,...p,children:[h,g]})});var pt=ft;const mt=(e,t)=>{let{ownerState:n}=e;return[t.root,n.dense&&t.dense,n.alignItems===`flex-start`&&t.alignItemsFlexStart,n.divider&&t.divider,!n.disableGutters&&t.gutters]},ht=e=>{let{alignItems:t,classes:n,dense:r,disabled:i,disableGutters:a,divider:o,selected:s}=e,c={root:[`root`,r&&`dense`,!a&&`gutters`,o&&`divider`,i&&`disabled`,t===`flex-start`&&`alignItemsFlexStart`,s&&`selected`]},l=F(c,d,n);return{...n,...l}},gt=L(he,{shouldForwardProp:e=>be(e)||e===`classes`,name:`MuiListItemButton`,slot:`Root`,overridesResolver:mt})(I(({theme:e})=>({display:`flex`,flexGrow:1,justifyContent:`flex-start`,alignItems:`center`,position:`relative`,textDecoration:`none`,minWidth:0,boxSizing:`border-box`,textAlign:`left`,paddingTop:8,paddingBottom:8,transition:e.transitions.create(`background-color`,{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:`none`,backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:`transparent`}},[`&.${f.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:R(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${f.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:R(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${f.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:R(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:R(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${f.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${f.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},variants:[{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:`padding-box`}},{props:{alignItems:`flex-start`},style:{alignItems:`flex-start`}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.dense,style:{paddingTop:4,paddingBottom:4}}]}))),_t=K.forwardRef(function(e,t){let n=j({props:e,name:`MuiListItemButton`}),{alignItems:i=`center`,autoFocus:a=!1,component:o=`div`,children:s,dense:c=!1,disableGutters:l=!1,divider:u=!1,focusVisibleClassName:d,selected:f=!1,className:p,...m}=n,h=K.useContext(k),g=K.useMemo(()=>({dense:c||h.dense||!1,alignItems:i,disableGutters:l}),[i,h.dense,c,l]),_=K.useRef(null);r(()=>{a&&_.current&&_.current.focus()},[a]);let v={...n,alignItems:i,dense:g.dense,disableGutters:l,divider:u,selected:f},y=ht(v),b=_e(_,t);return(0,q.jsx)(k.Provider,{value:g,children:(0,q.jsx)(gt,{ref:b,href:m.href||m.to,component:(m.href||m.to)&&o===`div`?`button`:o,focusVisibleClassName:z(y.focusVisible,d),ownerState:v,className:z(y.root,p),...m,classes:y,children:s})})});var vt=_t;const yt=K.createContext({});var J=yt;const bt=K.createContext({});var xt=bt;function St(e){return P(`MuiStep`,e)}N(`MuiStep`,[`root`,`horizontal`,`vertical`,`alternativeLabel`,`completed`]);const Ct=e=>{let{classes:t,orientation:n,alternativeLabel:r,completed:i}=e,a={root:[`root`,n,r&&`alternativeLabel`,i&&`completed`]};return F(a,St,t)},wt=L(`div`,{name:`MuiStep`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.completed&&t.completed]}})({variants:[{props:{orientation:`horizontal`},style:{paddingLeft:8,paddingRight:8}},{props:{alternativeLabel:!0},style:{flex:1,position:`relative`}}]}),Tt=K.forwardRef(function(e,t){let n=j({props:e,name:`MuiStep`}),{active:r,children:i,className:a,component:o=`div`,completed:s,disabled:c,expanded:l=!1,index:u,last:d,...f}=n,{activeStep:p,connector:m,alternativeLabel:h,orientation:g,nonLinear:_}=K.useContext(J),[v=!1,y=!1,b=!1]=[r,s,c];p===u?v=r===void 0?!0:r:!_&&p>u?y=s===void 0?!0:s:!_&&p<u&&(b=c===void 0?!0:c);let x=K.useMemo(()=>({index:u,last:d,expanded:l,icon:u+1,active:v,completed:y,disabled:b}),[u,d,l,v,y,b]),S={...n,active:v,orientation:g,alternativeLabel:h,completed:y,disabled:b,expanded:l,component:o},C=Ct(S),w=(0,q.jsxs)(wt,{as:o,className:z(C.root,a),ref:t,ownerState:S,...f,children:[m&&h&&u!==0?m:null,i]});return(0,q.jsx)(xt.Provider,{value:x,children:m&&!h&&u!==0?(0,q.jsxs)(K.Fragment,{children:[m,w]}):w})});var Et=Tt,Dt=ve((0,q.jsx)(`path`,{d:`M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z`}),`CheckCircle`),Ot=ve((0,q.jsx)(`path`,{d:`M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z`}),`Warning`);function kt(e){return P(`MuiStepIcon`,e)}const At=N(`MuiStepIcon`,[`root`,`active`,`completed`,`error`,`text`]);var jt=At,Mt;const Nt=e=>{let{classes:t,active:n,completed:r,error:i}=e,a={root:[`root`,n&&`active`,r&&`completed`,i&&`error`],text:[`text`]};return F(a,kt,t)},Pt=L(ye,{name:`MuiStepIcon`,slot:`Root`,overridesResolver:(e,t)=>t.root})(I(({theme:e})=>({display:`block`,transition:e.transitions.create(`color`,{duration:e.transitions.duration.shortest}),color:(e.vars||e).palette.text.disabled,[`&.${jt.completed}`]:{color:(e.vars||e).palette.primary.main},[`&.${jt.active}`]:{color:(e.vars||e).palette.primary.main},[`&.${jt.error}`]:{color:(e.vars||e).palette.error.main}}))),Ft=L(`text`,{name:`MuiStepIcon`,slot:`Text`,overridesResolver:(e,t)=>t.text})(I(({theme:e})=>({fill:(e.vars||e).palette.primary.contrastText,fontSize:e.typography.caption.fontSize,fontFamily:e.typography.fontFamily}))),It=K.forwardRef(function(e,t){let n=j({props:e,name:`MuiStepIcon`}),{active:r=!1,className:i,completed:a=!1,error:o=!1,icon:s,...c}=n,l={...n,active:r,completed:a,error:o},u=Nt(l);if(typeof s==`number`||typeof s==`string`){let e=z(i,u.root);return o?(0,q.jsx)(Pt,{as:Ot,className:e,ref:t,ownerState:l,...c}):a?(0,q.jsx)(Pt,{as:Dt,className:e,ref:t,ownerState:l,...c}):(0,q.jsxs)(Pt,{className:e,ref:t,ownerState:l,...c,children:[Mt||=(0,q.jsx)(`circle`,{cx:`12`,cy:`12`,r:`12`}),(0,q.jsx)(Ft,{className:u.text,x:`12`,y:`12`,textAnchor:`middle`,dominantBaseline:`central`,ownerState:l,children:s})]})}return s});var Lt=It;function Rt(e){return P(`MuiStepLabel`,e)}const zt=N(`MuiStepLabel`,[`root`,`horizontal`,`vertical`,`label`,`active`,`completed`,`error`,`disabled`,`iconContainer`,`alternativeLabel`,`labelContainer`]);var Y=zt;const Bt=e=>{let{classes:t,orientation:n,active:r,completed:i,error:a,disabled:o,alternativeLabel:s}=e,c={root:[`root`,n,a&&`error`,o&&`disabled`,s&&`alternativeLabel`],label:[`label`,r&&`active`,i&&`completed`,a&&`error`,o&&`disabled`,s&&`alternativeLabel`],iconContainer:[`iconContainer`,r&&`active`,i&&`completed`,a&&`error`,o&&`disabled`,s&&`alternativeLabel`],labelContainer:[`labelContainer`,s&&`alternativeLabel`]};return F(c,Rt,t)},Vt=L(`span`,{name:`MuiStepLabel`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[n.orientation]]}})({display:`flex`,alignItems:`center`,[`&.${Y.alternativeLabel}`]:{flexDirection:`column`},[`&.${Y.disabled}`]:{cursor:`default`},variants:[{props:{orientation:`vertical`},style:{textAlign:`left`,padding:`8px 0`}}]}),Ht=L(`span`,{name:`MuiStepLabel`,slot:`Label`,overridesResolver:(e,t)=>t.label})(I(({theme:e})=>({...e.typography.body2,display:`block`,transition:e.transitions.create(`color`,{duration:e.transitions.duration.shortest}),[`&.${Y.active}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${Y.completed}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${Y.alternativeLabel}`]:{marginTop:16},[`&.${Y.error}`]:{color:(e.vars||e).palette.error.main}}))),Ut=L(`span`,{name:`MuiStepLabel`,slot:`IconContainer`,overridesResolver:(e,t)=>t.iconContainer})({flexShrink:0,display:`flex`,paddingRight:8,[`&.${Y.alternativeLabel}`]:{paddingRight:0}}),Wt=L(`span`,{name:`MuiStepLabel`,slot:`LabelContainer`,overridesResolver:(e,t)=>t.labelContainer})(I(({theme:e})=>({width:`100%`,color:(e.vars||e).palette.text.secondary,[`&.${Y.alternativeLabel}`]:{textAlign:`center`}}))),Gt=K.forwardRef(function(e,t){let n=j({props:e,name:`MuiStepLabel`}),{children:r,className:i,componentsProps:a={},error:o=!1,icon:s,optional:c,slots:l={},slotProps:u={},StepIconComponent:d,StepIconProps:f,...p}=n,{alternativeLabel:m,orientation:h}=K.useContext(J),{active:g,disabled:_,completed:v,icon:y}=K.useContext(xt),b=s||y,x=d;b&&!x&&(x=Lt);let S={...n,active:g,alternativeLabel:m,completed:v,disabled:_,error:o,orientation:h},C=Bt(S),w={slots:l,slotProps:{stepIcon:f,...a,...u}},[T,E]=rt(`label`,{elementType:Ht,externalForwardedProps:w,ownerState:S}),[D,O]=rt(`stepIcon`,{elementType:x,externalForwardedProps:w,ownerState:S});return(0,q.jsxs)(Vt,{className:z(C.root,i),ref:t,ownerState:S,...p,children:[b||D?(0,q.jsx)(Ut,{className:C.iconContainer,ownerState:S,children:(0,q.jsx)(D,{completed:v,active:g,error:o,icon:b,...O})}):null,(0,q.jsxs)(Wt,{className:C.labelContainer,ownerState:S,children:[r?(0,q.jsx)(T,{...E,className:z(C.label,E?.className),children:r}):null,c]})]})});Gt.muiName=`StepLabel`;var Kt=Gt;function qt(e){return P(`MuiStepButton`,e)}const Jt=N(`MuiStepButton`,[`root`,`horizontal`,`vertical`,`touchRipple`]);var Yt=Jt;const Xt=e=>{let{classes:t,orientation:n}=e,r={root:[`root`,n],touchRipple:[`touchRipple`]};return F(r,qt,t)},Zt=L(he,{name:`MuiStepButton`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${Yt.touchRipple}`]:t.touchRipple},t.root,t[n.orientation]]}})({width:`100%`,padding:`24px 16px`,margin:`-24px -16px`,boxSizing:`content-box`,[`& .${Yt.touchRipple}`]:{color:`rgba(0, 0, 0, 0.3)`},variants:[{props:{orientation:`vertical`},style:{justifyContent:`flex-start`,padding:`8px`,margin:`-8px`}}]}),Qt=K.forwardRef(function(e,t){let n=j({props:e,name:`MuiStepButton`}),{children:r,className:a,icon:o,optional:s,...c}=n,{disabled:l,active:u}=K.useContext(xt),{orientation:d}=K.useContext(J),f={...n,orientation:d},p=Xt(f),m={icon:o,optional:s},h=i(r,[`StepLabel`])?K.cloneElement(r,m):(0,q.jsx)(Kt,{...m,children:r});return(0,q.jsx)(Zt,{focusRipple:!0,disabled:l,TouchRippleProps:{className:p.touchRipple},className:z(p.root,a),ref:t,ownerState:f,"aria-current":u?`step`:void 0,...c,children:h})});var $t=Qt;function en(e){return P(`MuiStepper`,e)}N(`MuiStepper`,[`root`,`horizontal`,`vertical`,`nonLinear`,`alternativeLabel`]);function tn(e){return P(`MuiStepConnector`,e)}N(`MuiStepConnector`,[`root`,`horizontal`,`vertical`,`alternativeLabel`,`active`,`completed`,`disabled`,`line`,`lineHorizontal`,`lineVertical`]);const nn=e=>{let{classes:t,orientation:n,alternativeLabel:r,active:i,completed:a,disabled:o}=e,s={root:[`root`,n,r&&`alternativeLabel`,i&&`active`,a&&`completed`,o&&`disabled`],line:[`line`,`line${M(n)}`]};return F(s,tn,t)},rn=L(`div`,{name:`MuiStepConnector`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.completed&&t.completed]}})({flex:`1 1 auto`,variants:[{props:{orientation:`vertical`},style:{marginLeft:12}},{props:{alternativeLabel:!0},style:{position:`absolute`,top:12,left:`calc(-50% + 20px)`,right:`calc(50% + 20px)`}}]}),an=L(`span`,{name:`MuiStepConnector`,slot:`Line`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.line,t[`line${M(n.orientation)}`]]}})(I(({theme:e})=>{let t=e.palette.mode===`light`?e.palette.grey[400]:e.palette.grey[600];return{display:`block`,borderColor:e.vars?e.vars.palette.StepConnector.border:t,variants:[{props:{orientation:`horizontal`},style:{borderTopStyle:`solid`,borderTopWidth:1}},{props:{orientation:`vertical`},style:{borderLeftStyle:`solid`,borderLeftWidth:1,minHeight:24}}]}})),on=K.forwardRef(function(e,t){let n=j({props:e,name:`MuiStepConnector`}),{className:r,...i}=n,{alternativeLabel:a,orientation:o=`horizontal`}=K.useContext(J),{active:s,disabled:c,completed:l}=K.useContext(xt),u={...n,alternativeLabel:a,orientation:o,active:s,completed:l,disabled:c},d=nn(u);return(0,q.jsx)(rn,{className:z(d.root,r),ref:t,ownerState:u,...i,children:(0,q.jsx)(an,{className:d.line,ownerState:u})})});var sn=on;const cn=e=>{let{orientation:t,nonLinear:n,alternativeLabel:r,classes:i}=e,a={root:[`root`,t,n&&`nonLinear`,r&&`alternativeLabel`]};return F(a,en,i)},ln=L(`div`,{name:`MuiStepper`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.nonLinear&&t.nonLinear]}})({display:`flex`,variants:[{props:{orientation:`horizontal`},style:{flexDirection:`row`,alignItems:`center`}},{props:{orientation:`vertical`},style:{flexDirection:`column`}},{props:{alternativeLabel:!0},style:{alignItems:`flex-start`}}]}),un=(0,q.jsx)(sn,{}),dn=K.forwardRef(function(e,t){let n=j({props:e,name:`MuiStepper`}),{activeStep:r=0,alternativeLabel:i=!1,children:a,className:o,component:s=`div`,connector:c=un,nonLinear:l=!1,orientation:u=`horizontal`,...d}=n,f={...n,nonLinear:l,alternativeLabel:i,orientation:u,component:s},p=cn(f),m=K.Children.toArray(a).filter(Boolean),h=m.map((e,t)=>K.cloneElement(e,{index:t,last:t+1===m.length,...e.props})),g=K.useMemo(()=>({activeStep:r,alternativeLabel:i,connector:c,nonLinear:l,orientation:u}),[r,i,c,l,u]);return(0,q.jsx)(J.Provider,{value:g,children:(0,q.jsx)(ln,{as:s,ownerState:f,className:z(p.root,o),ref:t,...d,children:h})})});var fn=dn;function pn(e){let t=new URL(global.location?.href);Object.entries(e).forEach(([e,n])=>{n===null?t.searchParams.delete(e):t.searchParams.set(e,n)}),global.history.replaceState(null,``,t.toString())}const mn=Te.span`font-mono`,hn=(e,n,r=`Lookup`)=>({InputProps:{endAdornment:(0,q.jsx)(t,{title:n?`Open search results for the song`:`Artist or title of the song is unknown`,children:(0,q.jsx)(`span`,{children:(0,q.jsx)(G,{sx:{mr:-1},endIcon:(0,q.jsx)(de,{}),color:`secondary`,variant:`text`,onClick:e,disabled:!n,children:r})})})}});function gn(t){let n=()=>{global.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(t?.songArtist+` `+t?.songTitle)}`,`_blank`)},r=!!t.songTitle&&!!t.songArtist,i=Ie(t.data.video);return(0,q.jsxs)(e,{sx:{display:`flex`,flexWrap:`wrap`},"data-test":`author-and-vid`,children:[(0,q.jsx)(g,{"data-test":`author-name`,sx:{mt:2},value:t.data.author,onChange:e=>t.onChange({...t.data,author:e.target.value}),label:`Author name (optional)`,fullWidth:!0,size:`small`,helperText:`Nickname of the person that created the .txt file.`}),(0,q.jsx)(g,{"data-test":`author-url`,sx:{mt:2},value:t.data.authorUrl,onChange:e=>t.onChange({...t.data,authorUrl:e.target.value}),label:`Author URL (optional)`,helperText:`Link to authors page/profile.`,fullWidth:!0,size:`small`}),(0,q.jsx)(e,{sx:{display:`flex`,flexDirection:`row`,mt:2,alignItems:`center`,width:`100%`},children:(0,q.jsx)(g,{"data-test":`video-url`,required:!0,value:t.data.video,onChange:e=>t.onChange({...t.data,video:e.target.value}),label:`YouTube Video URL`,placeholder:`https://www.youtube.com/watch?v=`,fullWidth:!0,size:`small`,helperText:`Link to YouTube video, eg https://www.youtube.com/watch?v=xxxxxxxxx. Click the 'Lookup' button to look for it on YouTube`,name:`videoUrl`,...hn(n,r)})}),i&&(0,q.jsx)(e,{children:(0,q.jsx)(Xe,{videoId:i})})]})}async function _n(e){try{let t=new URL(e);if(t.host===`usdb.animux.de`)return yn(e,t);if(t.host===`ultrastar-es.org`)return vn(e)}catch(e){console.warn(e)}}async function vn(e){let t=await fetch(`/proxy?url=${encodeURIComponent(e)}`),n=await t.text(),r=new DOMParser().parseFromString(n,`text/html`),i=r.querySelector(`ul[data-id]`)?.getAttribute(`data-id`),a=`https://ultrastar-es.org/pl/canciones/descargar/txt/${i}`;global.location.href=a;let o=r.querySelector(`#listado > ul > li > dl > dd:nth-child(6) > a`)?.getAttribute(`href`),s=r.querySelector(`#listado > ul > li`)?.getAttribute(`data-id`);return{authorUrl:o?`https://ultrastar-es.org`+o:``,author:r.querySelector(`#listado > ul > li > dl > dd:nth-child(6)`)?.textContent??``,video:s?`https://www.youtube.com/watch?v=`+s:``}}async function yn(e,t){let n=await fetch(`/proxy?url=${encodeURIComponent(e)}`),r=await n.text(),i=new DOMParser().parseFromString(r,`text/html`),a=i.querySelector(`a[href^="?link=profil&id="]`)?.textContent,o=i.querySelector(`a[href^="?link=profil&id="]`)?.getAttribute?.(`href`),s=i.querySelector(`#tablebg > tbody > tr:nth-child(3) > td > table:nth-child(2) > tbody > tr.list_head > td:nth-child(1)`)?.textContent,c=i.querySelector(`#tablebg > tbody > tr:nth-child(3) > td > table:nth-child(2) > tbody > tr.list_head > td:nth-child(2)`)?.textContent;return global.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(s+` `+c)}`,`_blank`),global.open(`http://usdb.animux.de/index.php?link=gettxt&id=${t.searchParams.get(`id`)}`,`_blank`),{authorUrl:o?`http://usdb.animux.de/index.php`+o:``,author:a??``,video:``}}const bn=e=>{let t=Math.floor(e/1e3/60),n=Math.floor(e/1e3)-t*60,r=Math.floor(e%1e3);return(0,q.jsxs)(mn,{children:[String(t).padStart(2,`0`),`:`,String(n).padStart(2,`0`),`.`,String(r).padStart(3,`0`)]})},xn=e=>`playVideo`in e?{play:()=>e.playVideo(),pause:()=>e.pauseVideo(),seekTo:t=>e.seekTo(t,!0),setPlaybackSpeed:t=>e.setPlaybackRate(t)}:e,Sn=(e,n)=>(0,q.jsx)(t,{title:`Click to play the moment just before this time`,placement:`top`,arrow:!0,children:(0,q.jsx)(G,{sx:{py:.15,mb:.5},variant:`contained`,size:`small`,disabled:!n,onClick:n?()=>{Re.resetPlayerNotes(),xn(n).seekTo((e??0)/1e3-.7)}:void 0,children:bn(e??0)})});var Cn=bn;const wn={polish:{È:`é`,í:`'`,"¥":`'`,"¯":`Ż`,"¹":`ą`,π:`ą`,ê:`ę`,Í:`ę`,Œ:`Ś`,å:`Ś`,œ:`ś`,ú:`ś`,æ:`ć`,Ê:`ć`,"¿":`ż`,ø:`ż`,Ø:`Ż`,ñ:`ń`,Ò:`ń`,"³":`ł`,"≥":`ł`,"£":`Ł`,Û:`ó`,ü:`ź`,Ÿ:`ź`},spanish:{ø:`¿`,È:`é`,Ì:`í`,Ò:`ñ`,ń:`ñ`,"·":`á`,Û:`ó`,"°":`!`,"˙":`ú`,ś:`ú`}};function Tn(e,t){let n=wn[t];if(n===void 0)return e;let r=e;for(let[e,t]of Object.entries(n))r=r.replaceAll(e,t);return r}function En(e){let t=e.split(`
`),n=[`#TITLE`,`#ARTIST`,`#BPM`];for(let e of n)if(!t.some(t=>t.startsWith(e)))return!1;if(!t.some(e=>e.startsWith(`:`)))return!1;try{Fe(e)}catch(e){return console.log(e),!1}return!0}function Dn(t){let n=async e=>{if(t.onChange({...t.data,sourceUrl:e.target.value}),t.shouldAutoImport){let n=await _n(e.target.value);n&&t.onAutoImport(n)}},r=e=>{t.onChange({...t.data,txtInput:Tn(t.data.txtInput,e)})},i=(0,K.useMemo)(()=>En(t.data.txtInput),[t.data.txtInput]),a=!i&&t.data.txtInput.length>0;return(0,q.jsxs)(e,{sx:{display:`flex`,flexWrap:`wrap`},"data-test":`basic-data`,children:[t.isTxtRequired&&(0,q.jsxs)(`div`,{children:[(0,q.jsx)(`h4`,{children:`Where to find songs?`}),(0,q.jsxs)(`p`,{children:[`Any UltraStar compatible .txt file will do. You can find many already made songs on`,` `,(0,q.jsx)(`a`,{href:`https://usdb.animux.de/`,target:`_blank`,rel:`noreferrer`,children:`usdb.animux.de`}),` or `,(0,q.jsx)(`a`,{href:`https://ultrastar-es.org/en`,target:`_blank`,rel:`noreferrer`,children:`ultrastar-es.org`}),`.`,(0,q.jsx)(`br`,{}),(0,q.jsx)(`br`,{})]}),(0,q.jsx)(`p`,{children:`You don't need audio/video files, you'll be able to search for appropriate YouTube video and synchronise the lyrics to it in subsequent steps.`})]}),(0,q.jsx)(g,{sx:{mt:2},value:t.data.sourceUrl,onChange:n,label:`Source URL (optional)`,fullWidth:!0,size:`small`,"data-test":`source-url`,helperText:`The link to the page from which the .TXT file was downloaded.`}),t.isTxtRequired?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(g,{error:a,helperText:a?`This doesn't look like a valid UltraStar .TXT format`:``,required:!0,sx:{mt:2},fullWidth:!0,size:`small`,multiline:!0,label:`Song's UltraStar .TXT file contents`,onChange:e=>t.onChange({...t.data,txtInput:e.target.value}),value:t.data.txtInput,maxRows:15,minRows:15,InputProps:{inputProps:{"data-test":`input-txt`,sx:{fontFamily:`monospace`}}}}),(0,q.jsxs)(e,{sx:{display:`flex`,gap:1,mt:1},children:[(0,q.jsx)(G,{onClick:()=>r(`polish`),children:`Fix 🇵🇱 Polish accents`}),(0,q.jsx)(G,{onClick:()=>r(`spanish`),children:`Fix 🇪🇸 Spanish accents`})]})]}):(0,q.jsx)(`div`,{className:`flex h-150 w-full gap-1 overflow-auto`,children:t.finalSong?.tracks?.map((e,n)=>(0,q.jsxs)(`div`,{className:`flex flex-1 flex-col gap-1`,children:[(0,q.jsx)(`h4`,{className:`py-3`,children:e.name??`Track #${n+1}`}),e.sections.filter(U).map(e=>(0,q.jsxs)(`p`,{children:[(0,q.jsxs)(`span`,{className:`text-[0.75rem]`,children:[` [`,Cn(Ge(e,t.finalSong)),`]`]}),` `,e.notes.map(e=>e.lyrics).join(``)]},e.start))]},n))})]})}const On={AF:`Afghanistan`,AX:`Åland Islands`,AL:`Albania`,DZ:`Algeria`,AS:`American Samoa`,AD:`Andorra`,AO:`Angola`,AI:`Anguilla`,AQ:`Antarctica`,AG:`Antigua and Barbuda`,AR:`Argentina`,AM:`Armenia`,AW:`Aruba`,AU:`Australia`,AT:`Austria`,AZ:`Azerbaijan`,BS:`Bahamas`,BH:`Bahrain`,BD:`Bangladesh`,BE:`Belgium`,BZ:`Belize`,BJ:`Benin`,BM:`Bermuda`,BT:`Bhutan`,BO:`Bolivia`,BA:`Bosnia and Herzegovina`,BW:`Botswana`,BV:`Bouvet Island`,BR:`Brazil`,IO:`British Indian Ocean Territory`,BN:`Brunei Darussalam`,BG:`Bulgaria`,BF:`Burkina Faso`,BI:`Burundi`,KH:`Cambodia`,CM:`Cameroon`,CA:`Canada`,CV:`Cape Verde`,KY:`Cayman Islands`,CF:`Central African Republic`,TD:`Chad`,CL:`Chile`,CN:`China`,CX:`Christmas Island`,CC:`Cocos (Keeling) Islands`,CO:`Colombia`,KM:`Comoros`,CG:`Congo`,CD:`Congo`,CK:`Cook Islands`,CR:`Costa Rica`,CI:`Cote D Ivoire`,HR:`Croatia`,CU:`Cuba`,CY:`Cyprus`,CZ:`Czech Republic`,DK:`Denmark`,DJ:`Djibouti`,DM:`Dominica`,DO:`Dominican Republic`,EC:`Ecuador`,EG:`Egypt`,SV:`El Salvador`,GQ:`Equatorial Guinea`,ER:`Eritrea`,EE:`Estonia`,ET:`Ethiopia`,FK:`Falkland Islands (Malvinas)`,FO:`Faroe Islands`,FJ:`Fiji`,FI:`Finland`,FR:`France`,GF:`French Guiana`,PF:`French Polynesia`,TF:`French Southern Territories`,GA:`Gabon`,GM:`Gambia`,GE:`Georgia`,DE:`Germany`,GH:`Ghana`,GI:`Gibraltar`,GR:`Greece`,GL:`Greenland`,GD:`Grenada`,GP:`Guadeloupe`,GU:`Guam`,GT:`Guatemala`,GG:`Guernsey`,GN:`Guinea`,GW:`Guinea-Bissau`,GY:`Guyana`,HT:`Haiti`,HM:`Heard Island and Mcdonald Islands`,VA:`Holy See (Vatican City State)`,HN:`Honduras`,HK:`Hong Kong`,HU:`Hungary`,IS:`Iceland`,IN:`India`,ID:`Indonesia`,IR:`Iran`,IQ:`Iraq`,IE:`Ireland`,IM:`Isle of Man`,IL:`Israel`,IT:`Italy`,JM:`Jamaica`,JP:`Japan`,JE:`Jersey`,JO:`Jordan`,KZ:`Kazakhstan`,KE:`Kenya`,KI:`Kiribati`,KP:`South Korea`,KR:`North Korea`,KW:`Kuwait`,KG:`Kyrgyzstan`,LA:`Lao People Democratic Republic`,LV:`Latvia`,LB:`Lebanon`,LS:`Lesotho`,LR:`Liberia`,LY:`Libyan Arab Jamahiriya`,LI:`Liechtenstein`,LT:`Lithuania`,LU:`Luxembourg`,MO:`Macao`,MK:`Macedonia`,MG:`Madagascar`,MW:`Malawi`,MY:`Malaysia`,MV:`Maldives`,ML:`Mali`,MT:`Malta`,MH:`Marshall Islands`,MQ:`Martinique`,MR:`Mauritania`,MU:`Mauritius`,YT:`Mayotte`,MX:`Mexico`,FM:`Micronesia`,MD:`Moldova`,MC:`Monaco`,MN:`Mongolia`,MS:`Montserrat`,MA:`Morocco`,MZ:`Mozambique`,MM:`Myanmar`,NA:`Namibia`,NR:`Nauru`,NP:`Nepal`,NL:`Netherlands`,AN:`Netherlands Antilles`,NC:`New Caledonia`,NZ:`New Zealand`,NI:`Nicaragua`,NE:`Niger`,NG:`Nigeria`,NU:`Niue`,NF:`Norfolk Island`,MP:`Northern Mariana Islands`,NO:`Norway`,OM:`Oman`,PK:`Pakistan`,PW:`Palau`,PS:`Palestinian Territory`,PA:`Panama`,PG:`Papua New Guinea`,PY:`Paraguay`,PE:`Peru`,PH:`Philippines`,PN:`Pitcairn`,PL:`Poland`,PT:`Portugal`,PR:`Puerto Rico`,QA:`Qatar`,RE:`Reunion`,RO:`Romania`,RU:`Russian Federation`,RW:`Rwanda`,SH:`Saint Helena`,KN:`Saint Kitts and Nevis`,LC:`Saint Lucia`,PM:`Saint Pierre and Miquelon`,VC:`Saint Vincent and the Grenadines`,WS:`Samoa`,SM:`San Marino`,ST:`Sao Tome and Principe`,SA:`Saudi Arabia`,SN:`Senegal`,CS:`Serbia and Montenegro`,SC:`Seychelles`,SL:`Sierra Leone`,SG:`Singapore`,SK:`Slovakia`,SI:`Slovenia`,SB:`Solomon Islands`,SO:`Somalia`,ZA:`South Africa`,GS:`South Georgia and the South Sandwich Islands`,ES:`Spain`,LK:`Sri Lanka`,SD:`Sudan`,SR:`Suriname`,SJ:`Svalbard and Jan Mayen`,SZ:`Swaziland`,SE:`Sweden`,CH:`Switzerland`,SY:`Syrian Arab Republic`,TW:`Taiwan`,TJ:`Tajikistan`,TZ:`Tanzania`,TH:`Thailand`,TL:`Timor-Leste`,TG:`Togo`,TK:`Tokelau`,TO:`Tonga`,TT:`Trinidad and Tobago`,TN:`Tunisia`,TR:`Turkey`,TM:`Turkmenistan`,TC:`Turks and Caicos Islands`,TV:`Tuvalu`,UG:`Uganda`,UA:`Ukraine`,AE:`United Arab Emirates`,GB:`United Kingdom`,US:`United States`,UY:`Uruguay`,UZ:`Uzbekistan`,VU:`Vanuatu`,VE:`Venezuela`,VN:`Vietnam`,VI:`Virgin Islands`,WF:`Wallis and Futuna`,EH:`Western Sahara`,YE:`Yemen`,ZM:`Zambia`,ZW:`Zimbabwe`},kn=10;function An({data:t,onChange:n,videoId:r,videoGap:i=0}){let a=(0,K.useRef)(null),o=(0,K.useRef)(null),[s,c]=(0,K.useState)(!1);(0,K.useEffect)(()=>{let e=setInterval(async()=>{if(!s)t.volume===0?(n({...t,volume:.7}),await a.current?.getInternalPlayer()?.setVolume(70)):await a.current?.getInternalPlayer()?.setVolume(t.volume*100),c(!0);else{let e=await a.current?.getInternalPlayer()?.getVolume();e!==void 0&&e!==t.volume*100&&n({...t,volume:e/100})}},500);return()=>{clearInterval(e)}},[s,t,n]);let[u,d]=(0,K.useState)(!1),[f,p]=(0,K.useState)(!1),m=async(e,r)=>{await a.current?.getInternalPlayer()?.setVolume(r*100),n({...t,volume:+r})},h=t.previewStart??i+60,g=t.previewEnd??h+30,[_,v]=(0,K.useState)(null);(0,K.useEffect)(()=>{o.current&&(o.current.currentTime=35),a.current?.getInternalPlayer()?.getDuration().then(v)},[]),(0,K.useEffect)(()=>{if(_!==null&&_<g){let e=Math.max(_-i-kn,0)/2,r=Math.max(i+e,0),a=Math.max(r+kn,_);n({...t,previewStart:r,previewEnd:a})}},[_,t,g,n,i]);let y=a.current?.getInternalPlayer();return(0,q.jsxs)(e,{sx:{display:`flex`,flexDirection:`column`,width:`100%`},gap:1,children:[(0,q.jsxs)(`h4`,{children:[`Set song preview (start: `,Sn(h*1e3,y),`, end:`,` `,Sn(g*1e3,y),`)`]}),(0,q.jsx)(e,{sx:{display:`flex`,gap:5},children:(0,q.jsx)(l,{"data-test":`song-preview`,disabled:_===null,step:1,value:[h,g],max:(_??500)-kn,onChange:(e,r)=>{let[i,a]=r;a-i>kn&&n({...t,previewStart:i,previewEnd:a})}})}),(0,q.jsx)(`h4`,{children:`Adjust volume`}),(0,q.jsxs)(e,{sx:{display:`flex`,gap:5},children:[(0,q.jsxs)(e,{sx:{display:`flex`,flexDirection:`column`,gap:1},children:[(0,q.jsx)(`h5`,{children:`Song`}),(0,q.jsx)(Xe,{videoId:r,ref:a,onPlay:()=>{d(!0),f&&(o.current?.pause(),setTimeout(()=>p(!0),200))},onPause:()=>{p(!1)}})]}),(0,q.jsxs)(e,{sx:{display:`flex`,flexDirection:`column`,gap:1},children:[(0,q.jsx)(`h5`,{children:`Reference sound`}),(0,q.jsx)(`p`,{children:`Use the slider below to make the video volume roughly the same as this music.`}),(0,q.jsx)(`br`,{}),(0,q.jsx)(`audio`,{ref:o,controls:!0,src:Ne,loop:!0,onLoad:e=>e.currentTarget.currentTime=35,onPlay:e=>{e.currentTarget.volume=.5,p(!0),u&&(a.current?.getInternalPlayer()?.pauseVideo(),setTimeout(()=>d(!0),200))},onPause:()=>{p(!1),u&&a.current?.getInternalPlayer()?.playVideo()}})]})]}),(0,q.jsxs)(`h5`,{children:[`Final Song Volume (`,t.volume*100,`)`]}),(0,q.jsx)(e,{children:(0,q.jsx)(l,{"data-test":`volume`,min:.1,max:1,step:.01,"aria-label":`Volume`,value:t.volume,onChange:m})})]})}const jn=e=>{let t=le(!0);return(0,K.useMemo)(()=>{let n=t.data.filter(t=>t.artist===e).map(e=>e.artistOrigin).filter(Boolean).reduce((e,t)=>(e[t]?e[t]++:e[t]=1,e),{});return Object.entries(n).sort((e,t)=>t[1]-e[1])?.[0]?.[0]??``},[e,t.data])};function Mn(e){let t=le(!0),r=jn(e.songArtist??``);(0,K.useEffect)(()=>{e.data.artistOrigin===void 0&&(console.log(`props.data.artistOrigin`,r),e.onChange({...e.data,artistOrigin:r}))},[r,e.data]);let i=(0,K.useMemo)(()=>[...new Set(t.data.map(({language:e})=>Array.isArray(e)?e:[e]).flat().filter(Boolean))],[t.data]),a=On,o=(0,K.useMemo)(()=>[...new Set(t.data.map(e=>e.genre).filter(Boolean).map(e=>e.toLowerCase().replace(/\b\w/g,e=>e.toUpperCase().trim())))],[t.data]),s=(0,K.useMemo)(()=>[...new Set(t.data.map(e=>e.edition).filter(Boolean).map(e=>e.toLowerCase().replace(/\b\w/g,e=>e.toUpperCase().trim())))].sort(),[t.data]),c=t=>{global.open(`https://www.google.com/search?q=${encodeURIComponent(`${e.data.artist} ${e.data.title} ${t}`)}`,`_blank`)},l=!!e.data.title&&!!e.data.artist,u=+(e.data?.realBpm??0)>200,[d,f]=(0,K.useState)(!1);return(0,q.jsxs)(n,{container:!0,spacing:2,"data-test":`song-metadata`,children:[(0,q.jsx)(n,{item:!0,xs:6,children:(0,q.jsx)(g,{value:e.data.artist,onChange:t=>e.onChange({...e.data,artist:t.target.value}),label:`Song artist`,size:`small`,"data-test":`song-artist`,required:!0,fullWidth:!0})}),(0,q.jsx)(n,{item:!0,xs:6,children:(0,q.jsx)(g,{value:e.data.title,onChange:t=>e.onChange({...e.data,title:t.target.value}),label:`Song title`,fullWidth:!0,size:`small`,required:!0,"data-test":`song-title`})}),(0,q.jsx)(n,{item:!0,xs:3,children:(0,q.jsx)(m,{onKeyDown:e=>{e.key===`Enter`&&e.preventDefault()},freeSolo:!0,disableClearable:!0,options:o,value:e.data.genre??``,onChange:(t,n)=>e.onChange({...e.data,genre:n}),renderInput:t=>(0,q.jsx)(g,{...t,onBlur:t=>e.onChange({...e.data,genre:t.target.value}),label:`Song genre (optional)`,size:`small`,"data-test":`song-genre`,fullWidth:!0})})}),(0,q.jsx)(n,{item:!0,xs:3,children:(0,q.jsx)(m,{onKeyDown:e=>{e.key===`Enter`&&e.preventDefault()},freeSolo:!0,disableClearable:!0,options:s,value:e.data.edition??``,onChange:(t,n)=>e.onChange({...e.data,edition:n}),renderInput:t=>(0,q.jsx)(g,{...t,onBlur:t=>e.onChange({...e.data,edition:t.target.value}),label:`Song edition (optional)`,size:`small`,"data-test":`song-edition`,helperText:`Songs with the same theme, e.g. 'Christmas'`,fullWidth:!0})})}),(0,q.jsx)(n,{item:!0,xs:3,children:(0,q.jsx)(m,{onKeyDown:e=>{e.key===`Enter`&&e.preventDefault()},multiple:!0,freeSolo:!0,disableClearable:!0,options:i,value:typeof e.data.language==`string`?[e.data.language]:e.data.language,onChange:(t,n)=>{e.onChange({...e.data,language:n?n.filter(Boolean):e.data.language})},renderInput:t=>(0,q.jsx)(g,{...t,label:`Song language`,fullWidth:!0,size:`small`,required:!e.data.language?.length,"data-test":`song-language`})})}),(0,q.jsx)(n,{item:!0,xs:3,children:(0,q.jsxs)(y,{fullWidth:!0,children:[(0,q.jsx)(b,{id:`song-origin-select-label`,size:`small`,children:`Song/artist origin (optional)`}),(0,q.jsxs)(_,{"data-test":`artist-origin`,size:`small`,labelId:`song-origin-select-label`,id:`song-origin-select`,value:e.data.artistOrigin??``,label:`Song/artist origin (optional)`,onChange:t=>e.onChange({...e.data,artistOrigin:t.target.value}),children:[(0,q.jsx)(w,{value:``,children:`None`},`none`),Object.entries(a).map(([e,t])=>(0,q.jsxs)(w,{value:e,children:[(0,q.jsx)(Nn,{isocode:e}),` `,t]},e))]}),(0,q.jsx)(v,{children:`Used to show the flag on the list`})]})}),(0,q.jsx)(n,{item:!0,xs:6,children:(0,q.jsx)(g,{"data-test":`release-year`,value:e.data.year,onChange:t=>e.onChange({...e.data,year:t.target.value}),label:`Release year`,helperText:`The year the song was released. Click the 'Lookup' button to look for it on Google`,fullWidth:!0,size:`small`,required:!0,...hn(()=>c(`release year`),l)})}),(0,q.jsx)(n,{item:!0,xs:6,children:(0,q.jsx)(g,{"data-test":`song-bpm`,value:e.data.realBpm,onChange:t=>e.onChange({...e.data,realBpm:t.target.value}),label:`Song (real) BPM`,focused:u?!0:void 0,helperText:u?(0,q.jsxs)(q.Fragment,{children:[`Usually songs don't have higher BPM than `,(0,q.jsx)(`b`,{children:`200`}),`. Make sure the value is correct (you can still save the song)`]}):`The actual tempo of the song. Click the 'Lookup' button to look for it on Google. ${d?`If you can't find it, you can still save the song`:``}`,color:u?`warning`:void 0,fullWidth:!0,type:`number`,size:`small`,required:!d,...hn(()=>{f(!0),c(`tempo`)},l)})}),(0,q.jsx)(n,{item:!0,xs:12}),(0,q.jsx)(n,{item:!0,xs:12,children:(0,q.jsx)(An,{...e})})]})}const Nn=V(ue,{target:`e70j9sv0`})({name:`3kqygp`,styles:`width:1em;margin-right:0.5em;display:inline-block`});var Pn=1,Fn=4;function In(e){return De(e,Pn|Fn)}var Ln=In;function Rn(e){return P(`MuiButtonGroup`,e)}const zn=N(`MuiButtonGroup`,`root.contained.outlined.text.disableElevation.disabled.firstButton.fullWidth.horizontal.vertical.colorPrimary.colorSecondary.grouped.groupedHorizontal.groupedVertical.groupedText.groupedTextHorizontal.groupedTextVertical.groupedTextPrimary.groupedTextSecondary.groupedOutlined.groupedOutlinedHorizontal.groupedOutlinedVertical.groupedOutlinedPrimary.groupedOutlinedSecondary.groupedContained.groupedContainedHorizontal.groupedContainedVertical.groupedContainedPrimary.groupedContainedSecondary.lastButton.middleButton`.split(`.`));var X=zn;const Bn=(e,t)=>{let{ownerState:n}=e;return[{[`& .${X.grouped}`]:t.grouped},{[`& .${X.grouped}`]:t[`grouped${M(n.orientation)}`]},{[`& .${X.grouped}`]:t[`grouped${M(n.variant)}`]},{[`& .${X.grouped}`]:t[`grouped${M(n.variant)}${M(n.orientation)}`]},{[`& .${X.grouped}`]:t[`grouped${M(n.variant)}${M(n.color)}`]},{[`& .${X.firstButton}`]:t.firstButton},{[`& .${X.lastButton}`]:t.lastButton},{[`& .${X.middleButton}`]:t.middleButton},t.root,t[n.variant],n.disableElevation===!0&&t.disableElevation,n.fullWidth&&t.fullWidth,n.orientation===`vertical`&&t.vertical]},Vn=e=>{let{classes:t,color:n,disabled:r,disableElevation:i,fullWidth:a,orientation:o,variant:s}=e,c={root:[`root`,s,o,a&&`fullWidth`,i&&`disableElevation`,`color${M(n)}`],grouped:[`grouped`,`grouped${M(o)}`,`grouped${M(s)}`,`grouped${M(s)}${M(o)}`,`grouped${M(s)}${M(n)}`,r&&`disabled`],firstButton:[`firstButton`],lastButton:[`lastButton`],middleButton:[`middleButton`]};return F(c,Rn,t)},Hn=L(`div`,{name:`MuiButtonGroup`,slot:`Root`,overridesResolver:Bn})(I(({theme:e})=>({display:`inline-flex`,borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{variant:`contained`},style:{boxShadow:(e.vars||e).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:`none`}},{props:{fullWidth:!0},style:{width:`100%`}},{props:{orientation:`vertical`},style:{flexDirection:`column`,[`& .${X.lastButton},& .${X.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${X.firstButton},& .${X.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:`horizontal`},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${X.lastButton},& .${X.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:`text`,orientation:`horizontal`},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderRight:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode===`light`?`rgba(0, 0, 0, 0.23)`:`rgba(255, 255, 255, 0.23)`}`,[`&.${X.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},{props:{variant:`text`,orientation:`vertical`},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderBottom:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode===`light`?`rgba(0, 0, 0, 0.23)`:`rgba(255, 255, 255, 0.23)`}`,[`&.${X.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},...Object.entries(e.palette).filter(ge()).flatMap(([t])=>[{props:{variant:`text`,color:t},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderColor:e.vars?`rgba(${e.vars.palette[t].mainChannel} / 0.5)`:R(e.palette[t].main,.5)}}}]),{props:{variant:`outlined`,orientation:`horizontal`},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderRightColor:`transparent`,"&:hover":{borderRightColor:`currentColor`}},[`& .${X.lastButton},& .${X.middleButton}`]:{marginLeft:-1}}},{props:{variant:`outlined`,orientation:`vertical`},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderBottomColor:`transparent`,"&:hover":{borderBottomColor:`currentColor`}},[`& .${X.lastButton},& .${X.middleButton}`]:{marginTop:-1}}},{props:{variant:`contained`,orientation:`horizontal`},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderRight:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${X.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},{props:{variant:`contained`,orientation:`vertical`},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderBottom:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${X.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},...Object.entries(e.palette).filter(ge([`dark`])).map(([t])=>({props:{variant:`contained`,color:t},style:{[`& .${X.firstButton},& .${X.middleButton}`]:{borderColor:(e.vars||e).palette[t].dark}}}))],[`& .${X.grouped}`]:{minWidth:40,boxShadow:`none`,props:{variant:`contained`},style:{"&:hover":{boxShadow:`none`}}}}))),Un=K.forwardRef(function(e,t){let n=j({props:e,name:`MuiButtonGroup`}),{children:r,className:i,color:a=`primary`,component:o=`div`,disabled:s=!1,disableElevation:c=!1,disableFocusRipple:l=!1,disableRipple:u=!1,fullWidth:d=!1,orientation:f=`horizontal`,size:p=`medium`,variant:m=`outlined`,...h}=n,g={...n,color:a,component:o,disabled:s,disableElevation:c,disableFocusRipple:l,disableRipple:u,fullWidth:d,orientation:f,size:p,variant:m},_=Vn(g),v=K.useMemo(()=>({className:_.grouped,color:a,disabled:s,disableElevation:c,disableFocusRipple:l,disableRipple:u,fullWidth:d,size:p,variant:m}),[a,s,c,l,u,d,p,m,_.grouped]),y=ot(r),b=y.length,x=e=>{let t=e===0,n=e===b-1;return t&&n?``:t?_.firstButton:n?_.lastButton:_.middleButton};return(0,q.jsx)(Hn,{as:o,role:`group`,className:z(_.root,i),ref:t,ownerState:g,...h,children:(0,q.jsx)(at.Provider,{value:v,children:y.map((e,t)=>(0,q.jsx)(it.Provider,{value:x(t),children:e},t))})})});var Z=Un;function Q({shortcutKey:e,children:n}){let r=p(e=>e.breakpoints.down(`sm`));return r?n:(0,q.jsx)(t,{disableInteractive:!0,title:`${e}`,placement:`bottom-end`,open:!0,slotProps:{popper:{modifiers:[{name:`offset`,options:{offset:[5,-20]}}]}},children:n})}function Wn({player:t,currentTime:n,playbackSpeed:r,setPlaybackSpeed:i}){let a=e=>t.seekTo((n+e)/1e3);return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(e,{children:[(0,q.jsxs)(W,{"data-test":`current-time`,children:[`Current time: `,Cn(n),` (`,(0,q.jsx)(mn,{children:Math.round(n)}),` ms)`]}),(0,q.jsxs)(e,{sx:{display:`flex`,gap:1},children:[(0,q.jsxs)(Z,{variant:`contained`,sx:{display:`flex`,mt:1,flex:1},children:[(0,q.jsx)(G,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(-1e4),"data-test":`seek-10s`,children:`-10`}),(0,q.jsx)(G,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(-5e3),"data-test":`seek-5s`,children:`-5`}),(0,q.jsx)(G,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(-1e3),"data-test":`seek-1s`,children:`-1`}),(0,q.jsx)(G,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(-500),"data-test":`seek-0.5s`,children:`-0.5`})]}),(0,q.jsx)(D,{}),(0,q.jsxs)(Z,{variant:`contained`,sx:{display:`flex`,mt:1,flex:1},children:[(0,q.jsx)(G,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(500),"data-test":`seek+0.5s`,children:`+0.5`}),(0,q.jsx)(G,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(1e3),"data-test":`seek+1s`,children:`+1`}),(0,q.jsx)(G,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(5e3),"data-test":`seek+5s`,children:`+5`}),(0,q.jsx)(G,{size:`small`,sx:{flex:1,px:1},onClick:()=>a(1e4),"data-test":`seek+10s`,children:`+10`})]})]})]}),(0,q.jsxs)(e,{children:[(0,q.jsxs)(W,{children:[`Playback speed: `,(0,q.jsxs)(mn,{"data-test":`current-speed`,children:[r*100,`%`]})]}),(0,q.jsx)(Q,{shortcutKey:`1/2/3/4`,children:(0,q.jsx)(Z,{variant:`contained`,sx:{display:`flex`,mt:1},children:[.25,.5,.75,1,1.25,1.5,2].map(e=>(0,q.jsxs)(G,{size:`small`,"data-test":`speed-${e}`,sx:{flex:1},onClick:()=>{i(e)},disabled:r===e,children:[e*100,`%`]},e))})})]})]})}function Gn(e,t){let n=Math.floor(t);return(0,K.useMemo)(()=>e.findIndex((t,r)=>n<0?!0:n<t.start?!1:r===e.length-1||e[r+1].start>n),[n,e])}function Kn({song:t,currentTime:n,beatLength:r,player:i,onRecordChange:a,onLyricChange:o,playbackSpeed:s,onTrackNameChange:c,lyricChanges:l}){let[d,f]=(0,K.useState)(0),[p,m]=(0,K.useState)(-1),[h,_]=(0,K.useState)([]),v=qe(n,r,t.gap),y=t.tracks[d].sections.filter(U),b=Gn(y,v),x=e=>{m(e),Re.resetPlayerNotes();let n=Ge(y[e],t);i.seekTo(n/1e3-.8*s)},S=()=>{_(e=>[...e,{type:`delete`,section:p,track:d}]),p===y.length-1&&m(e=>e-1)},w=e=>{_(t=>{let n=t.at(-1);if(n&&n.type===`shift`&&n.track===d&&n.section===p){let n=[...t];return n.at(-1).shift=e,n}return[...t,{type:`shift`,section:p,track:d,shift:e}]})};return(0,K.useEffect)(()=>{a(h)},[a,h]),(0,q.jsxs)(Zn,{children:[(0,q.jsxs)(C,{direction:`row`,children:[(0,q.jsxs)(W,{variant:`h6`,mb:0,sx:{flex:1,display:`flex`,alignItems:`center`},children:[`Edit verses`,t.tracks.length>1&&(0,q.jsx)(Z,{variant:`contained`,sx:{ml:2},size:`small`,children:t.tracks.map((e,t)=>(0,q.jsxs)(G,{onClick:()=>f(t),disabled:d===t,"data-test":`track-${t+1}`,children:[`Track `,t+1]},t))})]}),(0,q.jsx)(g,{label:`Track name`,placeholder:`Set track name`,sx:{flex:1},size:`small`,value:t.tracks[d]?.name??``,onChange:e=>c(d,e.target.value),"data-test":`track-name`})]}),(0,q.jsxs)(C,{direction:`row`,spacing:2,sx:{height:`400px`,mt:3},children:[(0,q.jsx)(O,{sx:{overflowY:`auto`},children:y.map((e,t)=>(0,q.jsx)(u,{disablePadding:!0,"data-test":`section-${t}`,sx:{maxWidth:250,overflowX:`hidden`,textWrap:`ellipsis`,whiteSpace:`nowrap`},children:(0,q.jsx)(vt,{onClick:()=>x(t),selected:p===t,children:(0,q.jsx)(pt,{primaryTypographyProps:{fontWeight:t===b?`bold`:`normal`},primary:U(e)?e.notes.map(e=>e.lyrics.replaceAll(` `,`·`)).join(``):`[pause]`})})},e.start))}),(0,q.jsx)(Qn,{children:p>-1&&(0,q.jsxs)(q.Fragment,{children:[p===0&&(0,q.jsx)(`h3`,{"data-test":`use-gap-info`,children:`Use gap shift to change when this section starts`}),p>0&&(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(g,{"data-test":`change-start-beat`,size:`small`,type:`number`,onChange:e=>w(+e.target.value),value:Be([y[p]]),label:`Change start beat`,InputProps:{inputProps:{step:1}},fullWidth:!0,sx:{mb:2},helperText:(0,q.jsxs)(q.Fragment,{children:[`Timestamp:`,` `,Sn(Be([y[p]])*r+t.gap,i)]})})}),(0,q.jsx)($n,{children:y[p].notes.map((e,t)=>{let n=l[d]?.[p]?.[t]??e.lyrics;return(0,q.jsx)(er,{style:{width:`${n.length}ch`},value:n,"data-test":`lyric-input-${t}`,onChange:e=>{o({section:p,track:d,noteIndex:t,newLyric:e.target.value})},onKeyDown:e=>{let t=e.target.selectionStart;if(e.key===`ArrowLeft`&&t===0){let t=e.target?.previousElementSibling;t&&(t.focus(),setTimeout(()=>t.setSelectionRange(t.value.length,t.value.length),10))}else if(e.key===`ArrowRight`&&t===e.target.value.length){let t=e.target?.nextElementSibling;t&&(t.focus(),setTimeout(()=>t.setSelectionRange(0,0),10))}}},t)})}),(0,q.jsx)(G,{variant:`contained`,color:`error`,onClick:S,fullWidth:!0,"data-test":`delete-section`,children:`Delete section`})]})}),(0,q.jsxs)(qn,{children:[(0,q.jsx)(e,{sx:{overflowY:`auto`,maxHeight:`34rem`},"data-test":`change-list`,children:h.map((e,t)=>{let n=``,r=Yn;return e.type===`delete`?(r=Yn,n=`Deleted`):e.type===`shift`&&(r=Xn,n=`Start -> ${e.shift}`),(0,q.jsx)(r,{children:(0,q.jsxs)(`strong`,{children:[`Track: `,e.track+1,`, Section: `,e.section+1,`, `,n]})},t)})}),h.length>0&&(0,q.jsx)(G,{"data-test":`undo-change`,variant:`contained`,color:`warning`,onClick:()=>_(e=>e.filter((t,n)=>n!==e.length-1)),fullWidth:!0,children:`Undo last change`})]})]})]})}const qn=V(`div`,{target:`e18sxv6t7`})({name:`82a6rk`,styles:`flex:1`}),Jn=V(`div`,{target:`e18sxv6t6`})({name:`m1a2da`,styles:`padding:0.5rem`}),Yn=V(Jn,{target:`e18sxv6t5`})({name:`hwfcu5`,styles:`color:red`}),Xn=V(Jn,{target:`e18sxv6t4`})({name:`zzs6wi`,styles:`color:#0059ff`}),Zn=V(`div`,{target:`e18sxv6t3`})(``),Qn=V(`div`,{target:`e18sxv6t2`})({name:`82a6rk`,styles:`flex:1`}),$n=V(`div`,{target:`e18sxv6t1`})({name:`1qhi3cl`,styles:`display:flex;gap:0.25rem;column-gap:0;margin-bottom:1rem;align-items:center;flex-wrap:wrap`}),er=V(`input`,{target:`e18sxv6t0`})({name:`1bv0k4z`,styles:`font-family:monospace;background:#f6f6f6;width:3rem;padding:0.5rem 0.1rem;border:0;border-right:1px solid #ececec;text-decoration:underline;box-sizing:content-box;&:focus{background:#ececec;outline:none!important;}`});function tr(e,t){let n=t.tracks[0].sections.filter(U),r=n.at(-1)?.notes.at(-1),i=e-t.gap,a=r.start+r.length;return Number((6e4/(i/a*t.bar)).toFixed(2))}function nr({current:e,onChange:t,song:n}){let r=Math.max(...n.tracks.map(e=>Ve(e.sections))),i=ne(r,n)+n.gap,[a,o]=(0,K.useState)(Math.round(i));return(0,q.jsxs)(`div`,{className:`mb-2 flex items-start gap-2`,children:[(0,q.jsx)(g,{"data-test":`desired-end`,size:`small`,type:`number`,value:a,onChange:e=>o(+e.target.value),label:`Target last note end time (ms)`,sx:{flex:1},helperText:a?(0,q.jsxs)(q.Fragment,{children:[`Estimated proper Tempo (BPM) of the lyrics:`,` `,(0,q.jsx)(mn,{"data-test":`desired-bpm`,children:tr(a,n)})]}):` `}),(0,q.jsxs)(`div`,{className:`flex flex-1`,children:[(0,q.jsx)(Q,{shortcutKey:`z`,children:(0,q.jsx)(G,{sx:{minWidth:`40px`,width:`40px`},variant:`contained`,size:`small`,onClick:()=>t(e-.1),children:`-`})}),(0,q.jsx)(g,{"data-test":`change-bpm`,size:`small`,type:`number`,value:e,onChange:e=>!isNaN(+e.target.value)&&t(+e.target.value),label:`Tempo (BPM) of the lyrics`,sx:{flex:1},InputProps:{inputProps:{step:`0.1`}}}),(0,q.jsx)(Q,{shortcutKey:`w`,children:(0,q.jsx)(G,{variant:`contained`,size:`small`,sx:{minWidth:`40px`,width:`40px`},onClick:()=>t(e+.1),children:`+`})})]})]})}function rr({current:t,onChange:n,player:r,finalGap:i}){let a=e=>{let r=String(Number(t)+e);n(r)};return(0,q.jsxs)(e,{flex:`1`,children:[(0,q.jsxs)(W,{children:[`Lyrics Gap shift (final: `,Sn(i,r),`)`]}),(0,q.jsxs)(`div`,{className:`mt-1 flex gap-1`,children:[(0,q.jsxs)(Z,{sx:{flex:1},children:[(0,q.jsx)(G,{sx:{flex:1,px:1},onClick:()=>a(-1e3),"data-test":`shift-gap-1s`,children:`-1000`}),(0,q.jsx)(G,{sx:{flex:1,px:1},onClick:()=>a(-500),"data-test":`shift-gap-0.5s`,children:`-500`}),(0,q.jsx)(Q,{shortcutKey:`a`,children:(0,q.jsx)(G,{sx:{flex:1,px:1},onClick:()=>a(-50),"data-test":`shift-gap-0.05s`,children:`-50`})})]}),(0,q.jsx)(g,{sx:{py:0,flex:1},size:`small`,type:`text`,value:t,onChange:e=>n(e.target.value),label:`Miliseconds`,"data-test":`shift-gap`}),(0,q.jsxs)(Z,{sx:{flex:1},children:[(0,q.jsx)(Q,{shortcutKey:`s`,children:(0,q.jsx)(G,{sx:{flex:1,px:1},onClick:()=>a(50),"data-test":`shift-gap+0.05s`,children:`+50`})}),(0,q.jsx)(G,{sx:{flex:1,px:1},onClick:()=>a(500),"data-test":`shift-gap+0.5s`,children:`+500`}),(0,q.jsx)(G,{sx:{flex:1,px:1},onClick:()=>a(1e3),"data-test":`shift-gap+1s`,children:`+1000`})]})]})]})}function ir({current:t,onChange:n,player:r,finalGap:i}){return(0,q.jsxs)(e,{flex:`1`,children:[(0,q.jsxs)(W,{children:[`Video Gap shift (final: `,Sn((i??0)*1e3,r),`)`]}),(0,q.jsxs)(e,{sx:{display:`flex`,gap:1,mt:1},children:[(0,q.jsxs)(Z,{sx:{flex:1},children:[(0,q.jsx)(G,{sx:{flex:1,px:1.25},onClick:()=>n(t-10),"data-test":`shift-video-gap-10s`,children:`-10`}),(0,q.jsx)(G,{sx:{flex:1,px:1.25},onClick:()=>n(t-5),"data-test":`shift-video-gap-5s`,children:`-5`}),(0,q.jsx)(G,{sx:{flex:1,px:1.25},onClick:()=>n(t-1),"data-test":`shift-video-gap-1s`,children:`-1`})]}),(0,q.jsx)(g,{"data-test":`shift-video-gap`,sx:{py:0,flex:1},size:`small`,type:`text`,value:t,onChange:e=>n(+e.target.value),label:`Seconds`}),(0,q.jsxs)(Z,{sx:{flex:1},children:[(0,q.jsx)(G,{sx:{flex:1,px:1.25},onClick:()=>n(t+1),"data-test":`shift-video-gap+1s`,children:`+1`}),(0,q.jsx)(G,{sx:{flex:1,px:1.25},onClick:()=>n(t+5),"data-test":`shift-video-gap+5s`,children:`+5`}),(0,q.jsx)(G,{sx:{flex:1,px:1.25},onClick:()=>n(t+10),"data-test":`shift-video-gap+10s`,children:`+10`})]})]})]})}const ar=(e,t)=>({...e,gap:e.gap+t}),or=(e,t)=>({...e,videoGap:(e.videoGap??0)+t}),sr=(e,t)=>({...e,bpm:t}),cr=(e,t)=>({...e,tracks:e.tracks.map((e,n)=>{let r=t.filter(e=>e.track===n),i=[...e.sections].filter(U);return r.forEach(e=>{if(e.type===`delete`)i=i.filter((t,n)=>n!==e.section);else if(e.type===`shift`){let t=e.shift-Be([i[e.section]]);i=i.map((n,r)=>r<e.section?n:{...n,notes:n.notes.map(e=>({...e,start:e.start+t}))})}}),{...e,sections:i}})}),lr=(e,t)=>({...e,tracks:e.tracks.map((e,n)=>({...e,name:t[n]??e.name}))}),ur=(e,t)=>({...e,tracks:e.tracks.map((e,n)=>{let r=t[n]??{};return{...e,sections:e.sections.map((e,t)=>{let n=r[t]??{};return U(e)?{...e,notes:e.notes.map((e,t)=>({...e,lyrics:n[t]??e.lyrics}))}:e})}})});function dr({song:t,onUpdate:r,visible:i}){let a=(0,K.useRef)(null),[o,s]=(0,K.useState)(0),[c,l]=(0,K.useState)(1),{width:u}=Ee(),d=Math.min(u-16,824),f=d/16*9,[p,m]=(0,K.useState)(`0`),[h,g]=(0,K.useState)(0),[_,v]=(0,K.useState)(t.bpm),[y,b]=(0,K.useState)([]),[x,S]=(0,K.useState)(t.tracks.map(e=>e.name??void 0)),[C,w]=(0,K.useState)({}),T=(0,K.useMemo)(()=>{let e=Ln(t);return e=te(e),e=re(e),e=ie(e),isNaN(Number(p))||(e=ar(e,Number(p))),e=or(e,h),e=sr(e,_),e=cr(e,y),e=lr(e,x),e=ur(e,C),e=ie(e),e=ee(e),e},[p,h,t,_,y,x,C]);(0,K.useEffect)(()=>{r?.(T)},[r,T]);let E=(0,K.useMemo)(()=>({id:`test`,mode:Je.DUEL,players:[{number:0,track:0},{number:1,track:t.tracks.length-1}],tolerance:6}),[t]),D=Ke(T);(0,K.useEffect)(()=>{i||a.current?.pause()},[i]),(0,K.useEffect)(()=>{a.current?.setPlaybackSpeed(c)},[c]);let O=(e,t=.5*c)=>{e&&a.current&&(a.current.seekTo((e.start*D+T.gap)/1e3-t),a.current.play())},k=e=>{let t=ze(T.tracks[0].sections);O(t,e)},ne=async(e,t)=>{if(!a.current)return;let n=qe(await a.current.getCurrentTime(),D,T.gap),r=T.tracks[0].sections.filter(U),i=r.findIndex(e=>We(e)<=n&&Ue(e)>=n);i===-1||r[i+e]===void 0||O(r[i+e].notes[0],t)},ae=e=>{ne(1,e)},oe=e=>{ne(-1,e)},se=e=>{let t=He(T.tracks[0].sections)?.notes[0];O(t,e)};return B(`1`,()=>{l(.25)},[T,l]),B(`2`,()=>{l(.5)},[T,l]),B(`3`,()=>{l(1)},[T,l]),B(`4`,()=>{l(2)},[T,l]),B(`q`,()=>{k()},[T,k]),B(`w`,()=>{oe()},[T,oe]),B(`e`,()=>{ae()},[T,ae]),B(`r`,()=>{se()},[T]),B(`a`,()=>{m(e=>String(Number(e)-50))}),B(`s`,()=>{m(e=>String(Number(e)+50))}),B(`z`,()=>{v(e=>e-.1)}),B(`x`,()=>{v(e=>e+.1)}),(0,q.jsxs)(n,{container:!0,spacing:2,sx:{display:i?void 0:`none`},children:[(0,q.jsx)(n,{item:!0,xs:12,sm:8,"data-test":`player-container`,children:(0,q.jsx)(e,{sx:{width:d,height:f},children:(0,q.jsx)(xe,{song:T,showControls:!0,autoplay:!1,width:d,height:f,ref:a,onCurrentTimeUpdate:s,effectsEnabled:!1,singSetup:E,onSongEnd:()=>void 0},0)})}),(0,q.jsxs)(n,{item:!0,xs:12,sm:4,sx:{display:`flex`,flexDirection:`column`,gap:2},children:[a.current&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Wn,{player:a.current,currentTime:o,playbackSpeed:c,setPlaybackSpeed:l}),(0,q.jsxs)(`div`,{className:`flex justify-between`,children:[(0,q.jsx)(Q,{shortcutKey:`q`,children:(0,q.jsx)(G,{variant:`outlined`,size:`small`,onClick:()=>k(),children:`First section`})}),(0,q.jsx)(Q,{shortcutKey:`w`,children:(0,q.jsx)(G,{variant:`outlined`,size:`small`,onClick:()=>oe(),children:`Prev`})}),(0,q.jsx)(Q,{shortcutKey:`e`,children:(0,q.jsx)(G,{variant:`outlined`,size:`small`,onClick:()=>ae(),children:`Next`})}),(0,q.jsx)(Q,{shortcutKey:`r`,children:(0,q.jsx)(G,{variant:`outlined`,size:`small`,onClick:()=>se(),children:`Last section`})})]})]}),!a.current&&(0,q.jsx)(`h2`,{children:`Start the song to see the manipulation form`})]}),a.current&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(n,{item:!0,xs:12,sm:8,children:(0,q.jsxs)(`div`,{className:`flex flex-1 flex-col gap-5 sm:flex-row`,children:[(0,q.jsx)(ir,{player:a.current,onChange:e=>{let t=e-h;g(e),m(e=>isNaN(Number(e))?e:String(Number(e)+t*1e3))},current:h,finalGap:T.videoGap}),(0,q.jsx)(rr,{player:a.current,onChange:m,current:p,finalGap:T.gap})]})}),(0,q.jsxs)(n,{item:!0,xs:0,sm:4,className:`hidden sm:block`,children:[(0,q.jsxs)(`div`,{className:`mb-2 text-xs`,children:[`Use `,(0,q.jsx)(`strong`,{children:`Video shift gap`}),` to crop the beginning of the video if it starts with an intro.`]}),(0,q.jsxs)(`div`,{className:`mb-2 text-xs`,children:[`Use `,(0,q.jsx)(`strong`,{children:`Lyrics shift gap`}),` to sync the start of the lyrics to the video. You can lower the`,` `,(0,q.jsx)(`strong`,{children:`Playback speed`}),` above to make sure you got it just right.`,` `]})]}),(0,q.jsxs)(n,{item:!0,xs:12,sm:8,children:[(0,q.jsx)(W,{variant:`h5`,mb:2,children:`Advanced`}),(0,q.jsx)(nr,{onChange:v,current:_,song:T},T.gap)]}),(0,q.jsxs)(n,{item:!0,xs:0,sm:4,className:`hidden sm:block`,children:[(0,q.jsx)(`div`,{className:`mb-2 text-xs`,children:`If the lyrics desynchronise over time, probably the tempo (BPM) of the lyrics is wrong.`}),(0,q.jsxs)(`div`,{className:`mb-2 text-xs`,children:[`You can either use `,(0,q.jsx)(`strong`,{children:`Last note end time`}),` - enter the millisecond when the last note should end (seek through the video for the moment as `,(0,q.jsx)(`strong`,{children:`Current time`}),` panel show the exact millisecond) and a suggested BPM value will appear below.`]}),(0,q.jsxs)(`div`,{className:`mb-2 text-xs`,children:[(0,q.jsx)(`strong`,{children:`Tempo (BPM)`}),` field allows to fine-tune the tempo.`]})]}),(0,q.jsx)(n,{item:!0,xs:12,sm:8,children:(0,q.jsx)(Kn,{playbackSpeed:c,song:T,currentTime:o,beatLength:D,player:a.current,onRecordChange:b,onTrackNameChange:(e,t)=>S(n=>{let r=[...n];return r[e]=t===``?void 0:t,r}),lyricChanges:C,onLyricChange:e=>w(t=>({...t,[e.track]:{...t[e.track],[e.section]:{...t[e.track]?.[e.section],[e.noteIndex]:e.newLyric}}}))})}),(0,q.jsxs)(n,{item:!0,xs:0,sm:4,className:`hidden sm:block`,children:[(0,q.jsxs)(`div`,{className:`mb-2 text-xs`,children:[`If the lyrics there are more lyrics than in the video or there are longer/shorter interludes between verses, you can `,(0,q.jsx)(`strong`,{children:`Edit verses`}),`.`]}),(0,q.jsx)(`div`,{className:`mb-2 text-xs`,children:`Select a verse by clicking on it.`}),(0,q.jsxs)(`div`,{className:`mb-2 text-xs`,children:[`You can either `,(0,q.jsx)(`strong`,{children:`Change its start beat`}),` (which will "move in time" the verse and all subsequent ones) or `,(0,q.jsx)(`strong`,{children:`Delete it`}),` (it won't affect the timing of other verses). You can also edit the lyrics of each note.`]}),(0,q.jsxs)(`div`,{className:`mb-2 text-xs`,children:[(0,q.jsx)(`strong`,{children:`List of changes`}),` on the right allows you to see and undo the actions one by one.`]})]})]})]})}function fr(t){return(0,q.jsx)(e,{"data-test":`sync-lyrics`,children:t.data&&t.data.video.length<15&&!!t.data.tracks?.[0]?.sections?.length&&(0,q.jsx)(dr,{song:t.data,onUpdate:t.onChange,visible:t.visible})})}function pr(e){return Array.isArray(e)?e.length===0:!e}const $=[`basic-data`,`author-and-video`,`sync`,`metadata`];function mr({song:e}){let t=!!e,{data:r}=le(!0);we(!1);let i=pe();ce(!1);let a=Se(`step`),[o,l]=(0,K.useState)(Math.max(0,$.indexOf(a))),[u,d]=(0,K.useState)(!1),f=Se(`redirect`);(0,K.useEffect)(()=>{$[o]&&pn({step:$[o]})},[o]);let[p,m]=(0,K.useState)({sourceUrl:e?.sourceUrl??``,txtInput:``}),[h,g]=(0,K.useState)({author:e?.author??``,authorUrl:e?.authorUrl??``,video:e?.video?`https://www.youtube.com/watch?v=${e.video}`:``}),[_,v]=(0,K.useState)({artist:e?.artist??``,title:e?.title??``,realBpm:e?.realBpm?String(e.realBpm):``,year:e?.year??``,language:e?.language??[],volume:e?.volume??70,previewStart:e?.previewStart??void 0,previewEnd:e?.previewEnd??void 0,genre:e?.genre,edition:e?.edition,artistOrigin:e?.artistOrigin}),[y,b]=(0,K.useState)(e),x=(0,K.useMemo)(()=>{try{if(t)return{...e,video:Ie(h.video)||e.video,author:h.author,authorUrl:h.authorUrl,sourceUrl:p.sourceUrl};if(!p.txtInput)return;let n=Fe(p.txtInput,h.video,h.author,h.authorUrl,p.sourceUrl);return n}catch(e){console.error(e)}},[p.txtInput,h.video,h.author,h.authorUrl,p.sourceUrl,e,t]),S=(0,K.useMemo)(()=>!t&&x&&r?.find(e=>H.generateSongFile(e)===H.generateSongFile(x)),[r,x,t]);(0,K.useEffect)(()=>{x&&(x.video&&!h.video&&g(e=>({...e,video:`https://www.youtube.com/watch?v=${x.video}`})),x.author&&!h.author&&g(e=>({...e,author:e.author||x?.author||``,authorUrl:e.authorUrl||x?.authorUrl||``})),x.sourceUrl&&!p.sourceUrl&&m(e=>({...e,sourceUrl:x.sourceUrl})),[`year`,`language`,`realBpm`,`genre`,`artist`,`title`,`volume`,`previewStart`,`previewEnd`,`artistOrigin`].forEach(e=>{x[e]&&pr(_[e])&&v(t=>({...t,[e]:x[e]}))}))},[x,_.year,_.language,_.realBpm,_.genre,_.artist,_.volume,_.title,_.previewStart,_.previewEnd,p.sourceUrl,h.video]);let C=!!p.txtInput||t,w=!!h.video,T=$[o]===`author-and-video`?w:!0,E={...y,..._,author:h.author,authorUrl:h.authorUrl,realBpm:+_.realBpm,sourceUrl:p.sourceUrl,id:Le(_)},D=async()=>{d(!0),await H.store(E),f?($e(E.id),i(f)):(await $e(E.id),i(`edit/list/`,{id:E.id,created:t?null:`true`,song:null})),d(!1)},O=()=>{o<$.length-1?l(e=>e+1):$[o]===`metadata`&&D()};B(`shift+enter`,()=>{O()},[O]);let k=$.at(o)===`metadata`;return(0,q.jsxs)(lt,{injectFirst:!0,children:[(0,q.jsx)(Ce,{}),(0,q.jsxs)(n,{container:!0,gap:2,p:1,pb:10,children:[(0,q.jsx)(n,{item:!0,xs:12,children:!t&&(0,q.jsx)(`div`,{style:{marginBottom:`1rem`},children:(0,q.jsx)(A,{to:`menu/`,children:(0,q.jsx)(`a`,{children:`Return to the main menu`})})})}),(0,q.jsx)(n,{item:!0,xs:12,children:(0,q.jsxs)(fn,{activeStep:o,sx:{mb:2},nonLinear:t,children:[(0,q.jsx)(Et,{completed:C,children:(0,q.jsx)($t,{color:`inherit`,onClick:()=>l(0),children:`Basic Info`})},0),(0,q.jsx)(Et,{completed:w,children:(0,q.jsx)($t,{color:`inherit`,onClick:()=>l(1),children:`Author and video data`})},1),(0,q.jsx)(Et,{children:(0,q.jsx)($t,{color:`inherit`,onClick:()=>l(2),children:`Sync lyrics to video`})},2),(0,q.jsx)(Et,{children:(0,q.jsx)($t,{color:`inherit`,onClick:()=>l(3),children:`Fill song metadata`})},3)]})}),(0,q.jsx)(n,{item:!0,xs:12,children:(0,q.jsxs)(`form`,{onSubmit:async e=>{e.preventDefault(),O()},children:[$.at(o)===`basic-data`&&(0,q.jsx)(Dn,{shouldAutoImport:!w,isTxtRequired:!e,onAutoImport:g,onChange:m,data:p,finalSong:E}),$.at(o)===`author-and-video`&&(0,q.jsx)(gn,{songArtist:x?.artist,songTitle:x?.title,onChange:g,data:h}),x&&(0,q.jsx)(fr,{onChange:b,data:x,visible:$.at(o)===`sync`}),$.at(o)===`metadata`&&(0,q.jsx)(Mn,{videoGap:y?.videoGap,onChange:v,data:_,songArtist:x?.artist,videoId:x?.video??``}),S&&(0,q.jsxs)(c,{severity:`warning`,"data-test":`possible-duplicate`,children:[(0,q.jsx)(s,{children:`Possible duplicate`}),`There is already a song with similar artist and/or name:`,` `,(0,q.jsxs)(`b`,{children:[S.artist,` - `,S.title]})]}),(0,q.jsxs)(oe,{sx:{position:`fixed`,bottom:0,left:`50%`,maxWidth:`1260px`,width:`100%`,padding:1,transform:`translateX(-50%)`,display:`flex`,gap:2,justifyContent:`space-between`},elevation:3,children:[f&&(0,q.jsx)(G,{disabled:u,sx:{align:`right`},onClick:async()=>{d(!0),await H.store(E),d(!1),i(f)},children:`Skip`}),(0,q.jsxs)(`div`,{className:`flex items-end`,children:[(0,q.jsx)(G,{"data-test":`previous-button`,sx:{align:`right`},onClick:()=>l(e=>e-1),disabled:o===0,children:`Previous`}),k?(0,q.jsx)(G,{"data-test":`save-button`,sx:{align:`right`},type:`submit`,variant:`contained`,disabled:u,children:u?`Saving...`:`Save`}):(0,q.jsx)(G,{"data-test":`next-button`,sx:{align:`right`},variant:`contained`,type:`submit`,disabled:u||!T||o===$.length-1,children:`Next`})]})]})]})})]})]})}var hr=ve((0,q.jsx)(`path`,{d:`M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z`}),`Download`),gr=ve((0,q.jsx)(`path`,{d:`M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3`}),`Visibility`);function _r(){we(!1),ce(!1);let{data:e,reload:t}=le(!0),[r,i]=et(null),s=Se(`created`),c=Se(`id`);return e?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(se,{children:(0,q.jsx)(`title`,{children:`Song List | AllKaraoke.Party - Free Online Karaoke Party Game`})}),(0,q.jsx)(Ze,{children:(0,q.jsxs)(vr,{children:[s&&(0,q.jsx)(Qe,{id:c}),(0,q.jsx)(Ce,{}),(0,q.jsxs)(n,{container:!0,rowGap:2,children:[(0,q.jsx)(n,{item:!0,xs:3,display:`flex`,alignItems:`center`,justifyContent:`flex-start`,children:(0,q.jsx)(A,{to:`menu/`,children:(0,q.jsx)(G,{"data-test":`main-menu-link`,children:`Return to main menu`})})}),(0,q.jsx)(n,{item:!0,xs:6,display:`flex`,alignItems:`center`,justifyContent:`center`,children:(0,q.jsxs)(`h4`,{children:[(0,q.jsx)(`span`,{onClick:()=>{window.__exposeSingletons(),window.__singletons.importSongs()},children:e.length}),` `,(0,q.jsx)(A,{to:`edit/redirect-to-first-local-song`,children:(0,q.jsx)(`span`,{children:`songs`})})]})}),(0,q.jsx)(n,{item:!0,xs:3,display:`flex`,alignItems:`center`,justifyContent:`flex-end`,children:(0,q.jsx)(A,{to:`convert/`,children:(0,q.jsx)(G,{"data-test":`convert-song`,variant:`contained`,children:`Import UltraStar .TXT`})})}),(0,q.jsx)(n,{item:!0,xs:12,children:(0,q.jsx)(a,{globalFilter:c,data:e,renderRowActions:({row:n})=>(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(A,{to:fe(`edit/song/`,{song:n.original.id,id:null}),children:(0,q.jsx)(me,{title:`Edit the song`,"data-test":`edit-song`,"data-song":n.original.id,children:(0,q.jsx)(S,{})})}),(0,q.jsx)(me,{title:`Download .txt file`,onClick:async()=>{let e=await H.get(n.original.id),t=tt(e),r=document.createElement(`a`);r.href=`data:plain/text;charset=utf-8,${encodeURIComponent(t)}`,r.download=`${H.generateSongFile(e)}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r)},"data-test":`download-song`,"data-song":n.original.id,children:(0,q.jsx)(hr,{})}),!n.original.isDeleted&&(0,q.jsx)(me,{title:`Hide the song`,onClick:async()=>{await H.softDeleteSong(n.original.id),t()},"data-test":`hide-song`,"data-song":n.original.id,children:(0,q.jsx)(gr,{})}),n.original.isDeleted&&(0,q.jsx)(me,{title:`Restore the song`,onClick:async()=>{await H.restoreSong(n.original.id),t()},"data-test":`restore-song`,"data-song":n.original.id,children:(0,q.jsx)(x,{})}),(0,q.jsx)(me,{className:n.original.local?``:`cursor-default! opacity-50`,title:`Delete the song`,onClick:async()=>{let i=global.confirm(`Are you sure you want to delete this song?`);i&&(await H.deleteSong(n.original.id),r&&e.some(e=>e.id===n.original.id)&&Oe.capture(`unshare-song`,{songId:n.original.id}),t())},"data-test":`delete-song`,"data-song":n.original.id,children:(0,q.jsx)(ae,{})})]})})}),r!==null&&(0,q.jsx)(n,{item:!0,xs:12,children:(0,q.jsx)(h,{control:(0,q.jsx)(o,{defaultChecked:!0,checked:r,onChange:e=>i(e.target.checked),"data-test":`share-songs-switch`}),label:`Share added songs (so they can be played by others)`})})]})]})})]}):(0,q.jsx)(q.Fragment,{children:`Loading`})}const vr=V(`div`,{target:`e4idn2b0`})({name:`19rvb6v`,styles:`margin:0 auto;height:100%;width:1260px;background:white;padding:60px 20px 0 20px`});export{mr as Convert,_r as SongList};
//# sourceMappingURL=SongManagement-C-o1MimM.js.map
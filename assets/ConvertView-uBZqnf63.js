import{r as d,j as a,bl as Pe,bm as Me,d as O,g as H,s as U,e as b,w as K,u as G,i as F,m as z,p as M,n as W,B as Ce,t as Ue,z as Ee,l as Ne,c as Se,bn as ze,bo as Ae,a2 as D,Q as ke,ac as Ve,bp as $e,bq as Le,b7 as X,bj as we,br as Ge,X as Be,bs as Fe,b8 as se,b5 as We,bt as De,bu as _e,bv as qe,bw as pe,bx as Oe,ar as He,b4 as Ye,V as Ke,aR as Xe,W as Je,by as Qe,a0 as oe,bz as Ze,Z as et,$ as tt}from"./index-D6oeGp8W.js";import{y as at,z as ot,E as Y,L as ie,H as rt,l as he,T as N,J as nt,B as k,m as B,k as P,t as xe,G as T,s as me,q as st,S as fe,i as it,j as lt,K as ct,A as dt,o as ut}from"./ShareSongsModal-w3NdbrjP.js";import{c as pt,e as ht}from"./Player-q2WSF6yx.js";function xt(e){return d.Children.toArray(e).filter(t=>d.isValidElement(t))}let le;typeof document=="object"&&(le=Me({key:"css",prepend:!0}));function mt(e){const{injectFirst:t,children:o}=e;return t&&le?a.jsx(Pe,{value:le,children:o}):o}function ft(e){return H("MuiButtonGroup",e)}const vt=O("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),R=vt,gt=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],bt=(e,t)=>{const{ownerState:o}=e;return[{[`& .${R.grouped}`]:t.grouped},{[`& .${R.grouped}`]:t[`grouped${M(o.orientation)}`]},{[`& .${R.grouped}`]:t[`grouped${M(o.variant)}`]},{[`& .${R.grouped}`]:t[`grouped${M(o.variant)}${M(o.orientation)}`]},{[`& .${R.grouped}`]:t[`grouped${M(o.variant)}${M(o.color)}`]},{[`& .${R.firstButton}`]:t.firstButton},{[`& .${R.lastButton}`]:t.lastButton},{[`& .${R.middleButton}`]:t.middleButton},t.root,t[o.variant],o.disableElevation===!0&&t.disableElevation,o.fullWidth&&t.fullWidth,o.orientation==="vertical"&&t.vertical]},yt=e=>{const{classes:t,color:o,disabled:n,disableElevation:s,fullWidth:c,orientation:r,variant:l}=e,i={root:["root",l,r==="vertical"&&"vertical",c&&"fullWidth",s&&"disableElevation"],grouped:["grouped",`grouped${M(r)}`,`grouped${M(l)}`,`grouped${M(l)}${M(r)}`,`grouped${M(l)}${M(o)}`,n&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return W(i,ft,t)},jt=U("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:bt})(({theme:e,ownerState:t})=>b({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius},t.variant==="contained"&&{boxShadow:(e.vars||e).shadows[2]},t.disableElevation&&{boxShadow:"none"},t.fullWidth&&{width:"100%"},t.orientation==="vertical"&&{flexDirection:"column"},{[`& .${R.grouped}`]:b({minWidth:40,"&:hover":b({},t.variant==="contained"&&{boxShadow:"none"})},t.variant==="contained"&&{boxShadow:"none"}),[`& .${R.firstButton},& .${R.middleButton}`]:b({},t.orientation==="horizontal"&&{borderTopRightRadius:0,borderBottomRightRadius:0},t.orientation==="vertical"&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},t.variant==="text"&&t.orientation==="horizontal"&&{borderRight:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${R.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}},t.variant==="text"&&t.orientation==="vertical"&&{borderBottom:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${R.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}},t.variant==="text"&&t.color!=="inherit"&&{borderColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / 0.5)`:K(e.palette[t.color].main,.5)},t.variant==="outlined"&&t.orientation==="horizontal"&&{borderRightColor:"transparent"},t.variant==="outlined"&&t.orientation==="vertical"&&{borderBottomColor:"transparent"},t.variant==="contained"&&t.orientation==="horizontal"&&{borderRight:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${R.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}},t.variant==="contained"&&t.orientation==="vertical"&&{borderBottom:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${R.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}},t.variant==="contained"&&t.color!=="inherit"&&{borderColor:(e.vars||e).palette[t.color].dark},{"&:hover":b({},t.variant==="outlined"&&t.orientation==="horizontal"&&{borderRightColor:"currentColor"},t.variant==="outlined"&&t.orientation==="vertical"&&{borderBottomColor:"currentColor"})}),[`& .${R.lastButton},& .${R.middleButton}`]:b({},t.orientation==="horizontal"&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},t.orientation==="vertical"&&{borderTopRightRadius:0,borderTopLeftRadius:0},t.variant==="outlined"&&t.orientation==="horizontal"&&{marginLeft:-1},t.variant==="outlined"&&t.orientation==="vertical"&&{marginTop:-1})})),Ct=d.forwardRef(function(t,o){const n=G({props:t,name:"MuiButtonGroup"}),{children:s,className:c,color:r="primary",component:l="div",disabled:i=!1,disableElevation:f=!1,disableFocusRipple:x=!1,disableRipple:v=!1,fullWidth:y=!1,orientation:S="horizontal",size:j="medium",variant:h="outlined"}=n,L=F(n,gt),w=b({},n,{color:r,component:l,disabled:i,disableElevation:f,disableFocusRipple:x,disableRipple:v,fullWidth:y,orientation:S,size:j,variant:h}),$=yt(w),u=d.useMemo(()=>({className:$.grouped,color:r,disabled:i,disableElevation:f,disableFocusRipple:x,disableRipple:v,fullWidth:y,size:j,variant:h}),[r,i,f,x,v,y,j,h,$.grouped]),p=xt(s),m=p.length,C=g=>{const I=g===0,E=g===m-1;return I&&E?"":I?$.firstButton:E?$.lastButton:$.middleButton};return a.jsx(jt,b({as:l,role:"group",className:z($.root,c),ref:o,ownerState:w},L,{children:a.jsx(at.Provider,{value:u,children:p.map((g,I)=>a.jsx(ot.Provider,{value:C(I),children:g},I))})}))}),q=Ct,St=["alignItems","autoFocus","component","children","dense","disableGutters","divider","focusVisibleClassName","selected","className"],kt=(e,t)=>{const{ownerState:o}=e;return[t.root,o.dense&&t.dense,o.alignItems==="flex-start"&&t.alignItemsFlexStart,o.divider&&t.divider,!o.disableGutters&&t.gutters]},$t=e=>{const{alignItems:t,classes:o,dense:n,disabled:s,disableGutters:c,divider:r,selected:l}=e,f=W({root:["root",n&&"dense",!c&&"gutters",r&&"divider",s&&"disabled",t==="flex-start"&&"alignItemsFlexStart",l&&"selected"]},rt,o);return b({},o,f)},Lt=U(Ce,{shouldForwardProp:e=>Ue(e)||e==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:kt})(({theme:e,ownerState:t})=>b({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Y.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:K(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${Y.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:K(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${Y.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:K(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:K(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${Y.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${Y.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},t.divider&&{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"},t.alignItems==="flex-start"&&{alignItems:"flex-start"},!t.disableGutters&&{paddingLeft:16,paddingRight:16},t.dense&&{paddingTop:4,paddingBottom:4})),wt=d.forwardRef(function(t,o){const n=G({props:t,name:"MuiListItemButton"}),{alignItems:s="center",autoFocus:c=!1,component:r="div",children:l,dense:i=!1,disableGutters:f=!1,divider:x=!1,focusVisibleClassName:v,selected:y=!1,className:S}=n,j=F(n,St),h=d.useContext(ie),L=d.useMemo(()=>({dense:i||h.dense||!1,alignItems:s,disableGutters:f}),[s,h.dense,i,f]),w=d.useRef(null);Ee(()=>{c&&w.current&&w.current.focus()},[c]);const $=b({},n,{alignItems:s,dense:L.dense,disableGutters:f,divider:x,selected:y}),u=$t($),p=Ne(w,o);return a.jsx(ie.Provider,{value:L,children:a.jsx(Lt,b({ref:p,href:j.href||j.to,component:(j.href||j.to)&&r==="div"?"button":r,focusVisibleClassName:z(u.focusVisible,v),ownerState:$,className:z(u.root,S)},j,{classes:u,children:l}))})}),Bt=wt,Tt=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],It=e=>{const{classes:t,inset:o,primary:n,secondary:s,dense:c}=e;return W({root:["root",o&&"inset",c&&"dense",n&&s&&"multiline"],primary:["primary"],secondary:["secondary"]},nt,t)},Rt=U("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[{[`& .${he.primary}`]:t.primary},{[`& .${he.secondary}`]:t.secondary},t.root,o.inset&&t.inset,o.primary&&o.secondary&&t.multiline,o.dense&&t.dense]}})(({ownerState:e})=>b({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},e.primary&&e.secondary&&{marginTop:6,marginBottom:6},e.inset&&{paddingLeft:56})),Pt=d.forwardRef(function(t,o){const n=G({props:t,name:"MuiListItemText"}),{children:s,className:c,disableTypography:r=!1,inset:l=!1,primary:i,primaryTypographyProps:f,secondary:x,secondaryTypographyProps:v}=n,y=F(n,Tt),{dense:S}=d.useContext(ie);let j=i??s,h=x;const L=b({},n,{disableTypography:r,inset:l,primary:!!j,secondary:!!h,dense:S}),w=It(L);return j!=null&&j.type!==N&&!r&&(j=a.jsx(N,b({variant:S?"body2":"body1",className:w.primary,component:f!=null&&f.variant?void 0:"span",display:"block"},f,{children:j}))),h!=null&&h.type!==N&&!r&&(h=a.jsx(N,b({variant:"body2",className:w.secondary,color:"text.secondary",display:"block"},v,{children:h}))),a.jsxs(Rt,b({className:z(w.root,c),ownerState:L,ref:o},y,{children:[j,h]}))}),Mt=Pt,Ut=d.createContext({}),Q=Ut,Et=d.createContext({}),ae=Et;function Nt(e){return H("MuiStep",e)}O("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const zt=["active","children","className","component","completed","disabled","expanded","index","last"],At=e=>{const{classes:t,orientation:o,alternativeLabel:n,completed:s}=e;return W({root:["root",o,n&&"alternativeLabel",s&&"completed"]},Nt,t)},Vt=U("div",{name:"MuiStep",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation],o.alternativeLabel&&t.alternativeLabel,o.completed&&t.completed]}})(({ownerState:e})=>b({},e.orientation==="horizontal"&&{paddingLeft:8,paddingRight:8},e.alternativeLabel&&{flex:1,position:"relative"})),Gt=d.forwardRef(function(t,o){const n=G({props:t,name:"MuiStep"}),{active:s,children:c,className:r,component:l="div",completed:i,disabled:f,expanded:x=!1,index:v,last:y}=n,S=F(n,zt),{activeStep:j,connector:h,alternativeLabel:L,orientation:w,nonLinear:$}=d.useContext(Q);let[u=!1,p=!1,m=!1]=[s,i,f];j===v?u=s!==void 0?s:!0:!$&&j>v?p=i!==void 0?i:!0:!$&&j<v&&(m=f!==void 0?f:!0);const C=d.useMemo(()=>({index:v,last:y,expanded:x,icon:v+1,active:u,completed:p,disabled:m}),[v,y,x,u,p,m]),g=b({},n,{active:u,orientation:w,alternativeLabel:L,completed:p,disabled:m,expanded:x,component:l}),I=At(g),E=a.jsxs(Vt,b({as:l,className:z(I.root,r),ref:o,ownerState:g},S,{children:[h&&L&&v!==0?h:null,c]}));return a.jsx(ae.Provider,{value:C,children:h&&!L&&v!==0?a.jsxs(d.Fragment,{children:[h,E]}):E})}),Z=Gt,Ft=Se(a.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),Wt=Se(a.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function Dt(e){return H("MuiStepIcon",e)}const _t=O("MuiStepIcon",["root","active","completed","error","text"]),re=_t;var ve;const qt=["active","className","completed","error","icon"],Ot=e=>{const{classes:t,active:o,completed:n,error:s}=e;return W({root:["root",o&&"active",n&&"completed",s&&"error"],text:["text"]},Dt,t)},ne=U(ze,{name:"MuiStepIcon",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),color:(e.vars||e).palette.text.disabled,[`&.${re.completed}`]:{color:(e.vars||e).palette.primary.main},[`&.${re.active}`]:{color:(e.vars||e).palette.primary.main},[`&.${re.error}`]:{color:(e.vars||e).palette.error.main}})),Ht=U("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(e,t)=>t.text})(({theme:e})=>({fill:(e.vars||e).palette.primary.contrastText,fontSize:e.typography.caption.fontSize,fontFamily:e.typography.fontFamily})),Yt=d.forwardRef(function(t,o){const n=G({props:t,name:"MuiStepIcon"}),{active:s=!1,className:c,completed:r=!1,error:l=!1,icon:i}=n,f=F(n,qt),x=b({},n,{active:s,completed:r,error:l}),v=Ot(x);if(typeof i=="number"||typeof i=="string"){const y=z(c,v.root);return l?a.jsx(ne,b({as:Wt,className:y,ref:o,ownerState:x},f)):r?a.jsx(ne,b({as:Ft,className:y,ref:o,ownerState:x},f)):a.jsxs(ne,b({className:y,ref:o,ownerState:x},f,{children:[ve||(ve=a.jsx("circle",{cx:"12",cy:"12",r:"12"})),a.jsx(Ht,{className:v.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:x,children:i})]}))}return i}),Kt=Yt;function Xt(e){return H("MuiStepLabel",e)}const Jt=O("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),_=Jt,Qt=["children","className","componentsProps","error","icon","optional","slotProps","StepIconComponent","StepIconProps"],Zt=e=>{const{classes:t,orientation:o,active:n,completed:s,error:c,disabled:r,alternativeLabel:l}=e;return W({root:["root",o,c&&"error",r&&"disabled",l&&"alternativeLabel"],label:["label",n&&"active",s&&"completed",c&&"error",r&&"disabled",l&&"alternativeLabel"],iconContainer:["iconContainer",n&&"active",s&&"completed",c&&"error",r&&"disabled",l&&"alternativeLabel"],labelContainer:["labelContainer",l&&"alternativeLabel"]},Xt,t)},ea=U("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation]]}})(({ownerState:e})=>b({display:"flex",alignItems:"center",[`&.${_.alternativeLabel}`]:{flexDirection:"column"},[`&.${_.disabled}`]:{cursor:"default"}},e.orientation==="vertical"&&{textAlign:"left",padding:"8px 0"})),ta=U("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(e,t)=>t.label})(({theme:e})=>b({},e.typography.body2,{display:"block",transition:e.transitions.create("color",{duration:e.transitions.duration.shortest}),[`&.${_.active}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${_.completed}`]:{color:(e.vars||e).palette.text.primary,fontWeight:500},[`&.${_.alternativeLabel}`]:{marginTop:16},[`&.${_.error}`]:{color:(e.vars||e).palette.error.main}})),aa=U("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(e,t)=>t.iconContainer})(()=>({flexShrink:0,display:"flex",paddingRight:8,[`&.${_.alternativeLabel}`]:{paddingRight:0}})),oa=U("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(e,t)=>t.labelContainer})(({theme:e})=>({width:"100%",color:(e.vars||e).palette.text.secondary,[`&.${_.alternativeLabel}`]:{textAlign:"center"}})),Te=d.forwardRef(function(t,o){var n;const s=G({props:t,name:"MuiStepLabel"}),{children:c,className:r,componentsProps:l={},error:i=!1,icon:f,optional:x,slotProps:v={},StepIconComponent:y,StepIconProps:S}=s,j=F(s,Qt),{alternativeLabel:h,orientation:L}=d.useContext(Q),{active:w,disabled:$,completed:u,icon:p}=d.useContext(ae),m=f||p;let C=y;m&&!C&&(C=Kt);const g=b({},s,{active:w,alternativeLabel:h,completed:u,disabled:$,error:i,orientation:L}),I=Zt(g),E=(n=v.label)!=null?n:l.label;return a.jsxs(ea,b({className:z(I.root,r),ref:o,ownerState:g},j,{children:[m||C?a.jsx(aa,{className:I.iconContainer,ownerState:g,children:a.jsx(C,b({completed:u,active:w,error:i,icon:m},S))}):null,a.jsxs(oa,{className:I.labelContainer,ownerState:g,children:[c?a.jsx(ta,b({ownerState:g},E,{className:z(I.label,E==null?void 0:E.className),children:c})):null,x]})]}))});Te.muiName="StepLabel";const ra=Te;function na(e){return H("MuiStepButton",e)}const sa=O("MuiStepButton",["root","horizontal","vertical","touchRipple"]),ge=sa,ia=["children","className","icon","optional"],la=e=>{const{classes:t,orientation:o}=e;return W({root:["root",o],touchRipple:["touchRipple"]},na,t)},ca=U(Ce,{name:"MuiStepButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[{[`& .${ge.touchRipple}`]:t.touchRipple},t.root,t[o.orientation]]}})(({ownerState:e})=>b({width:"100%",padding:"24px 16px",margin:"-24px -16px",boxSizing:"content-box"},e.orientation==="vertical"&&{justifyContent:"flex-start",padding:"8px",margin:"-8px"},{[`& .${ge.touchRipple}`]:{color:"rgba(0, 0, 0, 0.3)"}})),da=d.forwardRef(function(t,o){const n=G({props:t,name:"MuiStepButton"}),{children:s,className:c,icon:r,optional:l}=n,i=F(n,ia),{disabled:f,active:x}=d.useContext(ae),{orientation:v}=d.useContext(Q),y=b({},n,{orientation:v}),S=la(y),j={icon:r,optional:l},h=Ae(s,["StepLabel"])?d.cloneElement(s,j):a.jsx(ra,b({},j,{children:s}));return a.jsx(ca,b({focusRipple:!0,disabled:f,TouchRippleProps:{className:S.touchRipple},className:z(S.root,c),ref:o,ownerState:y,"aria-current":x?"step":void 0},i,{children:h}))}),ee=da;function ua(e){return H("MuiStepConnector",e)}O("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const pa=["className"],ha=e=>{const{classes:t,orientation:o,alternativeLabel:n,active:s,completed:c,disabled:r}=e,l={root:["root",o,n&&"alternativeLabel",s&&"active",c&&"completed",r&&"disabled"],line:["line",`line${M(o)}`]};return W(l,ua,t)},xa=U("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation],o.alternativeLabel&&t.alternativeLabel,o.completed&&t.completed]}})(({ownerState:e})=>b({flex:"1 1 auto"},e.orientation==="vertical"&&{marginLeft:12},e.alternativeLabel&&{position:"absolute",top:8+4,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"})),ma=U("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.line,t[`line${M(o.orientation)}`]]}})(({ownerState:e,theme:t})=>{const o=t.palette.mode==="light"?t.palette.grey[400]:t.palette.grey[600];return b({display:"block",borderColor:t.vars?t.vars.palette.StepConnector.border:o},e.orientation==="horizontal"&&{borderTopStyle:"solid",borderTopWidth:1},e.orientation==="vertical"&&{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24})}),fa=d.forwardRef(function(t,o){const n=G({props:t,name:"MuiStepConnector"}),{className:s}=n,c=F(n,pa),{alternativeLabel:r,orientation:l="horizontal"}=d.useContext(Q),{active:i,disabled:f,completed:x}=d.useContext(ae),v=b({},n,{alternativeLabel:r,orientation:l,active:i,completed:x,disabled:f}),y=ha(v);return a.jsx(xa,b({className:z(y.root,s),ref:o,ownerState:v},c,{children:a.jsx(ma,{className:y.line,ownerState:v})}))}),va=fa;function ga(e){return H("MuiStepper",e)}O("MuiStepper",["root","horizontal","vertical","alternativeLabel"]);const ba=["activeStep","alternativeLabel","children","className","component","connector","nonLinear","orientation"],ya=e=>{const{orientation:t,alternativeLabel:o,classes:n}=e;return W({root:["root",t,o&&"alternativeLabel"]},ga,n)},ja=U("div",{name:"MuiStepper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation],o.alternativeLabel&&t.alternativeLabel]}})(({ownerState:e})=>b({display:"flex"},e.orientation==="horizontal"&&{flexDirection:"row",alignItems:"center"},e.orientation==="vertical"&&{flexDirection:"column"},e.alternativeLabel&&{alignItems:"flex-start"})),Ca=a.jsx(va,{}),Sa=d.forwardRef(function(t,o){const n=G({props:t,name:"MuiStepper"}),{activeStep:s=0,alternativeLabel:c=!1,children:r,className:l,component:i="div",connector:f=Ca,nonLinear:x=!1,orientation:v="horizontal"}=n,y=F(n,ba),S=b({},n,{alternativeLabel:c,orientation:v,component:i}),j=ya(S),h=d.Children.toArray(r).filter(Boolean),L=h.map(($,u)=>d.cloneElement($,b({index:u,last:u+1===h.length},$.props))),w=d.useMemo(()=>({activeStep:s,alternativeLabel:c,connector:f,nonLinear:x,orientation:v}),[s,c,f,x,v]);return a.jsx(Q.Provider,{value:w,children:a.jsx(ja,b({as:i,ownerState:S,className:z(j.root,l),ref:o},y,{children:L}))})}),ka=Sa,te=D("span",{target:"e1juu05a0"})({name:"1n7r223",styles:"font-family:monospace"}),ce=(e,t,o="Lookup")=>({InputProps:{endAdornment:a.jsx(ke,{title:t?"Open search results for the song":"Artist or title of the song is unknown",children:a.jsx("span",{children:a.jsx(k,{sx:{mr:-1},endIcon:a.jsx(Ve,{}),color:"secondary",variant:"text",onClick:e,disabled:!t,children:o})})})}});function $a(e){const t=()=>{window.open(`https://www.youtube.com/results?search_query=${encodeURIComponent((e==null?void 0:e.songArtist)+" "+(e==null?void 0:e.songTitle))}`,"_blank")},o=!!e.songTitle&&!!e.songArtist,n=$e(e.data.video);return a.jsxs(B,{sx:{display:"flex",flexWrap:"wrap"},"data-test":"author-and-vid",children:[a.jsx(P,{"data-test":"author-name",sx:{mt:2},value:e.data.author,onChange:s=>e.onChange({...e.data,author:s.target.value}),label:"Author name (optional)",fullWidth:!0,size:"small",helperText:"Nickname of the person that created the .txt file."}),a.jsx(P,{"data-test":"author-url",sx:{mt:2},value:e.data.authorUrl,onChange:s=>e.onChange({...e.data,authorUrl:s.target.value}),label:"Author URL (optional)",helperText:"Link to authors page/profile.",fullWidth:!0,size:"small"}),a.jsx(B,{sx:{display:"flex",flexDirection:"row",mt:2,alignItems:"center",width:"100%"},children:a.jsx(P,{"data-test":"video-url",required:!0,value:e.data.video,onChange:s=>e.onChange({...e.data,video:s.target.value}),label:"YouTube Video URL",placeholder:"https://www.youtube.com/watch?v=",fullWidth:!0,size:"small",helperText:"Link to YouTube video, eg https://www.youtube.com/watch?v=xxxxxxxxx. Click the 'Lookup' button to look for it on YouTube",name:"videoUrl",...ce(t,o)})}),n&&a.jsx(B,{children:a.jsx(Le,{videoId:n})})]})}const La={polish:{È:"é",í:"'","¥":"'","¯":"Ż","¹":"ą",π:"ą",ê:"ę",Í:"ę",Œ:"Ś",å:"Ś",œ:"ś",ú:"ś",æ:"ć",Ê:"ć","¿":"ż",ø:"ż",Ø:"Ż",ñ:"ń",Ò:"ń","³":"ł","≥":"ł","£":"Ł",Û:"ó",ü:"ź",Ÿ:"ź"},spanish:{ø:"¿",È:"é",Ì:"í",Ò:"ñ",ń:"ñ","·":"á",Û:"ó","°":"!","˙":"ú",ś:"ú"}};function wa(e,t){const o=La[t];if(o===void 0)return e;let n=e;for(const[s,c]of Object.entries(o))n=n.replaceAll(s,c);return n}function Ba(e){const t=e.split(`
`),o=["#TITLE","#ARTIST","#BPM"];let n=!0;return o.forEach(s=>{t.some(c=>c.startsWith(s))||(n=!1)}),t.some(s=>s.startsWith(":"))||(n=!1),n}async function Ta(e){try{const t=new URL(e);if(t.host==="usdb.animux.de")return Ra(e,t);if(t.host==="ultrastar-es.org")return Ia(e)}catch(t){console.warn(t)}}async function Ia(e){var i,f,x,v;const o=await(await fetch(`https://backend.allkaraoke.party/proxy?url=${encodeURIComponent(e)}`)).text(),n=new DOMParser().parseFromString(o,"text/html"),c=`https://ultrastar-es.org/pl/canciones/descargar/txt/${(i=n.querySelector("ul[data-id]"))==null?void 0:i.getAttribute("data-id")}`;window.location.href=c;const r=(f=n.querySelector("#listado > ul > li > dl > dd:nth-child(6) > a"))==null?void 0:f.getAttribute("href"),l=(x=n.querySelector("#listado > ul > li"))==null?void 0:x.getAttribute("data-id");return{authorUrl:r?"https://ultrastar-es.org"+r:"",author:((v=n.querySelector("#listado > ul > li > dl > dd:nth-child(6)"))==null?void 0:v.textContent)??"",video:l?"https://www.youtube.com/watch?v="+l:""}}async function Ra(e,t){var f,x,v,y,S;const n=await(await fetch(`https://backend.allkaraoke.party/proxy?url=${encodeURIComponent(e)}`)).text(),s=new DOMParser().parseFromString(n,"text/html"),c=(f=s.querySelector('a[href^="?link=profil&id="]'))==null?void 0:f.textContent,r=(v=(x=s.querySelector('a[href^="?link=profil&id="]'))==null?void 0:x.getAttribute)==null?void 0:v.call(x,"href"),l=(y=s.querySelector("#tablebg > tbody > tr:nth-child(3) > td > table:nth-child(2) > tbody > tr.list_head > td:nth-child(1)"))==null?void 0:y.textContent,i=(S=s.querySelector("#tablebg > tbody > tr:nth-child(3) > td > table:nth-child(2) > tbody > tr.list_head > td:nth-child(2)"))==null?void 0:S.textContent;return window.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(l+" "+i)}`,"_blank"),window.open(`http://usdb.animux.de/index.php?link=gettxt&id=${t.searchParams.get("id")}`,"_blank"),{authorUrl:r?"http://usdb.animux.de/index.php"+r:"",author:c??"",video:""}}function Pa(e){var c,r;const t=async l=>{if(e.onChange({...e.data,sourceUrl:l.target.value}),e.shouldAutoImport){const i=await Ta(l.target.value);i&&e.onAutoImport(i)}},o=l=>{e.onChange({...e.data,txtInput:wa(e.data.txtInput,l)})},s=!d.useMemo(()=>Ba(e.data.txtInput),[e.data.txtInput])&&e.data.txtInput.length>0;return a.jsxs(B,{sx:{display:"flex",flexWrap:"wrap"},"data-test":"basic-data",children:[e.isTxtRequired&&a.jsxs("div",{children:[a.jsx("h4",{children:"Where to find songs?"}),a.jsxs("p",{children:["Any UltraStar compatible .txt file will do. You can find many already made songs on"," ",a.jsx("a",{href:"https://usdb.animux.de/",target:"_blank",rel:"noreferrer",children:"usdb.animux.de"})," or ",a.jsx("a",{href:"https://ultrastar-es.org/en",target:"_blank",rel:"noreferrer",children:"ultrastar-es.org"}),".",a.jsx("br",{}),a.jsx("br",{})]}),a.jsx("p",{children:"You don't need audio/video files, you'll be able to search for appropriate YouTube video and synchronise the lyrics to it in subsequent steps."})]}),a.jsx(P,{sx:{mt:2},value:e.data.sourceUrl,onChange:t,label:"Source URL (optional)",fullWidth:!0,size:"small","data-test":"source-url",helperText:"The link to the page from which the .TXT file was downloaded."}),e.isTxtRequired?a.jsxs(a.Fragment,{children:[a.jsx(P,{error:s,helperText:s?"This doesn't look like a valid UltraStar .TXT format":"",required:!0,sx:{mt:2},fullWidth:!0,size:"small",multiline:!0,label:"Song's UltraStar .TXT file contents",onChange:l=>e.onChange({...e.data,txtInput:l.target.value}),value:e.data.txtInput,maxRows:15,minRows:15,InputProps:{inputProps:{"data-test":"input-txt",sx:{fontFamily:"monospace"}}}}),a.jsxs(B,{sx:{display:"flex",gap:1,mt:1},children:[a.jsx(k,{onClick:()=>o("polish"),children:"Fix 🇵🇱 Polish accents"}),a.jsx(k,{onClick:()=>o("spanish"),children:"Fix 🇪🇸 Spanish accents"})]})]}):a.jsx(B,{sx:{display:"flex",width:"100%",height:500,overflow:"auto"},children:(r=(c=e.finalSong)==null?void 0:c.tracks)==null?void 0:r.map((l,i)=>a.jsxs(B,{sx:{flex:1},children:[a.jsx("h4",{children:l.name??`Track #${i+1}`}),l.sections.filter(X).map(f=>a.jsx("p",{children:f.notes.map(x=>x.lyrics).join("")},f.start))]},i))})]})}const Ie=e=>{const t=Math.floor(e/1e3/60),o=Math.floor(e/1e3)-t*60,n=Math.floor(e%1e3);return a.jsxs(te,{children:[String(t).padStart(2,"0"),":",String(o).padStart(2,"0"),".",String(n).padStart(3,"0")]})},Ma=e=>"playVideo"in e?{play:()=>e.playVideo(),pause:()=>e.pauseVideo(),seekTo:t=>e.seekTo(t,!0),setPlaybackSpeed:t=>e.setPlaybackRate(t)}:e,J=(e,t)=>a.jsx(ke,{title:"Click to play the moment just before this time",placement:"top",arrow:!0,children:a.jsx(k,{sx:{py:.15,mb:.5},variant:"contained",size:"small",disabled:!t,onClick:t?()=>{we.resetPlayerNotes(),Ma(t).seekTo((e??0)/1e3-.7)}:void 0,children:Ie(e??0)})}),Ua=Ie,be=10;function Ea({data:e,onChange:t,videoId:o,videoGap:n=0}){var $;const s=d.useRef(null),c=d.useRef(null),[r,l]=d.useState(!1);d.useEffect(()=>{(async()=>{var u,p,m,C;e.volume===0?(t({...e,volume:.5}),await((p=(u=s.current)==null?void 0:u.getInternalPlayer())==null?void 0:p.setVolume(50))):await((C=(m=s.current)==null?void 0:m.getInternalPlayer())==null?void 0:C.setVolume(e.volume*100)),l(!0)})()},[]),d.useEffect(()=>{if(!r)return;const u=setInterval(async()=>{var m,C;const p=await((C=(m=s.current)==null?void 0:m.getInternalPlayer())==null?void 0:C.getVolume());p!==void 0&&p!==e.volume*100&&t({...e,volume:p/100})},500);return()=>{clearInterval(u)}},[r,e,t]);const[i,f]=d.useState(!1),[x,v]=d.useState(!1),y=async(u,p)=>{var m,C;await((C=(m=s.current)==null?void 0:m.getInternalPlayer())==null?void 0:C.setVolume(+p*100)),t({...e,volume:+p})},S=e.previewStart??n+60,j=e.previewEnd??S+30,[h,L]=d.useState(null);d.useEffect(()=>{var u,p;c.current&&(c.current.currentTime=35),(p=(u=s.current)==null?void 0:u.getInternalPlayer())==null||p.getDuration().then(L)},[]);const w=($=s.current)==null?void 0:$.getInternalPlayer();return a.jsxs(B,{sx:{display:"flex",flexDirection:"column",width:"100%"},children:[a.jsxs("h3",{children:["Set song preview (start: ",J(S*1e3,w),", end:"," ",J(j*1e3,w),")"]}),a.jsx(B,{sx:{display:"flex",gap:5},children:a.jsx(xe,{"data-test":"song-preview",disabled:h===null,step:1,value:[S,j],max:(h??500)-be,onChange:(u,p)=>{const[m,C]=p;C-m>be&&t({...e,previewStart:m,previewEnd:C})}})}),a.jsx("h3",{children:"Adjust volume"}),a.jsxs(B,{sx:{display:"flex",gap:5},children:[a.jsxs(B,{children:[a.jsx("h4",{children:"Song"}),a.jsx(Le,{videoId:o,ref:s,onPlay:()=>{var u;f(!0),x&&((u=c.current)==null||u.pause(),setTimeout(()=>v(!0),200))},onPause:()=>{v(!1)}})]}),a.jsxs(B,{children:[a.jsx("h4",{children:"Reference sound"}),a.jsx("p",{children:"Use the slider below to make the video volume roughly the same as this music."}),a.jsx("br",{}),a.jsx("audio",{ref:c,controls:!0,src:Ge,loop:!0,onLoad:u=>u.currentTarget.currentTime=35,onPlay:u=>{var p,m;u.currentTarget.volume=.5,v(!0),i&&((m=(p=s.current)==null?void 0:p.getInternalPlayer())==null||m.pauseVideo(),setTimeout(()=>f(!0),200))},onPause:()=>{var u,p;v(!1),i&&((p=(u=s.current)==null?void 0:u.getInternalPlayer())==null||p.playVideo())}})]})]}),a.jsxs("h4",{children:["Final Song Volume (",e.volume*100,")"]}),a.jsx(B,{children:a.jsx(xe,{"data-test":"volume",min:.1,max:1,step:.01,"aria-label":"Volume",value:e.volume,onChange:y})})]})}function Na(e){const t=Be(!0),o=d.useMemo(()=>[...new Set(t.data.map(({language:r})=>Array.isArray(r)?r:[r]).flat().filter(Boolean))],[t.data]),n=d.useMemo(()=>[...new Set(t.data.map(r=>r.genre).filter(Boolean).map(r=>r.toLowerCase().replace(/\b\w/g,l=>l.toUpperCase().trim())))],[t.data]),s=r=>{window.open(`https://www.google.com/search?q=${encodeURIComponent(`${e.songArtist} ${e.songTitle} ${r}`)}`,"_blank")},c=!!e.songTitle&&!!e.songArtist;return a.jsxs(T,{container:!0,spacing:2,sx:{mt:6},children:[a.jsx(T,{item:!0,xs:6,children:a.jsx(P,{value:e.data.artist,onChange:r=>e.onChange({...e.data,artist:r.target.value}),label:"Song artist",size:"small","data-test":"song-artist",required:!0,fullWidth:!0})}),a.jsx(T,{item:!0,xs:6,children:a.jsx(P,{value:e.data.title,onChange:r=>e.onChange({...e.data,title:r.target.value}),label:"Song title",fullWidth:!0,size:"small",required:!0,"data-test":"song-title"})}),a.jsx(T,{item:!0,xs:6,children:a.jsx(me,{onKeyDown:r=>{r.key==="Enter"&&r.preventDefault()},freeSolo:!0,disableClearable:!0,options:n,value:e.data.genre??"",onChange:(r,l)=>e.onChange({...e.data,genre:l}),renderInput:r=>a.jsx(P,{...r,onBlur:l=>e.onChange({...e.data,genre:l.target.value}),label:"Song genre (optional)",size:"small","data-test":"song-genre",fullWidth:!0})})}),a.jsx(T,{item:!0,xs:6,children:a.jsx(me,{onKeyDown:r=>{r.key==="Enter"&&r.preventDefault()},multiple:!0,freeSolo:!0,disableClearable:!0,options:o,value:typeof e.data.language=="string"?[e.data.language]:e.data.language,onChange:(r,l)=>{e.onChange({...e.data,language:l?l.filter(Boolean):e.data.language})},renderInput:r=>{var l;return a.jsx(P,{...r,label:"Song language",fullWidth:!0,size:"small",required:!((l=e.data.language)!=null&&l.length),"data-test":"song-language"})}})}),a.jsx(T,{item:!0,xs:6,children:a.jsx(P,{"data-test":"release-year",value:e.data.year,onChange:r=>e.onChange({...e.data,year:r.target.value}),label:"Release year",helperText:"The year the song was released. Click the 'Lookup' button to look for it on Google",fullWidth:!0,size:"small",required:!0,...ce(()=>s("release year"),c)})}),a.jsx(T,{item:!0,xs:6,children:a.jsx(P,{"data-test":"song-bpm",value:e.data.realBpm,onChange:r=>e.onChange({...e.data,realBpm:r.target.value}),label:"Song (real) BPM",helperText:"The actual tempo of the song. Click the 'Lookup' button to look for it on Google",fullWidth:!0,type:"number",size:"small",required:!0,...ce(()=>s("tempo"),c)})}),a.jsx(T,{item:!0,xs:12}),a.jsx(T,{item:!0,xs:12,children:a.jsx(Ea,{...e})})]})}function za({player:e,currentTime:t,effectsEnabled:o,onEffectsToggle:n}){const s=l=>e.seekTo((t+l)/1e3),[c,r]=d.useState(1);return a.jsxs(a.Fragment,{children:[a.jsxs(B,{sx:{mb:2},children:[a.jsxs(N,{variant:"h6","data-test":"current-time",children:["Current time: ",Ua(t)," (",a.jsx(te,{children:Math.round(t)})," ms)"]}),a.jsxs(B,{sx:{display:"flex",gap:1},children:[a.jsxs(q,{variant:"contained",sx:{display:"flex",mt:1,flex:1},children:[a.jsx(k,{sx:{flex:1,px:1},onClick:()=>s(-1e4),"data-test":"seek-10s",children:"-10"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>s(-5e3),"data-test":"seek-5s",children:"-5"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>s(-1e3),"data-test":"seek-1s",children:"-1"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>s(-500),"data-test":"seek-0.5s",children:"-0.5"})]}),a.jsx(st,{}),a.jsxs(q,{variant:"contained",sx:{display:"flex",mt:1,flex:1},children:[a.jsx(k,{sx:{flex:1,px:1},onClick:()=>s(500),"data-test":"seek+0.5s",children:"+0.5"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>s(1e3),"data-test":"seek+1s",children:"+1"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>s(5e3),"data-test":"seek+5s",children:"+5"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>s(1e4),"data-test":"seek+10s",children:"+10"})]})]})]}),a.jsxs(B,{sx:{mb:2},children:[a.jsxs(N,{variant:"h6",children:["Playback speed: ",a.jsxs(te,{"data-test":"current-speed",children:[c*100,"%"]})]}),a.jsx(q,{variant:"contained",sx:{display:"flex",mt:1},children:[.25,.5,.75,1,1.25,1.5,2].map(l=>a.jsxs(k,{"data-test":`speed-${l}`,sx:{flex:1},onClick:()=>{r(l),e.setPlaybackSpeed(l)},disabled:c===l,children:[l*100,"%"]},l))})]})]})}function Aa(e,t){const o=Math.floor(t);return d.useMemo(()=>e.findIndex((n,s)=>o<0?!0:o<n.start?!1:s===e.length-1||e[s+1].start>o),[o,e])}function Va({song:e,currentTime:t,beatLength:o,player:n,onRecordChange:s,onTrackNameChange:c}){var $;const[r,l]=d.useState(0),[i,f]=d.useState(-1),[x,v]=d.useState([]),y=Fe(t,o,e.gap),S=e.tracks[r].sections.filter(X),j=Aa(S,y),h=u=>{f(u),we.resetPlayerNotes(),n.seekTo((S[u].start*o+e.gap)/1e3)},L=()=>{v(u=>[...u,{type:"delete",section:i,track:r}]),i===S.length-1&&f(u=>u-1)},w=u=>{v(p=>{const m=p.at(-1);if(m&&m.type==="shift"&&m.track===r&&m.section===i){const C=[...p];return C.at(-1).shift=u,C}return[...p,{type:"shift",section:i,track:r,shift:u}]})};return d.useEffect(()=>{s(x)},[s,x]),a.jsxs(Wa,{children:[a.jsxs(fe,{direction:"row",children:[a.jsxs(N,{variant:"h6",mb:0,sx:{flex:1},children:["Edit verses",e.tracks.length>1&&a.jsx(q,{variant:"contained",sx:{ml:2},size:"small",children:e.tracks.map((u,p)=>a.jsxs(k,{onClick:()=>l(p),disabled:r===p,"data-test":`track-${p+1}`,children:["Track ",p+1]},p))})]}),a.jsx(P,{placeholder:"Set track name",sx:{flex:1},size:"small",value:(($=e.tracks[r])==null?void 0:$.name)??"",onChange:u=>c(r,u.target.value),"data-test":"track-name"})]}),a.jsxs(fe,{direction:"row",spacing:2,sx:{height:"400px"},children:[a.jsx(it,{sx:{overflowY:"auto"},children:S.map((u,p)=>a.jsx(lt,{disablePadding:!0,"data-test":`section-${p}`,children:a.jsx(Bt,{onClick:()=>h(p),selected:i===p,children:a.jsx(Mt,{primaryTypographyProps:{fontWeight:p===j?"bold":"normal"},primary:X(u)?u.notes.map(m=>m.lyrics).join(""):"[pause]"})})},u.start))}),a.jsx(Da,{children:i>-1&&a.jsxs(a.Fragment,{children:[i===0&&a.jsx("h3",{"data-test":"use-gap-info",children:"Use gap shift to change when this section starts"}),i>0&&a.jsx(a.Fragment,{children:a.jsx(P,{"data-test":"change-start-beat",size:"small",type:"number",onChange:u=>w(+u.target.value),value:se([S[i]]),label:"Change start beat",InputProps:{inputProps:{step:1}},fullWidth:!0,sx:{mb:2},helperText:a.jsxs(a.Fragment,{children:["Timestamp:"," ",J(se([S[i]])*o+e.gap,n)]})})}),a.jsx(k,{variant:"contained",color:"error",onClick:L,fullWidth:!0,"data-test":"delete-section",children:"Delete section"})]})}),a.jsxs(Ga,{children:[a.jsx(B,{sx:{overflowY:"auto",maxHeight:"34rem"},"data-test":"change-list",children:x.map((u,p)=>{let m="",C=ye;return u.type==="delete"?(C=ye,m="Deleted"):u.type==="shift"&&(C=Fa,m=`Start -> ${u.shift}`),a.jsx(C,{children:a.jsxs("strong",{children:["Track: ",u.track+1,", Section: ",u.section+1,", ",m]})},p)})}),x.length>0&&a.jsx(k,{"data-test":"undo-change",variant:"contained",color:"warning",onClick:()=>v(u=>u.filter((p,m)=>m!==u.length-1)),fullWidth:!0,children:"Undo last change"})]})]})]})}const Ga=D("div",{target:"edf68o88"})({name:"82a6rk",styles:"flex:1"}),Re=D("div",{target:"edf68o87"})({name:"m1a2da",styles:"padding:0.5rem"}),ye=D(Re,{target:"edf68o86"})({name:"hwfcu5",styles:"color:red"}),Fa=D(Re,{target:"edf68o85"})({name:"zzs6wi",styles:"color:#0059ff"}),Wa=D("div",{target:"edf68o83"})(""),Da=D("div",{target:"edf68o82"})({name:"82a6rk",styles:"flex:1"});function _a({song:e,player:t,beatLength:o}){return a.jsx(a.Fragment,{})}function qa(e,t){var r;const n=(r=t.tracks[0].sections.filter(X).at(-1))==null?void 0:r.notes.at(-1),s=e-t.gap,c=n.start+n.length;return Number((6e4/(s/c*t.bar)).toFixed(2))}function Oa({current:e,onChange:t,player:o,song:n}){const s=Math.max(...n.tracks.map(i=>We(i.sections))),c=De(s,n)+n.gap,[r,l]=d.useState(Math.round(c));return a.jsxs(B,{sx:{display:"flex",gap:2,mb:2},children:[a.jsx(P,{"data-test":"desired-end",size:"small",type:"number",value:r,onChange:i=>l(+i.target.value),label:"Desired last note end time (in milliseconds)",sx:{flex:1},helperText:r?a.jsxs(a.Fragment,{children:["Est. proper Tempo (BPM): ",a.jsx(te,{"data-test":"desired-bpm",children:qa(r,n)})]}):" "}),a.jsx(P,{"data-test":"change-bpm",size:"small",type:"number",value:e,onChange:i=>t(+i.target.value),label:"Tempo (BPM) of the lyrics",sx:{flex:.5},helperText:" ",InputProps:{inputProps:{step:"0.1"}}})]})}function Ha({current:e,onChange:t,player:o,finalGap:n}){return a.jsxs(B,{sx:{flex:1},children:[a.jsxs(N,{variant:"h6",children:["Gap shift (final: ",J(n,o),")"]}),a.jsxs(B,{sx:{display:"flex",gap:1,mt:1},children:[a.jsxs(q,{sx:{flex:1},children:[a.jsx(k,{sx:{flex:1,px:1},onClick:()=>t(e-1e3),"data-test":"shift-gap-1s",children:"-1000"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>t(e-500),"data-test":"shift-gap-0.5s",children:"-500"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>t(e-50),"data-test":"shift-gap-0.05s",children:"-50"})]}),a.jsx(P,{sx:{py:0,flex:1},size:"small",type:"text",value:e,onChange:s=>t(+s.target.value),label:"Miliseconds","data-test":"shift-gap"}),a.jsxs(q,{sx:{flex:1},children:[a.jsx(k,{sx:{flex:1,px:1},onClick:()=>t(e+50),"data-test":"shift-gap+0.05s",children:"+50"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>t(e+500),"data-test":"shift-gap+0.5s",children:"+500"}),a.jsx(k,{sx:{flex:1,px:1},onClick:()=>t(e+1e3),"data-test":"shift-gap+1s",children:"+1000"})]})]})]})}function Ya({current:e,onChange:t,player:o,finalGap:n}){return a.jsxs(B,{sx:{flex:1},children:[a.jsxs(N,{variant:"h6",children:["Video Gap shift (final: ",J((n??0)*1e3,o),")"]}),a.jsxs(B,{sx:{display:"flex",gap:1,mt:1},children:[a.jsxs(q,{sx:{flex:1},children:[a.jsx(k,{sx:{flex:1,px:1.25},onClick:()=>t(e-10),"data-test":"shift-video-gap-10s",children:"-10"}),a.jsx(k,{sx:{flex:1,px:1.25},onClick:()=>t(e-5),"data-test":"shift-video-gap-5s",children:"-5"}),a.jsx(k,{sx:{flex:1,px:1.25},onClick:()=>t(e-1),"data-test":"shift-video-gap-1s",children:"-1"})]}),a.jsx(P,{"data-test":"shift-video-gap",sx:{py:0,flex:1},size:"small",type:"text",value:e,onChange:s=>t(+s.target.value),label:"Seconds"}),a.jsxs(q,{sx:{flex:1},children:[a.jsx(k,{sx:{flex:1,px:1.25},onClick:()=>t(e+1),"data-test":"shift-video-gap+1s",children:"+1"}),a.jsx(k,{sx:{flex:1,px:1.25},onClick:()=>t(e+5),"data-test":"shift-video-gap+5s",children:"+5"}),a.jsx(k,{sx:{flex:1,px:1.25},onClick:()=>t(e+10),"data-test":"shift-video-gap+10s",children:"+10"})]})]})]})}const Ka=(e,t)=>({...e,gap:e.gap+t}),Xa=(e,t)=>({...e,videoGap:(e.videoGap??0)+t}),Ja=(e,t)=>({...e,bpm:t}),Qa=(e,t)=>({...e,tracks:e.tracks.map((o,n)=>{const s=t.filter(r=>r.track===n);let c=[...o.sections].filter(X);return s.forEach(r=>{if(r.type==="delete")c=c.filter((l,i)=>i!==r.section);else if(r.type==="shift"){const l=r.shift-se([c[r.section]]);c=c.map((i,f)=>f<r.section?i:{...i,notes:i.notes.map(x=>({...x,start:x.start+l}))})}}),{...o,sections:c}})}),Za=(e,t)=>({...e,tracks:e.tracks.map((o,n)=>({...o,name:t[n]??o.name}))}),de=800,je=de/16*9;function eo({song:e,onUpdate:t,visible:o}){const n=d.useRef(null),[s,c]=d.useState(0),[r,l]=d.useState(0),[i,f]=d.useState(0),[x,v]=d.useState(e.bpm),[y,S]=d.useState(0),[j,h]=d.useState([]),[L,w]=d.useState(!1),[$,u]=d.useState(e.tracks.map(g=>g.name??void 0)),p=d.useMemo(()=>{let g=pt(e);return g=_e(g),g=qe(g),g=pe(g),g=Ka(g,r),g=Xa(g,i),g=Ja(g,x),g=Qa(g,j),g=Za(g,$),g=pe(g),g=Oe(g),g},[r,i,e,x,j,$]);d.useEffect(()=>{t==null||t(p)},[t,p]);const m=d.useMemo(()=>({id:"test",mode:He.DUEL,players:[{number:0,track:0},{number:1,track:e.tracks.length-1}],tolerance:6}),[e]);let C;return C=Ye(p),d.useEffect(()=>{var g;o||(g=n.current)==null||g.pause()},[o]),a.jsxs(T,{container:!0,spacing:2,sx:{display:o?void 0:"none"},children:[a.jsx(T,{item:!0,xs:8,"data-test":"player-container",children:a.jsx(B,{sx:{width:de,height:je},children:a.jsx(ht,{song:p,showControls:!0,autoplay:!1,width:de,height:je,ref:n,onCurrentTimeUpdate:c,players:m.players,effectsEnabled:L,singSetup:m,onSongEnd:()=>{}},y)})}),a.jsxs(T,{item:!0,xs:4,children:[a.jsx(N,{variant:"h5",mb:2,children:"Playback controls"}),n.current&&a.jsx(za,{player:n.current,currentTime:s,effectsEnabled:L,onEffectsToggle:()=>w(g=>!g)}),!n.current&&a.jsx("h2",{children:"Start the song to see the manipulation form"})]}),n.current&&a.jsxs(a.Fragment,{children:[a.jsx(T,{item:!0,xs:8,children:a.jsxs(B,{sx:{display:"flex",gap:5,flex:1},children:[a.jsx(Ya,{player:n.current,onChange:g=>{const I=g-i;f(g),l(E=>E+I*1e3)},current:i,finalGap:p.videoGap}),a.jsx(Ha,{player:n.current,onChange:l,current:r,finalGap:p.gap})]})}),a.jsxs(T,{item:!0,xs:4,children:[a.jsxs(A,{children:["Use ",a.jsx("strong",{children:"Video shift gap"})," to crop the beginning of the video if it starts with an intro."]}),a.jsxs(A,{children:["Use ",a.jsx("strong",{children:"Shift gap"})," to sync the start of the lyrics to the video. You can lower the"," ",a.jsx("strong",{children:"Playback speed"})," above to make sure you got it just right."]})]}),a.jsxs(T,{item:!0,xs:8,children:[a.jsx(N,{variant:"h5",mb:2,children:"Advanced"}),a.jsx(Oa,{player:n.current,onChange:v,current:x,song:p},p.gap),a.jsx(_a,{player:n.current,song:p,beatLength:C})]}),a.jsxs(T,{item:!0,xs:4,children:[a.jsx(A,{children:"If the lyrics desynchronise over time, probably the tempo (BPM) of the lyrics is wrong."}),a.jsxs(A,{children:["You can either use ",a.jsx("strong",{children:"Last note end time"})," - enter the millisecond when the last note should end (seek through the video for the moment as ",a.jsx("strong",{children:"Current time"})," panel show the exact millisecond) and a suggested BPM value will appear below."]}),a.jsxs(A,{children:[a.jsx("strong",{children:"Tempo (BPM)"})," field allows to fine-tune the tempo."]})]}),a.jsx(T,{item:!0,xs:8,children:a.jsx(Va,{song:p,currentTime:s,beatLength:C,player:n.current,onRecordChange:h,onTrackNameChange:(g,I)=>u(E=>{const ue=[...E];return ue[g]=I===""?void 0:I,ue})})}),a.jsxs(T,{item:!0,xs:4,children:[a.jsxs(A,{children:["If the lyrics there are more lyrics than in the video or there are longer/shorter interludes between verses, you can ",a.jsx("strong",{children:"Edit verses"}),"."]}),a.jsx(A,{children:"Select a verse by clicking on it."}),a.jsxs(A,{children:["You can either ",a.jsx("strong",{children:"Change its start beat"}),' (which will "move in time" the verse and all subsequent ones) or ',a.jsx("strong",{children:"Delete it"})," (it won't affect the timing of other verses)."]}),a.jsxs(A,{children:[a.jsx("strong",{children:"List of changes"})," on the right allows you to see and undo the actions one by one."]})]})]})]})}const A=D("p",{target:"enb6wj40"})({name:"1tcko1c",styles:"font-size:0.85rem;margin-bottom:1rem;line-height:1.25rem;strong{font-weight:bold;}"});function to(e){var t,o,n;return a.jsx(B,{"data-test":"sync-lyrics",children:e.data&&e.data.video.length<15&&!!((n=(o=(t=e.data.tracks)==null?void 0:t[0])==null?void 0:o.sections)!=null&&n.length)&&a.jsx(eo,{song:e.data,onUpdate:e.onChange,visible:e.visible})})}const V=["basic-data","author-and-video","sync","metadata"];function so({song:e}){const t=!!e,{data:o}=Be(!0);Ke(!1);const n=Xe();Je(!1);const[s,c]=d.useState(0),[r,l]=d.useState({sourceUrl:(e==null?void 0:e.sourceUrl)??"",txtInput:""}),[i,f]=d.useState({author:(e==null?void 0:e.author)??"",authorUrl:(e==null?void 0:e.authorUrl)??"",video:e!=null&&e.video?`https://www.youtube.com/watch?v=${e.video}`:""}),[x,v]=d.useState({artist:(e==null?void 0:e.artist)??"",title:(e==null?void 0:e.title)??"",realBpm:e!=null&&e.realBpm?String(e.realBpm):"",year:(e==null?void 0:e.year)??"",language:(e==null?void 0:e.language)??"",volume:(e==null?void 0:e.volume)??0,previewStart:(e==null?void 0:e.previewStart)??void 0,previewEnd:(e==null?void 0:e.previewEnd)??void 0,genre:e==null?void 0:e.genre}),[y,S]=d.useState(e),j=d.useRef(""),h=d.useMemo(()=>{try{return t?{...e,video:$e(i.video)||e.video,author:i.author,authorUrl:i.authorUrl,sourceUrl:r.sourceUrl}:r.txtInput?Qe(r.txtInput,i.video,i.author,i.authorUrl,r.sourceUrl):void 0}catch(m){j.current=m.message,console.error(m)}},[r.txtInput,i.video,i.author,i.authorUrl,r.sourceUrl,e,t]),L=d.useMemo(()=>!t&&h&&(o==null?void 0:o.find(m=>oe.generateSongFile(m)===oe.generateSongFile(h))),[o,h,t]);d.useEffect(()=>{h&&(h.video&&!i.video&&f(m=>({...m,video:`https://www.youtube.com/watch?v=${h.video}`})),h.author&&!i.author&&f(m=>({...m,author:m.author||(h==null?void 0:h.author)||"",authorUrl:m.authorUrl||(h==null?void 0:h.authorUrl)||""})),h.sourceUrl&&!r.sourceUrl&&l(m=>({...m,sourceUrl:h.sourceUrl})),["year","language","realBpm","genre","artist","title","volume","previewStart","previewEnd"].forEach(m=>{h[m]&&!x[m]&&v(C=>({...C,[m]:h[m]}))}))},[h,x.year,x.language,x.realBpm,x.genre,x.artist,x.volume,x.title,x.previewStart,x.previewEnd,r.sourceUrl,i.video]);const w=!!r.txtInput||t,$=!!i.video,u=V[s]==="author-and-video"?$:!0,p={...y,...x,author:i.author,authorUrl:i.authorUrl,realBpm:+x.realBpm,sourceUrl:r.sourceUrl,id:Ze(x)};return a.jsxs(mt,{injectFirst:!0,children:[a.jsx(et,{}),a.jsxs(ao,{children:[!t&&a.jsx("div",{style:{marginBottom:"1rem"},children:a.jsx(tt,{to:"",children:a.jsx("a",{children:"Return to the main menu"})})}),a.jsxs(ka,{activeStep:s,sx:{mb:2},nonLinear:t,children:[a.jsx(Z,{completed:w,children:a.jsx(ee,{color:"inherit",onClick:()=>c(0),children:"Basic Info"})},0),a.jsx(Z,{completed:$,children:a.jsx(ee,{color:"inherit",onClick:()=>c(1),children:"Author and video data"})},1),a.jsx(Z,{children:a.jsx(ee,{color:"inherit",onClick:()=>c(2),children:"Sync lyrics to video"})},2),a.jsx(Z,{children:a.jsx(ee,{color:"inherit",onClick:()=>c(3),children:"Fill song metadata"})},3)]}),a.jsxs("form",{onSubmit:async m=>{m.preventDefault(),s<V.length-1?c(C=>C+1):V.at(s)==="metadata"&&(await oe.store(p),t||ct(p.id),n(`edit?search=${encodeURIComponent(p.title)}${t?"":`&id=${p.id}`}`))},children:[V.at(s)==="basic-data"&&a.jsx(Pa,{shouldAutoImport:!$,isTxtRequired:!e,onAutoImport:f,onChange:l,data:r,finalSong:p}),V.at(s)==="author-and-video"&&a.jsx($a,{songArtist:h==null?void 0:h.artist,songTitle:h==null?void 0:h.title,onChange:f,data:i}),h&&a.jsx(to,{onChange:S,data:h,visible:V.at(s)==="sync"}),V.at(s)==="metadata"&&a.jsx(Na,{videoGap:y==null?void 0:y.videoGap,onChange:v,data:x,songArtist:h==null?void 0:h.artist,songTitle:h==null?void 0:h.title,videoId:h.video}),L&&a.jsxs(dt,{severity:"warning","data-test":"possible-duplicate",children:[a.jsx(ut,{children:"Possible duplicate"}),"There is already a song with similar artist and/or name:"," ",a.jsxs("b",{children:[L.artist," - ",L.title]})]}),a.jsxs(B,{sx:{display:"flex",justifyContent:"flex-end"},children:[a.jsx(k,{"data-test":"previous-button",sx:{mt:2,align:"right"},onClick:()=>c(m=>m-1),disabled:s===0,children:"Previous"}),V.at(s)==="metadata"?a.jsx(k,{"data-test":"save-button",sx:{mt:2,align:"right"},type:"submit",variant:"contained",children:"Save"}):a.jsx(k,{"data-test":"next-button",sx:{mt:2,align:"right"},variant:"contained",type:"submit",disabled:!u||s===V.length-1,children:"Next"})]})]})]})]})}const ao=D("div",{target:"e1qxoxak0"})({name:"1ec6m7r",styles:"background:white;margin:30px auto 0;width:1260px;height:100%"});export{so as default};
//# sourceMappingURL=ConvertView-uBZqnf63.js.map
